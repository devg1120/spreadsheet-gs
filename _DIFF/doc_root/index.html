
<!DOCTYPE html>
<html lang="jp" dir="ltr">

<head>
    <meta charset="utf-8">
    <title>test</title>
    <style>
        pre {
            font-size: 80%;
            font-weight:  bold;
            width: 100%;
            background-color: white;
            border-bottom: 1px dotted gray;
            padding: 0px;
            margin-top: 0px;
            margin-bottom: 0px;
          }

        body {
            background-color: white
            padding: 0px;
            margin: 0px;

        }
    </style>
</head>

<body>
<pre><font color="blue">../src/canvas/draw.js</font>                                                                                              <font color="blue">../../x-spreadsheet/src/canvas/draw.js</font>                                                                            </pre>
<pre>      <font color="black">39</font>     if (bottom) this.borderBottom = bottom;                                                                     <font color="black">39</font>     if (bottom) this.borderBottom = bottom;                                                              </pre>
<pre>      <font color="black">40</font>     if (left) this.borderLeft = left;                                                                           <font color="black">40</font>     if (left) this.borderLeft = left;                                                                    </pre>
<pre>      <font color="black">41</font>   }                                                                                                             <font color="black">41</font>   }                                                                                                      </pre>
<pre>      <font color="black">42</font>                                                                                                                 <font color="black">42</font>                                                                                                          </pre>
<pre>      <font color="black">43</font>   innerWidth() {                                                                                                <font color="black">43</font>   innerWidth() {                                                                                         </pre>
<pre>      <font color="black">44</font>     return this.width - (this.padding * 2);                                                                     <font color="black">44</font>     return this.width - (this.padding * 2)<font color="green"> - 2</font>;                                                          </pre>
<pre>      <font color="black">45</font>   }                                                                                                             <font color="black">45</font>   }                                                                                                      </pre>
<pre>      <font color="black">46</font>                                                                                                                 <font color="black">46</font>                                                                                                          </pre>
<pre>      <font color="black">47</font>   innerHeight() {                                                                                               <font color="black">47</font>   innerHeight() {                                                                                        </pre>
<pre>      <font color="black">48</font>     return this.height - (this.padding * 2);                                                                    <font color="black">48</font>     return this.height - (this.padding * 2)<font color="green"> - 2</font>;                                                         </pre>
<pre>      <font color="black">49</font>   }                                                                                                             <font color="black">49</font>   }                                                                                                      </pre>
<pre>      <font color="black">50</font>                                                                                                                 <font color="black">50</font>                                                                                                          </pre>
<pre>      <font color="black">51</font>   textx(align) {                                                                                                <font color="black">51</font>   textx(align) {                                                                                         </pre>
<pre>      <font color="black">52</font>     const { width, padding } = this;                                                                            <font color="black">52</font>     const { width, padding } = this;                                                                     </pre>
<pre>      <font color="black">53</font>     let { x } = this;                                                                                           <font color="black">53</font>     let { x } = this;                                                                                    </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">59</font>       x += width - padding;                                                                                     <font color="black">59</font>       x += width - padding;                                                                              </pre>
<pre>      <font color="black">60</font>     }                                                                                                           <font color="black">60</font>     }                                                                                                    </pre>
<pre>      <font color="black">61</font>     return x;                                                                                                   <font color="black">61</font>     return x;                                                                                            </pre>
<pre>      <font color="black">62</font>   }                                                                                                             <font color="black">62</font>   }                                                                                                      </pre>
<pre>      <font color="black">63</font>                                                                                                                 <font color="black">63</font>                                                                                                          </pre>
<pre>      <font color="black">64</font> <font color="red">  texty(align, fontSize, hoffset) {</font>                                                                             <font color="black">64</font> <font color="green">  texty(align, h) {</font>                                                                                      </pre>
<pre>      <font color="black">65</font>     const { height, padding } = this;                                                                           <font color="black">65</font>     const { height, padding } = this;                                                                    </pre>
<pre>      <font color="black">66</font>     let { y } = this;                                                                                           <font color="black">66</font>     let { y } = this;                                                                                    </pre>
<pre>      <font color="black">67</font>     if (align === 'top') {                                                                                      <font color="black">67</font>     if (align === 'top') {                                                                               </pre>
<pre>      <font color="black">68</font>       y += padding;                                                                                             <font color="black">68</font>       y += padding;                                                                                      </pre>
<pre>      <font color="black">69</font>     } else if (align === 'middle') {                                                                            <font color="black">69</font>     } else if (align === 'middle') {                                                                     </pre>
<pre>      <font color="black">70</font>       y =<font color="red"> y +</font> height / 2 - h<font color="orange">offset</font>;                                                                             <font color="black">70</font>       y <font color="green">+</font>= height / 2 - h<font color="orange"> / 2</font>;                                                                           </pre>
<pre>      <font color="black">71</font> <font color="red">      // y = y1;</font>                                                                                                                                                                                                            </pre>
<pre>      <font color="black">72</font> <font color="red">      // const y2 = y + padding + fontSize / 2 + 1;</font>                                                                                                                                                                         </pre>
<pre>      <font color="black">73</font> <font color="red">      // if (y1 < y2) y = y2;</font>                                                                                                                                                                                               </pre>
<pre>      <font color="black">74</font> <font color="red">      // else y = y1;</font>                                                                                                                                                                                                       </pre>
<pre>      <font color="black">75</font>     } else if (align === 'bottom') {                                                                            <font color="black">71</font>     } else if (align === 'bottom') {                                                                     </pre>
<pre>      <font color="black">76</font>       y += height -<font color="red"> hoffset * 2 -</font> padding;                                                                      <font color="black">72</font>       y += height - padding<font color="green"> - h</font>;                                                                         </pre>
<pre>      <font color="black">77</font>     }                                                                                                           <font color="black">73</font>     }                                                                                                    </pre>
<pre>      <font color="black">78</font>     return y;                                                                                                   <font color="black">74</font>     return y;                                                                                            </pre>
<pre>      <font color="black">79</font>   }                                                                                                             <font color="black">75</font>   }                                                                                                      </pre>
<pre>      <font color="black">80</font>                                                                                                                 <font color="black">76</font>                                                                                                          </pre>
<pre>      <font color="black">81</font>   topxys() {                                                                                                    <font color="black">77</font>   topxys() {                                                                                             </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">212</font>         italic: false,                                                                                         <font color="black">208</font>         italic: false,                                                                                   </pre>
<pre>     <font color="black">213</font>       }                                                                                                        <font color="black">209</font>       }                                                                                                  </pre>
<pre>     <font color="black">214</font>     }                                                                                                          <font color="black">210</font>     }                                                                                                    </pre>
<pre>     <font color="black">215</font>     textWrap: text wrapping                                                                                    <font color="black">211</font>     textWrap: text wrapping                                                                              </pre>
<pre>     <font color="black">216</font>   */                                                                                                           <font color="black">212</font>   */                                                                                                     </pre>
<pre>     <font color="black">217</font>   text(txt, box, attr = {}, textWrap = true) {                                                                 <font color="black">213</font>   text(<font color="green">m</font>txt, box, attr = {}, textWrap = true) {                                                          </pre>
<pre>     <font color="black">218</font>     const { ctx } = this;                                                                                      <font color="black">214</font>     const { ctx } = this;                                                                                </pre>
<pre>     <font color="black">219</font>     const {                                                                                                    <font color="black">215</font>     const {                                                                                              </pre>
<pre>     <font color="black">220</font>       align, valign, font, color, strike, underline,                                                           <font color="black">216</font>       align, valign, font, color, strike, underline,                                                     </pre>
<pre>     <font color="black">221</font>     } = attr;                                                                                                  <font color="black">217</font>     } = attr;                                                                                            </pre>
<pre>     <font color="black">222</font>     const tx = box.textx(align);                                                                               <font color="black">218</font>     const tx = box.textx(align);                                                                         </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">227</font>       textBaseline: valign,                                                                                    <font color="black">223</font>       textBaseline: valign,                                                                              </pre>
<pre>     <font color="black">228</font>       font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,      <font color="black">224</font>       font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,</pre>
<pre>     <font color="black">229</font>       fillStyle: color,                                                                                        <font color="black">225</font>       fillStyle: color,                                                                                  </pre>
<pre>     <font color="black">230</font>       strokeStyle: color,                                                                                      <font color="black">226</font>       strokeStyle: color,                                                                                </pre>
<pre>     <font color="black">231</font>     });                                                                                                        <font color="black">227</font>     });                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">228</font> <font color="green">    const txts = mtxt.split('\n');</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">229</font> <font color="green">    const biw = box.innerWidth();</font>                                                                        </pre>
<pre>                                                                                                                        <font color="black">230</font> <font color="green">    const ntxts = [];</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">231</font> <font color="green">    txts.forEach((it) => {</font>                                                                               </pre>
<pre>     <font color="black">232</font>     const txtWidth = ctx.measureText(<font color="orange">tx</font>t).width;                                                               <font color="black">232</font> <font color="green">  </font>    const txtWidth = ctx.measureText(<font color="orange">i</font>t).width;                                                        </pre>
<pre>     <font color="black">233</font> <font color="red">    let hoffset = 0;</font>                                                                                                                                                                                                        </pre>
<pre>     <font color="black">234</font> <font color="red">    if (textWrap) {</font>                                                                                                                                                                                                         </pre>
<pre>     <font color="black">235</font> <font color="red">      const n = Math.ceil(txtWidth / box.innerWidth());</font>                                                                                                                                                                     </pre>
<pre>     <font color="black">236</font> <font color="red">      hoffset = ((n - 1) * font.size) / 2;</font>                                                                                                                                                                                  </pre>
<pre>     <font color="black">237</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre>
<pre>     <font color="black">238</font> <font color="red">    let ty = box.texty(valign, font.size, hoffset);</font>                                                                                                                                                                         </pre>
<pre>     <font color="black">239</font> <font color="red">    // console.log('tx: ', tx, ', ty:', ty);</font>                                                                                                                                                                                </pre>
<pre>     <font color="black">240</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre>
<pre>     <font color="black">241</font>     if (textWrap && txtWidth > b<font color="red">ox.</font>i<font color="orange">nnerWidth(</font>)<font color="red">)</font> {                                                             <font color="black">233</font> <font color="green">  </font>    if (textWrap && txtWidth > bi<font color="orange">w</font>) {                                                                  </pre>
<pre>     <font color="black">242</font>       <font color="orange">cons</font>t textLine = { len: 0, start: 0 };                                                                   <font color="black">234</font>       <font color="orange">  le</font>t textLine = {<font color="green"> w: 0,</font> len: 0, start: 0 };                                                       </pre>
<pre>     <font color="black">243</font>       for (let i = 0; i < <font color="orange">tx</font>t.length; i += 1) {                                                                <font color="black">235</font> <font color="green">  </font>      for (let i = 0; i < <font color="orange">i</font>t.length; i += 1) {                                                         </pre>
<pre>     <font color="black">244</font> <font color="red">        if (textLine.len >= box.innerWidth()) {</font>                                                                <font color="black">236</font> <font color="green">          if (textLine.w >= biw) {</font>                                                                       </pre>
<pre>     <font color="black">245</font> <font color="red">          this.fillText(txt.substring(textLine.start, i), tx, ty);</font>                                             <font color="black">237</font> <font color="green">            ntxts.push(it.substr(textLine.start, textLine.len));</font>                                         </pre>
<pre>     <font color="black">246</font> <font color="red">          if (strike) {</font>                                                                                        <font color="black">238</font> <font color="green">            textLine = { w: 0, len: 0, start: i };</font>                                                       </pre>
<pre>     <font color="black">247</font> <font color="red">            drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                              </pre>
<pre>     <font color="black">248</font>           }                                                                                                    <font color="black">239</font>           }                                                                                              </pre>
<pre>     <font color="black">249</font> <font color="red">          if (underline) {</font>                                                                                                                                                                                                  </pre>
<pre>     <font color="black">250</font> <font color="red">            drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                           </pre>
<pre>     <font color="black">251</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">252</font> <font color="red">          ty += font.size + 2;</font>                                                                                                                                                                                              </pre>
<pre>     <font color="black">253</font>           textLine.len = <font color="orange">0</font>;                                                                                    <font color="black">240</font>           textLine.len <font color="green">+</font>= <font color="orange">1</font>;                                                                             </pre>
<pre>     <font color="black">254</font> <font color="red">          textLine.start = i;</font>                                                                                  <font color="black">241</font> <font color="green">          textLine.w += ctx.measureText(it[i]).width + 1;</font>                                                </pre>
<pre>     <font color="black">255</font>         }                                                                                                      <font color="black">242</font>         }                                                                                                </pre>
<pre>     <font color="black">256</font> <font color="red">        textLine.len += ctx.measureText(txt[i]).width;</font>                                                                                                                                                                      </pre>
<pre>     <font color="black">257</font> <font color="red">      }</font>                                                                                                                                                                                                                     </pre>
<pre>     <font color="black">258</font>       if (textLine.len > 0) {                                                                                  <font color="black">243</font> <font color="green">  </font>      if (textLine.len > 0) {                                                                          </pre>
<pre>     <font color="black">259</font> <font color="red">        this.fillText(txt.substring(textLine.start), tx, ty);</font>                                                  <font color="black">244</font> <font color="green">          ntxts.push(it.substr(textLine.start, textLine.len));</font>                                           </pre>
<pre>     <font color="black">260</font> <font color="red">        if (strike) {</font>                                                                                                                                                                                                       </pre>
<pre>     <font color="black">261</font> <font color="red">          drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                                </pre>
<pre>     <font color="black">262</font>         }                                                                                                      <font color="black">245</font>         }                                                                                                </pre>
<pre>     <font color="black">263</font> <font color="red">        if (underline) {</font>                                                                                                                                                                                                    </pre>
<pre>     <font color="black">264</font> <font color="red">          drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                             </pre>
<pre>     <font color="black">265</font> <font color="red">        }</font>                                                                                                                                                                                                                   </pre>
<pre>     <font color="black">266</font> <font color="red">      }</font>                                                                                                                                                                                                                     </pre>
<pre>     <font color="black">267</font> <font color="red">*/</font>                                                                                                                                                                                                                          </pre>
<pre>     <font color="black">268</font> <font color="red">//    } else if ( txtWidth > box.innerWidth()){</font>                                                                                                                                                                             </pre>
<pre>     <font color="black">269</font> <font color="red">//     } else {</font>                                                                                                                                                                                                             </pre>
<pre>     <font color="black">270</font> <font color="red">      const textLine = { len: 0, start: 0 };</font>                                                                                                                                                                                </pre>
<pre>     <font color="black">271</font> <font color="red">//      console.log(txt);</font>                                                                                                                                                                                                   </pre>
<pre>     <font color="black">272</font> <font color="red">      for (let i = 0; i < txt.length; i += 1) {</font>                                                                                                                                                                             </pre>
<pre>     <font color="black">273</font> <font color="red">        //console.log(txt.substring(textLine.start, i));</font>                                                                                                                                                                    </pre>
<pre>     <font color="black">274</font> <font color="red">        //console.log(txt.substr(textLine.start+i, 1));</font>                                                                                                                                                                     </pre>
<pre>     <font color="black">275</font> <font color="red">        //if (txt.substr(textLine.start+i, 1) == 'R') {</font>                                                                                                                                                                     </pre>
<pre>     <font color="black">276</font> <font color="red">         let x = i - textLine.start;</font>                                                                                                                                                                                        </pre>
<pre>     <font color="black">277</font> <font color="red">//        console.log("+ ",txt.substr(textLine.start+x, 1));</font>                                                                                                                                                                </pre>
<pre>     <font color="black">278</font> <font color="red">        if (txt.substr(textLine.start+x, 1) == '\n') {</font>                                                                                                                                                                      </pre>
<pre>     <font color="black">279</font> <font color="red">          this.fillText(txt.substring(textLine.start, i), tx, ty);</font>                                                                                                                                                          </pre>
<pre>     <font color="black">280</font> <font color="red">          if (strike) {</font>                                                                                                                                                                                                     </pre>
<pre>     <font color="black">281</font> <font color="red">            drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                              </pre>
<pre>     <font color="black">282</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">283</font> <font color="red">          if (underline) {</font>                                                                                                                                                                                                  </pre>
<pre>     <font color="black">284</font> <font color="red">            drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                           </pre>
<pre>     <font color="black">285</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">286</font> <font color="red">          ty += font.size + 2; // next line</font>                                                                                                                                                                                 </pre>
<pre>     <font color="black">287</font> <font color="red">          textLine.len = 0;</font>                                                                                                                                                                                                 </pre>
<pre>     <font color="black">288</font> <font color="red">          i++;                 // \n skip</font>                                                                                                                                                                                   </pre>
<pre>     <font color="black">289</font> <font color="red">          textLine.start = i;</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">290</font> <font color="red">         /*else if (textLine.len >= box.innerWidth()) {</font>                                                                                                                                                                     </pre>
<pre>     <font color="black">291</font> <font color="red">          this.fillText(txt.substring(textLine.start, i), tx, ty);</font>                                                                                                                                                          </pre>
<pre>     <font color="black">292</font> <font color="red">          if (strike) {</font>                                                                                                                                                                                                     </pre>
<pre>     <font color="black">293</font> <font color="red">            drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                              </pre>
<pre>     <font color="black">294</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">295</font> <font color="red">          if (underline) {</font>                                                                                                                                                                                                  </pre>
<pre>     <font color="black">296</font> <font color="red">            drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                           </pre>
<pre>     <font color="black">297</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">298</font> <font color="red">          ty += font.size + 2;</font>                                                                                                                                                                                              </pre>
<pre>     <font color="black">299</font> <font color="red">          textLine.len = 0;</font>                                                                                                                                                                                                 </pre>
<pre>     <font color="black">300</font> <font color="red">          textLine.start = i;</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">301</font> <font color="red">        }*/</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">302</font> <font color="red">        }else{</font>                                                                                                                                                                                                              </pre>
<pre>     <font color="black">303</font> <font color="red">        textLine.len += ctx.measureText(txt[i]).width;</font>                                                                                                                                                                      </pre>
<pre>     <font color="black">304</font> <font color="red">        }</font>                                                                                                                                                                                                                   </pre>
<pre>     <font color="black">305</font> <font color="red">      } //for</font>                                                                                                                                                                                                               </pre>
<pre>     <font color="black">306</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre>
<pre>     <font color="black">307</font> <font color="red">      if (textLine.len > 0) {</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">308</font> <font color="red">//        console.log(">>",txt.substring(textLine.start));</font>                                                                                                                                                                  </pre>
<pre>     <font color="black">309</font> <font color="red">          this.fillText(txt.substring(textLine.start), tx, ty);</font>                                                                                                                                                             </pre>
<pre>     <font color="black">310</font> <font color="red">          if (strike) {</font>                                                                                                                                                                                                     </pre>
<pre>     <font color="black">311</font> <font color="red">            drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                              </pre>
<pre>     <font color="black">312</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">313</font> <font color="red">          if (underline) {</font>                                                                                                                                                                                                  </pre>
<pre>     <font color="black">314</font> <font color="red">            drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                           </pre>
<pre>     <font color="black">315</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">316</font> <font color="red">        }</font>                                                                                                                                                                                                                   </pre>
<pre>     <font color="black">317</font> <font color="red">        </font>                                                                                                                                                                                                                    </pre>
<pre>     <font color="black">318</font> <font color="red"> //     }</font>                                                                                                                                                                                                                   </pre>
<pre>     <font color="black">319</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">320</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre>
<pre>     <font color="black">321</font>     } else {                                                                                                   <font color="black">246</font> <font color="green">  </font>    } else {                                                                                           </pre>
<pre>                                                                                                                        <font color="black">247</font> <font color="green">        ntxts.push(it);</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">248</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">249</font> <font color="green">    });</font>                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">250</font> <font color="green">    const txtHeight = (ntxts.length - 1) * (font.size + 2);</font>                                              </pre>
<pre>                                                                                                                        <font color="black">251</font> <font color="green">    let ty = box.texty(valign, txtHeight);</font>                                                               </pre>
<pre>                                                                                                                        <font color="black">252</font> <font color="green">    ntxts.forEach((txt) => {</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">253</font> <font color="green">      const txtWidth = ctx.measureText(txt).width;</font>                                                       </pre>
<pre>     <font color="black">322</font>       this.fillText(txt, tx, ty);                                                                              <font color="black">254</font>       this.fillText(txt, tx, ty);                                                                        </pre>
<pre>     <font color="black">323</font>       if (strike) {                                                                                            <font color="black">255</font>       if (strike) {                                                                                      </pre>
<pre>     <font color="black">324</font>         drawFontLine.call(this, 'strike<font color="red">t</font>', tx, ty, align, valign, font.size, txtWidth);                        <font color="black">256</font>         drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, txtWidth);                   </pre>
<pre>     <font color="black">325</font>       }                                                                                                        <font color="black">257</font>       }                                                                                                  </pre>
<pre>     <font color="black">326</font>       if (underline) {                                                                                         <font color="black">258</font>       if (underline) {                                                                                   </pre>
<pre>     <font color="black">327</font>         drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);                      <font color="black">259</font>         drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);                </pre>
<pre>     <font color="black">328</font>       }                                                                                                        <font color="black">260</font>       }                                                                                                  </pre>
<pre>     <font color="black">329</font> <font color="red">*/</font>                                                                                                             <font color="black">261</font> <font color="green">      ty += font.size + 2;</font>                                                                               </pre>
<pre>     <font color="black">330</font> <font color="red">//    }</font>                                                                                                        <font color="black">262</font> <font color="green">    });</font>                                                                                                  </pre>
<pre>     <font color="black">331</font>     ctx.restore();                                                                                             <font color="black">263</font>     ctx.restore();                                                                                       </pre>
<pre>     <font color="black">332</font>     return this;                                                                                               <font color="black">264</font>     return this;                                                                                         </pre>
<pre>     <font color="black">333</font>   }                                                                                                            <font color="black">265</font>   }                                                                                                      </pre>
<pre>     <font color="black">334</font>                                                                                                                <font color="black">266</font>                                                                                                          </pre>
<pre>     <font color="black">335</font>   border(style, color) {                                                                                       <font color="black">267</font>   border(style, color) {                                                                                 </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">424</font>     ctx.fillStyle = 'rgba(255, 0, 0, .65)';                                                                    <font color="black">356</font>     ctx.fillStyle = 'rgba(255, 0, 0, .65)';                                                              </pre>
<pre>     <font color="black">425</font>     ctx.fill();                                                                                                <font color="black">357</font>     ctx.fill();                                                                                          </pre>
<pre>     <font color="black">426</font>     ctx.restore();                                                                                             <font color="black">358</font>     ctx.restore();                                                                                       </pre>
<pre>     <font color="black">427</font>   }                                                                                                            <font color="black">359</font>   }                                                                                                      </pre>
<pre>     <font color="black">428</font>                                                                                                                <font color="black">360</font>                                                                                                          </pre>
<pre>                                                                                                                        <font color="black">361</font> <font color="green">  frozen(box) {</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">362</font> <font color="green">    const { ctx } = this;</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">363</font> <font color="green">    const { x, y, width } = box;</font>                                                                         </pre>
<pre>                                                                                                                        <font color="black">364</font> <font color="green">    const sx = x + width - 1;</font>                                                                            </pre>
<pre>                                                                                                                        <font color="black">365</font> <font color="green">    ctx.save();</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">366</font> <font color="green">    ctx.beginPath();</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">367</font> <font color="green">    ctx.moveTo(npx(sx - 8), npx(y - 1));</font>                                                                 </pre>
<pre>                                                                                                                        <font color="black">368</font> <font color="green">    ctx.lineTo(npx(sx), npx(y - 1));</font>                                                                     </pre>
<pre>                                                                                                                        <font color="black">369</font> <font color="green">    ctx.lineTo(npx(sx), npx(y + 8));</font>                                                                     </pre>
<pre>                                                                                                                        <font color="black">370</font> <font color="green">    ctx.closePath();</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">371</font> <font color="green">    ctx.fillStyle = 'rgba(0, 255, 0, .85)';</font>                                                              </pre>
<pre>                                                                                                                        <font color="black">372</font> <font color="green">    ctx.fill();</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">373</font> <font color="green">    ctx.restore();</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">374</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">375</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">429</font>   rect(box, dtextcb) {                                                                                         <font color="black">376</font>   rect(box, dtextcb) {                                                                                   </pre>
<pre>     <font color="black">430</font>     const { ctx } = this;                                                                                      <font color="black">377</font>     const { ctx } = this;                                                                                </pre>
<pre>     <font color="black">431</font>     const {                                                                                                    <font color="black">378</font>     const {                                                                                              </pre>
<pre>     <font color="black">432</font>       x, y, width, height, bgcolor,                                                                            <font color="black">379</font>       x, y, width, height, bgcolor,                                                                      </pre>
<pre>     <font color="black">433</font>     } = box;                                                                                                   <font color="black">380</font>     } = box;                                                                                             </pre>
<pre><font color="blue">../src/locale/zh-cn.js</font>                                                                                             <font color="blue">../../x-spreadsheet/src/locale/zh-cn.js</font>                                                                           </pre>
<pre>       <font color="black">1</font> export default {                                                                                                 <font color="black">1</font> export default {                                                                                         </pre>
<pre>       <font color="black">2</font>   toolbar: {                                                                                                     <font color="black">2</font>   toolbar: {                                                                                             </pre>
<pre>       <font color="black">3</font>     undo: '撤销',                                                                                                <font color="black">3</font>     undo: '撤销',                                                                                        </pre>
<pre>       <font color="black">4</font>     redo: '恢复',                                                                                                <font color="black">4</font>     redo: '恢复',                                                                                        </pre>
<pre>                                                                                                                          <font color="black">5</font> <font color="green">    print: '打印',</font>                                                                                       </pre>
<pre>       <font color="black">5</font>     paintformat: '格式刷',                                                                                       <font color="black">6</font>     paintformat: '格式刷',                                                                               </pre>
<pre>       <font color="black">6</font>     clearformat: '清除格式',                                                                                     <font color="black">7</font>     clearformat: '清除格式',                                                                             </pre>
<pre>       <font color="black">7</font>     format: '数据格式',                                                                                          <font color="black">8</font>     format: '数据格式',                                                                                  </pre>
<pre>       <font color="black">8</font>     font: '字体',                                                                                                <font color="black">9</font>     font<font color="green">Name</font>: '字体',                                                                                    </pre>
<pre>       <font color="black">9</font>     fontSize: '字号',                                                                                           <font color="black">10</font>     fontSize: '字号',                                                                                    </pre>
<pre>      <font color="black">10</font>     fontBold: '加粗',                                                                                           <font color="black">11</font>     fontBold: '加粗',                                                                                    </pre>
<pre>      <font color="black">11</font>     fontItalic: '倾斜',                                                                                         <font color="black">12</font>     fontItalic: '倾斜',                                                                                  </pre>
<pre>      <font color="black">12</font>     underline: '下划线',                                                                                        <font color="black">13</font>     underline: '下划线',                                                                                 </pre>
<pre>      <font color="black">13</font>     strike: '删除线',                                                                                           <font color="black">14</font>     strike: '删除线',                                                                                    </pre>
<pre>      <font color="black">14</font>     <font color="orange">textC</font>olor: '字体颜色',                                                                                      <font color="black">15</font>     <font color="orange">c</font>olor: '字体颜色',                                                                                   </pre>
<pre>      <font color="black">15</font>     <font color="orange">fillC</font>olor: '填充颜色',                                                                                      <font color="black">16</font>     <font color="orange">bgc</font>olor: '填充颜色',                                                                                 </pre>
<pre>      <font color="black">16</font>     border: '边框',                                                                                             <font color="black">17</font>     border: '边框',                                                                                      </pre>
<pre>      <font color="black">17</font>     merge: '合并单元格',                                                                                        <font color="black">18</font>     merge: '合并单元格',                                                                                 </pre>
<pre>      <font color="black">18</font>     align: '水平对齐',                                                                                          <font color="black">19</font>     align: '水平对齐',                                                                                   </pre>
<pre>      <font color="black">19</font>     valign: '垂直对齐',                                                                                         <font color="black">20</font>     valign: '垂直对齐',                                                                                  </pre>
<pre>      <font color="black">20</font>     textwrap: '自动换行',                                                                                       <font color="black">21</font>     textwrap: '自动换行',                                                                                </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">29</font>     paste: '粘贴',                                                                                              <font color="black">30</font>     paste: '粘贴',                                                                                       </pre>
<pre>      <font color="black">30</font>     pasteValue: '粘贴数据',                                                                                     <font color="black">31</font>     pasteValue: '粘贴数据',                                                                              </pre>
<pre>      <font color="black">31</font>     pasteFormat: '粘贴格式',                                                                                    <font color="black">32</font>     pasteFormat: '粘贴格式',                                                                             </pre>
<pre>      <font color="black">32</font>     insertRow: '插入行',                                                                                        <font color="black">33</font>     insertRow: '插入行',                                                                                 </pre>
<pre>      <font color="black">33</font>     insertColumn: '插入列',                                                                                     <font color="black">34</font>     insertColumn: '插入列',                                                                              </pre>
<pre>                                                                                                                         <font color="black">35</font> <font color="green">    deleteSheet: '删除',</font>                                                                                 </pre>
<pre>      <font color="black">34</font>     deleteRow: '删除行',                                                                                        <font color="black">36</font>     deleteRow: '删除行',                                                                                 </pre>
<pre>      <font color="black">35</font>     deleteColumn: '删除列',                                                                                     <font color="black">37</font>     deleteColumn: '删除列',                                                                              </pre>
<pre>      <font color="black">36</font>     deleteCell: '删除',                                                                                         <font color="black">38</font>     deleteCell: '删除',                                                                                  </pre>
<pre>      <font color="black">37</font>     deleteCellText: '删除数据',                                                                                 <font color="black">39</font>     deleteCellText: '删除数据',                                                                          </pre>
<pre>      <font color="black">38</font>     validation: '数据验证',                                                                                     <font color="black">40</font>     validation: '数据验证',                                                                              </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">53</font>     sum: '求和',                                                                                                <font color="black">55</font>     sum: '求和',                                                                                         </pre>
<pre>      <font color="black">54</font>     average: '求平均值',                                                                                        <font color="black">56</font>     average: '求平均值',                                                                                 </pre>
<pre>      <font color="black">55</font>     max: '求最大值',                                                                                            <font color="black">57</font>     max: '求最大值',                                                                                     </pre>
<pre>      <font color="black">56</font>     min: '求最小值',                                                                                            <font color="black">58</font>     min: '求最小值',                                                                                     </pre>
<pre>      <font color="black">57</font>     concat: '字符拼接',                                                                                         <font color="black">59</font>     concat: '字符拼接',                                                                                  </pre>
<pre>                                                                                                                         <font color="black">60</font> <font color="green">    _if: '条件判断',</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">61</font> <font color="green">    and: '和',</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">62</font> <font color="green">    or: '或',</font>                                                                                            </pre>
<pre>      <font color="black">58</font>   },                                                                                                            <font color="black">63</font>   },                                                                                                     </pre>
<pre>      <font color="black">59</font>   validation: {                                                                                                 <font color="black">64</font>   validation: {                                                                                          </pre>
<pre>      <font color="black">60</font>     required: '此值必填',                                                                                       <font color="black">65</font>     required: '此值必填',                                                                                </pre>
<pre>      <font color="black">61</font>     notMatch: '此值不匹配验证规则',                                                                             <font color="black">66</font>     notMatch: '此值不匹配验证规则',                                                                      </pre>
<pre>      <font color="black">62</font>     between: '此值应在 {} 和 {} 之间',                                                                          <font color="black">67</font>     between: '此值应在 {} 和 {} 之间',                                                                   </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">75</font>   calendar: {                                                                                                   <font color="black">80</font>   calendar: {                                                                                            </pre>
<pre>      <font color="black">76</font>     weeks: ['日', '一', '二', '三', '四', '五', '六'],                                                          <font color="black">81</font>     weeks: ['日', '一', '二', '三', '四', '五', '六'],                                                   </pre>
<pre>      <font color="black">77</font>     months: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十       <font color="black">82</font>     months: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十</pre>
<pre>二月'],                                                                                                            二月'],                                                                                                           </pre>
<pre>      <font color="black">78</font>   },                                                                                                            <font color="black">83</font>   },                                                                                                     </pre>
<pre>      <font color="black">79</font>   button: {                                                                                                     <font color="black">84</font>   button: {                                                                                              </pre>
<pre>                                                                                                                         <font color="black">85</font> <font color="green">    next: '下一步',</font>                                                                                      </pre>
<pre>      <font color="black">80</font>     cancel: '取消',                                                                                             <font color="black">86</font>     cancel: '取消',                                                                                      </pre>
<pre>      <font color="black">81</font>     remove: '删除',                                                                                             <font color="black">87</font>     remove: '删除',                                                                                      </pre>
<pre>      <font color="black">82</font>     save: '保存',                                                                                               <font color="black">88</font>     save: '保存',                                                                                        </pre>
<pre>      <font color="black">83</font>     ok: '确认',                                                                                                 <font color="black">89</font>     ok: '确认',                                                                                          </pre>
<pre>      <font color="black">84</font>   },                                                                                                            <font color="black">90</font>   },                                                                                                     </pre>
<pre><font color="blue">../src/locale/en.js</font>                                                                                                <font color="blue">../../x-spreadsheet/src/locale/en.js</font>                                                                              </pre>
<pre>       <font color="black">1</font> export default {                                                                                                 <font color="black">1</font> export default {                                                                                         </pre>
<pre>       <font color="black">2</font>   toolbar: {                                                                                                     <font color="black">2</font>   toolbar: {                                                                                             </pre>
<pre>       <font color="black">3</font>     undo: 'Undo',                                                                                                <font color="black">3</font>     undo: 'Undo',                                                                                        </pre>
<pre>       <font color="black">4</font>     redo: 'Redo',                                                                                                <font color="black">4</font>     redo: 'Redo',                                                                                        </pre>
<pre>                                                                                                                          <font color="black">5</font> <font color="green">    print: 'Print',</font>                                                                                      </pre>
<pre>       <font color="black">5</font>     paintformat: 'Paint format',                                                                                 <font color="black">6</font>     paintformat: 'Paint format',                                                                         </pre>
<pre>       <font color="black">6</font>     clearformat: 'Clear format',                                                                                 <font color="black">7</font>     clearformat: 'Clear format',                                                                         </pre>
<pre>       <font color="black">7</font>     format: 'Format',                                                                                            <font color="black">8</font>     format: 'Format',                                                                                    </pre>
<pre>       <font color="black">8</font>     font: 'Font',                                                                                                <font color="black">9</font>     font<font color="green">Name</font>: 'Font',                                                                                    </pre>
<pre>       <font color="black">9</font>     fontSize: 'Font size',                                                                                      <font color="black">10</font>     fontSize: 'Font size',                                                                               </pre>
<pre>      <font color="black">10</font>     fontBold: 'Font bold',                                                                                      <font color="black">11</font>     fontBold: 'Font bold',                                                                               </pre>
<pre>      <font color="black">11</font>     fontItalic: 'Font italic',                                                                                  <font color="black">12</font>     fontItalic: 'Font italic',                                                                           </pre>
<pre>      <font color="black">12</font>     underline: 'Underline',                                                                                     <font color="black">13</font>     underline: 'Underline',                                                                              </pre>
<pre>      <font color="black">13</font>     strike: 'Strike',                                                                                           <font color="black">14</font>     strike: 'Strike',                                                                                    </pre>
<pre>      <font color="black">14</font>     <font color="orange">textC</font>olor: 'Text color',                                                                                    <font color="black">15</font>     <font color="orange">c</font>olor: 'Text color',                                                                                 </pre>
<pre>      <font color="black">15</font>     <font color="orange">fillC</font>olor: 'Fill color',                                                                                    <font color="black">16</font>     <font color="orange">bgc</font>olor: 'Fill color',                                                                               </pre>
<pre>      <font color="black">16</font>     border: 'Borders',                                                                                          <font color="black">17</font>     border: 'Borders',                                                                                   </pre>
<pre>      <font color="black">17</font>     merge: 'Merge cells',                                                                                       <font color="black">18</font>     merge: 'Merge cells',                                                                                </pre>
<pre>      <font color="black">18</font>     align: 'Horizontal align',                                                                                  <font color="black">19</font>     align: 'Horizontal align',                                                                           </pre>
<pre>      <font color="black">19</font>     valign: 'Vertical align',                                                                                   <font color="black">20</font>     valign: 'Vertical align',                                                                            </pre>
<pre>      <font color="black">20</font>     textwrap: 'Text wrapping',                                                                                  <font color="black">21</font>     textwrap: 'Text wrapping',                                                                           </pre>
<pre>      <font color="black">21</font>     freeze: 'Freeze cell',                                                                                      <font color="black">22</font>     freeze: 'Freeze cell',                                                                               </pre>
<pre>      <font color="black">22</font> <font color="red">    overlayer: 'OverLayer enable',</font>                                                                                                                                                                                          </pre>
<pre>      <font color="black">23</font>     autofilter: 'Filter',                                                                                       <font color="black">23</font>     autofilter: 'Filter',                                                                                </pre>
<pre>      <font color="black">24</font>     formula: 'Functions',                                                                                       <font color="black">24</font>     formula: 'Functions',                                                                                </pre>
<pre>      <font color="black">25</font>     more: 'More',                                                                                               <font color="black">25</font>     more: 'More',                                                                                        </pre>
<pre>      <font color="black">26</font>   },                                                                                                            <font color="black">26</font>   },                                                                                                     </pre>
<pre>      <font color="black">27</font>   contextmenu: {                                                                                                <font color="black">27</font>   contextmenu: {                                                                                         </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">30</font>     paste: 'Paste',                                                                                             <font color="black">30</font>     paste: 'Paste',                                                                                      </pre>
<pre>      <font color="black">31</font>     pasteValue: 'Paste values only',                                                                            <font color="black">31</font>     pasteValue: 'Paste values only',                                                                     </pre>
<pre>      <font color="black">32</font>     pasteFormat: 'Paste format only',                                                                           <font color="black">32</font>     pasteFormat: 'Paste format only',                                                                    </pre>
<pre>      <font color="black">33</font>     insertRow: 'Insert row',                                                                                    <font color="black">33</font>     insertRow: 'Insert row',                                                                             </pre>
<pre>      <font color="black">34</font>     insertColumn: 'Insert column',                                                                              <font color="black">34</font>     insertColumn: 'Insert column',                                                                       </pre>
<pre>                                                                                                                         <font color="black">35</font> <font color="green">    deleteSheet: 'Delete',</font>                                                                               </pre>
<pre>      <font color="black">35</font>     deleteRow: 'Delete row',                                                                                    <font color="black">36</font>     deleteRow: 'Delete row',                                                                             </pre>
<pre>      <font color="black">36</font>     deleteColumn: 'Delete column',                                                                              <font color="black">37</font>     deleteColumn: 'Delete column',                                                                       </pre>
<pre>      <font color="black">37</font>     deleteCell: 'Delete cell',                                                                                  <font color="black">38</font>     deleteCell: 'Delete cell',                                                                           </pre>
<pre>      <font color="black">38</font>     deleteCellText: 'Delete cell text',                                                                         <font color="black">39</font>     deleteCellText: 'Delete cell text',                                                                  </pre>
<pre>      <font color="black">39</font>     validation: 'Data validations',                                                                             <font color="black">40</font>     validation: 'Data validations',                                                                      </pre>
<pre>                                                                                                                         <font color="black">41</font> <font color="green">    cellprintable: 'Enable export',</font>                                                                      </pre>
<pre>                                                                                                                         <font color="black">42</font> <font color="green">    cellnonprintable: 'Disable export',</font>                                                                  </pre>
<pre>                                                                                                                         <font color="black">43</font> <font color="green">    celleditable: 'Enable editing',</font>                                                                      </pre>
<pre>                                                                                                                         <font color="black">44</font> <font color="green">    cellnoneditable: 'Disable editing',</font>                                                                  </pre>
<pre>      <font color="black">40</font>   },                                                                                                            <font color="black">45</font>   },                                                                                                     </pre>
<pre>      <font color="black">41</font>   format: {                                                                                                     <font color="black">46</font>   format: {                                                                                              </pre>
<pre>      <font color="black">42</font>     normal: 'Normal',                                                                                           <font color="black">47</font>     normal: 'Normal',                                                                                    </pre>
<pre>      <font color="black">43</font>     text: 'Plain Text',                                                                                         <font color="black">48</font>     text: 'Plain Text',                                                                                  </pre>
<pre>      <font color="black">44</font>     number: 'Number',                                                                                           <font color="black">49</font>     number: 'Number',                                                                                    </pre>
<pre>      <font color="black">45</font>     percent: 'Percent',                                                                                         <font color="black">50</font>     percent: 'Percent',                                                                                  </pre>
<pre>      <font color="black">46</font>     rmb: 'RMB',                                                                                                 <font color="black">51</font>     rmb: 'RMB',                                                                                          </pre>
<pre>      <font color="black">47</font>     usd: 'USD',                                                                                                 <font color="black">52</font>     usd: 'USD',                                                                                          </pre>
<pre>                                                                                                                         <font color="black">53</font> <font color="green">    eur: 'EUR',</font>                                                                                          </pre>
<pre>      <font color="black">48</font>     date: 'Date',                                                                                               <font color="black">54</font>     date: 'Date',                                                                                        </pre>
<pre>      <font color="black">49</font>     time: 'Time',                                                                                               <font color="black">55</font>     time: 'Time',                                                                                        </pre>
<pre>      <font color="black">50</font>     datetime: 'Date time',                                                                                      <font color="black">56</font>     datetime: 'Date time',                                                                               </pre>
<pre>      <font color="black">51</font>     duration: 'Duration',                                                                                       <font color="black">57</font>     duration: 'Duration',                                                                                </pre>
<pre>      <font color="black">52</font>   },                                                                                                            <font color="black">58</font>   },                                                                                                     </pre>
<pre>      <font color="black">53</font>   formula: {                                                                                                    <font color="black">59</font>   formula: {                                                                                             </pre>
<pre>      <font color="black">54</font>     sum: 'Sum',                                                                                                 <font color="black">60</font>     sum: 'Sum',                                                                                          </pre>
<pre>      <font color="black">55</font>     average: 'Average',                                                                                         <font color="black">61</font>     average: 'Average',                                                                                  </pre>
<pre>      <font color="black">56</font>     max: 'Max',                                                                                                 <font color="black">62</font>     max: 'Max',                                                                                          </pre>
<pre>      <font color="black">57</font>     min: 'Min',                                                                                                 <font color="black">63</font>     min: 'Min',                                                                                          </pre>
<pre>                                                                                                                         <font color="black">64</font> <font color="green">    _if: 'IF',</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">65</font> <font color="green">    and: 'AND',</font>                                                                                          </pre>
<pre>                                                                                                                         <font color="black">66</font> <font color="green">    or: 'OR',</font>                                                                                            </pre>
<pre>      <font color="black">58</font>     concat: 'Concat',                                                                                           <font color="black">67</font>     concat: 'Concat',                                                                                    </pre>
<pre>      <font color="black">59</font>   },                                                                                                            <font color="black">68</font>   },                                                                                                     </pre>
<pre>      <font color="black">60</font>   validation: {                                                                                                 <font color="black">69</font>   validation: {                                                                                          </pre>
<pre>      <font color="black">61</font>     required: 'it must be required',                                                                            <font color="black">70</font>     required: 'it must be required',                                                                     </pre>
<pre>      <font color="black">62</font>     notMatch: 'it not match its validation rule',                                                               <font color="black">71</font>     notMatch: 'it not match its validation rule',                                                        </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">76</font>   calendar: {                                                                                                   <font color="black">85</font>   calendar: {                                                                                            </pre>
<pre>      <font color="black">77</font>     weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],                                                   <font color="black">86</font>     weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],                                            </pre>
<pre>      <font color="black">78</font>     months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'Octo       <font color="black">87</font>     months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'Octo</pre>
<pre>ber', 'November', 'December'],                                                                                     ber', 'November', 'December'],                                                                                    </pre>
<pre>      <font color="black">79</font>   },                                                                                                            <font color="black">88</font>   },                                                                                                     </pre>
<pre>      <font color="black">80</font>   button: {                                                                                                     <font color="black">89</font>   button: {                                                                                              </pre>
<pre>                                                                                                                         <font color="black">90</font> <font color="green">    next: 'Next',</font>                                                                                        </pre>
<pre>      <font color="black">81</font>     cancel: 'Cancel',                                                                                           <font color="black">91</font>     cancel: 'Cancel',                                                                                    </pre>
<pre>      <font color="black">82</font>     remove: 'Remove',                                                                                           <font color="black">92</font>     remove: 'Remove',                                                                                    </pre>
<pre>      <font color="black">83</font>     save: 'Save',                                                                                               <font color="black">93</font>     save: 'Save',                                                                                        </pre>
<pre>      <font color="black">84</font>     ok: 'OK',                                                                                                   <font color="black">94</font>     ok: 'OK',                                                                                            </pre>
<pre>      <font color="black">85</font>   },                                                                                                            <font color="black">95</font>   },                                                                                                     </pre>
<pre><font color="blue">../src/component/element.js</font>                                                                                        <font color="blue">../../x-spreadsheet/src/component/element.js</font>                                                                      </pre>
<pre>      <font color="black">42</font>     });                                                                                                         <font color="black">42</font>     });                                                                                                  </pre>
<pre>      <font color="black">43</font>     return this;                                                                                                <font color="black">43</font>     return this;                                                                                         </pre>
<pre>      <font color="black">44</font>   }                                                                                                             <font color="black">44</font>   }                                                                                                      </pre>
<pre>      <font color="black">45</font>                                                                                                                 <font color="black">45</font>                                                                                                          </pre>
<pre>      <font color="black">46</font>   offset(value) {                                                                                               <font color="black">46</font>   offset(value) {                                                                                        </pre>
<pre>      <font color="black">47</font> <font color="red">    //console.log("element offset value: ", value);</font>                                                                                                                                                                         </pre>
<pre>      <font color="black">48</font>     if (value !== undefined) {                                                                                  <font color="black">47</font>     if (value !== undefined) {                                                                           </pre>
<pre>      <font color="black">49</font>       Object.keys(value).forEach((k) => {                                                                       <font color="black">48</font>       Object.keys(value).forEach((k) => {                                                                </pre>
<pre>      <font color="black">50</font>         this.css(k, `${value[k]}px`);                                                                           <font color="black">49</font>         this.css(k, `${value[k]}px`);                                                                    </pre>
<pre>      <font color="black">51</font>       });                                                                                                       <font color="black">50</font>       });                                                                                                </pre>
<pre>      <font color="black">52</font>       return this;                                                                                              <font color="black">51</font>       return this;                                                                                       </pre>
<pre>      <font color="black">53</font>     }                                                                                                           <font color="black">52</font>     }                                                                                                    </pre>
<pre>      <font color="black">54</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre>
<pre>      <font color="black">55</font>     const {                                                                                                     <font color="black">53</font>     const {                                                                                              </pre>
<pre>      <font color="black">56</font>       offsetTop, offsetLeft, offsetHeight, offsetWidth,                                                         <font color="black">54</font>       offsetTop, offsetLeft, offsetHeight, offsetWidth,                                                  </pre>
<pre>      <font color="black">57</font>     } = this.el;                                                                                                <font color="black">55</font>     } = this.el;                                                                                         </pre>
<pre>      <font color="black">58</font>     return {                                                                                                    <font color="black">56</font>     return {                                                                                             </pre>
<pre>      <font color="black">59</font>       top: offsetTop,                                                                                           <font color="black">57</font>       top: offsetTop,                                                                                    </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">90</font>     }                                                                                                           <font color="black">88</font>     }                                                                                                    </pre>
<pre>      <font color="black">91</font>     eles.forEach(ele => this.child(ele));                                                                       <font color="black">89</font>     eles.forEach(ele => this.child(ele));                                                                </pre>
<pre>      <font color="black">92</font>     return this;                                                                                                <font color="black">90</font>     return this;                                                                                         </pre>
<pre>      <font color="black">93</font>   }                                                                                                             <font color="black">91</font>   }                                                                                                      </pre>
<pre>      <font color="black">94</font>                                                                                                                 <font color="black">92</font>                                                                                                          </pre>
<pre>                                                                                                                         <font color="black">93</font> <font color="green">  removeChild(el) {</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">94</font> <font color="green">    this.el.removeChild(el);</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">95</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">96</font> <font color="green"> </font>                                                                                                        </pre>
<pre>      <font color="black">95</font>   /*                                                                                                            <font color="black">97</font>   /*                                                                                                     </pre>
<pre>      <font color="black">96</font>   first() {                                                                                                     <font color="black">98</font>   first() {                                                                                              </pre>
<pre>      <font color="black">97</font>     return this.el.firstChild;                                                                                  <font color="black">99</font>     return this.el.firstChild;                                                                           </pre>
<pre>      <font color="black">98</font>   }                                                                                                            <font color="black">100</font>   }                                                                                                      </pre>
<pre>      <font color="black">99</font>                                                                                                                <font color="black">101</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">220</font>     if (v !== undefined) {                                                                                     <font color="black">222</font>     if (v !== undefined) {                                                                               </pre>
<pre>     <font color="black">221</font>       this.el.value = v;                                                                                       <font color="black">223</font>       this.el.value = v;                                                                                 </pre>
<pre>     <font color="black">222</font>       return this;                                                                                             <font color="black">224</font>       return this;                                                                                       </pre>
<pre>     <font color="black">223</font>     }                                                                                                          <font color="black">225</font>     }                                                                                                    </pre>
<pre>     <font color="black">224</font>     return this.el.value;                                                                                      <font color="black">226</font>     return this.el.value;                                                                                </pre>
<pre>                                                                                                                        <font color="black">227</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">228</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">229</font> <font color="green">  focus() {</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">230</font> <font color="green">    this.el.focus();</font>                                                                                     </pre>
<pre>     <font color="black">225</font>   }                                                                                                            <font color="black">231</font>   }                                                                                                      </pre>
<pre>     <font color="black">226</font>                                                                                                                <font color="black">232</font>                                                                                                          </pre>
<pre>     <font color="black">227</font>   cssRemoveKeys(...keys) {                                                                                     <font color="black">233</font>   cssRemoveKeys(...keys) {                                                                               </pre>
<pre>     <font color="black">228</font>     keys.forEach(k => this.el.style.removeProperty(k));                                                        <font color="black">234</font>     keys.forEach(k => this.el.style.removeProperty(k));                                                  </pre>
<pre>     <font color="black">229</font>     return this;                                                                                               <font color="black">235</font>     return this;                                                                                         </pre>
<pre><font color="blue">../src/component/form_input.js</font>                                                                                     <font color="blue">../../x-spreadsheet/src/component/form_input.js</font>                                                                   </pre>
<pre>       <font color="black">9</font>       .on('input', evt => this.vchange(evt))                                                                     <font color="black">9</font>       .on('input', evt => this.vchange(evt))                                                             </pre>
<pre>      <font color="black">10</font>       .attr('placeholder', hint);                                                                               <font color="black">10</font>       .attr('placeholder', hint);                                                                        </pre>
<pre>      <font color="black">11</font>     this.el.child(this.input);                                                                                  <font color="black">11</font>     this.el.child(this.input);                                                                           </pre>
<pre>      <font color="black">12</font>   }                                                                                                             <font color="black">12</font>   }                                                                                                      </pre>
<pre>      <font color="black">13</font>                                                                                                                 <font color="black">13</font>                                                                                                          </pre>
<pre>                                                                                                                         <font color="black">14</font> <font color="green">  focus() {</font>                                                                                              </pre>
<pre>                                                                                                                         <font color="black">15</font> <font color="green">    setTimeout(() => {</font>                                                                                   </pre>
<pre>                                                                                                                         <font color="black">16</font> <font color="green">      this.input.el.focus();</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">17</font> <font color="green">    }, 10);</font>                                                                                              </pre>
<pre>                                                                                                                         <font color="black">18</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">19</font> <font color="green"> </font>                                                                                                        </pre>
<pre>      <font color="black">14</font>   hint(v) {                                                                                                     <font color="black">20</font>   hint(v) {                                                                                              </pre>
<pre>      <font color="black">15</font>     this.input.attr('placeholder', v);                                                                          <font color="black">21</font>     this.input.attr('placeholder', v);                                                                   </pre>
<pre>      <font color="black">16</font>   }                                                                                                             <font color="black">22</font>   }                                                                                                      </pre>
<pre>      <font color="black">17</font>                                                                                                                 <font color="black">23</font>                                                                                                          </pre>
<pre>      <font color="black">18</font>   val(v) {                                                                                                      <font color="black">24</font>   val(v) {                                                                                               </pre>
<pre><font color="blue">../src/component/selector.js</font>                                                                                       <font color="blue">../../x-spreadsheet/src/component/selector.js</font>                                                                     </pre>
<pre>       <font color="black">4</font>                                                                                                                  <font color="black">4</font>                                                                                                          </pre>
<pre>       <font color="black">5</font> const selectorHeightBorderWidth = 2 * 2 - 1;                                                                     <font color="black">5</font> const selectorHeightBorderWidth = 2 * 2 - 1;                                                             </pre>
<pre>       <font color="black">6</font> let startZIndex = 10;                                                                                            <font color="black">6</font> let startZIndex = 10;                                                                                    </pre>
<pre>       <font color="black">7</font>                                                                                                                  <font color="black">7</font>                                                                                                          </pre>
<pre>       <font color="black">8</font> class SelectorElement {                                                                                          <font color="black">8</font> class SelectorElement {                                                                                  </pre>
<pre>       <font color="black">9</font> <font color="red">  constructor() {</font>                                                                                                <font color="black">9</font> <font color="green">  constructor(useHideInput = false) {</font>                                                                    </pre>
<pre>                                                                                                                         <font color="black">10</font> <font color="green">    this.useHideInput = useHideInput;</font>                                                                    </pre>
<pre>                                                                                                                         <font color="black">11</font> <font color="green">    this.inputChange = () => {};</font>                                                                         </pre>
<pre>      <font color="black">10</font>     this.cornerEl = h('div', `${cssPrefix}-selector-corner`);                                                   <font color="black">12</font>     this.cornerEl = h('div', `${cssPrefix}-selector-corner`);                                            </pre>
<pre>      <font color="black">11</font>     this.areaEl = h('div', `${cssPrefix}-selector-area`)                                                        <font color="black">13</font>     this.areaEl = h('div', `${cssPrefix}-selector-area`)                                                 </pre>
<pre>      <font color="black">12</font>       .child(this.cornerEl).hide();                                                                             <font color="black">14</font>       .child(this.cornerEl).hide();                                                                      </pre>
<pre>      <font color="black">13</font>     this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();                                      <font color="black">15</font>     this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();                               </pre>
<pre>      <font color="black">14</font>     this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();                                        <font color="black">16</font>     this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();                                 </pre>
<pre>      <font color="black">15</font>     this.el = h('div', `${cssPrefix}-selector`)                                                                 <font color="black">17</font>     this.el = h('div', `${cssPrefix}-selector`)                                                          </pre>
<pre>      <font color="black">16</font>       .css('z-index', `${startZIndex}`)                                                                         <font color="black">18</font>       .css('z-index', `${startZIndex}`)                                                                  </pre>
<pre>      <font color="black">17</font>       .children(this.areaEl, this.clipboardEl, this.autofillEl)                                                 <font color="black">19</font>       .children(this.areaEl, this.clipboardEl, this.autofillEl)                                          </pre>
<pre>      <font color="black">18</font>       .hide();                                                                                                  <font color="black">20</font>       .hide();                                                                                           </pre>
<pre>                                                                                                                         <font color="black">21</font> <font color="green">    if (useHideInput) {</font>                                                                                  </pre>
<pre>                                                                                                                         <font color="black">22</font> <font color="green">      this.hideInput = h('input', '')</font>                                                                    </pre>
<pre>                                                                                                                         <font color="black">23</font> <font color="green">        .on('input', (evt) => {</font>                                                                          </pre>
<pre>                                                                                                                         <font color="black">24</font> <font color="green">          this.inputChange(evt.target.value);</font>                                                            </pre>
<pre>                                                                                                                         <font color="black">25</font> <font color="green">        });</font>                                                                                              </pre>
<pre>                                                                                                                         <font color="black">26</font> <font color="green">      this.el.child(this.hideInputDiv = h('div', 'hide-input').child(this.hideInput));</font>                   </pre>
<pre>                                                                                                                         <font color="black">27</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>      <font color="black">19</font>     startZIndex += 1;                                                                                           <font color="black">28</font>     startZIndex += 1;                                                                                    </pre>
<pre>      <font color="black">20</font>   }                                                                                                             <font color="black">29</font>   }                                                                                                      </pre>
<pre>      <font color="black">21</font>                                                                                                                 <font color="black">30</font>                                                                                                          </pre>
<pre>      <font color="black">22</font>   setOffset(v) {                                                                                                <font color="black">31</font>   setOffset(v) {                                                                                         </pre>
<pre>      <font color="black">23</font>     this.el.offset(v).show();                                                                                   <font color="black">32</font>     this.el.offset(v).show();                                                                            </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">31</font>                                                                                                                 <font color="black">40</font>                                                                                                          </pre>
<pre>      <font color="black">32</font>   setAreaOffset(v) {                                                                                            <font color="black">41</font>   setAreaOffset(v) {                                                                                     </pre>
<pre>      <font color="black">33</font>     const {                                                                                                     <font color="black">42</font>     const {                                                                                              </pre>
<pre>      <font color="black">34</font>       left, top, width, height,                                                                                 <font color="black">43</font>       left, top, width, height,                                                                          </pre>
<pre>      <font color="black">35</font>     } = v;                                                                                                      <font color="black">44</font>     } = v;                                                                                               </pre>
<pre>      <font color="black">36</font> <font color="red">    this.areaEl.offset({</font>                                                                                        <font color="black">45</font> <font color="green">    const of = {</font>                                                                                         </pre>
<pre>      <font color="black">37</font>       width: width - selectorHeightBorderWidth + 0.8,                                                           <font color="black">46</font>       width: width - selectorHeightBorderWidth + 0.8,                                                    </pre>
<pre>      <font color="black">38</font>       height: height - selectorHeightBorderWidth + 0.8,                                                         <font color="black">47</font>       height: height - selectorHeightBorderWidth + 0.8,                                                  </pre>
<pre>      <font color="black">39</font>       left: left - 0.8,                                                                                         <font color="black">48</font>       left: left - 0.8,                                                                                  </pre>
<pre>      <font color="black">40</font>       top: top - 0.8,                                                                                           <font color="black">49</font>       top: top - 0.8,                                                                                    </pre>
<pre>      <font color="black">41</font> <font color="red">    }).show();</font>                                                                                                  <font color="black">50</font> <font color="green">    };</font>                                                                                                   </pre>
<pre>                                                                                                                         <font color="black">51</font> <font color="green">    this.areaEl.offset(of).show();</font>                                                                       </pre>
<pre>                                                                                                                         <font color="black">52</font> <font color="green">    if (this.useHideInput) {</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">53</font> <font color="green">      this.hideInputDiv.offset(of);</font>                                                                      </pre>
<pre>                                                                                                                         <font color="black">54</font> <font color="green">      this.hideInput.val('').focus();</font>                                                                    </pre>
<pre>                                                                                                                         <font color="black">55</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>      <font color="black">42</font>   }                                                                                                             <font color="black">56</font>   }                                                                                                      </pre>
<pre>      <font color="black">43</font>                                                                                                                 <font color="black">57</font>                                                                                                          </pre>
<pre>      <font color="black">44</font>   setClipboardOffset(v) {                                                                                       <font color="black">58</font>   setClipboardOffset(v) {                                                                                </pre>
<pre>      <font color="black">45</font>     const {                                                                                                     <font color="black">59</font>     const {                                                                                              </pre>
<pre>      <font color="black">46</font>       left, top, width, height,                                                                                 <font color="black">60</font>       left, top, width, height,                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">178</font>   setLClipboardOffset.call(this, offset);                                                                      <font color="black">192</font>   setLClipboardOffset.call(this, offset);                                                                </pre>
<pre>     <font color="black">179</font> }                                                                                                              <font color="black">193</font> }                                                                                                        </pre>
<pre>     <font color="black">180</font>                                                                                                                <font color="black">194</font>                                                                                                          </pre>
<pre>     <font color="black">181</font> export default class Selector {                                                                                <font color="black">195</font> export default class Selector {                                                                          </pre>
<pre>     <font color="black">182</font>   constructor(data) {                                                                                          <font color="black">196</font>   constructor(data) {                                                                                    </pre>
<pre>                                                                                                                        <font color="black">197</font> <font color="green">    this.inputChange = () => {};</font>                                                                         </pre>
<pre>     <font color="black">183</font>     this.data = data;                                                                                          <font color="black">198</font>     this.data = data;                                                                                    </pre>
<pre>     <font color="black">184</font>     this.br = new SelectorElement();                                                                           <font color="black">199</font>     this.br = new SelectorElement(<font color="green">true</font>);                                                                 </pre>
<pre>     <font color="black">185</font>     this.t = new SelectorElement();                                                                            <font color="black">200</font>     this.t = new SelectorElement();                                                                      </pre>
<pre>     <font color="black">186</font>     this.l = new SelectorElement();                                                                            <font color="black">201</font>     this.l = new SelectorElement();                                                                      </pre>
<pre>     <font color="black">187</font>     this.tl = new SelectorElement();                                                                           <font color="black">202</font>     this.tl = new SelectorElement();                                                                     </pre>
<pre>                                                                                                                        <font color="black">203</font> <font color="green">    this.br.inputChange = (v) => {</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">204</font> <font color="green">      this.inputChange(v);</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">205</font> <font color="green">    };</font>                                                                                                   </pre>
<pre>     <font color="black">188</font>     this.br.el.show();                                                                                         <font color="black">206</font>     this.br.el.show();                                                                                   </pre>
<pre>     <font color="black">189</font>     this.offset = null;                                                                                        <font color="black">207</font>     this.offset = null;                                                                                  </pre>
<pre>     <font color="black">190</font>     this.areaOffset = null;                                                                                    <font color="black">208</font>     this.areaOffset = null;                                                                              </pre>
<pre>     <font color="black">191</font>     this.indexes = null;                                                                                       <font color="black">209</font>     this.indexes = null;                                                                                 </pre>
<pre>     <font color="black">192</font>     this.range = null;                                                                                         <font color="black">210</font>     this.range = null;                                                                                   </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">202</font>     // for performance                                                                                         <font color="black">220</font>     // for performance                                                                                   </pre>
<pre>     <font color="black">203</font>     this.lastri = -1;                                                                                          <font color="black">221</font>     this.lastri = -1;                                                                                    </pre>
<pre>     <font color="black">204</font>     this.lastci = -1;                                                                                          <font color="black">222</font>     this.lastci = -1;                                                                                    </pre>
<pre>     <font color="black">205</font>                                                                                                                <font color="black">223</font>                                                                                                          </pre>
<pre>     <font color="black">206</font>     startZIndex += 1;                                                                                          <font color="black">224</font>     startZIndex += 1;                                                                                    </pre>
<pre>                                                                                                                        <font color="black">225</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">226</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">227</font> <font color="green">  resetData(data) {</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">228</font> <font color="green">    this.data = data;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">229</font> <font color="green">    this.range = data.selector.range;</font>                                                                    </pre>
<pre>                                                                                                                        <font color="black">230</font> <font color="green">    this.resetAreaOffset();</font>                                                                              </pre>
<pre>     <font color="black">207</font>   }                                                                                                            <font color="black">231</font>   }                                                                                                      </pre>
<pre>     <font color="black">208</font>                                                                                                                <font color="black">232</font>                                                                                                          </pre>
<pre>     <font color="black">209</font>   hide() {                                                                                                     <font color="black">233</font>   hide() {                                                                                               </pre>
<pre>     <font color="black">210</font>     this.el.hide();                                                                                            <font color="black">234</font>     this.el.hide();                                                                                      </pre>
<pre>     <font color="black">211</font>   }                                                                                                            <font color="black">235</font>   }                                                                                                      </pre>
<pre><font color="blue">../src/component/dropdown.js</font>                                                                                       <font color="blue">../../x-spreadsheet/src/component/dropdown.js</font>                                                                     </pre>
<pre>       <font color="black">5</font> export default class Dropdown extends Element {                                                                  <font color="black">5</font> export default class Dropdown extends Element {                                                          </pre>
<pre>       <font color="black">6</font>   constructor(title, width, showArrow, placement, ...children) {                                                 <font color="black">6</font>   constructor(title, width, showArrow, placement, ...children) {                                         </pre>
<pre>       <font color="black">7</font>     super('div', `${cssPrefix}-dropdown ${placement}`);                                                          <font color="black">7</font>     super('div', `${cssPrefix}-dropdown ${placement}`);                                                  </pre>
<pre>       <font color="black">8</font>     this.title = title;                                                                                          <font color="black">8</font>     this.title = title;                                                                                  </pre>
<pre>       <font color="black">9</font>     this.change = () => {};                                                                                      <font color="black">9</font>     this.change = () => {};                                                                              </pre>
<pre>                                                                                                                         <font color="black">10</font> <font color="green">    this.headerClick = () => {};</font>                                                                         </pre>
<pre>      <font color="black">10</font>     if (typeof title === 'string') {                                                                            <font color="black">11</font>     if (typeof title === 'string') {                                                                     </pre>
<pre>      <font color="black">11</font>       this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);                                        <font color="black">12</font>       this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);                                 </pre>
<pre>      <font color="black">12</font>     } else if (showArrow) {                                                                                     <font color="black">13</font>     } else if (showArrow) {                                                                              </pre>
<pre>      <font color="black">13</font>       this.title.addClass('arrow-left');                                                                        <font color="black">14</font>       this.title.addClass('arrow-left');                                                                 </pre>
<pre>      <font color="black">14</font>     }                                                                                                           <font color="black">15</font>     }                                                                                                    </pre>
<pre>      <font color="black">15</font>     this.contentEl = h('div', `${cssPrefix}-dropdown-content`)                                                  <font color="black">16</font>     this.contentEl = h('div', `${cssPrefix}-dropdown-content`)                                           </pre>
<pre>      <font color="black">16</font> <font color="red">      .children(...children)</font>                                                                                                                                                                                                </pre>
<pre>      <font color="black">17</font>       .css('width', width)                                                                                      <font color="black">17</font>       .css('width', width)                                                                               </pre>
<pre>      <font color="black">18</font>       .hide();                                                                                                  <font color="black">18</font>       .hide();                                                                                           </pre>
<pre>                                                                                                                         <font color="black">19</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">20</font> <font color="green">    this.setContentChildren(...children);</font>                                                                </pre>
<pre>      <font color="black">19</font>                                                                                                                 <font color="black">21</font>                                                                                                          </pre>
<pre>      <font color="black">20</font>     this.headerEl = h('div', `${cssPrefix}-dropdown-header`);                                                   <font color="black">22</font>     this.headerEl = h('div', `${cssPrefix}-dropdown-header`);                                            </pre>
<pre>      <font color="black">21</font>     this.headerEl.on('click', () => {                                                                           <font color="black">23</font>     this.headerEl.on('click', () => {                                                                    </pre>
<pre>      <font color="black">22</font>       if (this.contentEl.css('display') !== 'block') {                                                          <font color="black">24</font>       if (this.contentEl.css('display') !== 'block') {                                                   </pre>
<pre>      <font color="black">23</font>         this.show();                                                                                            <font color="black">25</font>         this.show();                                                                                     </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">29</font>       showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(                                              <font color="black">31</font>       showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(                                       </pre>
<pre>      <font color="black">30</font>         h('div', `${cssPrefix}-icon-img arrow-down`),                                                           <font color="black">32</font>         h('div', `${cssPrefix}-icon-img arrow-down`),                                                    </pre>
<pre>      <font color="black">31</font>       ) : '',                                                                                                   <font color="black">33</font>       ) : '',                                                                                            </pre>
<pre>      <font color="black">32</font>     );                                                                                                          <font color="black">34</font>     );                                                                                                   </pre>
<pre>      <font color="black">33</font>     this.children(this.headerEl, this.contentEl);                                                               <font color="black">35</font>     this.children(this.headerEl, this.contentEl);                                                        </pre>
<pre>                                                                                                                         <font color="black">36</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">37</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">38</font> <font color="green">  setContentChildren(...children) {</font>                                                                      </pre>
<pre>                                                                                                                         <font color="black">39</font> <font color="green">    this.contentEl.html('');</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">40</font> <font color="green">    if (children.length > 0) {</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">41</font> <font color="green">      this.contentEl.children(...children);</font>                                                              </pre>
<pre>                                                                                                                         <font color="black">42</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>      <font color="black">34</font>   }                                                                                                             <font color="black">43</font>   }                                                                                                      </pre>
<pre>      <font color="black">35</font>                                                                                                                 <font color="black">44</font>                                                                                                          </pre>
<pre>      <font color="black">36</font>   setTitle(title) {                                                                                             <font color="black">45</font>   setTitle(title) {                                                                                      </pre>
<pre>      <font color="black">37</font>     this.title.html(title);                                                                                     <font color="black">46</font>     this.title.html(title);                                                                              </pre>
<pre>      <font color="black">38</font>     this.hide();                                                                                                <font color="black">47</font>     this.hide();                                                                                         </pre>
<pre><font color="blue">../src/component/dropdown_format.js</font>                                                                                <font color="blue">../../x-spreadsheet/src/component/dropdown_format.js</font>                                                              </pre>
<pre>       <font color="black">5</font>                                                                                                                  <font color="black">5</font>                                                                                                          </pre>
<pre>       <font color="black">6</font> export default class DropdownFormat extends Dropdown {                                                           <font color="black">6</font> export default class DropdownFormat extends Dropdown {                                                   </pre>
<pre>       <font color="black">7</font>   constructor() {                                                                                                <font color="black">7</font>   constructor() {                                                                                        </pre>
<pre>       <font color="black">8</font>     let nformats = baseFormats.slice(0);                                                                         <font color="black">8</font>     let nformats = baseFormats.slice(0);                                                                 </pre>
<pre>       <font color="black">9</font>     nformats.splice(2, 0, { key: 'divider' });                                                                   <font color="black">9</font>     nformats.splice(2, 0, { key: 'divider' });                                                           </pre>
<pre>      <font color="black">10</font>     nformats.splice(<font color="orange">7</font>, 0, { key: 'divider' });                                                                  <font color="black">10</font>     nformats.splice(<font color="orange">8</font>, 0, { key: 'divider' });                                                           </pre>
<pre>      <font color="black">11</font>     nformats = nformats.map((it) => {                                                                           <font color="black">11</font>     nformats = nformats.map((it) => {                                                                    </pre>
<pre>      <font color="black">12</font>       const item = h('div', `${cssPrefix}-item`);                                                               <font color="black">12</font>       const item = h('div', `${cssPrefix}-item`);                                                        </pre>
<pre>      <font color="black">13</font>       if (it.key === 'divider') {                                                                               <font color="black">13</font>       if (it.key === 'divider') {                                                                        </pre>
<pre>      <font color="black">14</font>         item.addClass('divider');                                                                               <font color="black">14</font>         item.addClass('divider');                                                                        </pre>
<pre>      <font color="black">15</font>       } else {                                                                                                  <font color="black">15</font>       } else {                                                                                           </pre>
<pre><font color="blue">../src/component/scrollbar.js</font>                                                                                      <font color="blue">../../x-spreadsheet/src/component/scrollbar.js</font>                                                                    </pre>
<pre>      <font color="black">30</font>   set(distance, contentDistance) {                                                                              <font color="black">30</font>   set(distance, contentDistance) {                                                                       </pre>
<pre>      <font color="black">31</font>     const d = distance - 1;                                                                                     <font color="black">31</font>     const d = distance - 1;                                                                              </pre>
<pre>      <font color="black">32</font>     // console.log('distance:', distance, ', contentDistance:', contentDistance);                               <font color="black">32</font>     // console.log('distance:', distance, ', contentDistance:', contentDistance);                        </pre>
<pre>      <font color="black">33</font>     if (contentDistance > d) {                                                                                  <font color="black">33</font>     if (contentDistance > d) {                                                                           </pre>
<pre>      <font color="black">34</font>       const cssKey = this.vertical ? 'height' : 'width';                                                        <font color="black">34</font>       const cssKey = this.vertical ? 'height' : 'width';                                                 </pre>
<pre>                                                                                                                         <font color="black">35</font> <font color="green">      // console.log('d:', d);</font>                                                                           </pre>
<pre>      <font color="black">35</font>       this.el.css(cssKey, `${d}px`).show();                                                                     <font color="black">36</font>       this.el.css(cssKey, `${d<font color="green"> - 15</font>}px`).show();                                                         </pre>
<pre>      <font color="black">36</font>       this.contentEl                                                                                            <font color="black">37</font>       this.contentEl                                                                                     </pre>
<pre>      <font color="black">37</font>         .css(this.vertical ? 'width' : 'height', '1px')                                                         <font color="black">38</font>         .css(this.vertical ? 'width' : 'height', '1px')                                                  </pre>
<pre>      <font color="black">38</font>         .css(cssKey, `${contentDistance}px`);                                                                   <font color="black">39</font>         .css(cssKey, `${contentDistance}px`);                                                            </pre>
<pre>      <font color="black">39</font>     } else {                                                                                                    <font color="black">40</font>     } else {                                                                                             </pre>
<pre>      <font color="black">40</font>       this.el.hide();                                                                                           <font color="black">41</font>       this.el.hide();                                                                                    </pre>
<pre><font color="blue">../src/component/editor.js</font>                                                                                         <font color="blue">../../x-spreadsheet/src/component/editor.js</font>                                                                       </pre>
<pre>       <font color="black">4</font> import Datepicker from './datepicker';                                                                           <font color="black">4</font> import Datepicker from './datepicker';                                                                   </pre>
<pre>       <font color="black">5</font> import { cssPrefix } from '../config';                                                                           <font color="black">5</font> import { cssPrefix } from '../config';                                                                   </pre>
<pre>       <font color="black">6</font> // import { mouseMoveUp } from '../event';                                                                       <font color="black">6</font> // import { mouseMoveUp } from '../event';                                                               </pre>
<pre>       <font color="black">7</font>                                                                                                                  <font color="black">7</font>                                                                                                          </pre>
<pre>       <font color="black">8</font> function resetTextareaSize() {                                                                                   <font color="black">8</font> function resetTextareaSize() {                                                                           </pre>
<pre>                                                                                                                          <font color="black">9</font> <font color="green">  const { inputText } = this;</font>                                                                            </pre>
<pre>       <font color="black">9</font> <font color="red">//</font>  if (!/^\s*$/.test(<font color="red">this.</font>inputText)) {                                                                        <font color="black">10</font>   if (!/^\s*$/.test(inputText)) {                                                                        </pre>
<pre>      <font color="black">10</font>     const {                                                                                                     <font color="black">11</font>     const {                                                                                              </pre>
<pre>      <font color="black">11</font>       textlineEl, textEl, areaOffset,                                                                           <font color="black">12</font>       textlineEl, textEl, areaOffset,                                                                    </pre>
<pre>      <font color="black">12</font>     } = this;                                                                                                   <font color="black">13</font>     } = this;                                                                                            </pre>
<pre>                                                                                                                         <font color="black">14</font> <font color="green">    const txts = inputText.split('\n');</font>                                                                  </pre>
<pre>                                                                                                                         <font color="black">15</font> <font color="green">    const maxTxtSize = Math.max(...txts.map(it => it.length));</font>                                           </pre>
<pre>      <font color="black">13</font>     const tl<font color="orange">in</font>e<font color="red">Wid</font>t<font color="red">h</font> = textlineEl.offset()<font color="red">.width + 9</font>;                                                           <font color="black">16</font>     const tl<font color="orange">Offs</font>et = textlineEl.offset();                                                                </pre>
<pre>                                                                                                                         <font color="black">17</font> <font color="green">    const fontWidth = tlOffset.width / inputText.length;</font>                                                 </pre>
<pre>                                                                                                                         <font color="black">18</font> <font color="green">    const tlineWidth = (maxTxtSize + 1) * fontWidth + 5;</font>                                                 </pre>
<pre>      <font color="black">14</font>     const maxWidth = this.viewFn().width - areaOffset.left - <font color="orange">9</font>;                                                 <font color="black">19</font>     const maxWidth = this.viewFn().width - areaOffset.left - <font color="orange">fontWidth</font>;                                  </pre>
<pre>      <font color="black">15</font> <font color="red">    // console.log('tlineWidth:', tlineWidth, ':', maxWidth);</font>                                                   <font color="black">20</font> <font color="green">    let h1 = txts.length;</font>                                                                                </pre>
<pre>      <font color="black">16</font>     if (tlineWidth > areaOffset.width) {                                                                        <font color="black">21</font>     if (tlineWidth > areaOffset.width) {                                                                 </pre>
<pre>      <font color="black">17</font>       let twidth = tlineWidth;                                                                                  <font color="black">22</font>       let twidth = tlineWidth;                                                                           </pre>
<pre>      <font color="black">18</font>       if (tlineWidth > maxWidth) {                                                                              <font color="black">23</font>       if (tlineWidth > maxWidth) {                                                                       </pre>
<pre>      <font color="black">19</font>         twidth = maxWidth;                                                                                      <font color="black">24</font>         twidth = maxWidth;                                                                               </pre>
<pre>      <font color="black">20</font>        <font color="red"> let</font> h1 = parseInt(tlineWidth / maxWidth, 10);                                                           <font color="black">25</font>         h1 <font color="green">+</font>= parseInt(tlineWidth / maxWidth, 10);                                                       </pre>
<pre>      <font color="black">21</font>         h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;                                                              <font color="black">26</font>         h1 += (tlineWidth % maxWidth) > 0 ? 1 : 0;                                                       </pre>
<pre>                                                                                                                         <font color="black">27</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>                                                                                                                         <font color="black">28</font> <font color="green">      textEl.css('width', `${twidth}px`);</font>                                                                </pre>
<pre>                                                                                                                         <font color="black">29</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>      <font color="black">22</font> <font color="red">    </font>    h1 *= this.rowHeight;                                                                                   <font color="black">30</font>     h1 *= this.rowHeight;                                                                                </pre>
<pre>      <font color="black">23</font> <font color="red">    </font>    if (h1 > areaOffset.height) {                                                                           <font color="black">31</font>     if (h1 > areaOffset.height) {                                                                        </pre>
<pre>      <font color="black">24</font> <font color="red">    </font>      textEl.css('height', `${h1}px`);                                                                      <font color="black">32</font>       textEl.css('height', `${h1}px`);                                                                   </pre>
<pre>                                                                                                                         <font color="black">33</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                         <font color="black">34</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">35</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">36</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">37</font> <font color="green">function inputEventHandler(evt) {</font>                                                                        </pre>
<pre>                                                                                                                         <font color="black">38</font> <font color="green">  const v = evt.target.value;</font>                                                                            </pre>
<pre>                                                                                                                         <font color="black">39</font> <font color="green">  // console.log(evt, 'v:', v);</font>                                                                          </pre>
<pre>                                                                                                                         <font color="black">40</font> <font color="green">  const { suggest, textlineEl, validator } = this;</font>                                                       </pre>
<pre>                                                                                                                         <font color="black">41</font> <font color="green">  const { cell } = this;</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">42</font> <font color="green">  if (cell !== null) {</font>                                                                                   </pre>
<pre>                                                                                                                         <font color="black">43</font> <font color="green">    if (('editable' in cell && cell.editable === true) || (cell.editable === undefined)) {</font>               </pre>
<pre>                                                                                                                         <font color="black">44</font> <font color="green">      this.inputText = v;</font>                                                                                </pre>
<pre>                                                                                                                         <font color="black">45</font> <font color="green">      if (validator) {</font>                                                                                   </pre>
<pre>                                                                                                                         <font color="black">46</font> <font color="green">        if (validator.type === 'list') {</font>                                                                 </pre>
<pre>                                                                                                                         <font color="black">47</font> <font color="green">          suggest.search(v);</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">48</font> <font color="green">        } else {</font>                                                                                         </pre>
<pre>                                                                                                                         <font color="black">49</font> <font color="green">          suggest.hide();</font>                                                                                </pre>
<pre>      <font color="black">25</font>         }                                                                                                       <font color="black">50</font>         }                                                                                                </pre>
<pre>                                                                                                                         <font color="black">51</font> <font color="green">      } else {</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">52</font> <font color="green">        const start = v.lastIndexOf('=');</font>                                                                </pre>
<pre>                                                                                                                         <font color="black">53</font> <font color="green">        if (start !== -1) {</font>                                                                              </pre>
<pre>                                                                                                                         <font color="black">54</font> <font color="green">          suggest.search(v.substring(start + 1));</font>                                                        </pre>
<pre>                                                                                                                         <font color="black">55</font> <font color="green">        } else {</font>                                                                                         </pre>
<pre>                                                                                                                         <font color="black">56</font> <font color="green">          suggest.hide();</font>                                                                                </pre>
<pre>      <font color="black">26</font>       }                                                                                                         <font color="black">57</font> <font color="green">  </font>      }                                                                                                </pre>
<pre>      <font color="black">27</font> <font color="red">      textEl.css('width', `${twidth}px`);</font>                                                                                                                                                                                   </pre>
<pre>      <font color="black">28</font>     }                                                                                                           <font color="black">58</font> <font color="green">  </font>    }                                                                                                  </pre>
<pre>      <font color="black">29</font> <font color="red">//  }</font>                                                                                                           <font color="black">59</font> <font color="green">      textlineEl.html(v);</font>                                                                                </pre>
<pre>      <font color="black">30</font> <font color="red">}</font>                                                                                                               <font color="black">60</font> <font color="green">      resetTextareaSize.call(this);</font>                                                                      </pre>
<pre>      <font color="black">31</font> <font color="red"> </font>                                                                                                               <font color="black">61</font> <font color="green">      this.change('input', v);</font>                                                                           </pre>
<pre>      <font color="black">32</font> <font color="red">function inputEventHandler(evt) {</font>                                                                                                                                                                                           </pre>
<pre>      <font color="black">33</font> <font color="red">    const keyCode = evt.keyCode || evt.which;</font>                                                                                                                                                                               </pre>
<pre>      <font color="black">34</font> <font color="red">    const {</font>                                                                                                                                                                                                                 </pre>
<pre>      <font color="black">35</font> <font color="red">      key, ctrlKey, shiftKey, altKey, metaKey,</font>                                                                                                                                                                              </pre>
<pre>      <font color="black">36</font> <font color="red">    } = evt;</font>                                                                                                                                                                                                                </pre>
<pre>      <font color="black">37</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">38</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre>
<pre>      <font color="black">39</font> <font color="red">    if (altKey) {</font>                                                                                                                                                                                                           </pre>
<pre>      <font color="black">40</font> <font color="red">      console.log("alt:",keyCode);</font>                                                                                                                                                                                          </pre>
<pre>      <font color="black">41</font> <font color="red">      switch (keyCode) {</font>                                                                                                                                                                                                    </pre>
<pre>      <font color="black">42</font> <font color="red">        case 13:</font>                                                                                                                                                                                                            </pre>
<pre>      <font color="black">43</font> <font color="red">            console.log("input alt+Enter");</font>                                                                                                                                                                                 </pre>
<pre>      <font color="black">44</font> <font color="red">            break;</font>                                                                                                                                                                                                          </pre>
<pre>      <font color="black">45</font> <font color="red">      }</font>                                                                                                                                                                                                                     </pre>
<pre>      <font color="black">46</font> <font color="red">}   </font>                                                                                                                                                                                                                        </pre>
<pre>      <font color="black">47</font> <font color="red">*/</font>                                                                                                                                                                                                                          </pre>
<pre>      <font color="black">48</font> <font color="red">  //console.log("input:",evt);</font>                                                                                                                                                                                              </pre>
<pre>      <font color="black">49</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">50</font> <font color="red">  const v = evt.target.value;</font>                                                                                                                                                                                               </pre>
<pre>      <font color="black">51</font> <font color="red">  const { suggest, textlineEl, validator } = this;</font>                                                                                                                                                                          </pre>
<pre>      <font color="black">52</font> <font color="red">  this.inputText =  v ;</font>                                                                                                                                                                                                     </pre>
<pre>      <font color="black">53</font> <font color="red">  if (validator) {</font>                                                                                                                                                                                                          </pre>
<pre>      <font color="black">54</font> <font color="red">    if (validator.type === 'list') {</font>                                                                                                                                                                                        </pre>
<pre>      <font color="black">55</font> <font color="red">      suggest.search(v);</font>                                                                                                                                                                                                    </pre>
<pre>      <font color="black">56</font>     } else {                                                                                                    <font color="black">62</font>     } else {                                                                                             </pre>
<pre>      <font color="black">57</font> <font color="red">      suggest.hide();</font>                                                                                           <font color="black">63</font> <font color="green">      evt.target.value = '';</font>                                                                             </pre>
<pre>      <font color="black">58</font>     }                                                                                                           <font color="black">64</font>     }                                                                                                    </pre>
<pre>      <font color="black">59</font>   } else {                                                                                                      <font color="black">65</font>   } else {                                                                                               </pre>
<pre>      <font color="black">60</font> <font color="red">    const start = v.lastIndexOf('=');</font>                                                                           <font color="black">66</font> <font color="green">    this.inputText = v;</font>                                                                                  </pre>
<pre>      <font color="black">61</font> <font color="red">    if (start !== -1) {</font>                                                                                         <font color="black">67</font> <font color="green">    if (validator) {</font>                                                                                     </pre>
<pre>      <font color="black">62</font> <font color="red">      suggest.search(v.substring(start + 1));</font>                                                                   <font color="black">68</font> <font color="green">      if (validator.type === 'list') {</font>                                                                   </pre>
<pre>                                                                                                                         <font color="black">69</font> <font color="green">        suggest.search(v);</font>                                                                               </pre>
<pre>                                                                                                                         <font color="black">70</font> <font color="green">      } else {</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">71</font> <font color="green">        suggest.hide();</font>                                                                                  </pre>
<pre>                                                                                                                         <font color="black">72</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>      <font color="black">63</font>     } else {                                                                                                    <font color="black">73</font>     } else {                                                                                             </pre>
<pre>      <font color="black">64</font> <font color="red">      suggest.hide();</font>                                                                                                                                                                                                       </pre>
<pre>      <font color="black">65</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre>
<pre>      <font color="black">66</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>      <font color="black">67</font> <font color="red">  textlineEl.html(v);</font>                                                                                                                                                                                                       </pre>
<pre>      <font color="black">68</font> <font color="red">  resetTextareaSize.call(this);</font>                                                                                                                                                                                             </pre>
<pre>      <font color="black">69</font> <font color="red">  this.change('input', v);</font>                                                                                                                                                                                                  </pre>
<pre>      <font color="black">70</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">71</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">72</font> <font color="red">function keydownEventHandler(evt) {</font>                                                                                                                                                                                         </pre>
<pre>      <font color="black">73</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">74</font> <font color="red">    const keyCode = evt.keyCode || evt.which;</font>                                                                                                                                                                               </pre>
<pre>      <font color="black">75</font> <font color="red">    const {</font>                                                                                                                                                                                                                 </pre>
<pre>      <font color="black">76</font> <font color="red">      key, ctrlKey, shiftKey, altKey, metaKey,</font>                                                                                                                                                                              </pre>
<pre>      <font color="black">77</font> <font color="red">    } = evt;</font>                                                                                                                                                                                                                </pre>
<pre>      <font color="black">78</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">79</font> <font color="red">  var v = evt.target.value;</font>                                                                                                                                                                                                 </pre>
<pre>      <font color="black">80</font> <font color="red">  var t = evt.target;</font>                                                                                                                                                                                                       </pre>
<pre>      <font color="black">81</font> <font color="red">                       //console.log("input :", evt);</font>                                                                                                                                                                       </pre>
<pre>      <font color="black">82</font> <font color="red">                       //console.log("v :", t);</font>                                                                                                                                                                             </pre>
<pre>      <font color="black">83</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">84</font> <font color="red">      if (altKey) {</font>                                                                                                                                                                                                         </pre>
<pre>      <font color="black">85</font> <font color="red">            switch (keyCode) {</font>                                                                                                                                                                                              </pre>
<pre>      <font color="black">86</font> <font color="red">                 case 13:</font>                                                                                                                                                                                                   </pre>
<pre>      <font color="black">87</font> <font color="red">                       //console.log("input alt+Enter");</font>                                                                                                                                                                    </pre>
<pre>      <font color="black">88</font> <font color="red">                       //v = 13;</font>                                                                                                                                                                                            </pre>
<pre>      <font color="black">89</font> <font color="red">                       //v = '&#13';</font>                                                                                                                                                                                        </pre>
<pre>      <font color="black">90</font> <font color="red">                       //t.value =  t.value + 13</font>                                                                                                                                                                            </pre>
<pre>      <font color="black">91</font> <font color="red">                       //t.value =  t.value + '&#13;&#10;';</font>                                                                                                                                                                 </pre>
<pre>      <font color="black">92</font> <font color="red">                       //t.value =  t.value + "&#10;";</font>                                                                                                                                                                      </pre>
<pre>      <font color="black">93</font> <font color="red">                      // var newline = String.fromCharCode(13, 10);</font>                                                                                                                                                         </pre>
<pre>      <font color="black">94</font> <font color="red">                       var newline = String.fromCharCode(13,10 );</font>                                                                                                                                                           </pre>
<pre>      <font color="black">95</font> <font color="red">                       t.value =  t.value + newline;</font>                                                                                                                                                                        </pre>
<pre>      <font color="black">96</font> <font color="red">                       //t.value =  t.value + "<pre>";</font>                                                                                                                                                                      </pre>
<pre>      <font color="black">97</font> <font color="red">                       ;</font>                                                                                                                                                                                                    </pre>
<pre>      <font color="black">98</font> <font color="red">                       break;</font>                                                                                                                                                                                               </pre>
<pre>      <font color="black">99</font> <font color="red">             }</font>                                                                                                                                                                                                              </pre>
<pre>     <font color="black">100</font> <font color="red">       }</font>                                                                                                                                                                                                                    </pre>
<pre>     <font color="black">101</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">102</font> <font color="red">//  console.log("keydown:",evt);</font>                                                                                                                                                                                            </pre>
<pre>     <font color="black">103</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">104</font> <font color="red">  //const v = evt.target.value;</font>                                                                                                                                                                                             </pre>
<pre>     <font color="black">105</font> <font color="red">  const { suggest, textlineEl, validator } = this;</font>                                                                                                                                                                          </pre>
<pre>     <font color="black">106</font> <font color="red">  this.inputText =  v ;</font>                                                                                                                                                                                                     </pre>
<pre>     <font color="black">107</font> <font color="red">  if (validator) {</font>                                                                                                                                                                                                          </pre>
<pre>     <font color="black">108</font> <font color="red">    if (validator.type === 'list') {</font>                                                                                                                                                                                        </pre>
<pre>     <font color="black">109</font> <font color="red">      suggest.search(v);</font>                                                                                                                                                                                                    </pre>
<pre>     <font color="black">110</font> <font color="red">    } else {</font>                                                                                                                                                                                                                </pre>
<pre>     <font color="black">111</font> <font color="red">      suggest.hide();</font>                                                                                                                                                                                                       </pre>
<pre>     <font color="black">112</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre>
<pre>     <font color="black">113</font> <font color="red">  } else {</font>                                                                                                                                                                                                                  </pre>
<pre>     <font color="black">114</font> <font color="red">    if (typeof v === 'string' || v instanceof String) {</font>                                                                                                                                                                     </pre>
<pre>     <font color="black">115</font>     const start = v.lastIndexOf('=');                                                                           <font color="black">74</font> <font color="green">  </font>    const start = v.lastIndexOf('=');                                                                  </pre>
<pre>     <font color="black">116</font>     if (start !== -1) {                                                                                         <font color="black">75</font> <font color="green">  </font>    if (start !== -1) {                                                                                </pre>
<pre>     <font color="black">117</font>       suggest.search(v.substring(start + 1));                                                                   <font color="black">76</font> <font color="green">  </font>      suggest.search(v.substring(start + 1));                                                          </pre>
<pre>     <font color="black">118</font>     } else {                                                                                                    <font color="black">77</font> <font color="green">  </font>    } else {                                                                                           </pre>
<pre>     <font color="black">119</font>       suggest.hide();                                                                                           <font color="black">78</font> <font color="green">  </font>      suggest.hide();                                                                                  </pre>
<pre>     <font color="black">120</font>     }                                                                                                           <font color="black">79</font> <font color="green">  </font>    }                                                                                                  </pre>
<pre>     <font color="black">121</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre>
<pre>     <font color="black">122</font>   }                                                                                                             <font color="black">80</font> <font color="green">  </font>  }                                                                                                    </pre>
<pre>     <font color="black">123</font>   textlineEl.html(v);                                                                                           <font color="black">81</font> <font color="green">  </font>  textlineEl.html(v);                                                                                  </pre>
<pre>     <font color="black">124</font>   resetTextareaSize.call(this);                                                                                 <font color="black">82</font> <font color="green">  </font>  resetTextareaSize.call(this);                                                                        </pre>
<pre>     <font color="black">125</font>   this.change('t<font color="red">extarea</font>', v);                                                                                   <font color="black">83</font> <font color="green">  </font>  this.change('<font color="green">inpu</font>t', v);                                                                             </pre>
<pre>     <font color="black">126</font> <font color="red"> </font>                                                                                                               <font color="black">84</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>     <font color="black">127</font> <font color="red">  ////</font>                                                                                                                                                                                                                      </pre>
<pre>     <font color="black">128</font> <font color="red">  /*</font>                                                                                                                                                                                                                        </pre>
<pre>     <font color="black">129</font> <font color="red">    var el = this;</font>                                                                                                                                                                                                          </pre>
<pre>     <font color="black">130</font> <font color="red">  setTimeout(function(){</font>                                                                                                                                                                                                    </pre>
<pre>     <font color="black">131</font> <font color="red">    el.style.cssText = 'height:auto; padding:0';</font>                                                                                                                                                                            </pre>
<pre>     <font color="black">132</font> <font color="red">    // for box-sizing other than "content-box" use:</font>                                                                                                                                                                         </pre>
<pre>     <font color="black">133</font> <font color="red">    // el.style.cssText = '-moz-box-sizing:content-box';</font>                                                                                                                                                                    </pre>
<pre>     <font color="black">134</font> <font color="red">    el.style.cssText = 'height:' + el.scrollHeight + 'px';</font>                                                                                                                                                                  </pre>
<pre>     <font color="black">135</font> <font color="red">  },0);</font>                                                                                                                                                                                                                     </pre>
<pre>     <font color="black">136</font> <font color="red">  */</font>                                                                                                                                                                                                                        </pre>
<pre>     <font color="black">137</font> <font color="red">      var textarea = evt.target;</font>                                                                                                                                                                                            </pre>
<pre>     <font color="black">138</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">139</font> <font color="red">   textarea.style.height = ""; /* Reset the height*/</font>                                                                                                                                                                        </pre>
<pre>     <font color="black">140</font> <font color="red">  textarea.style.height = textarea.scrollHeight + "px";</font>                                                                                                                                                                     </pre>
<pre>     <font color="black">141</font> }                                                                                                               <font color="black">85</font> }                                                                                                        </pre>
<pre>     <font color="black">142</font>                                                                                                                 <font color="black">86</font>                                                                                                          </pre>
<pre>     <font color="black">143</font> function setTextareaRange(position) {                                                                           <font color="black">87</font> function setTextareaRange(position) {                                                                    </pre>
<pre>     <font color="black">144</font>   const { el } = this.textEl;                                                                                   <font color="black">88</font>   const { el } = this.textEl;                                                                            </pre>
<pre>     <font color="black">145</font>   setTimeout(() => {                                                                                            <font color="black">89</font>   setTimeout(() => {                                                                                     </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">189</font>   let month = d.getMonth() + 1;                                                                                <font color="black">133</font>   let month = d.getMonth() + 1;                                                                          </pre>
<pre>     <font color="black">190</font>   let date = d.getDate();                                                                                      <font color="black">134</font>   let date = d.getDate();                                                                                </pre>
<pre>     <font color="black">191</font>   if (month < 10) month = `0${month}`;                                                                         <font color="black">135</font>   if (month < 10) month = `0${month}`;                                                                   </pre>
<pre>     <font color="black">192</font>   if (date < 10) date = `0${date}`;                                                                            <font color="black">136</font>   if (date < 10) date = `0${date}`;                                                                      </pre>
<pre>     <font color="black">193</font>   return `${d.getFullYear()}-${month}-${date}`;                                                                <font color="black">137</font>   return `${d.getFullYear()}-${month}-${date}`;                                                          </pre>
<pre>     <font color="black">194</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">195</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">196</font> <font color="red">function textarea_autosize(){</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">197</font> <font color="red">      var rows = parseInt(textarea.getAttribute("rows"));</font>                                                                                                                                                                   </pre>
<pre>     <font color="black">198</font> <font color="red">    // If we don't decrease the amount of rows, the scrollHeight would show the scrollHeight for all the </font>                                                                                                                   </pre>
<pre><font color="red">rows</font>                                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">199</font> <font color="red">    // even if there is no text.</font>                                                                                                                                                                                            </pre>
<pre>     <font color="black">200</font> <font color="red">    textarea.setAttribute("rows", "1");</font>                                                                                                                                                                                     </pre>
<pre>     <font color="black">201</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">202</font> <font color="red">    if (rows < limitRows && textarea.scrollHeight > messageLastScrollHeight) {</font>                                                                                                                                              </pre>
<pre>     <font color="black">203</font> <font color="red">        rows++;</font>                                                                                                                                                                                                             </pre>
<pre>     <font color="black">204</font> <font color="red">    } else if (rows > 1 && textarea.scrollHeight < messageLastScrollHeight) {</font>                                                                                                                                               </pre>
<pre>     <font color="black">205</font> <font color="red">        rows--;</font>                                                                                                                                                                                                             </pre>
<pre>     <font color="black">206</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre>
<pre>     <font color="black">207</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">208</font> <font color="red">    messageLastScrollHeight = textarea.scrollHeight;</font>                                                                                                                                                                        </pre>
<pre>     <font color="black">209</font> <font color="red">    textarea.setAttribute("rows", rows);</font>                                                                                                                                                                                    </pre>
<pre>     <font color="black">210</font> }                                                                                                              <font color="black">138</font> }                                                                                                        </pre>
<pre>     <font color="black">211</font>                                                                                                                <font color="black">139</font>                                                                                                          </pre>
<pre>     <font color="black">212</font> export default class Editor {                                                                                  <font color="black">140</font> export default class Editor {                                                                            </pre>
<pre>     <font color="black">213</font>   constructor(formulas, viewFn, rowHeight) {                                                                   <font color="black">141</font>   constructor(formulas, viewFn, rowHeight) {                                                             </pre>
<pre>     <font color="black">214</font>     this.viewFn = viewFn;                                                                                      <font color="black">142</font>     this.viewFn = viewFn;                                                                                </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">224</font>       this.clear();                                                                                            <font color="black">152</font>       this.clear();                                                                                      </pre>
<pre>     <font color="black">225</font>     });                                                                                                        <font color="black">153</font>     });                                                                                                  </pre>
<pre>     <font color="black">226</font>     this.areaEl = h('div', `${cssPrefix}-editor-area`)                                                         <font color="black">154</font>     this.areaEl = h('div', `${cssPrefix}-editor-area`)                                                   </pre>
<pre>     <font color="black">227</font>       .children(                                                                                               <font color="black">155</font>       .children(                                                                                         </pre>
<pre>     <font color="black">228</font>         this.textEl = h('textarea', '')                                                                        <font color="black">156</font>         this.textEl = h('textarea', '')                                                                  </pre>
<pre>     <font color="black">229</font>        <font color="red">//</font>   .on('input', evt => inputEventHandler.call(this, evt)),                                            <font color="black">157</font>           .on('input', evt => inputEventHandler.call(this, evt)),                                        </pre>
<pre>     <font color="black">230</font> <font color="red">          .on('keydown', evt => keydownEventHandler.call(this, evt)),</font>                                                                                                                                                       </pre>
<pre>     <font color="black">231</font> <font color="red">        //  .on('textarea', evt => textareaEventHandler.call(this, evt)),</font>                                                                                                                                                   </pre>
<pre>     <font color="black">232</font> <font color="red">        //this.textEl.attr("rows","5"),</font>                                                                                                                                                                                     </pre>
<pre>     <font color="black">233</font> <font color="red">        //this.textEl.attr("cols","5"),</font>                                                                                                                                                                                     </pre>
<pre>     <font color="black">234</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">235</font>         this.textlineEl = h('div', 'textline'),                                                                <font color="black">158</font>         this.textlineEl = h('div', 'textline'),                                                          </pre>
<pre>     <font color="black">236</font>         this.suggest.el,                                                                                       <font color="black">159</font>         this.suggest.el,                                                                                 </pre>
<pre>     <font color="black">237</font>         this.datepicker.el,                                                                                    <font color="black">160</font>         this.datepicker.el,                                                                              </pre>
<pre>     <font color="black">238</font>       )                                                                                                        <font color="black">161</font>       )                                                                                                  </pre>
<pre>     <font color="black">239</font>       .on('mousemove.stop', () => {})                                                                          <font color="black">162</font>       .on('mousemove.stop', () => {})                                                                    </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">325</font>       }                                                                                                        <font color="black">248</font>       }                                                                                                  </pre>
<pre>     <font color="black">326</font>     }                                                                                                          <font color="black">249</font>     }                                                                                                    </pre>
<pre>     <font color="black">327</font>   }                                                                                                            <font color="black">250</font>   }                                                                                                      </pre>
<pre>     <font color="black">328</font>                                                                                                                <font color="black">251</font>                                                                                                          </pre>
<pre>     <font color="black">329</font>   setText(text) {                                                                                              <font color="black">252</font>   setText(text) {                                                                                        </pre>
<pre>     <font color="black">330</font>     this.inputText = text<font color="red"> </font>;                                                                                    <font color="black">253</font>     this.inputText = text;                                                                               </pre>
<pre>     <font color="black">331</font>     // console.log('text>>:', text);                                                                           <font color="black">254</font>     // console.log('text>>:', text);                                                                     </pre>
<pre>     <font color="black">332</font>     setText.call(this, text, text.length);                                                                     <font color="black">255</font>     setText.call(this, text, text.length);                                                               </pre>
<pre>     <font color="black">333</font>     resetTextareaSize.call(this);                                                                              <font color="black">256</font>     resetTextareaSize.call(this);                                                                        </pre>
<pre>     <font color="black">334</font>   }                                                                                                            <font color="black">257</font>   }                                                                                                      </pre>
<pre>     <font color="black">335</font> }                                                                                                              <font color="black">258</font> }                                                                                                        </pre>
<pre><font color="blue">../src/component/table.js</font>                                                                                          <font color="blue">../../x-spreadsheet/src/component/table.js</font>                                                                        </pre>
<pre>      <font color="black">24</font>     lineWidth: thinLineWidth(),                                                                                 <font color="black">24</font>     lineWidth: thinLineWidth(),                                                                          </pre>
<pre>      <font color="black">25</font>     strokeStyle: '#e6e6e6',                                                                                     <font color="black">25</font>     strokeStyle: '#e6e6e6',                                                                              </pre>
<pre>      <font color="black">26</font>   };                                                                                                            <font color="black">26</font>   };                                                                                                     </pre>
<pre>      <font color="black">27</font> }                                                                                                               <font color="black">27</font> }                                                                                                        </pre>
<pre>      <font color="black">28</font>                                                                                                                 <font color="black">28</font>                                                                                                          </pre>
<pre>      <font color="black">29</font> function getDrawBox(rindex, cindex) {                                                                           <font color="black">29</font> function getDrawBox(<font color="green">data, </font>rindex, cindex<font color="green">, yoffset = 0</font>) {                                                 </pre>
<pre>      <font color="black">30</font> <font color="red">  const { data } = this;</font>                                                                                                                                                                                                    </pre>
<pre>      <font color="black">31</font>   const {                                                                                                       <font color="black">30</font>   const {                                                                                                </pre>
<pre>      <font color="black">32</font>     left, top, width, height,                                                                                   <font color="black">31</font>     left, top, width, height,                                                                            </pre>
<pre>      <font color="black">33</font>   } = data.cellRect(rindex, cindex);                                                                            <font color="black">32</font>   } = data.cellRect(rindex, cindex);                                                                     </pre>
<pre>      <font color="black">34</font>   return new DrawBox(left, top, width, height, cellPaddingWidth);                                               <font color="black">33</font>   return new DrawBox(left, top<font color="green"> + yoffset</font>, width, height, cellPaddingWidth);                              </pre>
<pre>      <font color="black">35</font> }                                                                                                               <font color="black">34</font> }                                                                                                        </pre>
<pre>      <font color="black">36</font> /*                                                                                                              <font color="black">35</font> /*                                                                                                       </pre>
<pre>      <font color="black">37</font> function renderCellBorders(bboxes, translateFunc) {                                                             <font color="black">36</font> function renderCellBorders(bboxes, translateFunc) {                                                      </pre>
<pre>      <font color="black">38</font>   const { draw } = this;                                                                                        <font color="black">37</font>   const { draw } = this;                                                                                 </pre>
<pre>      <font color="black">39</font>   if (bboxes) {                                                                                                 <font color="black">38</font>   if (bboxes) {                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">48</font>     });                                                                                                         <font color="black">47</font>     });                                                                                                  </pre>
<pre>      <font color="black">49</font>   }                                                                                                             <font color="black">48</font>   }                                                                                                      </pre>
<pre>      <font color="black">50</font> }                                                                                                               <font color="black">49</font> }                                                                                                        </pre>
<pre>      <font color="black">51</font> */                                                                                                              <font color="black">50</font> */                                                                                                       </pre>
<pre>      <font color="black">52</font>                                                                                                                 <font color="black">51</font>                                                                                                          </pre>
<pre>      <font color="black">53</font> <font color="red">function renderCell(rindex, cindex) {</font>                                                                           <font color="black">52</font> <font color="green">export function renderCell(draw, data, rindex, cindex, yoffset = 0) {</font>                                    </pre>
<pre>      <font color="black">54</font> <font color="red">  const { draw, data } = this;</font>                                                                                                                                                                                              </pre>
<pre>      <font color="black">55</font>   const { sortedRowMap } = data;                                                                                <font color="black">53</font>   const { sortedRowMap } = data;                                                                         </pre>
<pre>      <font color="black">56</font>   let nrindex = rindex;                                                                                         <font color="black">54</font>   let nrindex = rindex;                                                                                  </pre>
<pre>      <font color="black">57</font>   if (sortedRowMap.has(rindex)) {                                                                               <font color="black">55</font>   if (sortedRowMap.has(rindex)) {                                                                        </pre>
<pre>      <font color="black">58</font>     nrindex = sortedRowMap.get(rindex);                                                                         <font color="black">56</font>     nrindex = sortedRowMap.get(rindex);                                                                  </pre>
<pre>      <font color="black">59</font>   }                                                                                                             <font color="black">57</font>   }                                                                                                      </pre>
<pre>      <font color="black">60</font>                                                                                                                 <font color="black">58</font>                                                                                                          </pre>
<pre>      <font color="black">61</font>   const cell = data.getCell(nrindex, cindex);                                                                   <font color="black">59</font>   const cell = data.getCell(nrindex, cindex);                                                            </pre>
<pre>      <font color="black">62</font>   if (cell === null) return;                                                                                    <font color="black">60</font>   if (cell === null) return;                                                                             </pre>
<pre>                                                                                                                         <font color="black">61</font> <font color="green">  let frozen = false;</font>                                                                                    </pre>
<pre>                                                                                                                         <font color="black">62</font> <font color="green">  if ('editable' in cell && cell.editable === false) {</font>                                                   </pre>
<pre>                                                                                                                         <font color="black">63</font> <font color="green">    frozen = true;</font>                                                                                       </pre>
<pre>                                                                                                                         <font color="black">64</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>      <font color="black">63</font>                                                                                                                 <font color="black">65</font>                                                                                                          </pre>
<pre>      <font color="black">64</font>   const style = data.getCellStyleOrDefault(nrindex, cindex);                                                    <font color="black">66</font>   const style = data.getCellStyleOrDefault(nrindex, cindex);                                             </pre>
<pre>      <font color="black">65</font> <font color="red">  // console.log('style:', style);</font>                                                                                                                                                                                          </pre>
<pre>      <font color="black">66</font>   const dbox = getDrawBox<font color="orange">.c</font>a<font color="red">ll(</font>t<font color="orange">his</font>, rindex, cindex);                                                           <font color="black">67</font>   const dbox = getDrawBox<font color="orange">(d</font>at<font color="orange">a</font>, rindex, cindex<font color="green">, yoffset</font>);                                                </pre>
<pre>      <font color="black">67</font>   dbox.bgcolor = style.bgcolor;                                                                                 <font color="black">68</font>   dbox.bgcolor = style.bgcolor;                                                                          </pre>
<pre>      <font color="black">68</font>   if (style.border !== undefined) {                                                                             <font color="black">69</font>   if (style.border !== undefined) {                                                                      </pre>
<pre>      <font color="black">69</font>     dbox.setBorders(style.border);                                                                              <font color="black">70</font>     dbox.setBorders(style.border);                                                                       </pre>
<pre>      <font color="black">70</font>     // bboxes.push({ ri: rindex, ci: cindex, box: dbox });                                                      <font color="black">71</font>     // bboxes.push({ ri: rindex, ci: cindex, box: dbox });                                               </pre>
<pre>      <font color="black">71</font>     draw.strokeBorders(dbox);                                                                                   <font color="black">72</font>     draw.strokeBorders(dbox);                                                                            </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">92</font>     const error = data.validations.getError(rindex, cindex);                                                    <font color="black">93</font>     const error = data.validations.getError(rindex, cindex);                                             </pre>
<pre>      <font color="black">93</font>     if (error) {                                                                                                <font color="black">94</font>     if (error) {                                                                                         </pre>
<pre>      <font color="black">94</font>       // console.log('error:', rindex, cindex, error);                                                          <font color="black">95</font>       // console.log('error:', rindex, cindex, error);                                                   </pre>
<pre>      <font color="black">95</font>       draw.error(dbox);                                                                                         <font color="black">96</font>       draw.error(dbox);                                                                                  </pre>
<pre>      <font color="black">96</font>     }                                                                                                           <font color="black">97</font>     }                                                                                                    </pre>
<pre>                                                                                                                         <font color="black">98</font> <font color="green">    if (frozen) {</font>                                                                                        </pre>
<pre>                                                                                                                         <font color="black">99</font> <font color="green">      draw.frozen(dbox);</font>                                                                                 </pre>
<pre>                                                                                                                        <font color="black">100</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>      <font color="black">97</font>   });                                                                                                          <font color="black">101</font>   });                                                                                                    </pre>
<pre>      <font color="black">98</font> }                                                                                                              <font color="black">102</font> }                                                                                                        </pre>
<pre>      <font color="black">99</font>                                                                                                                <font color="black">103</font>                                                                                                          </pre>
<pre>     <font color="black">100</font> function renderAutofilter(viewRange) {                                                                         <font color="black">104</font> function renderAutofilter(viewRange) {                                                                   </pre>
<pre>     <font color="black">101</font>   const { data, draw } = this;                                                                                 <font color="black">105</font>   const { data, draw } = this;                                                                           </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">103</font>     const { autoFilter } = data;                                                                               <font color="black">107</font>     const { autoFilter } = data;                                                                         </pre>
<pre>     <font color="black">104</font>     if (!autoFilter.active()) return;                                                                          <font color="black">108</font>     if (!autoFilter.active()) return;                                                                    </pre>
<pre>     <font color="black">105</font>     const afRange = autoFilter.hrange();                                                                       <font color="black">109</font>     const afRange = autoFilter.hrange();                                                                 </pre>
<pre>     <font color="black">106</font>     if (viewRange.intersects(afRange)) {                                                                       <font color="black">110</font>     if (viewRange.intersects(afRange)) {                                                                 </pre>
<pre>     <font color="black">107</font>       afRange.each((ri, ci) => {                                                                               <font color="black">111</font>       afRange.each((ri, ci) => {                                                                         </pre>
<pre>     <font color="black">108</font>         const dbox = getDrawBox<font color="orange">.c</font>a<font color="red">ll(</font>t<font color="orange">his</font>, ri, ci);                                                            <font color="black">112</font>         const dbox = getDrawBox<font color="orange">(d</font>at<font color="orange">a</font>, ri, ci);                                                           </pre>
<pre>     <font color="black">109</font>         draw.dropdown(dbox);                                                                                   <font color="black">113</font>         draw.dropdown(dbox);                                                                             </pre>
<pre>     <font color="black">110</font>       });                                                                                                      <font color="black">114</font>       });                                                                                                </pre>
<pre>     <font color="black">111</font>     }                                                                                                          <font color="black">115</font>     }                                                                                                    </pre>
<pre>     <font color="black">112</font>   }                                                                                                            <font color="black">116</font>   }                                                                                                      </pre>
<pre>     <font color="black">113</font> }                                                                                                              <font color="black">117</font> }                                                                                                        </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">117</font>   draw.save();                                                                                                 <font color="black">121</font>   draw.save();                                                                                           </pre>
<pre>     <font color="black">118</font>   draw.translate(fw, fh)                                                                                       <font color="black">122</font>   draw.translate(fw, fh)                                                                                 </pre>
<pre>     <font color="black">119</font>     .translate(tx, ty);                                                                                        <font color="black">123</font>     .translate(tx, ty);                                                                                  </pre>
<pre>     <font color="black">120</font>                                                                                                                <font color="black">124</font>                                                                                                          </pre>
<pre>     <font color="black">121</font>   const { exceptRowSet } = data;                                                                               <font color="black">125</font>   const { exceptRowSet } = data;                                                                         </pre>
<pre>                                                                                                                        <font color="black">126</font> <font color="green">  // const exceptRows = Array.from(exceptRowSet);</font>                                                        </pre>
<pre>     <font color="black">122</font>   const filteredTranslateFunc = (ri) => {                                                                      <font color="black">127</font>   const filteredTranslateFunc = (ri) => {                                                                </pre>
<pre>     <font color="black">123</font>     const ret = exceptRowSet.has(ri);                                                                          <font color="black">128</font>     const ret = exceptRowSet.has(ri);                                                                    </pre>
<pre>     <font color="black">124</font>     if (ret) {                                                                                                 <font color="black">129</font>     if (ret) {                                                                                           </pre>
<pre>     <font color="black">125</font>       const height = data.rows.getHeight(ri);                                                                  <font color="black">130</font>       const height = data.rows.getHeight(ri);                                                            </pre>
<pre>     <font color="black">126</font>       draw.translate(0, -height);                                                                              <font color="black">131</font>       draw.translate(0, -height);                                                                        </pre>
<pre>     <font color="black">127</font>     }                                                                                                          <font color="black">132</font>     }                                                                                                    </pre>
<pre>     <font color="black">128</font>     return !ret;                                                                                               <font color="black">133</font>     return !ret;                                                                                         </pre>
<pre>     <font color="black">129</font>   };                                                                                                           <font color="black">134</font>   };                                                                                                     </pre>
<pre>                                                                                                                        <font color="black">135</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">136</font> <font color="green">  const exceptRowTotalHeight = data.exceptRowTotalHeight(viewRange.sri, viewRange.eri);</font>                  </pre>
<pre>     <font color="black">130</font>   // 1 render cell                                                                                             <font color="black">137</font>   // 1 render cell                                                                                       </pre>
<pre>     <font color="black">131</font> <font color="red">  // let bboxes = [];</font>                                                                                                                                                                                                       </pre>
<pre>     <font color="black">132</font>   draw.save();                                                                                                 <font color="black">138</font>   draw.save();                                                                                           </pre>
<pre>                                                                                                                        <font color="black">139</font> <font color="green">  draw.translate(0, -exceptRowTotalHeight);</font>                                                              </pre>
<pre>     <font color="black">133</font>   viewRange.each((ri, ci) => {                                                                                 <font color="black">140</font>   viewRange.each((ri, ci) => {                                                                           </pre>
<pre>     <font color="black">134</font>     renderCell<font color="orange">.c</font>a<font color="orange">ll(</font>t<font color="orange">his</font>, ri, ci);                                                                             <font color="black">141</font>     renderCell<font color="orange">(dr</font>a<font color="orange">w, da</font>t<font color="orange">a</font>, ri, ci);                                                                      </pre>
<pre>     <font color="black">135</font>   }, ri => filteredTranslateFunc(ri));                                                                         <font color="black">142</font>   }, ri => filteredTranslateFunc(ri));                                                                   </pre>
<pre>     <font color="black">136</font>   draw.restore();                                                                                              <font color="black">143</font>   draw.restore();                                                                                        </pre>
<pre>     <font color="black">137</font>                                                                                                                <font color="black">144</font>                                                                                                          </pre>
<pre>     <font color="black">138</font> <font color="red">  // 2 render cell border</font>                                                                                                                                                                                                   </pre>
<pre>     <font color="black">139</font> <font color="red">  // draw.save();</font>                                                                                                                                                                                                           </pre>
<pre>     <font color="black">140</font> <font color="red">  // renderCellBorders.call(this, bboxes, (ri) => filteredTranslateFunc(ri));</font>                                                                                                                                               </pre>
<pre>     <font color="black">141</font> <font color="red">  // draw.restore();</font>                                                                                                                                                                                                        </pre>
<pre>     <font color="black">142</font>                                                                                                                <font color="black">145</font>                                                                                                          </pre>
<pre>     <font color="black">143</font> <font color="red">  // / bboxes = [];</font>                                                                                                                                                                                                         </pre>
<pre>     <font color="black">144</font>   // <font color="orange">3</font> render mergeCell                                                                                        <font color="black">146</font>   // <font color="orange">2</font> render mergeCell                                                                                  </pre>
<pre>     <font color="black">145</font>   const rset = new Set();                                                                                      <font color="black">147</font>   const rset = new Set();                                                                                </pre>
<pre>     <font color="black">146</font>   draw.save();                                                                                                 <font color="black">148</font>   draw.save();                                                                                           </pre>
<pre>                                                                                                                        <font color="black">149</font> <font color="green">  draw.translate(0, -exceptRowTotalHeight);</font>                                                              </pre>
<pre>     <font color="black">147</font>   data.eachMergesInView(viewRange, ({ sri, sci, eri }) => {                                                    <font color="black">150</font>   data.eachMergesInView(viewRange, ({ sri, sci, eri }) => {                                              </pre>
<pre>     <font color="black">148</font>     if (!exceptRowSet.has(sri)) {                                                                              <font color="black">151</font>     if (!exceptRowSet.has(sri)) {                                                                        </pre>
<pre>     <font color="black">149</font>       renderCell<font color="orange">.c</font>a<font color="orange">ll(</font>t<font color="orange">his</font>, sri, sci);                                                                         <font color="black">152</font>       renderCell<font color="orange">(dr</font>a<font color="orange">w, da</font>t<font color="orange">a</font>, sri, sci);                                                                  </pre>
<pre>     <font color="black">150</font>     } else if (!rset.has(sri)) {                                                                               <font color="black">153</font>     } else if (!rset.has(sri)) {                                                                         </pre>
<pre>     <font color="black">151</font>       rset.add(sri);                                                                                           <font color="black">154</font>       rset.add(sri);                                                                                     </pre>
<pre>     <font color="black">152</font>       const height = data.rows.sumHeight(sri, eri + 1);                                                        <font color="black">155</font>       const height = data.rows.sumHeight(sri, eri + 1);                                                  </pre>
<pre>     <font color="black">153</font>       draw.translate(0, -height);                                                                              <font color="black">156</font>       draw.translate(0, -height);                                                                        </pre>
<pre>     <font color="black">154</font>     }                                                                                                          <font color="black">157</font>     }                                                                                                    </pre>
<pre>     <font color="black">155</font>   });                                                                                                          <font color="black">158</font>   });                                                                                                    </pre>
<pre>     <font color="black">156</font>   draw.restore();                                                                                              <font color="black">159</font>   draw.restore();                                                                                        </pre>
<pre>     <font color="black">157</font>                                                                                                                <font color="black">160</font>                                                                                                          </pre>
<pre>     <font color="black">158</font> <font color="red">  // 4 render mergeCell border</font>                                                                                                                                                                                              </pre>
<pre>     <font color="black">159</font> <font color="red">  // draw.save();</font>                                                                                                                                                                                                           </pre>
<pre>     <font color="black">160</font> <font color="red">  // renderCellBorders.call(this, bboxes, (ri) => filteredTranslateFunc(ri));</font>                                                                                                                                               </pre>
<pre>     <font color="black">161</font> <font color="red">  // draw.restore();</font>                                                                                                                                                                                                        </pre>
<pre>     <font color="black">162</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">163</font>   // <font color="orange">5</font> render autofilter                                                                                       <font color="black">161</font>   // <font color="orange">3</font> render autofilter                                                                                 </pre>
<pre>     <font color="black">164</font>   renderAutofilter.call(this, viewRange);                                                                      <font color="black">162</font>   renderAutofilter.call(this, viewRange);                                                                </pre>
<pre>     <font color="black">165</font>                                                                                                                <font color="black">163</font>                                                                                                          </pre>
<pre>     <font color="black">166</font>   draw.restore();                                                                                              <font color="black">164</font>   draw.restore();                                                                                        </pre>
<pre>     <font color="black">167</font> }                                                                                                              <font color="black">165</font> }                                                                                                        </pre>
<pre>     <font color="black">168</font>                                                                                                                <font color="black">166</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">286</font> class Table {                                                                                                  <font color="black">284</font> class Table {                                                                                            </pre>
<pre>     <font color="black">287</font>   constructor(el, data) {                                                                                      <font color="black">285</font>   constructor(el, data) {                                                                                </pre>
<pre>     <font color="black">288</font>     this.el = el;                                                                                              <font color="black">286</font>     this.el = el;                                                                                        </pre>
<pre>     <font color="black">289</font>     this.draw = new Draw(el, data.viewWidth(), data.viewHeight());                                             <font color="black">287</font>     this.draw = new Draw(el, data.viewWidth(), data.viewHeight());                                       </pre>
<pre>     <font color="black">290</font>     this.data = data;                                                                                          <font color="black">288</font>     this.data = data;                                                                                    </pre>
<pre>                                                                                                                        <font color="black">289</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">290</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">291</font> <font color="green">  resetData(data) {</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">292</font> <font color="green">    this.data = data;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">293</font> <font color="green">    this.render();</font>                                                                                       </pre>
<pre>     <font color="black">291</font>   }                                                                                                            <font color="black">294</font>   }                                                                                                      </pre>
<pre>     <font color="black">292</font>                                                                                                                <font color="black">295</font>                                                                                                          </pre>
<pre>     <font color="black">293</font>   render() {                                                                                                   <font color="black">296</font>   render() {                                                                                             </pre>
<pre>     <font color="black">294</font>     // resize canvas                                                                                           <font color="black">297</font>     // resize canvas                                                                                     </pre>
<pre>     <font color="black">295</font>     const { data } = this;                                                                                     <font color="black">298</font>     const { data } = this;                                                                               </pre>
<pre><font color="blue">../src/component/toolbar.js</font>                                                                                        <font color="blue">../../x-spreadsheet/src/component/toolbar.js</font>                                                                      </pre>
<pre>     <font color="black">156</font>       this.textwrapEl = buildButtonWithIcon(`${t('toolbar.textwrap')}`, 'textwrap', () => toggleChange.ca      <font color="black">156</font>       this.textwrapEl = buildButtonWithIcon(`${t('toolbar.textwrap')}`, 'textwrap', () => toggleChange.ca</pre>
<pre>ll(this, 'textwrap')),                                                                                             ll(this, 'textwrap')),                                                                                            </pre>
<pre>     <font color="black">157</font>       buildDivider(),                                                                                          <font color="black">157</font>       buildDivider(),                                                                                    </pre>
<pre>     <font color="black">158</font>       // this.linkEl = buildButtonWithIcon('Insert link', 'link'),                                             <font color="black">158</font>       // this.linkEl = buildButtonWithIcon('Insert link', 'link'),                                       </pre>
<pre>     <font color="black">159</font>       // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),                                          <font color="black">159</font>       // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),                                    </pre>
<pre>     <font color="black">160</font>       this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () => toggleChange.call(thi      <font color="black">160</font>       this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () => toggleChange.call(thi</pre>
<pre>s, 'freeze')),                                                                                                     s, 'freeze')),                                                                                                    </pre>
<pre>     <font color="black">161</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">162</font> <font color="red">      //GUSA</font>                                                                                                                                                                                                                </pre>
<pre>     <font color="black">163</font> <font color="red">      this.overlayerEl = buildButtonWithIcon(`${t('toolbar.overlayer')}`, 'overlayer', () => toggleChange</font>                                                                                                                   </pre>
<pre><font color="red">.call(this, 'overlayer')),</font>                                                                                                                                                                                                           </pre>
<pre>     <font color="black">164</font>       this.autofilterEl = buildButtonWithIcon(`${t('toolbar.autofilter')}`, 'autofilter', () => toggleCha      <font color="black">161</font>       this.autofilterEl = buildButtonWithIcon(`${t('toolbar.autofilter')}`, 'autofilter', () => toggleCha</pre>
<pre>nge.call(this, 'autofilter')),                                                                                     nge.call(this, 'autofilter')),                                                                                    </pre>
<pre>     <font color="black">165</font>       buildButton(`${t('toolbar.formula')}`).child(this.ddFormula.el),                                         <font color="black">162</font>       buildButton(`${t('toolbar.formula')}`).child(this.ddFormula.el),                                   </pre>
<pre>     <font color="black">166</font>       // buildDivider(),                                                                                       <font color="black">163</font>       // buildDivider(),                                                                                 </pre>
<pre>     <font color="black">167</font>       this.moreEl = buildButton(`${t('toolbar.more')}`).child(this.ddMore.el).hide(),                          <font color="black">164</font>       this.moreEl = buildButton(`${t('toolbar.more')}`).child(this.ddMore.el).hide(),                    </pre>
<pre>     <font color="black">168</font>     ];                                                                                                         <font color="black">165</font>     ];                                                                                                   </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">222</font>     if (cell) {                                                                                                <font color="black">219</font>     if (cell) {                                                                                          </pre>
<pre>     <font color="black">223</font>       if (cell.format) {                                                                                       <font color="black">220</font>       if (cell.format) {                                                                                 </pre>
<pre>     <font color="black">224</font>         this.ddFormat.setTitle(cell.format);                                                                   <font color="black">221</font>         this.ddFormat.setTitle(cell.format);                                                             </pre>
<pre>     <font color="black">225</font>       }                                                                                                        <font color="black">222</font>       }                                                                                                  </pre>
<pre>     <font color="black">226</font>     }                                                                                                          <font color="black">223</font>     }                                                                                                    </pre>
<pre>     <font color="black">227</font> <font color="red">    this.overlayerEl.active(true);</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">228</font>   }                                                                                                            <font color="black">224</font>   }                                                                                                      </pre>
<pre>     <font color="black">229</font> }                                                                                                              <font color="black">225</font> }                                                                                                        </pre>
<pre><font color="blue">../src/component/bottombar.js</font>                                                                                      <font color="blue">../../x-spreadsheet/src/component/bottombar.js</font>                                                                    </pre>
<pre>       <font color="black">1</font> import { h } from './element';                                                                                   <font color="black">1</font> import { h } from './element';                                                                           </pre>
<pre>                                                                                                                          <font color="black">2</font> <font color="green">import { bindClickoutside, unbindClickoutside } from './event';</font>                                          </pre>
<pre>       <font color="black">2</font> import { cssPrefix } from '../config';                                                                           <font color="black">3</font> import { cssPrefix } from '../config';                                                                   </pre>
<pre>                                                                                                                          <font color="black">4</font> <font color="green">import Icon from './icon';</font>                                                                               </pre>
<pre>                                                                                                                          <font color="black">5</font> <font color="green">import FormInput from './form_input';</font>                                                                    </pre>
<pre>                                                                                                                          <font color="black">6</font> <font color="green">import Dropdown from './dropdown';</font>                                                                       </pre>
<pre>                                                                                                                          <font color="black">7</font> <font color="green">import { xtoast } from './message';</font>                                                                      </pre>
<pre>                                                                                                                          <font color="black">8</font> <font color="green">import { tf } from '../locale/locale';</font>                                                                   </pre>
<pre>                                                                                                                          <font color="black">9</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">10</font> <font color="green">class DropdownMore extends Dropdown {</font>                                                                    </pre>
<pre>                                                                                                                         <font color="black">11</font> <font color="green">  constructor(click) {</font>                                                                                   </pre>
<pre>                                                                                                                         <font color="black">12</font> <font color="green">    const icon = new Icon('ellipsis');</font>                                                                   </pre>
<pre>                                                                                                                         <font color="black">13</font> <font color="green">    super(icon, 'auto', false, 'top-left');</font>                                                              </pre>
<pre>                                                                                                                         <font color="black">14</font> <font color="green">    this.contentClick = click;</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">15</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">16</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">17</font> <font color="green">  reset(items) {</font>                                                                                         </pre>
<pre>                                                                                                                         <font color="black">18</font> <font color="green">    const eles = items.map((it, i) => h('div', `${cssPrefix}-item`)</font>                                      </pre>
<pre>                                                                                                                         <font color="black">19</font> <font color="green">      .css('width', '150px')</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">20</font> <font color="green">      .css('font-weight', 'normal')</font>                                                                      </pre>
<pre>                                                                                                                         <font color="black">21</font> <font color="green">      .on('click', () => {</font>                                                                               </pre>
<pre>                                                                                                                         <font color="black">22</font> <font color="green">        this.contentClick(i);</font>                                                                            </pre>
<pre>                                                                                                                         <font color="black">23</font> <font color="green">        this.hide();</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">24</font> <font color="green">      })</font>                                                                                                 </pre>
<pre>                                                                                                                         <font color="black">25</font> <font color="green">      .child(it));</font>                                                                                       </pre>
<pre>                                                                                                                         <font color="black">26</font> <font color="green">    this.setContentChildren(...eles);</font>                                                                    </pre>
<pre>                                                                                                                         <font color="black">27</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">28</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">29</font> <font color="green">  setTitle() {}</font>                                                                                          </pre>
<pre>                                                                                                                         <font color="black">30</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">31</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">32</font> <font color="green">const menuItems = [</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">33</font> <font color="green">  { key: 'delete', title: tf('contextmenu.deleteSheet') },</font>                                               </pre>
<pre>                                                                                                                         <font color="black">34</font> <font color="green">];</font>                                                                                                       </pre>
<pre>                                                                                                                         <font color="black">35</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">36</font> <font color="green">function buildMenuItem(item) {</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">37</font> <font color="green">  return h('div', `${cssPrefix}-item`)</font>                                                                   </pre>
<pre>                                                                                                                         <font color="black">38</font> <font color="green">    .child(item.title())</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">39</font> <font color="green">    .on('click', () => {</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">40</font> <font color="green">      this.itemClick(item.key);</font>                                                                          </pre>
<pre>                                                                                                                         <font color="black">41</font> <font color="green">      this.hide();</font>                                                                                       </pre>
<pre>                                                                                                                         <font color="black">42</font> <font color="green">    });</font>                                                                                                  </pre>
<pre>                                                                                                                         <font color="black">43</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">44</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">45</font> <font color="green">function buildMenu() {</font>                                                                                   </pre>
<pre>                                                                                                                         <font color="black">46</font> <font color="green">  return menuItems.map(it => buildMenuItem.call(this, it));</font>                                              </pre>
<pre>                                                                                                                         <font color="black">47</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">48</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">49</font> <font color="green">class ContextMenu {</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">50</font> <font color="green">  constructor() {</font>                                                                                        </pre>
<pre>                                                                                                                         <font color="black">51</font> <font color="green">    this.el = h('div', `${cssPrefix}-contextmenu`)</font>                                                       </pre>
<pre>                                                                                                                         <font color="black">52</font> <font color="green">      .css('width', '160px')</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">53</font> <font color="green">      .children(...buildMenu.call(this))</font>                                                                 </pre>
<pre>                                                                                                                         <font color="black">54</font> <font color="green">      .hide();</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">55</font> <font color="green">    this.itemClick = () => {};</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">56</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">57</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">58</font> <font color="green">  hide() {</font>                                                                                               </pre>
<pre>                                                                                                                         <font color="black">59</font> <font color="green">    const { el } = this;</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">60</font> <font color="green">    el.hide();</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">61</font> <font color="green">    unbindClickoutside(el);</font>                                                                              </pre>
<pre>                                                                                                                         <font color="black">62</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">63</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">64</font> <font color="green">  setOffset(offset) {</font>                                                                                    </pre>
<pre>                                                                                                                         <font color="black">65</font> <font color="green">    const { el } = this;</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">66</font> <font color="green">    el.offset(offset);</font>                                                                                   </pre>
<pre>                                                                                                                         <font color="black">67</font> <font color="green">    el.show();</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">68</font> <font color="green">    bindClickoutside(el);</font>                                                                                </pre>
<pre>                                                                                                                         <font color="black">69</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">70</font> <font color="green">}</font>                                                                                                        </pre>
<pre>       <font color="black">3</font>                                                                                                                 <font color="black">71</font>                                                                                                          </pre>
<pre>       <font color="black">4</font> export default class Bottombar {                                                                                <font color="black">72</font> export default class Bottombar {                                                                         </pre>
<pre>       <font color="black">5</font> <font color="red">  constructor(datas) {</font>                                                                                          <font color="black">73</font> <font color="green">  constructor(addFunc = () => {},</font>                                                                        </pre>
<pre>                                                                                                                         <font color="black">74</font> <font color="green">    swapFunc = () => {},</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">75</font> <font color="green">    deleteFunc = () => {},</font>                                                                               </pre>
<pre>                                                                                                                         <font color="black">76</font> <font color="green">    updateFunc = () => {}) {</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">77</font> <font color="green">    this.swapFunc = swapFunc;</font>                                                                            </pre>
<pre>                                                                                                                         <font color="black">78</font> <font color="green">    this.updateFunc = updateFunc;</font>                                                                        </pre>
<pre>       <font color="black">6</font>     this.datas = <font color="orange">datas</font>;                                                                                         <font color="black">79</font>     this.data<font color="green">Name</font>s = <font color="orange">[]</font>;                                                                                 </pre>
<pre>                                                                                                                         <font color="black">80</font> <font color="green">    this.activeEl = null;</font>                                                                                </pre>
<pre>                                                                                                                         <font color="black">81</font> <font color="green">    this.deleteEl = null;</font>                                                                                </pre>
<pre>                                                                                                                         <font color="black">82</font> <font color="green">    this.items = [];</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">83</font> <font color="green">    this.moreEl = new DropdownMore((i) => {</font>                                                              </pre>
<pre>                                                                                                                         <font color="black">84</font> <font color="green">      this.clickSwap2(this.items[i]);</font>                                                                    </pre>
<pre>                                                                                                                         <font color="black">85</font> <font color="green">    });</font>                                                                                                  </pre>
<pre>                                                                                                                         <font color="black">86</font> <font color="green">    this.contextMenu = new ContextMenu();</font>                                                                </pre>
<pre>                                                                                                                         <font color="black">87</font> <font color="green">    this.contextMenu.itemClick = deleteFunc;</font>                                                             </pre>
<pre>       <font color="black">7</font>     this.el = h('div', `${cssPrefix}-bottombar`)<font color="orange">;</font>                                                               <font color="black">88</font>     this.el = h('div', `${cssPrefix}-bottombar`)<font color="orange">.children(</font>                                               </pre>
<pre>                                                                                                                         <font color="black">89</font> <font color="green">      this.contextMenu.el,</font>                                                                               </pre>
<pre>                                                                                                                         <font color="black">90</font> <font color="green">      this.menuEl = h('ul', `${cssPrefix}-menu`).child(</font>                                                  </pre>
<pre>                                                                                                                         <font color="black">91</font> <font color="green">        h('li', '').children(</font>                                                                            </pre>
<pre>                                                                                                                         <font color="black">92</font> <font color="green">          new Icon('add').on('click', () => {</font>                                                            </pre>
<pre>                                                                                                                         <font color="black">93</font> <font color="green">            if (this.dataNames.length < 10) {</font>                                                            </pre>
<pre>                                                                                                                         <font color="black">94</font> <font color="green">              addFunc();</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">95</font> <font color="green">            } else {</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">96</font> <font color="green">              xtoast('tip', 'it less than or equal to 10');</font>                                              </pre>
<pre>                                                                                                                         <font color="black">97</font> <font color="green">            }</font>                                                                                            </pre>
<pre>                                                                                                                         <font color="black">98</font> <font color="green">          }),</font>                                                                                            </pre>
<pre>                                                                                                                         <font color="black">99</font> <font color="green">          h('span', '').child(this.moreEl),</font>                                                              </pre>
<pre>                                                                                                                        <font color="black">100</font> <font color="green">        ),</font>                                                                                               </pre>
<pre>                                                                                                                        <font color="black">101</font> <font color="green">      ),</font>                                                                                                 </pre>
<pre>                                                                                                                        <font color="black">102</font> <font color="green">    );</font>                                                                                                   </pre>
<pre>                                                                                                                        <font color="black">103</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">104</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">105</font> <font color="green">  addItem(name, active) {</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">106</font> <font color="green">    this.dataNames.push(name);</font>                                                                           </pre>
<pre>                                                                                                                        <font color="black">107</font> <font color="green">    const item = h('li', active ? 'active' : '').child(name);</font>                                            </pre>
<pre>                                                                                                                        <font color="black">108</font> <font color="green">    item.on('click', () => {</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">109</font> <font color="green">      this.clickSwap2(item);</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">110</font> <font color="green">    }).on('contextmenu', (evt) => {</font>                                                                      </pre>
<pre>                                                                                                                        <font color="black">111</font> <font color="green">      const { offsetLeft, offsetHeight } = evt.target;</font>                                                   </pre>
<pre>                                                                                                                        <font color="black">112</font> <font color="green">      this.contextMenu.setOffset({ left: offsetLeft, bottom: offsetHeight + 1 });</font>                        </pre>
<pre>                                                                                                                        <font color="black">113</font> <font color="green">      this.deleteEl = item;</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">114</font> <font color="green">    }).on('dblclick', () => {</font>                                                                            </pre>
<pre>                                                                                                                        <font color="black">115</font> <font color="green">      const v = item.html();</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">116</font> <font color="green">      const input = new FormInput('auto', '');</font>                                                           </pre>
<pre>                                                                                                                        <font color="black">117</font> <font color="green">      input.val(v);</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">118</font> <font color="green">      input.input.on('blur', ({ target }) => {</font>                                                           </pre>
<pre>                                                                                                                        <font color="black">119</font> <font color="green">        const { value } = target;</font>                                                                        </pre>
<pre>                                                                                                                        <font color="black">120</font> <font color="green">        const nindex = this.dataNames.findIndex(it => it === v);</font>                                         </pre>
<pre>                                                                                                                        <font color="black">121</font> <font color="green">        this.dataNames.splice(nindex, 1, value);</font>                                                         </pre>
<pre>                                                                                                                        <font color="black">122</font> <font color="green">        this.moreEl.reset(this.dataNames);</font>                                                               </pre>
<pre>                                                                                                                        <font color="black">123</font> <font color="green">        item.html('').child(value);</font>                                                                      </pre>
<pre>                                                                                                                        <font color="black">124</font> <font color="green">        this.updateFunc(nindex, value);</font>                                                                  </pre>
<pre>                                                                                                                        <font color="black">125</font> <font color="green">      });</font>                                                                                                </pre>
<pre>                                                                                                                        <font color="black">126</font> <font color="green">      item.html('').child(input.el);</font>                                                                     </pre>
<pre>                                                                                                                        <font color="black">127</font> <font color="green">      input.focus();</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">128</font> <font color="green">    });</font>                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">129</font> <font color="green">    if (active) {</font>                                                                                        </pre>
<pre>                                                                                                                        <font color="black">130</font> <font color="green">      this.clickSwap(item);</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">131</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">132</font> <font color="green">    this.items.push(item);</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">133</font> <font color="green">    this.menuEl.child(item);</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">134</font> <font color="green">    this.moreEl.reset(this.dataNames);</font>                                                                   </pre>
<pre>                                                                                                                        <font color="black">135</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">136</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">137</font> <font color="green">  deleteItem() {</font>                                                                                         </pre>
<pre>                                                                                                                        <font color="black">138</font> <font color="green">    const { activeEl, deleteEl } = this;</font>                                                                 </pre>
<pre>                                                                                                                        <font color="black">139</font> <font color="green">    if (this.items.length > 1) {</font>                                                                         </pre>
<pre>                                                                                                                        <font color="black">140</font> <font color="green">      const index = this.items.findIndex(it => it === deleteEl);</font>                                         </pre>
<pre>                                                                                                                        <font color="black">141</font> <font color="green">      this.items.splice(index, 1);</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">142</font> <font color="green">      this.dataNames.splice(index, 1);</font>                                                                   </pre>
<pre>                                                                                                                        <font color="black">143</font> <font color="green">      this.menuEl.removeChild(deleteEl.el);</font>                                                              </pre>
<pre>                                                                                                                        <font color="black">144</font> <font color="green">      this.moreEl.reset(this.dataNames);</font>                                                                 </pre>
<pre>                                                                                                                        <font color="black">145</font> <font color="green">      if (activeEl === deleteEl) {</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">146</font> <font color="green">        const [f] = this.items;</font>                                                                          </pre>
<pre>                                                                                                                        <font color="black">147</font> <font color="green">        this.activeEl = f;</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">148</font> <font color="green">        this.activeEl.toggle();</font>                                                                          </pre>
<pre>                                                                                                                        <font color="black">149</font> <font color="green">        return [index, 0];</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">150</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">151</font> <font color="green">      return [index, -1];</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">152</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">153</font> <font color="green">    return [-1];</font>                                                                                         </pre>
<pre>                                                                                                                        <font color="black">154</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">155</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">156</font> <font color="green">  clickSwap2(item) {</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">157</font> <font color="green">    const index = this.items.findIndex(it => it === item);</font>                                               </pre>
<pre>                                                                                                                        <font color="black">158</font> <font color="green">    this.clickSwap(item);</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">159</font> <font color="green">    this.activeEl.toggle();</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">160</font> <font color="green">    this.swapFunc(index);</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">161</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">162</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">163</font> <font color="green">  clickSwap(item) {</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">164</font> <font color="green">    if (this.activeEl !== null) {</font>                                                                        </pre>
<pre>                                                                                                                        <font color="black">165</font> <font color="green">      this.activeEl.toggle();</font>                                                                            </pre>
<pre>                                                                                                                        <font color="black">166</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">167</font> <font color="green">    this.activeEl = item;</font>                                                                                </pre>
<pre>       <font color="black">8</font>   }                                                                                                            <font color="black">168</font>   }                                                                                                      </pre>
<pre>       <font color="black">9</font> }                                                                                                              <font color="black">169</font> }                                                                                                        </pre>
<pre><font color="blue">../src/component/sheet.js</font>                                                                                          <font color="blue">../../x-spreadsheet/src/component/sheet.js</font>                                                                        </pre>
<pre>       <font color="black">3</font> import { bind, mouseMoveUp, bindTouch } from './event';                                                          <font color="black">3</font> import { bind, mouseMoveUp, bindTouch } from './event';                                                  </pre>
<pre>       <font color="black">4</font> import Resizer from './resizer';                                                                                 <font color="black">4</font> import Resizer from './resizer';                                                                         </pre>
<pre>       <font color="black">5</font> import Scrollbar from './scrollbar';                                                                             <font color="black">5</font> import Scrollbar from './scrollbar';                                                                     </pre>
<pre>       <font color="black">6</font> import Selector from './selector';                                                                               <font color="black">6</font> import Selector from './selector';                                                                       </pre>
<pre>       <font color="black">7</font> import Editor from './editor';                                                                                   <font color="black">7</font> import Editor from './editor';                                                                           </pre>
<pre>                                                                                                                          <font color="black">8</font> <font color="green">import Print from './print';</font>                                                                             </pre>
<pre>       <font color="black">8</font> import ContextMenu from './contextmenu';                                                                         <font color="black">9</font> import ContextMenu from './contextmenu';                                                                 </pre>
<pre>       <font color="black">9</font> <font color="red">//import Table from './table';</font>                                                                                                                                                                                              </pre>
<pre>      <font color="black">10</font> import Table from './table<font color="red">2</font>';                                                                                   <font color="black">10</font> import Table from './table';                                                                             </pre>
<pre>      <font color="black">11</font> import Toolbar from './toolbar';                                                                                <font color="black">11</font> import Toolbar from './toolbar<font color="green">/index</font>';                                                                   </pre>
<pre>      <font color="black">12</font> import ModalValidation from './modal_validation';                                                               <font color="black">12</font> import ModalValidation from './modal_validation';                                                        </pre>
<pre>      <font color="black">13</font> import SortFilter from './sort_filter';                                                                         <font color="black">13</font> import SortFilter from './sort_filter';                                                                  </pre>
<pre>      <font color="black">14</font> import { xtoast } from './message';                                                                             <font color="black">14</font> import { xtoast } from './message';                                                                      </pre>
<pre>      <font color="black">15</font> import { cssPrefix } from '../config';                                                                          <font color="black">15</font> import { cssPrefix } from '../config';                                                                   </pre>
<pre>      <font color="black">16</font> import { formulas } from '../core/formula';                                                                     <font color="black">16</font> import { formulas } from '../core/formula';                                                              </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">131</font>     colResizer.hide();                                                                                         <font color="black">131</font>     colResizer.hide();                                                                                   </pre>
<pre>     <font color="black">132</font>   }                                                                                                            <font color="black">132</font>   }                                                                                                      </pre>
<pre>     <font color="black">133</font> }                                                                                                              <font color="black">133</font> }                                                                                                        </pre>
<pre>     <font color="black">134</font>                                                                                                                <font color="black">134</font>                                                                                                          </pre>
<pre>     <font color="black">135</font> function overlayerMousescroll(evt) {                                                                           <font color="black">135</font> function overlayerMousescroll(evt) {                                                                     </pre>
<pre>     <font color="black">136</font>   const { verticalScrollbar, data } = this;                                                                    <font color="black">136</font>   const { verticalScrollbar, <font color="green">horizontalScrollbar, </font>data } = this;                                         </pre>
<pre>     <font color="black">137</font>   const { top } = verticalScrollbar.scroll();                                                                  <font color="black">137</font>   const { top } = verticalScrollbar.scroll();                                                            </pre>
<pre>                                                                                                                        <font color="black">138</font> <font color="green">  const { left } = horizontalScrollbar.scroll();</font>                                                         </pre>
<pre>     <font color="black">138</font>   // console.log('evt:::', evt.wheelDelta, evt.detail * 40);                                                   <font color="black">139</font>   // console.log('evt:::', evt.wheelDelta, evt.detail * 40);                                             </pre>
<pre>     <font color="black">139</font> <font color="red">  let delta = evt.deltaY;</font>                                                                                      <font color="black">140</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">140</font>   const { rows } = data;                                                                                       <font color="black">141</font>   const { rows<font color="green">, cols</font> } = data;                                                                           </pre>
<pre>                                                                                                                        <font color="black">142</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">143</font> <font color="green">  // deltaY for vertical delta</font>                                                                           </pre>
<pre>                                                                                                                        <font color="black">144</font> <font color="green">  let { deltaY } = evt;</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">145</font> <font color="green">  // console.log('deltaX', deltaX, 'evt.detail', evt.detail);</font>                                            </pre>
<pre>     <font color="black">141</font>   if (evt.detail) delta = evt.detail * 40;                                                                     <font color="black">146</font>   if (evt.detail) delta<font color="green">Y</font> = evt.detail * 40;                                                              </pre>
<pre>     <font color="black">142</font>   if (delta > 0) {                                                                                             <font color="black">147</font>   if (delta<font color="green">Y</font> > 0) {                                                                                      </pre>
<pre>     <font color="black">143</font>     // up                                                                                                      <font color="black">148</font>     // up                                                                                                </pre>
<pre>     <font color="black">144</font>     const ri = data.scroll.ri + 1;                                                                             <font color="black">149</font>     const ri = data.scroll.ri + 1;                                                                       </pre>
<pre>     <font color="black">145</font>     if (ri < rows.len) {                                                                                       <font color="black">150</font>     if (ri < rows.len) {                                                                                 </pre>
<pre>     <font color="black">146</font>       verticalScrollbar.move({ top: top + rows.getHeight(ri) - 1 });                                           <font color="black">151</font>       verticalScrollbar.move({ top: top + rows.getHeight(ri) - 1 });                                     </pre>
<pre>     <font color="black">147</font>     }                                                                                                          <font color="black">152</font>     }                                                                                                    </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">150</font>     const ri = data.scroll.ri - 1;                                                                             <font color="black">155</font>     const ri = data.scroll.ri - 1;                                                                       </pre>
<pre>     <font color="black">151</font>     if (ri >= 0) {                                                                                             <font color="black">156</font>     if (ri >= 0) {                                                                                       </pre>
<pre>     <font color="black">152</font>       verticalScrollbar.move({ top: ri === 0 ? 0 : top - rows.getHeight(ri) });                                <font color="black">157</font>       verticalScrollbar.move({ top: ri === 0 ? 0 : top - rows.getHeight(ri) });                          </pre>
<pre>     <font color="black">153</font>     }                                                                                                          <font color="black">158</font>     }                                                                                                    </pre>
<pre>     <font color="black">154</font>   }                                                                                                            <font color="black">159</font>   }                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">160</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">161</font> <font color="green">  // deltaX for Mac horizontal scroll</font>                                                                    </pre>
<pre>                                                                                                                        <font color="black">162</font> <font color="green">  const { deltaX } = evt;</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">163</font> <font color="green">  if (deltaX > 0) {</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">164</font> <font color="green">    // left</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">165</font> <font color="green">    const ci = data.scroll.ci + 1;</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">166</font> <font color="green">    if (ci < cols.len) {</font>                                                                                 </pre>
<pre>                                                                                                                        <font color="black">167</font> <font color="green">      horizontalScrollbar.move({ left: left + cols.getWidth(ci) - 1 });</font>                                  </pre>
<pre>                                                                                                                        <font color="black">168</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">169</font> <font color="green">  } else {</font>                                                                                               </pre>
<pre>                                                                                                                        <font color="black">170</font> <font color="green">    // right</font>                                                                                             </pre>
<pre>                                                                                                                        <font color="black">171</font> <font color="green">    const ci = data.scroll.ci - 1;</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">172</font> <font color="green">    if (ci >= 0) {</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">173</font> <font color="green">      horizontalScrollbar.move({</font>                                                                         </pre>
<pre>                                                                                                                        <font color="black">174</font> <font color="green">        left: ci === 0 ? 0 : left - cols.getWidth(ci),</font>                                                   </pre>
<pre>                                                                                                                        <font color="black">175</font> <font color="green">      });</font>                                                                                                </pre>
<pre>                                                                                                                        <font color="black">176</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">177</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>     <font color="black">155</font> }                                                                                                              <font color="black">178</font> }                                                                                                        </pre>
<pre>     <font color="black">156</font>                                                                                                                <font color="black">179</font>                                                                                                          </pre>
<pre>     <font color="black">157</font> function overlayerTouch(direction, distance) {                                                                 <font color="black">180</font> function overlayerTouch(direction, distance) {                                                           </pre>
<pre>     <font color="black">158</font>   const { verticalScrollbar, horizontalScrollbar } = this;                                                     <font color="black">181</font>   const { verticalScrollbar, horizontalScrollbar } = this;                                               </pre>
<pre>     <font color="black">159</font>   const { top } = verticalScrollbar.scroll();                                                                  <font color="black">182</font>   const { top } = verticalScrollbar.scroll();                                                            </pre>
<pre>     <font color="black">160</font>   const { left } = horizontalScrollbar.scroll();                                                               <font color="black">183</font>   const { left } = horizontalScrollbar.scroll();                                                         </pre>
<pre>     <font color="black">161</font> <font color="red">  // console.log('direction:', direction, ', distance:', distance, left);</font>                                      <font color="black">184</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">162</font>   if (direction === 'left' || direction === 'right') {                                                         <font color="black">185</font>   if (direction === 'left' || direction === 'right') {                                                   </pre>
<pre>     <font color="black">163</font>     horizontalScrollbar.move({ left: left - distance });                                                       <font color="black">186</font>     horizontalScrollbar.move({ left: left - distance });                                                 </pre>
<pre>     <font color="black">164</font>   } else if (direction === 'up' || direction === 'down') {                                                     <font color="black">187</font>   } else if (direction === 'up' || direction === 'down') {                                               </pre>
<pre>     <font color="black">165</font>     verticalScrollbar.move({ top: top - distance });                                                           <font color="black">188</font>     verticalScrollbar.move({ top: top - distance });                                                     </pre>
<pre>     <font color="black">166</font>   }                                                                                                            <font color="black">189</font>   }                                                                                                      </pre>
<pre>     <font color="black">167</font> }                                                                                                              <font color="black">190</font> }                                                                                                        </pre>
<pre>     <font color="black">168</font>                                                                                                                <font color="black">191</font>                                                                                                          </pre>
<pre>     <font color="black">169</font> function verticalScrollbarSet() {                                                                              <font color="black">192</font> function verticalScrollbarSet() {                                                                        </pre>
<pre>     <font color="black">170</font>   const { data, verticalScrollbar } = this;                                                                    <font color="black">193</font>   const { data, verticalScrollbar } = this;                                                              </pre>
<pre>     <font color="black">171</font>   const { height } = this.getTableOffset();                                                                    <font color="black">194</font>   const { height } = this.getTableOffset();                                                              </pre>
<pre>                                                                                                                        <font color="black">195</font> <font color="green">  const erth = data.exceptRowTotalHeight(0, -1);</font>                                                         </pre>
<pre>                                                                                                                        <font color="black">196</font> <font color="green">  // console.log('erth:', erth);</font>                                                                         </pre>
<pre>     <font color="black">172</font>   verticalScrollbar.set(height, data.rows.totalHeight());                                                      <font color="black">197</font>   verticalScrollbar.set(height, data.rows.totalHeight()<font color="green"> - erth</font>);                                         </pre>
<pre>     <font color="black">173</font> }                                                                                                              <font color="black">198</font> }                                                                                                        </pre>
<pre>     <font color="black">174</font>                                                                                                                <font color="black">199</font>                                                                                                          </pre>
<pre>     <font color="black">175</font> function horizontalScrollbarSet() {                                                                            <font color="black">200</font> function horizontalScrollbarSet() {                                                                      </pre>
<pre>     <font color="black">176</font>   const { data, horizontalScrollbar } = this;                                                                  <font color="black">201</font>   const { data, horizontalScrollbar } = this;                                                            </pre>
<pre>     <font color="black">177</font>   const { width } = this.getTableOffset();                                                                     <font color="black">202</font>   const { width } = this.getTableOffset();                                                               </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">191</font>     editor.setFreezeLengths(fwidth, fheight);                                                                  <font color="black">216</font>     editor.setFreezeLengths(fwidth, fheight);                                                            </pre>
<pre>     <font color="black">192</font>   }                                                                                                            <font color="black">217</font>   }                                                                                                      </pre>
<pre>     <font color="black">193</font>   selector.resetAreaOffset();                                                                                  <font color="black">218</font>   selector.resetAreaOffset();                                                                            </pre>
<pre>     <font color="black">194</font> }                                                                                                              <font color="black">219</font> }                                                                                                        </pre>
<pre>     <font color="black">195</font>                                                                                                                <font color="black">220</font>                                                                                                          </pre>
<pre>     <font color="black">196</font> <font color="red">function dataSync() {  //GUSA</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">197</font> <font color="red">  const {</font>                                                                                                                                                                                                                   </pre>
<pre>     <font color="black">198</font> <font color="red">    table,</font>                                                                                                                                                                                                                  </pre>
<pre>     <font color="black">199</font> <font color="red">  } = this;</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">200</font> <font color="red">  table.render();</font>                                                                                                                                                                                                           </pre>
<pre>     <font color="black">201</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">202</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">203</font> function sheetReset() {                                                                                        <font color="black">221</font> function sheetReset() {                                                                                  </pre>
<pre>     <font color="black">204</font>   const {                                                                                                      <font color="black">222</font>   const {                                                                                                </pre>
<pre>     <font color="black">205</font>     tableEl,                                                                                                   <font color="black">223</font>     tableEl,                                                                                             </pre>
<pre>     <font color="black">206</font>     overlayerEl,                                                                                               <font color="black">224</font>     overlayerEl,                                                                                         </pre>
<pre>     <font color="black">207</font>     overlayerCEl,                                                                                              <font color="black">225</font>     overlayerCEl,                                                                                        </pre>
<pre>     <font color="black">208</font>     table,                                                                                                     <font color="black">226</font>     table,                                                                                               </pre>
<pre>     <font color="black">209</font>     toolbar,                                                                                                   <font color="black">227</font>     toolbar,                                                                                             </pre>
<pre>     <font color="black">210</font>     selector,                                                                                                  <font color="black">228</font>     selector,                                                                                            </pre>
<pre>     <font color="black">211</font>     el,                                                                                                        <font color="black">229</font>     el,                                                                                                  </pre>
<pre>     <font color="black">212</font> <font color="red">//    sync_sheet, //GUSA</font>                                                                                                                                                                                                    </pre>
<pre>     <font color="black">213</font>   } = this;                                                                                                    <font color="black">230</font>   } = this;                                                                                              </pre>
<pre>     <font color="black">214</font>   const tOffset = this.getTableOffset();                                                                       <font color="black">231</font>   const tOffset = this.getTableOffset();                                                                 </pre>
<pre>     <font color="black">215</font>   const vRect = this.getRect();                                                                                <font color="black">232</font>   const vRect = this.getRect();                                                                          </pre>
<pre>     <font color="black">216</font>   tableEl.attr(vRect);                                                                                         <font color="black">233</font>   tableEl.attr(vRect);                                                                                   </pre>
<pre>     <font color="black">217</font>   overlayerEl.offset(vRect);                                                                                   <font color="black">234</font>   overlayerEl.offset(vRect);                                                                             </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">221</font>   horizontalScrollbarSet.call(this);                                                                           <font color="black">238</font>   horizontalScrollbarSet.call(this);                                                                     </pre>
<pre>     <font color="black">222</font>   sheetFreeze.call(this);                                                                                      <font color="black">239</font>   sheetFreeze.call(this);                                                                                </pre>
<pre>     <font color="black">223</font>   table.render();                                                                                              <font color="black">240</font>   table.render();                                                                                        </pre>
<pre>     <font color="black">224</font>   toolbar.reset();                                                                                             <font color="black">241</font>   toolbar.reset();                                                                                       </pre>
<pre>     <font color="black">225</font>   selector.reset();                                                                                            <font color="black">242</font>   selector.reset();                                                                                      </pre>
<pre>     <font color="black">226</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre>
<pre>     <font color="black">227</font> <font color="red">  //GUSA</font>                                                                                                                                                                                                                    </pre>
<pre>     <font color="black">228</font> <font color="red">    console.log("sync_sheets !!!");</font>                                                                                                                                                                                         </pre>
<pre>     <font color="black">229</font> <font color="red">  //GUSA</font>                                                                                                                                                                                                                    </pre>
<pre>     <font color="black">230</font> <font color="red">  if (this.sync_sheets) { //GUSA</font>                                                                                                                                                                                            </pre>
<pre>     <font color="black">231</font> <font color="red">    console.log("sync_sheets !!!");</font>                                                                                                                                                                                         </pre>
<pre>     <font color="black">232</font> <font color="red">    //this.sync_sheets[0].reload(); //GUSA</font>                                                                                                                                                                                  </pre>
<pre>     <font color="black">233</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>     <font color="black">234</font> <font color="red"> */ </font>                                                                                                                                                                                                                        </pre>
<pre>     <font color="black">235</font> }                                                                                                              <font color="black">243</font> }                                                                                                        </pre>
<pre>     <font color="black">236</font>                                                                                                                <font color="black">244</font>                                                                                                          </pre>
<pre>     <font color="black">237</font> function clearClipboard() {                                                                                    <font color="black">245</font> function clearClipboard() {                                                                              </pre>
<pre>     <font color="black">238</font>   const { data, selector } = this;                                                                             <font color="black">246</font>   const { data, selector } = this;                                                                       </pre>
<pre>     <font color="black">239</font>   data.clearClipboard();                                                                                       <font color="black">247</font>   data.clearClipboard();                                                                                 </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">370</font>     editorSetOffset.call(this);                                                                                <font color="black">378</font>     editorSetOffset.call(this);                                                                          </pre>
<pre>     <font color="black">371</font>     table.render();                                                                                            <font color="black">379</font>     table.render();                                                                                      </pre>
<pre>     <font color="black">372</font>   });                                                                                                          <font color="black">380</font>   });                                                                                                    </pre>
<pre>     <font color="black">373</font> }                                                                                                              <font color="black">381</font> }                                                                                                        </pre>
<pre>     <font color="black">374</font>                                                                                                                <font color="black">382</font>                                                                                                          </pre>
<pre>     <font color="black">375</font> <font color="red">function sync_verticalScrollbarMove(distance) {</font>                                                                                                                                                                             </pre>
<pre>     <font color="black">376</font> <font color="red">  const { data, table, selector } = this;</font>                                                                                                                                                                                   </pre>
<pre>     <font color="black">377</font> <font color="red">  data.sync_scrolly(distance, () => {</font>                                                                                                                                                                                       </pre>
<pre>     <font color="black">378</font> <font color="red">    selector.resetBRLAreaOffset();</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">379</font> <font color="red">    editorSetOffset.call(this);</font>                                                                                                                                                                                             </pre>
<pre>     <font color="black">380</font> <font color="red">    table.render();</font>                                                                                                                                                                                                         </pre>
<pre>     <font color="black">381</font> <font color="red">  });</font>                                                                                                                                                                                                                       </pre>
<pre>     <font color="black">382</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">383</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">384</font> <font color="red">function sync_horizontalScrollbarMove(distance) {</font>                                                                                                                                                                           </pre>
<pre>     <font color="black">385</font> <font color="red">  const { data, table, selector } = this;</font>                                                                                                                                                                                   </pre>
<pre>     <font color="black">386</font> <font color="red">  data.sync_scrollx(distance, () => {</font>                                                                                                                                                                                       </pre>
<pre>     <font color="black">387</font> <font color="red">    selector.resetBRTAreaOffset();</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">388</font> <font color="red">    editorSetOffset.call(this);</font>                                                                                                                                                                                             </pre>
<pre>     <font color="black">389</font> <font color="red">    table.render();</font>                                                                                                                                                                                                         </pre>
<pre>     <font color="black">390</font> <font color="red">  });</font>                                                                                                                                                                                                                       </pre>
<pre>     <font color="black">391</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">392</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">393</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre>
<pre>     <font color="black">394</font> <font color="red">function sync_shape_layer_move() {</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">395</font> <font color="red">  const { data, table, selector } = this;</font>                                                                                                                                                                                   </pre>
<pre>     <font color="black">396</font> <font color="red">    table.sync_move_laerd_cell();</font>                                                                                                                                                                                           </pre>
<pre>     <font color="black">397</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">398</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">399</font> <font color="red">*/</font>                                                                                                                                                                                                                          </pre>
<pre>     <font color="black">400</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">401</font> function rowResizerFinished(cRect, distance) {                                                                 <font color="black">383</font> function rowResizerFinished(cRect, distance) {                                                           </pre>
<pre>     <font color="black">402</font>   const { ri } = cRect;                                                                                        <font color="black">384</font>   const { ri } = cRect;                                                                                  </pre>
<pre>     <font color="black">403</font>   const { table, selector, data } = this;                                                                      <font color="black">385</font>   const { table, selector, data } = this;                                                                </pre>
<pre>     <font color="black">404</font>   data.rows.setHeight(ri, distance);                                                                           <font color="black">386</font>   data.rows.setHeight(ri, distance);                                                                     </pre>
<pre>     <font color="black">405</font> <font color="red">  data.setRowHeight(ri, distance);  //GUSA</font>                                                                                                                                                                                  </pre>
<pre>     <font color="black">406</font>   table.render();                                                                                              <font color="black">387</font>   table.render();                                                                                        </pre>
<pre>     <font color="black">407</font>   selector.resetAreaOffset();                                                                                  <font color="black">388</font>   selector.resetAreaOffset();                                                                            </pre>
<pre>     <font color="black">408</font>   verticalScrollbarSet.call(this);                                                                             <font color="black">389</font>   verticalScrollbarSet.call(this);                                                                       </pre>
<pre>     <font color="black">409</font>   editorSetOffset.call(this);                                                                                  <font color="black">390</font>   editorSetOffset.call(this);                                                                            </pre>
<pre>     <font color="black">410</font> }                                                                                                              <font color="black">391</font> }                                                                                                        </pre>
<pre>     <font color="black">411</font>                                                                                                                <font color="black">392</font>                                                                                                          </pre>
<pre>     <font color="black">412</font> function colResizerFinished(cRect, distance) {                                                                 <font color="black">393</font> function colResizerFinished(cRect, distance) {                                                           </pre>
<pre>     <font color="black">413</font>   const { ci } = cRect;                                                                                        <font color="black">394</font>   const { ci } = cRect;                                                                                  </pre>
<pre>     <font color="black">414</font>   const { table, selector, data } = this;                                                                      <font color="black">395</font>   const { table, selector, data } = this;                                                                </pre>
<pre>     <font color="black">415</font>   data.cols.setWidth(ci, distance);                                                                            <font color="black">396</font>   data.cols.setWidth(ci, distance);                                                                      </pre>
<pre>     <font color="black">416</font> <font color="red">  data.setColWidth(ci, distance); //GUSA</font>                                                                                                                                                                                    </pre>
<pre>     <font color="black">417</font>   // console.log('data:', data);                                                                               <font color="black">397</font>   // console.log('data:', data);                                                                         </pre>
<pre>     <font color="black">418</font>   table.render();                                                                                              <font color="black">398</font>   table.render();                                                                                        </pre>
<pre>     <font color="black">419</font>   selector.resetAreaOffset();                                                                                  <font color="black">399</font>   selector.resetAreaOffset();                                                                            </pre>
<pre>     <font color="black">420</font>   horizontalScrollbarSet.call(this);                                                                           <font color="black">400</font>   horizontalScrollbarSet.call(this);                                                                     </pre>
<pre>     <font color="black">421</font>   editorSetOffset.call(this);                                                                                  <font color="black">401</font>   editorSetOffset.call(this);                                                                            </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">442</font>     data.deleteCell();                                                                                         <font color="black">422</font>     data.deleteCell();                                                                                   </pre>
<pre>     <font color="black">443</font>   } else if (type === 'delete-cell-format') {                                                                  <font color="black">423</font>   } else if (type === 'delete-cell-format') {                                                            </pre>
<pre>     <font color="black">444</font>     data.deleteCell('format');                                                                                 <font color="black">424</font>     data.deleteCell('format');                                                                           </pre>
<pre>     <font color="black">445</font>   } else if (type === 'delete-cell-text') {                                                                    <font color="black">425</font>   } else if (type === 'delete-cell-text') {                                                              </pre>
<pre>     <font color="black">446</font>     data.deleteCell('text');                                                                                   <font color="black">426</font>     data.deleteCell('text');                                                                             </pre>
<pre>                                                                                                                        <font color="black">427</font> <font color="green">  } else if (type === 'cell-printable') {</font>                                                                </pre>
<pre>                                                                                                                        <font color="black">428</font> <font color="green">    data.setSelectedCellAttr('printable', true);</font>                                                         </pre>
<pre>                                                                                                                        <font color="black">429</font> <font color="green">  } else if (type === 'cell-non-printable') {</font>                                                            </pre>
<pre>                                                                                                                        <font color="black">430</font> <font color="green">    data.setSelectedCellAttr('printable', false);</font>                                                        </pre>
<pre>                                                                                                                        <font color="black">431</font> <font color="green">  } else if (type === 'cell-editable') {</font>                                                                 </pre>
<pre>                                                                                                                        <font color="black">432</font> <font color="green">    data.setSelectedCellAttr('editable', true);</font>                                                          </pre>
<pre>                                                                                                                        <font color="black">433</font> <font color="green">  } else if (type === 'cell-non-editable') {</font>                                                             </pre>
<pre>                                                                                                                        <font color="black">434</font> <font color="green">    data.setSelectedCellAttr('editable', false);</font>                                                         </pre>
<pre>     <font color="black">447</font>   }                                                                                                            <font color="black">435</font>   }                                                                                                      </pre>
<pre>     <font color="black">448</font>   clearClipboard.call(this);                                                                                   <font color="black">436</font>   clearClipboard.call(this);                                                                             </pre>
<pre>     <font color="black">449</font>   sheetReset.call(this);                                                                                       <font color="black">437</font>   sheetReset.call(this);                                                                                 </pre>
<pre>     <font color="black">450</font> }                                                                                                              <font color="black">438</font> }                                                                                                        </pre>
<pre>     <font color="black">451</font>                                                                                                                <font color="black">439</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">454</font>   if (type === 'undo') {                                                                                       <font color="black">442</font>   if (type === 'undo') {                                                                                 </pre>
<pre>     <font color="black">455</font>     this.undo();                                                                                               <font color="black">443</font>     this.undo();                                                                                         </pre>
<pre>     <font color="black">456</font>   } else if (type === 'redo') {                                                                                <font color="black">444</font>   } else if (type === 'redo') {                                                                          </pre>
<pre>     <font color="black">457</font>     this.redo();                                                                                               <font color="black">445</font>     this.redo();                                                                                         </pre>
<pre>     <font color="black">458</font>   } else if (type === 'print') {                                                                               <font color="black">446</font>   } else if (type === 'print') {                                                                         </pre>
<pre>     <font color="black">459</font> <font color="red">    // print</font>                                                                                                   <font color="black">447</font> <font color="green">    this.print.preview();</font>                                                                                </pre>
<pre>     <font color="black">460</font>   } else if (type === 'paintformat') {                                                                         <font color="black">448</font>   } else if (type === 'paintformat') {                                                                   </pre>
<pre>     <font color="black">461</font>     if (value === true) copy.call(this);                                                                       <font color="black">449</font>     if (value === true) copy.call(this);                                                                 </pre>
<pre>     <font color="black">462</font>     else clearClipboard.call(this);                                                                            <font color="black">450</font>     else clearClipboard.call(this);                                                                      </pre>
<pre>     <font color="black">463</font>   } else if (type === 'clearformat') {                                                                         <font color="black">451</font>   } else if (type === 'clearformat') {                                                                   </pre>
<pre>     <font color="black">464</font>     insertDeleteRowColumn.call(this, 'delete-cell-format');                                                    <font color="black">452</font>     insertDeleteRowColumn.call(this, 'delete-cell-format');                                              </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">474</font>       const { ri, ci } = data.selector;                                                                        <font color="black">462</font>       const { ri, ci } = data.selector;                                                                  </pre>
<pre>     <font color="black">475</font>       this.freeze(ri, ci);                                                                                     <font color="black">463</font>       this.freeze(ri, ci);                                                                               </pre>
<pre>     <font color="black">476</font>     } else {                                                                                                   <font color="black">464</font>     } else {                                                                                             </pre>
<pre>     <font color="black">477</font>       this.freeze(0, 0);                                                                                       <font color="black">465</font>       this.freeze(0, 0);                                                                                 </pre>
<pre>     <font color="black">478</font>     }                                                                                                          <font color="black">466</font>     }                                                                                                    </pre>
<pre>     <font color="black">479</font> <font color="red">  } else if (type === 'overlayer') {</font>                                                                                                                                                                                        </pre>
<pre>     <font color="black">480</font> <font color="red">     this.enableOverlayer(value);</font>                                                                                                                                                                                           </pre>
<pre>     <font color="black">481</font>   } else {                                                                                                     <font color="black">467</font>   } else {                                                                                               </pre>
<pre>     <font color="black">482</font>     data.setSelectedCellAttr(type, value);                                                                     <font color="black">468</font>     data.setSelectedCellAttr(type, value);                                                               </pre>
<pre>     <font color="black">483</font> <font color="red">    if (type === 'formula') {</font>                                                                                  <font color="black">469</font> <font color="green">    if (type === 'formula' && !data.selector.multiple()) {</font>                                               </pre>
<pre>     <font color="black">484</font>       editorSet.call(this);                                                                                    <font color="black">470</font>       editorSet.call(this);                                                                              </pre>
<pre>     <font color="black">485</font>     }                                                                                                          <font color="black">471</font>     }                                                                                                    </pre>
<pre>     <font color="black">486</font>     sheetReset.call(this);                                                                                     <font color="black">472</font>     sheetReset.call(this);                                                                               </pre>
<pre>     <font color="black">487</font>   }                                                                                                            <font color="black">473</font>   }                                                                                                      </pre>
<pre>     <font color="black">488</font> }                                                                                                              <font color="black">474</font> }                                                                                                        </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">493</font>   sheetReset.call(this);                                                                                       <font color="black">479</font>   sheetReset.call(this);                                                                                 </pre>
<pre>     <font color="black">494</font> }                                                                                                              <font color="black">480</font> }                                                                                                        </pre>
<pre>     <font color="black">495</font>                                                                                                                <font color="black">481</font>                                                                                                          </pre>
<pre>     <font color="black">496</font> function sheetInitEvents() {                                                                                   <font color="black">482</font> function sheetInitEvents() {                                                                             </pre>
<pre>     <font color="black">497</font>   const {                                                                                                      <font color="black">483</font>   const {                                                                                                </pre>
<pre>                                                                                                                        <font color="black">484</font> <font color="green">    selector,</font>                                                                                            </pre>
<pre>     <font color="black">498</font>     overlayerEl,                                                                                               <font color="black">485</font>     overlayerEl,                                                                                         </pre>
<pre>     <font color="black">499</font>     rowResizer,                                                                                                <font color="black">486</font>     rowResizer,                                                                                          </pre>
<pre>     <font color="black">500</font>     colResizer,                                                                                                <font color="black">487</font>     colResizer,                                                                                          </pre>
<pre>     <font color="black">501</font>     verticalScrollbar,                                                                                         <font color="black">488</font>     verticalScrollbar,                                                                                   </pre>
<pre>     <font color="black">502</font>     horizontalScrollbar,                                                                                       <font color="black">489</font>     horizontalScrollbar,                                                                                 </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">526</font>         editorSet.call(this);                                                                                  <font color="black">513</font>         editorSet.call(this);                                                                            </pre>
<pre>     <font color="black">527</font>       } else {                                                                                                 <font color="black">514</font>       } else {                                                                                           </pre>
<pre>     <font color="black">528</font>         editor.clear();                                                                                        <font color="black">515</font>         editor.clear();                                                                                  </pre>
<pre>     <font color="black">529</font>         overlayerMousedown.call(this, evt);                                                                    <font color="black">516</font>         overlayerMousedown.call(this, evt);                                                              </pre>
<pre>     <font color="black">530</font>       }                                                                                                        <font color="black">517</font>       }                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">518</font> <font color="green">    })</font>                                                                                                   </pre>
<pre>     <font color="black">531</font>     <font color="red">})</font>.on('mousewheel.stop', (evt) => {                                                                        <font color="black">519</font>     .on('mousewheel.stop', (evt) => {                                                                    </pre>
<pre>     <font color="black">532</font>       overlayerMousescroll.call(this, evt);                                                                    <font color="black">520</font>       overlayerMousescroll.call(this, evt);                                                              </pre>
<pre>                                                                                                                        <font color="black">521</font> <font color="green">    })</font>                                                                                                   </pre>
<pre>                                                                                                                        <font color="black">522</font> <font color="green">    .on('mouseout', (evt) => {</font>                                                                           </pre>
<pre>                                                                                                                        <font color="black">523</font> <font color="green">      const { offsetX, offsetY } = evt;</font>                                                                  </pre>
<pre>                                                                                                                        <font color="black">524</font> <font color="green">      if (offsetY <= 0) colResizer.hide();</font>                                                               </pre>
<pre>                                                                                                                        <font color="black">525</font> <font color="green">      if (offsetX <= 0) rowResizer.hide();</font>                                                               </pre>
<pre>     <font color="black">533</font>     });                                                                                                        <font color="black">526</font>     });                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">527</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">528</font> <font color="green">  selector.inputChange = (v) => {</font>                                                                        </pre>
<pre>                                                                                                                        <font color="black">529</font> <font color="green">    dataSetCellText.call(this, v, 'input');</font>                                                              </pre>
<pre>                                                                                                                        <font color="black">530</font> <font color="green">    editorSet.call(this);</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">531</font> <font color="green">  };</font>                                                                                                     </pre>
<pre>     <font color="black">534</font>                                                                                                                <font color="black">532</font>                                                                                                          </pre>
<pre>     <font color="black">535</font>   // slide on mobile                                                                                           <font color="black">533</font>   // slide on mobile                                                                                     </pre>
<pre>     <font color="black">536</font>   bindTouch(overlayerEl.el, {                                                                                  <font color="black">534</font>   bindTouch(overlayerEl.el, {                                                                            </pre>
<pre>     <font color="black">537</font>     move: (direction, d) => {                                                                                  <font color="black">535</font>     move: (direction, d) => {                                                                            </pre>
<pre>     <font color="black">538</font>       overlayerTouch.call(this, direction, d);                                                                 <font color="black">536</font>       overlayerTouch.call(this, direction, d);                                                           </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">597</font>                                                                                                                <font color="black">595</font>                                                                                                          </pre>
<pre>     <font color="black">598</font>   bind(window, 'click', (evt) => {                                                                             <font color="black">596</font>   bind(window, 'click', (evt) => {                                                                       </pre>
<pre>     <font color="black">599</font>     this.focusing = overlayerEl.contains(evt.target);                                                          <font color="black">597</font>     this.focusing = overlayerEl.contains(evt.target);                                                    </pre>
<pre>     <font color="black">600</font>   });                                                                                                          <font color="black">598</font>   });                                                                                                    </pre>
<pre>     <font color="black">601</font>                                                                                                                <font color="black">599</font>                                                                                                          </pre>
<pre>                                                                                                                        <font color="black">600</font> <font color="green">  bind(window, 'paste', (evt) => {</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">601</font> <font color="green">    const cdata = evt.clipboardData.getData('text/plain');</font>                                               </pre>
<pre>                                                                                                                        <font color="black">602</font> <font color="green">    this.data.pasteFromText(cdata);</font>                                                                      </pre>
<pre>                                                                                                                        <font color="black">603</font> <font color="green">    sheetReset.call(this);</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">604</font> <font color="green">  });</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">605</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">602</font>   // for selector                                                                                              <font color="black">606</font>   // for selector                                                                                        </pre>
<pre>     <font color="black">603</font>   bind(window, 'keydown', (evt) => {                                                                           <font color="black">607</font>   bind(window, 'keydown', (evt) => {                                                                     </pre>
<pre>     <font color="black">604</font>     if (!this.focusing) return;                                                                                <font color="black">608</font>     if (!this.focusing) return;                                                                          </pre>
<pre>     <font color="black">605</font>     const keyCode = evt.keyCode || evt.which;                                                                  <font color="black">609</font>     const keyCode = evt.keyCode || evt.which;                                                            </pre>
<pre>     <font color="black">606</font>     const {                                                                                                    <font color="black">610</font>     const {                                                                                              </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">639</font>           evt.preventDefault();                                                                                <font color="black">643</font>           evt.preventDefault();                                                                          </pre>
<pre>     <font color="black">640</font>           break;                                                                                               <font color="black">644</font>           break;                                                                                         </pre>
<pre>     <font color="black">641</font>         case 86:                                                                                               <font color="black">645</font>         case 86:                                                                                         </pre>
<pre>     <font color="black">642</font>           // ctrl + v                                                                                          <font color="black">646</font>           // ctrl + v                                                                                    </pre>
<pre>     <font color="black">643</font>           paste.call(this, what);                                                                              <font color="black">647</font>           paste.call(this, what);                                                                        </pre>
<pre>     <font color="black">644</font>           evt.preventDefault();                                                                                <font color="black">648</font>          <font color="green"> //</font> evt.preventDefault();                                                                       </pre>
<pre>     <font color="black">645</font>           break;                                                                                               <font color="black">649</font>           break;                                                                                         </pre>
<pre>     <font color="black">646</font>         case 37:                                                                                               <font color="black">650</font>         case 37:                                                                                         </pre>
<pre>     <font color="black">647</font>           // ctrl + left                                                                                       <font color="black">651</font>           // ctrl + left                                                                                 </pre>
<pre>     <font color="black">648</font>           selectorMove.call(this, shiftKey, 'row-first');                                                      <font color="black">652</font>           selectorMove.call(this, shiftKey, 'row-first');                                                </pre>
<pre>     <font color="black">649</font>           evt.preventDefault();                                                                                <font color="black">653</font>           evt.preventDefault();                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">668</font>           selectorSet.call(this, false, -1, data.selector.ci, false);                                          <font color="black">672</font>           selectorSet.call(this, false, -1, data.selector.ci, false);                                    </pre>
<pre>     <font color="black">669</font>           evt.preventDefault();                                                                                <font color="black">673</font>           evt.preventDefault();                                                                          </pre>
<pre>     <font color="black">670</font>           break;                                                                                               <font color="black">674</font>           break;                                                                                         </pre>
<pre>     <font color="black">671</font>         case 66:                                                                                               <font color="black">675</font>         case 66:                                                                                         </pre>
<pre>     <font color="black">672</font>           // ctrl + B                                                                                          <font color="black">676</font>           // ctrl + B                                                                                    </pre>
<pre>     <font color="black">673</font>           toolbar.trigger('<font color="red">font-</font>bold');                                                                        <font color="black">677</font>           toolbar.trigger('bold');                                                                       </pre>
<pre>     <font color="black">674</font>           break;                                                                                               <font color="black">678</font>           break;                                                                                         </pre>
<pre>     <font color="black">675</font>         case 73:                                                                                               <font color="black">679</font>         case 73:                                                                                         </pre>
<pre>     <font color="black">676</font>           // ctrl + I                                                                                          <font color="black">680</font>           // ctrl + I                                                                                    </pre>
<pre>     <font color="black">677</font>           toolbar.trigger('<font color="red">font-</font>italic');                                                                      <font color="black">681</font>           toolbar.trigger('italic');                                                                     </pre>
<pre>     <font color="black">678</font>           break;                                                                                               <font color="black">682</font>           break;                                                                                         </pre>
<pre>     <font color="black">679</font>         default:                                                                                               <font color="black">683</font>         default:                                                                                         </pre>
<pre>     <font color="black">680</font>           break;                                                                                               <font color="black">684</font>           break;                                                                                         </pre>
<pre>     <font color="black">681</font>       }                                                                                                        <font color="black">685</font>       }                                                                                                  </pre>
<pre>     <font color="black">682</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre>
<pre>     <font color="black">683</font> <font color="red">    } else if (altKey) {</font>                                                                                                                                                                                                    </pre>
<pre>     <font color="black">684</font> <font color="red">      switch (keyCode) {</font>                                                                                                                                                                                                    </pre>
<pre>     <font color="black">685</font> <font color="red">        case 13:</font>                                                                                                                                                                                                            </pre>
<pre>     <font color="black">686</font> <font color="red">        dataSetCellText.call(this, evt.key, 'input');</font>                                                                                                                                                                       </pre>
<pre>     <font color="black">687</font> <font color="red">        editorSet.call(this);</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">688</font> <font color="red">            break;</font>                                                                                                                                                                                                          </pre>
<pre>     <font color="black">689</font> <font color="red">      }</font>                                                                                                                                                                                                                     </pre>
<pre>     <font color="black">690</font> <font color="red">*/</font>                                                                                                                                                                                                                          </pre>
<pre>     <font color="black">691</font>     } else {                                                                                                   <font color="black">686</font>     } else {                                                                                             </pre>
<pre>     <font color="black">692</font>       // console.log('evt.keyCode:', evt.keyCode);                                                             <font color="black">687</font>       // console.log('evt.keyCode:', evt.keyCode);                                                       </pre>
<pre>     <font color="black">693</font>       switch (keyCode) {                                                                                       <font color="black">688</font>       switch (keyCode) {                                                                                 </pre>
<pre>     <font color="black">694</font>         case 32:                                                                                               <font color="black">689</font>         case 32:                                                                                         </pre>
<pre>     <font color="black">695</font>           if (shiftKey) {                                                                                      <font color="black">690</font>           if (shiftKey) {                                                                                </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">721</font>           editor.clear();                                                                                      <font color="black">716</font>           editor.clear();                                                                                </pre>
<pre>     <font color="black">722</font>           // shift + tab => move left                                                                          <font color="black">717</font>           // shift + tab => move left                                                                    </pre>
<pre>     <font color="black">723</font>           // tab => move right                                                                                 <font color="black">718</font>           // tab => move right                                                                           </pre>
<pre>     <font color="black">724</font>           selectorMove.call(this, false, shiftKey ? 'left' : 'right');                                         <font color="black">719</font>           selectorMove.call(this, false, shiftKey ? 'left' : 'right');                                   </pre>
<pre>     <font color="black">725</font>           evt.preventDefault();                                                                                <font color="black">720</font>           evt.preventDefault();                                                                          </pre>
<pre>     <font color="black">726</font>         break;                                                                                                 <font color="black">721</font> <font color="green">  </font>        break;                                                                                         </pre>
<pre>     <font color="black">727</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">728</font>         case 13: // enter                                                                                      <font color="black">722</font>         case 13: // enter                                                                                </pre>
<pre>     <font color="black">729</font>           if (<font color="red">!</font>altKey) {                                                                                       <font color="black">723</font>           if (altKey) {                                                                                  </pre>
<pre>                                                                                                                        <font color="black">724</font> <font color="green">            const c = data.getSelectedCell();</font>                                                            </pre>
<pre>                                                                                                                        <font color="black">725</font> <font color="green">            const ntxt = c.text || '';</font>                                                                   </pre>
<pre>                                                                                                                        <font color="black">726</font> <font color="green">            dataSetCellText.call(this, `${ntxt}\n`, 'input');</font>                                            </pre>
<pre>                                                                                                                        <font color="black">727</font> <font color="green">            editorSet.call(this);</font>                                                                        </pre>
<pre>                                                                                                                        <font color="black">728</font> <font color="green">            break;</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">729</font> <font color="green">          }</font>                                                                                              </pre>
<pre>     <font color="black">730</font>           editor.clear();                                                                                      <font color="black">730</font>           editor.clear();                                                                                </pre>
<pre>     <font color="black">731</font>           // shift + enter => move up                                                                          <font color="black">731</font>           // shift + enter => move up                                                                    </pre>
<pre>     <font color="black">732</font>           // enter => move down                                                                                <font color="black">732</font>           // enter => move down                                                                          </pre>
<pre>     <font color="black">733</font>           selectorMove.call(this, false, shiftKey ? 'up' : 'down');                                            <font color="black">733</font>           selectorMove.call(this, false, shiftKey ? 'up' : 'down');                                      </pre>
<pre>     <font color="black">734</font>           evt.preventDefault();                                                                                <font color="black">734</font>           evt.preventDefault();                                                                          </pre>
<pre>     <font color="black">735</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">736</font>           break;                                                                                               <font color="black">735</font>           break;                                                                                         </pre>
<pre>     <font color="black">737</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">738</font>         case 8: // backspace                                                                                   <font color="black">736</font>         case 8: // backspace                                                                             </pre>
<pre>     <font color="black">739</font>           insertDeleteRowColumn.call(this, 'delete-cell-text');                                                <font color="black">737</font>           insertDeleteRowColumn.call(this, 'delete-cell-text');                                          </pre>
<pre>     <font color="black">740</font>           evt.preventDefault();                                                                                <font color="black">738</font>           evt.preventDefault();                                                                          </pre>
<pre>     <font color="black">741</font>           break;                                                                                               <font color="black">739</font>           break;                                                                                         </pre>
<pre>     <font color="black">742</font>         default:                                                                                               <font color="black">740</font>         default:                                                                                         </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">764</font> export default class Sheet {                                                                                   <font color="black">762</font> export default class Sheet {                                                                             </pre>
<pre>     <font color="black">765</font>   constructor(targetEl, data) {                                                                                <font color="black">763</font>   constructor(targetEl, data) {                                                                          </pre>
<pre>     <font color="black">766</font>     const { view, showToolbar, showContextmenu } = data.settings;                                              <font color="black">764</font>     const { view, showToolbar, showContextmenu } = data.settings;                                        </pre>
<pre>     <font color="black">767</font>     this.el = h('div', `${cssPrefix}-sheet`);                                                                  <font color="black">765</font>     this.el = h('div', `${cssPrefix}-sheet`);                                                            </pre>
<pre>     <font color="black">768</font>     this.toolbar = new Toolbar(data, view.width, !showToolbar);                                                <font color="black">766</font>     this.toolbar = new Toolbar(data, view.width, !showToolbar);                                          </pre>
<pre>                                                                                                                        <font color="black">767</font> <font color="green">    this.print = new Print(data);</font>                                                                        </pre>
<pre>     <font color="black">769</font>     targetEl.children(this.toolbar.el, this.el);                                                               <font color="black">768</font>     targetEl.children(this.toolbar.el, this.el<font color="green">, this.print.el</font>);                                          </pre>
<pre>     <font color="black">770</font>     this.data = data;                                                                                          <font color="black">769</font>     this.data = data;                                                                                    </pre>
<pre>     <font color="black">771</font>     // table                                                                                                   <font color="black">770</font>     // table                                                                                             </pre>
<pre>     <font color="black">772</font>     <font color="red">//</font>this.tableEl = h('canvas', `${cssPrefix}-table`);                                                        <font color="black">771</font>     this.tableEl = h('canvas', `${cssPrefix}-table`);                                                    </pre>
<pre>     <font color="black">773</font> <font color="red">    this.tableEl = h('div', `${cssPrefix}-table`);</font>                                                                                                                                                                          </pre>
<pre>     <font color="black">774</font>     // resizer                                                                                                 <font color="black">772</font>     // resizer                                                                                           </pre>
<pre>     <font color="black">775</font>     this.rowResizer = new Resizer(false, data.rows.height);                                                    <font color="black">773</font>     this.rowResizer = new Resizer(false, data.rows.height);                                              </pre>
<pre>     <font color="black">776</font>     this.colResizer = new Resizer(true, data.cols.minWidth);                                                   <font color="black">774</font>     this.colResizer = new Resizer(true, data.cols.minWidth);                                             </pre>
<pre>     <font color="black">777</font>     // scrollbar                                                                                               <font color="black">775</font>     // scrollbar                                                                                         </pre>
<pre>     <font color="black">778</font>     this.verticalScrollbar = new Scrollbar(true);                                                              <font color="black">776</font>     this.verticalScrollbar = new Scrollbar(true);                                                        </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">787</font>     this.modalValidation = new ModalValidation();                                                              <font color="black">785</font>     this.modalValidation = new ModalValidation();                                                        </pre>
<pre>     <font color="black">788</font>     // contextMenu                                                                                             <font color="black">786</font>     // contextMenu                                                                                       </pre>
<pre>     <font color="black">789</font>     this.contextMenu = new ContextMenu(() => this.getTableOffset(), !showContextmenu);                         <font color="black">787</font>     this.contextMenu = new ContextMenu(() => this.getTableOffset(), !showContextmenu);                   </pre>
<pre>     <font color="black">790</font>     // selector                                                                                                <font color="black">788</font>     // selector                                                                                          </pre>
<pre>     <font color="black">791</font>     this.selector = new Selector(data);                                                                        <font color="black">789</font>     this.selector = new Selector(data);                                                                  </pre>
<pre>     <font color="black">792</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre>
<pre>     <font color="black">793</font>     this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)                                             <font color="black">790</font>     this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)                                       </pre>
<pre>     <font color="black">794</font>       .children(                                                                                               <font color="black">791</font>       .children(                                                                                         </pre>
<pre>     <font color="black">795</font>         this.editor.el,                                                                                        <font color="black">792</font>         this.editor.el,                                                                                  </pre>
<pre>     <font color="black">796</font>         this.selector.el,                                                                                      <font color="black">793</font>         this.selector.el,                                                                                </pre>
<pre>     <font color="black">797</font>       );                                                                                                       <font color="black">794</font>       );                                                                                                 </pre>
<pre>     <font color="black">798</font>     this.overlayerEl = h('div', `${cssPrefix}-overlayer`)                                                      <font color="black">795</font>     this.overlayerEl = h('div', `${cssPrefix}-overlayer`)                                                </pre>
<pre>     <font color="black">799</font>       .child(this.overlayerCEl);                                                                               <font color="black">796</font>       .child(this.overlayerCEl);                                                                         </pre>
<pre>     <font color="black">800</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre>
<pre>     <font color="black">801</font>     // sortFilter                                                                                              <font color="black">797</font>     // sortFilter                                                                                        </pre>
<pre>     <font color="black">802</font>     this.sortFilter = new SortFilter();                                                                        <font color="black">798</font>     this.sortFilter = new SortFilter();                                                                  </pre>
<pre>     <font color="black">803</font>     // root element                                                                                            <font color="black">799</font>     // root element                                                                                      </pre>
<pre>     <font color="black">804</font>     this.el.children(                                                                                          <font color="black">800</font>     this.el.children(                                                                                    </pre>
<pre>     <font color="black">805</font>       this.tableEl,                                                                                            <font color="black">801</font>       this.tableEl,                                                                                      </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">813</font>       this.sortFilter.el,                                                                                      <font color="black">809</font>       this.sortFilter.el,                                                                                </pre>
<pre>     <font color="black">814</font>     );                                                                                                         <font color="black">810</font>     );                                                                                                   </pre>
<pre>     <font color="black">815</font>     // table                                                                                                   <font color="black">811</font>     // table                                                                                             </pre>
<pre>     <font color="black">816</font>     this.table = new Table(this.tableEl.el, data);                                                             <font color="black">812</font>     this.table = new Table(this.tableEl.el, data);                                                       </pre>
<pre>     <font color="black">817</font>     sheetInitEvents.call(this);                                                                                <font color="black">813</font>     sheetInitEvents.call(this);                                                                          </pre>
<pre>     <font color="black">818</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">819</font> <font color="red">    //this.overlayerEl.hide();//GUSA </font>                                                                                                                                                                                       </pre>
<pre>     <font color="black">820</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">821</font>     sheetReset.call(this);                                                                                     <font color="black">814</font>     sheetReset.call(this);                                                                               </pre>
<pre>     <font color="black">822</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">823</font> <font color="red">    //this.table.layerRender(); //GUSA TEST</font>                                                                                                                                                                                 </pre>
<pre>     <font color="black">824</font> <font color="red">    //</font>                                                                                                                                                                                                                      </pre>
<pre>     <font color="black">825</font>     // init selector [0, 0]                                                                                    <font color="black">815</font>     // init selector [0, 0]                                                                              </pre>
<pre>     <font color="black">826</font>     selectorSet.call(this, false, 0, 0);                                                                       <font color="black">816</font>     selectorSet.call(this, false, 0, 0);                                                                 </pre>
<pre>     <font color="black">827</font> <font color="red">    //this.sync_sheets = new Array(); //GUSA</font>                                                                                                                                                                                </pre>
<pre>     <font color="black">828</font> <font color="red">    this.sync_sheets = []; //GUSA</font>                                                                                                                                                                                           </pre>
<pre>     <font color="black">829</font>   }                                                                                                            <font color="black">817</font>   }                                                                                                      </pre>
<pre>     <font color="black">830</font>                                                                                                                <font color="black">818</font>                                                                                                          </pre>
<pre>     <font color="black">831</font> <font color="red">  exportData() {</font>                                                                                               <font color="black">819</font> <font color="green">  resetData(data) {</font>                                                                                      </pre>
<pre>     <font color="black">832</font> <font color="red">    return this.data.getData();</font>                                                                                <font color="black">820</font> <font color="green">    this.data = data;</font>                                                                                    </pre>
<pre>     <font color="black">833</font> <font color="red"> </font>                                                                                                              <font color="black">821</font> <font color="green">    this.toolbar.resetData(data);</font>                                                                        </pre>
<pre>     <font color="black">834</font> <font color="red">  }</font>                                                                                                            <font color="black">822</font> <font color="green">    this.print.resetData(data);</font>                                                                          </pre>
<pre>     <font color="black">835</font> <font color="red"> </font>                                                                                                              <font color="black">823</font> <font color="green">    this.selector.resetData(data);</font>                                                                       </pre>
<pre>     <font color="black">836</font> <font color="red">  setLayer() {</font>                                                                                                 <font color="black">824</font> <font color="green">    this.table.resetData(data);</font>                                                                          </pre>
<pre>     <font color="black">837</font> <font color="red">    this.table.setlayer(); //GUSA TEST</font>                                                                                                                                                                                      </pre>
<pre>     <font color="black">838</font>   }                                                                                                            <font color="black">825</font>   }                                                                                                      </pre>
<pre>     <font color="black">839</font>                                                                                                                <font color="black">826</font>                                                                                                          </pre>
<pre>     <font color="black">840</font>   loadData(data) {                                                                                             <font color="black">827</font>   loadData(data) {                                                                                       </pre>
<pre>     <font color="black">841</font>     this.data.setData(data);                                                                                   <font color="black">828</font>     this.data.setData(data);                                                                             </pre>
<pre>     <font color="black">842</font> <font color="red">    this.setLayer();</font>                                                                                                                                                                                                        </pre>
<pre>     <font color="black">843</font>     sheetReset.call(this);                                                                                     <font color="black">829</font>     sheetReset.call(this);                                                                               </pre>
<pre>     <font color="black">844</font> <font color="red">    console.log("loadData end");</font>                                                                                                                                                                                            </pre>
<pre>     <font color="black">845</font>     return this;                                                                                               <font color="black">830</font>     return this;                                                                                         </pre>
<pre>     <font color="black">846</font>   }                                                                                                            <font color="black">831</font>   }                                                                                                      </pre>
<pre>     <font color="black">847</font>                                                                                                                <font color="black">832</font>                                                                                                          </pre>
<pre>     <font color="black">848</font> <font color="red">  /*</font>                                                                                                                                                                                                                        </pre>
<pre>     <font color="black">849</font> <font color="red">  addSyncSheet(sheet) {  //GUSA</font>                                                                                                                                                                                             </pre>
<pre>     <font color="black">850</font> <font color="red">    //this.sync_sheet.push(sheet);</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">851</font> <font color="red">    this.sync_sheets[0]= sheet;</font>                                                                                                                                                                                             </pre>
<pre>     <font color="black">852</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">853</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>     <font color="black">854</font> <font color="red">  */</font>                                                                                                                                                                                                                        </pre>
<pre>     <font color="black">855</font>   // freeze rows or cols                                                                                       <font color="black">833</font>   // freeze rows or cols                                                                                 </pre>
<pre>     <font color="black">856</font>   freeze(ri, ci) {                                                                                             <font color="black">834</font>   freeze(ri, ci) {                                                                                       </pre>
<pre>     <font color="black">857</font>     const { data } = this;                                                                                     <font color="black">835</font>     const { data } = this;                                                                               </pre>
<pre>     <font color="black">858</font>     data.setFreeze(ri, ci);                                                                                    <font color="black">836</font>     data.setFreeze(ri, ci);                                                                              </pre>
<pre>     <font color="black">859</font>     sheetReset.call(this);                                                                                     <font color="black">837</font>     sheetReset.call(this);                                                                               </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">873</font>   reload() {                                                                                                   <font color="black">851</font>   reload() {                                                                                             </pre>
<pre>     <font color="black">874</font>     sheetReset.call(this);                                                                                     <font color="black">852</font>     sheetReset.call(this);                                                                               </pre>
<pre>     <font color="black">875</font>     return this;                                                                                               <font color="black">853</font>     return this;                                                                                         </pre>
<pre>     <font color="black">876</font>   }                                                                                                            <font color="black">854</font>   }                                                                                                      </pre>
<pre>     <font color="black">877</font>                                                                                                                <font color="black">855</font>                                                                                                          </pre>
<pre>     <font color="black">878</font> <font color="red">  sync() {  //GUSA</font>                                                                                                                                                                                                          </pre>
<pre>     <font color="black">879</font> <font color="red">    dataSync.call(this);</font>                                                                                                                                                                                                    </pre>
<pre>     <font color="black">880</font> <font color="red">    //sheetReset.call(this);</font>                                                                                                                                                                                                </pre>
<pre>     <font color="black">881</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">882</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>     <font color="black">883</font> <font color="red">  sync_movex(x) {</font>                                                                                                                                                                                                           </pre>
<pre>     <font color="black">884</font> <font color="red">    sync_horizontalScrollbarMove.call(this,x);</font>                                                                                                                                                                              </pre>
<pre>     <font color="black">885</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>     <font color="black">886</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">887</font> <font color="red">  sync_movey(y) {</font>                                                                                                                                                                                                           </pre>
<pre>     <font color="black">888</font> <font color="red">    sync_verticalScrollbarMove.call(this,y);</font>                                                                                                                                                                                </pre>
<pre>     <font color="black">889</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>     <font color="black">890</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre>
<pre>     <font color="black">891</font> <font color="red">  sync_shape_layer() {</font>                                                                                                                                                                                                      </pre>
<pre>     <font color="black">892</font> <font color="red">    sync_shape_layer_move(this);</font>                                                                                                                                                                                            </pre>
<pre>     <font color="black">893</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>     <font color="black">894</font> <font color="red">  */</font>                                                                                                                                                                                                                        </pre>
<pre>     <font color="black">895</font>   getRect() {                                                                                                  <font color="black">856</font>   getRect() {                                                                                            </pre>
<pre>     <font color="black">896</font>     const { data } = this;                                                                                     <font color="black">857</font>     const { data } = this;                                                                               </pre>
<pre>     <font color="black">897</font>     return { width: data.viewWidth(), height: data.viewHeight() };                                             <font color="black">858</font>     return { width: data.viewWidth(), height: data.viewHeight() };                                       </pre>
<pre>     <font color="black">898</font>   }                                                                                                            <font color="black">859</font>   }                                                                                                      </pre>
<pre>     <font color="black">899</font>                                                                                                                <font color="black">860</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">905</font>       height: height - rows.height,                                                                            <font color="black">866</font>       height: height - rows.height,                                                                      </pre>
<pre>     <font color="black">906</font>       left: cols.indexWidth,                                                                                   <font color="black">867</font>       left: cols.indexWidth,                                                                             </pre>
<pre>     <font color="black">907</font>       top: rows.height,                                                                                        <font color="black">868</font>       top: rows.height,                                                                                  </pre>
<pre>     <font color="black">908</font>     };                                                                                                         <font color="black">869</font>     };                                                                                                   </pre>
<pre>     <font color="black">909</font>   }                                                                                                            <font color="black">870</font>   }                                                                                                      </pre>
<pre>     <font color="black">910</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">911</font> <font color="red">  enableOverlayer(flag) {  //GUSA</font>                                                                                                                                                                                           </pre>
<pre>     <font color="black">912</font> <font color="red">    if (flag) {</font>                                                                                                                                                                                                             </pre>
<pre>     <font color="black">913</font> <font color="red">      this.overlayerEl.show();//GUSA </font>                                                                                                                                                                                       </pre>
<pre>     <font color="black">914</font> <font color="red">    } else {</font>                                                                                                                                                                                                                </pre>
<pre>     <font color="black">915</font> <font color="red">      this.overlayerEl.hide();//GUSA </font>                                                                                                                                                                                       </pre>
<pre>     <font color="black">916</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre>
<pre>     <font color="black">917</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>     <font color="black">918</font> }                                                                                                              <font color="black">871</font> }                                                                                                        </pre>
<pre><font color="blue">../src/component/contextmenu.js</font>                                                                                    <font color="blue">../../x-spreadsheet/src/component/contextmenu.js</font>                                                                  </pre>
<pre>      <font color="black">16</font>   { key: 'delete-row', title: tf('contextmenu.deleteRow') },                                                    <font color="black">16</font>   { key: 'delete-row', title: tf('contextmenu.deleteRow') },                                             </pre>
<pre>      <font color="black">17</font>   { key: 'delete-column', title: tf('contextmenu.deleteColumn') },                                              <font color="black">17</font>   { key: 'delete-column', title: tf('contextmenu.deleteColumn') },                                       </pre>
<pre>      <font color="black">18</font>   { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },                                         <font color="black">18</font>   { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },                                  </pre>
<pre>      <font color="black">19</font>   { key: 'divider' },                                                                                           <font color="black">19</font>   { key: 'divider' },                                                                                    </pre>
<pre>      <font color="black">20</font>   { key: 'validation', title: tf('contextmenu.validation') },                                                   <font color="black">20</font>   { key: 'validation', title: tf('contextmenu.validation') },                                            </pre>
<pre>                                                                                                                         <font color="black">21</font> <font color="green">  { key: 'divider' },</font>                                                                                    </pre>
<pre>                                                                                                                         <font color="black">22</font> <font color="green">  { key: 'cell-printable', title: tf('contextmenu.cellprintable') },</font>                                     </pre>
<pre>                                                                                                                         <font color="black">23</font> <font color="green">  { key: 'cell-non-printable', title: tf('contextmenu.cellnonprintable') },</font>                              </pre>
<pre>                                                                                                                         <font color="black">24</font> <font color="green">  { key: 'divider' },</font>                                                                                    </pre>
<pre>                                                                                                                         <font color="black">25</font> <font color="green">  { key: 'cell-editable', title: tf('contextmenu.celleditable') },</font>                                       </pre>
<pre>                                                                                                                         <font color="black">26</font> <font color="green">  { key: 'cell-non-editable', title: tf('contextmenu.cellnoneditable') },</font>                                </pre>
<pre>      <font color="black">21</font> ];                                                                                                              <font color="black">27</font> ];                                                                                                       </pre>
<pre>      <font color="black">22</font>                                                                                                                 <font color="black">28</font>                                                                                                          </pre>
<pre>      <font color="black">23</font> function buildMenuItem(item) {                                                                                  <font color="black">29</font> function buildMenuItem(item) {                                                                           </pre>
<pre>      <font color="black">24</font>   if (item.key === 'divider') {                                                                                 <font color="black">30</font>   if (item.key === 'divider') {                                                                          </pre>
<pre>      <font color="black">25</font>     return h('div', `${cssPrefix}-item divider`);                                                               <font color="black">31</font>     return h('div', `${cssPrefix}-item divider`);                                                        </pre>
<pre><font color="blue">../src/index.less</font>                                                                                                  <font color="blue">../../x-spreadsheet/src/index.less</font>                                                                                </pre>
<pre>     <font color="black">115</font>     margin: 0;                                                                                                 <font color="black">115</font>     margin: 0;                                                                                           </pre>
<pre>     <font color="black">116</font>     padding: 0;                                                                                                <font color="black">116</font>     padding: 0;                                                                                          </pre>
<pre>     <font color="black">117</font>     border-collapse: separate;                                                                                 <font color="black">117</font>     border-collapse: separate;                                                                           </pre>
<pre>     <font color="black">118</font>     border-spacing: 2;                                                                                         <font color="black">118</font>     border-spacing: 2;                                                                                   </pre>
<pre>     <font color="black">119</font>     background: #fff;                                                                                          <font color="black">119</font>     background: #fff;                                                                                    </pre>
<pre>     <font color="black">120</font> <font color="red">    </font>                                                                                                           <font color="black">120</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">121</font>     td {                                                                                                       <font color="black">121</font>     td {                                                                                                 </pre>
<pre>     <font color="black">122</font>       margin: 0;                                                                                               <font color="black">122</font>       margin: 0;                                                                                         </pre>
<pre>     <font color="black">123</font>       cursor: pointer;                                                                                         <font color="black">123</font>       cursor: pointer;                                                                                   </pre>
<pre>     <font color="black">124</font>       border: 1px solid transparent;                                                                           <font color="black">124</font>       border: 1px solid transparent;                                                                     </pre>
<pre>     <font color="black">125</font>                                                                                                                <font color="black">125</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">211</font>       top: calc(~'100% + 5px');                                                                                <font color="black">211</font>       top: calc(~'100% + 5px');                                                                          </pre>
<pre>     <font color="black">212</font>       right: 0;                                                                                                <font color="black">212</font>       right: 0;                                                                                          </pre>
<pre>     <font color="black">213</font>     }                                                                                                          <font color="black">213</font>     }                                                                                                    </pre>
<pre>     <font color="black">214</font>   }                                                                                                            <font color="black">214</font>   }                                                                                                      </pre>
<pre>     <font color="black">215</font>                                                                                                                <font color="black">215</font>                                                                                                          </pre>
<pre>                                                                                                                        <font color="black">216</font> <font color="green">  &.top-left {</font>                                                                                           </pre>
<pre>                                                                                                                        <font color="black">217</font> <font color="green">    .@{css-prefix}-dropdown-content {</font>                                                                    </pre>
<pre>                                                                                                                        <font color="black">218</font> <font color="green">      bottom: calc(~'100% + 5px');</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">219</font> <font color="green">      left: 0;</font>                                                                                           </pre>
<pre>                                                                                                                        <font color="black">220</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">221</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">222</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">223</font> <font color="green">  &.top-right {</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">224</font> <font color="green">    .@{css-prefix}-dropdown-content {</font>                                                                    </pre>
<pre>                                                                                                                        <font color="black">225</font> <font color="green">      bottom: calc(~'100% + 5px');</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">226</font> <font color="green">      right: 0;</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">227</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">228</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">229</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">230</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">216</font>   .@{css-prefix}-dropdown-title {                                                                              <font color="black">231</font>   .@{css-prefix}-dropdown-title {                                                                        </pre>
<pre>     <font color="black">217</font>     padding: 0 5px;                                                                                            <font color="black">232</font>     padding: 0 5px;                                                                                      </pre>
<pre>     <font color="black">218</font>     display: inline-block;                                                                                     <font color="black">233</font>     display: inline-block;                                                                               </pre>
<pre>     <font color="black">219</font>   }                                                                                                            <font color="black">234</font>   }                                                                                                      </pre>
<pre>     <font color="black">220</font>                                                                                                                <font color="black">235</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">264</font> .@{css-prefix}-scrollbar {                                                                                     <font color="black">279</font> .@{css-prefix}-scrollbar {                                                                               </pre>
<pre>     <font color="black">265</font>   position: absolute;                                                                                          <font color="black">280</font>   position: absolute;                                                                                    </pre>
<pre>     <font color="black">266</font>   bottom: 0;                                                                                                   <font color="black">281</font>   bottom: 0;                                                                                             </pre>
<pre>     <font color="black">267</font>   right: 0;                                                                                                    <font color="black">282</font>   right: 0;                                                                                              </pre>
<pre>     <font color="black">268</font>   background-color: #f4f5f8;                                                                                   <font color="black">283</font>   background-color: #f4f5f8;                                                                             </pre>
<pre>     <font color="black">269</font>   opacity: 0;                                                                                                  <font color="black">284</font>   opacity: 0<font color="green">.9</font>;                                                                                          </pre>
<pre>     <font color="black">270</font>   z-index: 12;                                                                                                 <font color="black">285</font>   z-index: 12;                                                                                           </pre>
<pre>     <font color="black">271</font>   &.horizontal {                                                                                               <font color="black">286</font>   &.horizontal {                                                                                         </pre>
<pre>     <font color="black">272</font>    <font color="red"> //</font> right: 15px;                                                                                            <font color="black">287</font>     right: 15px;                                                                                         </pre>
<pre>     <font color="black">273</font>     overflow-x: scroll;                                                                                        <font color="black">288</font>     overflow-x: scroll;                                                                                  </pre>
<pre>     <font color="black">274</font>     overflow-y: hidden;                                                                                        <font color="black">289</font>     overflow-y: hidden;                                                                                  </pre>
<pre>                                                                                                                        <font color="black">290</font> <font color="green">    > div {</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">291</font> <font color="green">      height: 1px;</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">292</font> <font color="green">      background: #ddd;</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">293</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>     <font color="black">275</font>   }                                                                                                            <font color="black">294</font>   }                                                                                                      </pre>
<pre>     <font color="black">276</font>   &.vertical {                                                                                                 <font color="black">295</font>   &.vertical {                                                                                           </pre>
<pre>     <font color="black">277</font>    <font color="red"> //</font> bottom: 15px;                                                                                           <font color="black">296</font>     bottom: 15px;                                                                                        </pre>
<pre>     <font color="black">278</font>     overflow-x: hidden;                                                                                        <font color="black">297</font>     overflow-x: hidden;                                                                                  </pre>
<pre>     <font color="black">279</font>     overflow-y: scroll;                                                                                        <font color="black">298</font>     overflow-y: scroll;                                                                                  </pre>
<pre>                                                                                                                        <font color="black">299</font> <font color="green">    > div {</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">300</font> <font color="green">      width: 1px;</font>                                                                                        </pre>
<pre>                                                                                                                        <font color="black">301</font> <font color="green">      background: #ddd;</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">302</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>     <font color="black">280</font>   }                                                                                                            <font color="black">303</font>   }                                                                                                      </pre>
<pre>     <font color="black">281</font>   &:hover {                                                                                                    <font color="black">304</font>   &:hover {                                                                                              </pre>
<pre>     <font color="black">282</font>     opacity: .85;                                                                                              <font color="black">305</font>    <font color="green"> //</font> opacity: .85;                                                                                     </pre>
<pre>     <font color="black">283</font>   }                                                                                                            <font color="black">306</font>   }                                                                                                      </pre>
<pre>     <font color="black">284</font> }                                                                                                              <font color="black">307</font> }                                                                                                        </pre>
<pre>     <font color="black">285</font>                                                                                                                <font color="black">308</font>                                                                                                          </pre>
<pre>     <font color="black">286</font> /* @{css-prefix}-overlayer */                                                                                  <font color="black">309</font> /* @{css-prefix}-overlayer */                                                                            </pre>
<pre>     <font color="black">287</font> .@{css-prefix}-overlayer {                                                                                     <font color="black">310</font> .@{css-prefix}-overlayer {                                                                               </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">297</font>     height: 100%;                                                                                              <font color="black">320</font>     height: 100%;                                                                                        </pre>
<pre>     <font color="black">298</font>   }                                                                                                            <font color="black">321</font>   }                                                                                                      </pre>
<pre>     <font color="black">299</font> }                                                                                                              <font color="black">322</font> }                                                                                                        </pre>
<pre>     <font color="black">300</font>                                                                                                                <font color="black">323</font>                                                                                                          </pre>
<pre>     <font color="black">301</font> .@{css-prefix}-editor, .@{css-prefix}-selector {                                                               <font color="black">324</font> .@{css-prefix}-editor, .@{css-prefix}-selector {                                                         </pre>
<pre>                                                                                                                        <font color="black">325</font> <font color="green">  box-sizing: content-box;</font>                                                                               </pre>
<pre>     <font color="black">302</font>   position: absolute;                                                                                          <font color="black">326</font>   position: absolute;                                                                                    </pre>
<pre>     <font color="black">303</font>   overflow: hidden;                                                                                            <font color="black">327</font>   overflow: hidden;                                                                                      </pre>
<pre>     <font color="black">304</font>   pointer-events: none;                                                                                        <font color="black">328</font>   pointer-events: none;                                                                                  </pre>
<pre>     <font color="black">305</font>   top: 0;                                                                                                      <font color="black">329</font>   top: 0;                                                                                                </pre>
<pre>     <font color="black">306</font>   left: 0;                                                                                                     <font color="black">330</font>   left: 0;                                                                                               </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">308</font>   height: 100%;                                                                                                <font color="black">332</font>   height: 100%;                                                                                          </pre>
<pre>     <font color="black">309</font> }                                                                                                              <font color="black">333</font> }                                                                                                        </pre>
<pre>     <font color="black">310</font>                                                                                                                <font color="black">334</font>                                                                                                          </pre>
<pre>     <font color="black">311</font> /* @{css-prefix}-selector */                                                                                   <font color="black">335</font> /* @{css-prefix}-selector */                                                                             </pre>
<pre>     <font color="black">312</font> .@{css-prefix}-selector {                                                                                      <font color="black">336</font> .@{css-prefix}-selector {                                                                                </pre>
<pre>                                                                                                                        <font color="black">337</font> <font color="green">  .hide-input {</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">338</font> <font color="green">    position: absolute;</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">339</font> <font color="green">    z-index: 0;</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">340</font> <font color="green">    input {</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">341</font> <font color="green">      width: 0;</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">342</font> <font color="green">      border: none;</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">343</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">344</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>     <font color="black">313</font>   .@{css-prefix}-selector-area {                                                                               <font color="black">345</font>   .@{css-prefix}-selector-area {                                                                         </pre>
<pre>     <font color="black">314</font>     position: absolute;                                                                                        <font color="black">346</font>     position: absolute;                                                                                  </pre>
<pre>     <font color="black">315</font>     border: 2px solid rgb(75, 137, 255);                                                                       <font color="black">347</font>     border: 2px solid rgb(75, 137, 255);                                                                 </pre>
<pre>     <font color="black">316</font>     background: rgba(75, 137, 255, .1);                                                                        <font color="black">348</font>     background: rgba(75, 137, 255, .1);                                                                  </pre>
<pre>                                                                                                                        <font color="black">349</font> <font color="green">    z-index: 5;</font>                                                                                          </pre>
<pre>     <font color="black">317</font>   }                                                                                                            <font color="black">350</font>   }                                                                                                      </pre>
<pre>     <font color="black">318</font>   .@{css-prefix}-selector-clipboard, .@{css-prefix}-selector-autofill {                                        <font color="black">351</font>   .@{css-prefix}-selector-clipboard, .@{css-prefix}-selector-autofill {                                  </pre>
<pre>     <font color="black">319</font>     position: absolute;                                                                                        <font color="black">352</font>     position: absolute;                                                                                  </pre>
<pre>     <font color="black">320</font>     background: transparent;                                                                                   <font color="black">353</font>     background: transparent;                                                                             </pre>
<pre>     <font color="black">321</font>     z-index: 100;                                                                                              <font color="black">354</font>     z-index: 100;                                                                                        </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">346</font>     text-align: left;                                                                                          <font color="black">379</font>     text-align: left;                                                                                    </pre>
<pre>     <font color="black">347</font>     border: 2px solid rgb(75, 137, 255);                                                                       <font color="black">380</font>     border: 2px solid rgb(75, 137, 255);                                                                 </pre>
<pre>     <font color="black">348</font>     line-height: 0;                                                                                            <font color="black">381</font>     line-height: 0;                                                                                      </pre>
<pre>     <font color="black">349</font>     z-index: 100;                                                                                              <font color="black">382</font>     z-index: 100;                                                                                        </pre>
<pre>     <font color="black">350</font>     pointer-events: auto;                                                                                      <font color="black">383</font>     pointer-events: auto;                                                                                </pre>
<pre>     <font color="black">351</font> <font color="red">  </font>                                                                                                             <font color="black">384</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">352</font>     textarea {                                                                                                 <font color="black">385</font>     textarea {                                                                                           </pre>
<pre>     <font color="black">353</font>       box-sizing: content-box;                                                                                 <font color="black">386</font>       box-sizing: content-box;                                                                           </pre>
<pre>     <font color="black">354</font>       border: none;                                                                                            <font color="black">387</font>       border: none;                                                                                      </pre>
<pre>     <font color="black">355</font>       padding: 0 3px;                                                                                          <font color="black">388</font>       padding: 0 3px;                                                                                    </pre>
<pre>     <font color="black">356</font> <font color="red">      outline-width: 0;</font>                                                                                        <font color="black">389</font> <font color="green">      outline: none;</font>                                                                                     </pre>
<pre>     <font color="black">357</font> <font color="red">//      height:auto;</font>                                                                                                                                                                                                        </pre>
<pre>     <font color="black">358</font> <font color="red">//</font>      resize: none;                                                                                          <font color="black">390</font>       resize: none;                                                                                      </pre>
<pre>     <font color="black">359</font>       text-align: start;                                                                                       <font color="black">391</font>       text-align: start;                                                                                 </pre>
<pre>     <font color="black">360</font>       overflow-y: hidden;                                                                                      <font color="black">392</font>       overflow-y: hidden;                                                                                </pre>
<pre>     <font color="black">361</font>       font: 400 13px Arial, 'Lato', 'Source Sans Pro', Roboto, Helvetica, sans-serif;                          <font color="black">393</font>       font: 400 13px Arial, 'Lato', 'Source Sans Pro', Roboto, Helvetica, sans-serif;                    </pre>
<pre>     <font color="black">362</font> <font color="red">//</font>      color: inherit;                                                                                        <font color="black">394</font>       color: inherit;                                                                                    </pre>
<pre>     <font color="black">363</font> <font color="red">      color: red;</font>                                                                                                                                                                                                           </pre>
<pre>     <font color="black">364</font> <font color="red">//</font>      white-space: normal;                                                                                   <font color="black">395</font>       white-space: normal;                                                                               </pre>
<pre>     <font color="black">365</font> <font color="red">      white-space: pre;</font>                                                                                                                                                                                                     </pre>
<pre>     <font color="black">366</font>  <font color="red">//</font>     word-wrap: break-word;                                                                                 <font color="black">396</font>       word-wrap: break-word;                                                                             </pre>
<pre>     <font color="black">367</font>       line-height: 22px;                                                                                       <font color="black">397</font>       line-height: 22px;                                                                                 </pre>
<pre>     <font color="black">368</font>       margin: 0;                                                                                               <font color="black">398</font>       margin: 0;                                                                                         </pre>
<pre>     <font color="black">369</font>     }                                                                                                          <font color="black">399</font>     }                                                                                                    </pre>
<pre>     <font color="black">370</font> <font color="red">  </font>                                                                                                             <font color="black">400</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">371</font>     .textline {                                                                                                <font color="black">401</font>     .textline {                                                                                          </pre>
<pre>     <font color="black">372</font>       overflow: hidden;                                                                                        <font color="black">402</font>       overflow: hidden;                                                                                  </pre>
<pre>     <font color="black">373</font>       visibility: hidden;                                                                                      <font color="black">403</font>       visibility: hidden;                                                                                </pre>
<pre>     <font color="black">374</font>       position: fixed;                                                                                         <font color="black">404</font>       position: fixed;                                                                                   </pre>
<pre>     <font color="black">375</font>       top:<font color="orange">1</font>0;                                                                                                  <font color="black">405</font>       top:<font color="orange"> </font>0;                                                                                            </pre>
<pre>     <font color="black">376</font>       left: 0;                                                                                                 <font color="black">406</font>       left: 0;                                                                                           </pre>
<pre>     <font color="black">377</font>     }                                                                                                          <font color="black">407</font>     }                                                                                                    </pre>
<pre>     <font color="black">378</font>   }                                                                                                            <font color="black">408</font>   }                                                                                                      </pre>
<pre>     <font color="black">379</font> }                                                                                                              <font color="black">409</font> }                                                                                                        </pre>
<pre>     <font color="black">380</font>                                                                                                                <font color="black">410</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">388</font>   line-height: 26px;                                                                                           <font color="black">418</font>   line-height: 26px;                                                                                     </pre>
<pre>     <font color="black">389</font>   list-style: none;                                                                                            <font color="black">419</font>   list-style: none;                                                                                      </pre>
<pre>     <font color="black">390</font>   padding: 2px 10px;                                                                                           <font color="black">420</font>   padding: 2px 10px;                                                                                     </pre>
<pre>     <font color="black">391</font>   cursor: default;                                                                                             <font color="black">421</font>   cursor: default;                                                                                       </pre>
<pre>     <font color="black">392</font>   text-align: left;                                                                                            <font color="black">422</font>   text-align: left;                                                                                      </pre>
<pre>                                                                                                                        <font color="black">423</font> <font color="green">  overflow: hidden;</font>                                                                                      </pre>
<pre>     <font color="black">393</font>                                                                                                                <font color="black">424</font>                                                                                                          </pre>
<pre>     <font color="black">394</font>   &.disabled {                                                                                                 <font color="black">425</font>   &.disabled {                                                                                           </pre>
<pre>     <font color="black">395</font>     pointer-events: none;                                                                                      <font color="black">426</font>     pointer-events: none;                                                                                </pre>
<pre>     <font color="black">396</font>     opacity: 0.5;                                                                                              <font color="black">427</font>     opacity: 0.5;                                                                                        </pre>
<pre>     <font color="black">397</font>   }                                                                                                            <font color="black">428</font>   }                                                                                                      </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">399</font>   &:hover, &.active {                                                                                          <font color="black">430</font>   &:hover, &.active {                                                                                    </pre>
<pre>     <font color="black">400</font>     background: rgba(0, 0, 0, .05);                                                                            <font color="black">431</font>     background: rgba(0, 0, 0, .05);                                                                      </pre>
<pre>     <font color="black">401</font>   }                                                                                                            <font color="black">432</font>   }                                                                                                      </pre>
<pre>     <font color="black">402</font>                                                                                                                <font color="black">433</font>                                                                                                          </pre>
<pre>     <font color="black">403</font>   // &.active {                                                                                                <font color="black">434</font>   // &.active {                                                                                          </pre>
<pre>     <font color="black">404</font>   ////   background: #89aef53d;                                                                                <font color="black">435</font> <font color="green">  </font>  ////   background: #89aef53d;                                                                        </pre>
<pre>     <font color="black">405</font>   // }                                                                                                         <font color="black">436</font>   // }                                                                                                   </pre>
<pre>     <font color="black">406</font>                                                                                                                <font color="black">437</font>                                                                                                          </pre>
<pre>     <font color="black">407</font>   &.divider {                                                                                                  <font color="black">438</font>   &.divider {                                                                                            </pre>
<pre>     <font color="black">408</font>     height: 0;                                                                                                 <font color="black">439</font>     height: 0;                                                                                           </pre>
<pre>     <font color="black">409</font>     padding: 0;                                                                                                <font color="black">440</font>     padding: 0;                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">460</font>   }                                                                                                            <font color="black">491</font>   }                                                                                                      </pre>
<pre>     <font color="black">461</font>                                                                                                                <font color="black">492</font>                                                                                                          </pre>
<pre>     <font color="black">462</font> }                                                                                                              <font color="black">493</font> }                                                                                                        </pre>
<pre>     <font color="black">463</font>                                                                                                                <font color="black">494</font>                                                                                                          </pre>
<pre>     <font color="black">464</font> .@{css-prefix}-checkbox {                                                                                      <font color="black">495</font> .@{css-prefix}-checkbox {                                                                                </pre>
<pre>     <font color="black">465</font> <font color="red">  </font>  position: relative;                                                                                        <font color="black">496</font>   position: relative;                                                                                    </pre>
<pre>     <font color="black">466</font> <font color="red">  </font>  display: inline-block;                                                                                     <font color="black">497</font>   display: inline-block;                                                                                 </pre>
<pre>     <font color="black">467</font> <font color="red">  </font>  backface-visibility: hidden;                                                                               <font color="black">498</font>   backface-visibility: hidden;                                                                           </pre>
<pre>                                                                                                                        <font color="black">499</font> <font color="green">  outline: 0;</font>                                                                                            </pre>
<pre>                                                                                                                        <font color="black">500</font> <font color="green">  vertical-align: baseline;</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">501</font> <font color="green">  font-style: normal;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">502</font> <font color="green">  font-size: 1rem;</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">503</font> <font color="green">  line-height: 1em;</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">504</font> <font color="green">  > input {</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">505</font> <font color="green">    position: absolute;</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">506</font> <font color="green">    top: 0;</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">507</font> <font color="green">    left: 0;</font>                                                                                             </pre>
<pre>                                                                                                                        <font color="black">508</font> <font color="green">    opacity: 0!important;</font>                                                                                </pre>
<pre>     <font color="black">468</font>     outline: 0;                                                                                                <font color="black">509</font>     outline: 0;                                                                                          </pre>
<pre>     <font color="black">469</font> <font color="red">    vertical-align: baseline;</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">470</font> <font color="red">    font-style: normal;</font>                                                                                                                                                                                                     </pre>
<pre>     <font color="black">471</font> <font color="red">    font-size: 1rem;</font>                                                                                                                                                                                                        </pre>
<pre>     <font color="black">472</font> <font color="red">    line-height: 1em;</font>                                                                                                                                                                                                       </pre>
<pre>     <font color="black">473</font> <font color="red">    > input {</font>                                                                                                                                                                                                               </pre>
<pre>     <font color="black">474</font> <font color="red">      position: absolute;</font>                                                                                                                                                                                                   </pre>
<pre>     <font color="black">475</font> <font color="red">      top: 0;</font>                                                                                                                                                                                                               </pre>
<pre>     <font color="black">476</font> <font color="red">      left: 0;</font>                                                                                                                                                                                                              </pre>
<pre>     <font color="black">477</font> <font color="red">      opacity: 0!important;</font>                                                                                                                                                                                                 </pre>
<pre>     <font color="black">478</font> <font color="red">      outline: 0;</font>                                                                                                                                                                                                           </pre>
<pre>     <font color="black">479</font> <font color="red">  </font>    z-index: -1;                                                                                             <font color="black">510</font>     z-index: -1;                                                                                         </pre>
<pre>     <font color="black">480</font> <font color="red">  </font>  }                                                                                                          <font color="black">511</font>   }                                                                                                      </pre>
<pre>     <font color="black">481</font> }                                                                                                              <font color="black">512</font> }                                                                                                        </pre>
<pre>     <font color="black">482</font>                                                                                                                <font color="black">513</font>                                                                                                          </pre>
<pre>     <font color="black">483</font> .@{css-prefix}-suggest,                                                                                        <font color="black">514</font> .@{css-prefix}-suggest,                                                                                  </pre>
<pre>     <font color="black">484</font> .@{css-prefix}-contextmenu,                                                                                    <font color="black">515</font> .@{css-prefix}-contextmenu,                                                                              </pre>
<pre>     <font color="black">485</font> .@{css-prefix}-sort-filter {                                                                                   <font color="black">516</font> .@{css-prefix}-sort-filter {                                                                             </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">531</font>   background: #f5f6f7;                                                                                         <font color="black">562</font>   background: #f5f6f7;                                                                                   </pre>
<pre>     <font color="black">532</font>   display: flex;                                                                                               <font color="black">563</font>   display: flex;                                                                                         </pre>
<pre>     <font color="black">533</font> }                                                                                                              <font color="black">564</font> }                                                                                                        </pre>
<pre>     <font color="black">534</font>                                                                                                                <font color="black">565</font>                                                                                                          </pre>
<pre>     <font color="black">535</font> .@{css-prefix}-bottombar {                                                                                     <font color="black">566</font> .@{css-prefix}-bottombar {                                                                               </pre>
<pre>                                                                                                                        <font color="black">567</font> <font color="green">  position: relative;</font>                                                                                    </pre>
<pre>     <font color="black">536</font>   border-top: 1px solid #e0e2e4;                                                                               <font color="black">568</font>   border-top: 1px solid #e0e2e4;                                                                         </pre>
<pre>                                                                                                                        <font color="black">569</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">570</font> <font color="green">  .@{css-prefix}-menu > li {</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">571</font> <font color="green">    line-height: 40px;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">572</font> <font color="green">    height: 40px;</font>                                                                                        </pre>
<pre>                                                                                                                        <font color="black">573</font> <font color="green">    padding-top: 0;</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">574</font> <font color="green">    padding-bottom: 0;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">575</font> <font color="green">    vertical-align: middle;</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">576</font> <font color="green">    border-right: 1px solid #e8eaed;</font>                                                                     </pre>
<pre>                                                                                                                        <font color="black">577</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">578</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">579</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">580</font> <font color="green">.@{css-prefix}-menu {</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">581</font> <font color="green">  list-style: none;</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">582</font> <font color="green">  margin: 0;</font>                                                                                             </pre>
<pre>                                                                                                                        <font color="black">583</font> <font color="green">  padding: 0;</font>                                                                                            </pre>
<pre>                                                                                                                        <font color="black">584</font> <font color="green">  user-select: none;</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">585</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">586</font> <font color="green">.@{css-prefix}-menu > li {</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">587</font> <font color="green">  float: left;</font>                                                                                           </pre>
<pre>                                                                                                                        <font color="black">588</font> <font color="green">  line-height: 1.25em;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">589</font> <font color="green">  padding: .785em 1em;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">590</font> <font color="green">  margin: 0;</font>                                                                                             </pre>
<pre>                                                                                                                        <font color="black">591</font> <font color="green">  vertical-align: middle;</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">592</font> <font color="green">  text-align: left;</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">593</font> <font color="green">  font-weight: 400;</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">594</font> <font color="green">  color: #80868b;</font>                                                                                        </pre>
<pre>                                                                                                                        <font color="black">595</font> <font color="green">  white-space: nowrap;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">596</font> <font color="green">  cursor: pointer;</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">597</font> <font color="green">  transition: all .3s;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">598</font> <font color="green">  font-weight: bold;</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">599</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">600</font> <font color="green">  &.active {</font>                                                                                             </pre>
<pre>                                                                                                                        <font color="black">601</font> <font color="green">    background-color: #fff;</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">602</font> <font color="green">    color: rgba(0, 0, 0, .65);</font>                                                                           </pre>
<pre>                                                                                                                        <font color="black">603</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">604</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">605</font> <font color="green">  .@{css-prefix}-icon {</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">606</font> <font color="green">    margin: 0 6px;</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">607</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">608</font> <font color="green">    .@{css-prefix}-icon-img {</font>                                                                            </pre>
<pre>                                                                                                                        <font color="black">609</font> <font color="green">      &:hover {</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">610</font> <font color="green">        opacity: .85;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">611</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">612</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">613</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">614</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">615</font> <font color="green">  .@{css-prefix}-dropdown {</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">616</font> <font color="green">    display: inline-block;</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">617</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>     <font color="black">537</font> }                                                                                                              <font color="black">618</font> }                                                                                                        </pre>
<pre>     <font color="black">538</font>                                                                                                                <font color="black">619</font>                                                                                                          </pre>
<pre>     <font color="black">539</font> .@{css-prefix}-toolbar {                                                                                       <font color="black">620</font> .@{css-prefix}-toolbar {                                                                                 </pre>
<pre>     <font color="black">540</font>   border-bottom: 1px solid #e0e2e4;                                                                            <font color="black">621</font>   border-bottom: 1px solid #e0e2e4;                                                                      </pre>
<pre>     <font color="black">541</font>                                                                                                                <font color="black">622</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">581</font>   vertical-align: middle;                                                                                      <font color="black">662</font>   vertical-align: middle;                                                                                </pre>
<pre>     <font color="black">582</font>   height: 18px;                                                                                                <font color="black">663</font>   height: 18px;                                                                                          </pre>
<pre>     <font color="black">583</font>   margin: 12px 3px 0;                                                                                          <font color="black">664</font>   margin: 12px 3px 0;                                                                                    </pre>
<pre>     <font color="black">584</font> }                                                                                                              <font color="black">665</font> }                                                                                                        </pre>
<pre>     <font color="black">585</font>                                                                                                                <font color="black">666</font>                                                                                                          </pre>
<pre>                                                                                                                        <font color="black">667</font> <font color="green">.@{css-prefix}-print {</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">668</font> <font color="green">  position: absolute;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">669</font> <font color="green">  left: 0;</font>                                                                                               </pre>
<pre>                                                                                                                        <font color="black">670</font> <font color="green">  top: 0;</font>                                                                                                </pre>
<pre>                                                                                                                        <font color="black">671</font> <font color="green">  z-index: 100;</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">672</font> <font color="green">  width: 100%;</font>                                                                                           </pre>
<pre>                                                                                                                        <font color="black">673</font> <font color="green">  height: 100%;</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">674</font> <font color="green">  display: flex;</font>                                                                                         </pre>
<pre>                                                                                                                        <font color="black">675</font> <font color="green">  flex-direction: column;</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">676</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">677</font> <font color="green">.@{css-prefix}-print-bar {</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">678</font> <font color="green">  background: #424242;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">679</font> <font color="green">  height: 60px;</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">680</font> <font color="green">  line-height: 60px;</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">681</font> <font color="green">  padding: 0 30px;</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">682</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">683</font> <font color="green">  .-title {</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">684</font> <font color="green">    color: #fff;</font>                                                                                         </pre>
<pre>                                                                                                                        <font color="black">685</font> <font color="green">    font-weight: bold;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">686</font> <font color="green">    font-size: 1.2em;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">687</font> <font color="green">    float: left;</font>                                                                                         </pre>
<pre>                                                                                                                        <font color="black">688</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">689</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">690</font> <font color="green">  .-right {</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">691</font> <font color="green">    float: right;</font>                                                                                        </pre>
<pre>                                                                                                                        <font color="black">692</font> <font color="green">    margin-top: 12px;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">693</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">694</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">695</font> <font color="green">.@{css-prefix}-print-content {</font>                                                                           </pre>
<pre>                                                                                                                        <font color="black">696</font> <font color="green">  display: flex;</font>                                                                                         </pre>
<pre>                                                                                                                        <font color="black">697</font> <font color="green">  flex: auto;</font>                                                                                            </pre>
<pre>                                                                                                                        <font color="black">698</font> <font color="green">  flex-direction: row;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">699</font> <font color="green">  background: #d0d0d0;</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">700</font> <font color="green">  height: calc(100% - 60px);</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">701</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">702</font> <font color="green">  .-sider {</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">703</font> <font color="green">    flex: 0 0 300px;</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">704</font> <font color="green">    width: 300px;</font>                                                                                        </pre>
<pre>                                                                                                                        <font color="black">705</font> <font color="green">    border-left: 2px solid #ccc;</font>                                                                         </pre>
<pre>                                                                                                                        <font color="black">706</font> <font color="green">    background: #fff;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">707</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">708</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">709</font> <font color="green">  .-content {</font>                                                                                            </pre>
<pre>                                                                                                                        <font color="black">710</font> <font color="green">    flex: auto;</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">711</font> <font color="green">    overflow-x: auto;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">712</font> <font color="green">    overflow-y: scroll;</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">713</font> <font color="green">    height: 100%;</font>                                                                                        </pre>
<pre>                                                                                                                        <font color="black">714</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">715</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">716</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">717</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">718</font> <font color="green">.@{css-prefix}-canvas-card-wraper {</font>                                                                      </pre>
<pre>                                                                                                                        <font color="black">719</font> <font color="green">  margin: 40px 20px;</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">720</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">721</font> <font color="green">.@{css-prefix}-canvas-card {</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">722</font> <font color="green">  background: #fff;</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">723</font> <font color="green">  margin: auto;</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">724</font> <font color="green">  page-break-before: auto;</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">725</font> <font color="green">  page-break-after: always;</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">726</font> <font color="green">  box-shadow: 0 8px 10px 1px rgba(0,0,0,0.14), 0 3px 14px 3px rgba(0,0,0,0.12), 0 4px 5px 0 rgba(0,0,0,0.</font></pre>
<pre>                                                                                                                   <font color="green">20);</font>                                                                                                              </pre>
<pre>                                                                                                                        <font color="black">727</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">728</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">586</font> .@{css-prefix}-calendar {                                                                                      <font color="black">729</font> .@{css-prefix}-calendar {                                                                                </pre>
<pre>     <font color="black">587</font>   color: rgba(0,0,0,.65);                                                                                      <font color="black">730</font>   color: rgba(0,0,0,.65);                                                                                </pre>
<pre>     <font color="black">588</font>   background: #ffffff;                                                                                         <font color="black">731</font>   background: #ffffff;                                                                                   </pre>
<pre>     <font color="black">589</font>   user-select: none;                                                                                           <font color="black">732</font>   user-select: none;                                                                                     </pre>
<pre>     <font color="black">590</font> <font color="red">  </font>                                                                                                             <font color="black">733</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">591</font>   .calendar-header {                                                                                           <font color="black">734</font>   .calendar-header {                                                                                     </pre>
<pre>     <font color="black">592</font>     font-weight: 700;                                                                                          <font color="black">735</font>     font-weight: 700;                                                                                    </pre>
<pre>     <font color="black">593</font>     line-height: 30px;                                                                                         <font color="black">736</font>     line-height: 30px;                                                                                   </pre>
<pre>     <font color="black">594</font>     text-align: center;                                                                                        <font color="black">737</font>     text-align: center;                                                                                  </pre>
<pre>     <font color="black">595</font>     width: 100%;                                                                                               <font color="black">738</font>     width: 100%;                                                                                         </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">601</font>       float: left;                                                                                             <font color="black">744</font>       float: left;                                                                                       </pre>
<pre>     <font color="black">602</font>     }                                                                                                          <font color="black">745</font>     }                                                                                                    </pre>
<pre>     <font color="black">603</font>                                                                                                                <font color="black">746</font>                                                                                                          </pre>
<pre>     <font color="black">604</font>     .calendar-header-right {                                                                                   <font color="black">747</font>     .calendar-header-right {                                                                             </pre>
<pre>     <font color="black">605</font>       float: right;                                                                                            <font color="black">748</font>       float: right;                                                                                      </pre>
<pre>     <font color="black">606</font> <font color="red">      </font>                                                                                                         <font color="black">749</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">607</font>       a {                                                                                                      <font color="black">750</font>       a {                                                                                                </pre>
<pre>     <font color="black">608</font>         padding: 3px 0;                                                                                        <font color="black">751</font>         padding: 3px 0;                                                                                  </pre>
<pre>     <font color="black">609</font>         margin-right: 2px;                                                                                     <font color="black">752</font>         margin-right: 2px;                                                                               </pre>
<pre>     <font color="black">610</font>         border-radius: 2px;                                                                                    <font color="black">753</font>         border-radius: 2px;                                                                              </pre>
<pre>     <font color="black">611</font>       }                                                                                                        <font color="black">754</font>       }                                                                                                  </pre>
<pre>     <font color="black">612</font>       a:hover {                                                                                                <font color="black">755</font>       a:hover {                                                                                          </pre>
<pre>     <font color="black">613</font>         background: rgba(0,0,0,.08);                                                                           <font color="black">756</font>         background: rgba(0,0,0,.08);                                                                     </pre>
<pre>     <font color="black">614</font>       }                                                                                                        <font color="black">757</font>       }                                                                                                  </pre>
<pre>     <font color="black">615</font>     }                                                                                                          <font color="black">758</font>     }                                                                                                    </pre>
<pre>     <font color="black">616</font>   }                                                                                                            <font color="black">759</font>   }                                                                                                      </pre>
<pre>     <font color="black">617</font> <font color="red">  </font>                                                                                                             <font color="black">760</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">618</font>   .calendar-body {                                                                                             <font color="black">761</font>   .calendar-body {                                                                                       </pre>
<pre>     <font color="black">619</font>     border-collapse: collapse;                                                                                 <font color="black">762</font>     border-collapse: collapse;                                                                           </pre>
<pre>     <font color="black">620</font>     border-spacing: 0;                                                                                         <font color="black">763</font>     border-spacing: 0;                                                                                   </pre>
<pre>     <font color="black">621</font> <font color="red">    </font>                                                                                                           <font color="black">764</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">622</font>     th, td {                                                                                                   <font color="black">765</font>     th, td {                                                                                             </pre>
<pre>     <font color="black">623</font>       width: 100%/7;                                                                                           <font color="black">766</font>       width: 100%/7;                                                                                     </pre>
<pre>     <font color="black">624</font>       min-width: 32px;                                                                                         <font color="black">767</font>       min-width: 32px;                                                                                   </pre>
<pre>     <font color="black">625</font>       text-align: center;                                                                                      <font color="black">768</font>       text-align: center;                                                                                </pre>
<pre>     <font color="black">626</font>       font-weight: 700;                                                                                        <font color="black">769</font>       font-weight: 700;                                                                                  </pre>
<pre>     <font color="black">627</font>       line-height: 30px;                                                                                       <font color="black">770</font>       line-height: 30px;                                                                                 </pre>
<pre>     <font color="black">628</font>       padding: 0;                                                                                              <font color="black">771</font>       padding: 0;                                                                                        </pre>
<pre>     <font color="black">629</font>     }                                                                                                          <font color="black">772</font>     }                                                                                                    </pre>
<pre>     <font color="black">630</font> <font color="red">    </font>                                                                                                           <font color="black">773</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">631</font>     td > .cell {                                                                                               <font color="black">774</font>     td > .cell {                                                                                         </pre>
<pre>     <font color="black">632</font>       // border: 1px solid rgba(0,0,0,.05);                                                                    <font color="black">775</font>       // border: 1px solid rgba(0,0,0,.05);                                                              </pre>
<pre>     <font color="black">633</font> <font color="red">      </font>                                                                                                         <font color="black">776</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">634</font>       &:hover {                                                                                                <font color="black">777</font>       &:hover {                                                                                          </pre>
<pre>     <font color="black">635</font>         background: #ecf6fd;                                                                                   <font color="black">778</font>         background: #ecf6fd;                                                                             </pre>
<pre>     <font color="black">636</font>       }                                                                                                        <font color="black">779</font>       }                                                                                                  </pre>
<pre>     <font color="black">637</font> <font color="red">      </font>                                                                                                         <font color="black">780</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">638</font>       &.active, &.active:hover {                                                                               <font color="black">781</font>       &.active, &.active:hover {                                                                         </pre>
<pre>     <font color="black">639</font>         background: #ecf6fd;                                                                                   <font color="black">782</font>         background: #ecf6fd;                                                                             </pre>
<pre>     <font color="black">640</font>         color: #2185D0;                                                                                        <font color="black">783</font>         color: #2185D0;                                                                                  </pre>
<pre>     <font color="black">641</font>       }                                                                                                        <font color="black">784</font>       }                                                                                                  </pre>
<pre>     <font color="black">642</font> <font color="red">      </font>                                                                                                         <font color="black">785</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">643</font>       &.disabled {                                                                                             <font color="black">786</font>       &.disabled {                                                                                       </pre>
<pre>     <font color="black">644</font>         pointer-events: none;                                                                                  <font color="black">787</font>         pointer-events: none;                                                                            </pre>
<pre>     <font color="black">645</font>         opacity: 0.5;                                                                                          <font color="black">788</font>         opacity: 0.5;                                                                                    </pre>
<pre>     <font color="black">646</font>       }                                                                                                        <font color="black">789</font>       }                                                                                                  </pre>
<pre>     <font color="black">647</font>     }                                                                                                          <font color="black">790</font>     }                                                                                                    </pre>
<pre>     <font color="black">648</font>   }                                                                                                            <font color="black">791</font>   }                                                                                                      </pre>
<pre>     <font color="black">649</font> }                                                                                                              <font color="black">792</font> }                                                                                                        </pre>
<pre>     <font color="black">650</font>                                                                                                                <font color="black">793</font>                                                                                                          </pre>
<pre>     <font color="black">651</font> .@{css-prefix}-datepicker {                                                                                    <font color="black">794</font> .@{css-prefix}-datepicker {                                                                              </pre>
<pre>     <font color="black">652</font> <font color="red">  </font>  box-shadow: 2px 2px 5px rgba(0,0,0,.2);                                                                    <font color="black">795</font>   box-shadow: 2px 2px 5px rgba(0,0,0,.2);                                                                </pre>
<pre>     <font color="black">653</font> <font color="red">  </font>  position: absolute;                                                                                        <font color="black">796</font>   position: absolute;                                                                                    </pre>
<pre>     <font color="black">654</font> <font color="red">  </font>  left: 0;                                                                                                   <font color="black">797</font>   left: 0;                                                                                               </pre>
<pre>     <font color="black">655</font> <font color="red">  </font>  top: calc(100% + 5px);                                                                                     <font color="black">798</font>   top: calc(100% + 5px);                                                                                 </pre>
<pre>     <font color="black">656</font> <font color="red">  </font>  z-index: 10;                                                                                               <font color="black">799</font>   z-index: 10;                                                                                           </pre>
<pre>     <font color="black">657</font> <font color="red">  </font>  width: auto;                                                                                               <font color="black">800</font>   width: auto;                                                                                           </pre>
<pre>     <font color="black">658</font> }                                                                                                              <font color="black">801</font> }                                                                                                        </pre>
<pre>     <font color="black">659</font>                                                                                                                <font color="black">802</font>                                                                                                          </pre>
<pre>     <font color="black">660</font> .@{css-prefix}-buttons {                                                                                       <font color="black">803</font> .@{css-prefix}-buttons {                                                                                 </pre>
<pre>     <font color="black">661</font>   display: flex;                                                                                               <font color="black">804</font>   display: flex;                                                                                         </pre>
<pre>     <font color="black">662</font>   justify-content: flex-end;                                                                                   <font color="black">805</font>   justify-content: flex-end;                                                                             </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">703</font>   font-size: 1em;                                                                                              <font color="black">846</font>   font-size: 1em;                                                                                        </pre>
<pre>     <font color="black">704</font>   position: relative;                                                                                          <font color="black">847</font>   position: relative;                                                                                    </pre>
<pre>     <font color="black">705</font>   font-weight: 400;                                                                                            <font color="black">848</font>   font-weight: 400;                                                                                      </pre>
<pre>     <font color="black">706</font>   display: inline-flex;                                                                                        <font color="black">849</font>   display: inline-flex;                                                                                  </pre>
<pre>     <font color="black">707</font>   color: rgba(0,0,0,.87);                                                                                      <font color="black">850</font>   color: rgba(0,0,0,.87);                                                                                </pre>
<pre>     <font color="black">708</font> <font color="red">  </font>                                                                                                             <font color="black">851</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">709</font>   input {                                                                                                      <font color="black">852</font>   input {                                                                                                </pre>
<pre>     <font color="black">710</font>     z-index: 1;                                                                                                <font color="black">853</font>     z-index: 1;                                                                                          </pre>
<pre>     <font color="black">711</font>     margin: 0;                                                                                                 <font color="black">854</font>     margin: 0;                                                                                           </pre>
<pre>     <font color="black">712</font>     max-width: 100%;                                                                                           <font color="black">855</font>     max-width: 100%;                                                                                     </pre>
<pre>     <font color="black">713</font>     flex: 1 0 auto;                                                                                            <font color="black">856</font>     flex: 1 0 auto;                                                                                      </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">809</font>     display: block;                                                                                            <font color="black">952</font>     display: block;                                                                                      </pre>
<pre>     <font color="black">810</font>     opacity: 1;                                                                                                <font color="black">953</font>     opacity: 1;                                                                                          </pre>
<pre>     <font color="black">811</font>   }                                                                                                            <font color="black">954</font>   }                                                                                                      </pre>
<pre>     <font color="black">812</font> }                                                                                                              <font color="black">955</font> }                                                                                                        </pre>
<pre>     <font color="black">813</font>                                                                                                                <font color="black">956</font>                                                                                                          </pre>
<pre>                                                                                                                        <font color="black">957</font> <font color="green">form fieldset {</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">958</font> <font color="green">  border: none;</font>                                                                                          </pre>
<pre>                                                                                                                        <font color="black">959</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">960</font> <font color="green">  label {</font>                                                                                                </pre>
<pre>                                                                                                                        <font color="black">961</font> <font color="green">    display: block;</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">962</font> <font color="green">    margin-bottom: .5em;</font>                                                                                 </pre>
<pre>                                                                                                                        <font color="black">963</font> <font color="green">    font-size: 1em;</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">964</font> <font color="green">    color: #666;</font>                                                                                         </pre>
<pre>                                                                                                                        <font color="black">965</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">966</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">967</font> <font color="green">  select {</font>                                                                                               </pre>
<pre>                                                                                                                        <font color="black">968</font> <font color="green">    font-size: 1.1em;</font>                                                                                    </pre>
<pre>                                                                                                                        <font color="black">969</font> <font color="green">    width: 100%;</font>                                                                                         </pre>
<pre>                                                                                                                        <font color="black">970</font> <font color="green">    background-color: #fff;</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">971</font> <font color="green">    border: none;</font>                                                                                        </pre>
<pre>                                                                                                                        <font color="black">972</font> <font color="green">    border-bottom: 2px solid #ddd;</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">973</font> <font color="green">    padding: .5em .85em;</font>                                                                                 </pre>
<pre>                                                                                                                        <font color="black">974</font> <font color="green">    border-radius: 2px;</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">975</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">976</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">977</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">814</font> .@{css-prefix}-modal, .@{css-prefix}-toast {                                                                   <font color="black">978</font> .@{css-prefix}-modal, .@{css-prefix}-toast {                                                             </pre>
<pre>     <font color="black">815</font>   font-size: 13px;                                                                                             <font color="black">979</font>   font-size: 13px;                                                                                       </pre>
<pre>     <font color="black">816</font>   position: fixed;                                                                                             <font color="black">980</font>   position: fixed;                                                                                       </pre>
<pre>     <font color="black">817</font>   z-index: 1001;                                                                                               <font color="black">981</font>   z-index: 1001;                                                                                         </pre>
<pre>     <font color="black">818</font>   text-align: left;                                                                                            <font color="black">982</font>   text-align: left;                                                                                      </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">841</font>   .@{css-prefix}-icon {                                                                                       <font color="black">1005</font>   .@{css-prefix}-icon {                                                                                  </pre>
<pre>     <font color="black">842</font>     position: absolute;                                                                                       <font color="black">1006</font>     position: absolute;                                                                                  </pre>
<pre>     <font color="black">843</font>     right: .8em;                                                                                              <font color="black">1007</font>     right: .8em;                                                                                         </pre>
<pre>     <font color="black">844</font>     top: .65em;                                                                                               <font color="black">1008</font>     top: .65em;                                                                                          </pre>
<pre>     <font color="black">845</font>     border-radius: 18px;                                                                                      <font color="black">1009</font>     border-radius: 18px;                                                                                 </pre>
<pre>     <font color="black">846</font> <font color="red">    </font>                                                                                                          <font color="black">1010</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">847</font>     &:hover {                                                                                                 <font color="black">1011</font>     &:hover {                                                                                            </pre>
<pre>     <font color="black">848</font>       opacity: 1;                                                                                             <font color="black">1012</font>       opacity: 1;                                                                                        </pre>
<pre>     <font color="black">849</font>       background: rgba(0, 0, 0, 0.08);                                                                        <font color="black">1013</font>       background: rgba(0, 0, 0, 0.08);                                                                   </pre>
<pre>     <font color="black">850</font>     }                                                                                                         <font color="black">1014</font>     }                                                                                                    </pre>
<pre>     <font color="black">851</font>   }                                                                                                           <font color="black">1015</font>   }                                                                                                      </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">884</font>   overflow: hidden;                                                                                           <font color="black">1048</font>   overflow: hidden;                                                                                      </pre>
<pre>     <font color="black">885</font>   position: relative;                                                                                         <font color="black">1049</font>   position: relative;                                                                                    </pre>
<pre>     <font color="black">886</font>   display: inline-block;                                                                                      <font color="black">1050</font>   display: inline-block;                                                                                 </pre>
<pre>     <font color="black">887</font>                                                                                                               <font color="black">1051</font>                                                                                                          </pre>
<pre>     <font color="black">888</font>   .@{css-prefix}-icon-img {                                                                                   <font color="black">1052</font>   .@{css-prefix}-icon-img {                                                                              </pre>
<pre>     <font color="black">889</font>     background-image: url('../assets/sprite<font color="red">3</font>.svg');                                                           <font color="black">1053</font>     background-image: url('../assets/sprite.svg');                                                       </pre>
<pre>     <font color="black">890</font>     position: absolute;                                                                                       <font color="black">1054</font>     position: absolute;                                                                                  </pre>
<pre>     <font color="black">891</font>     width: 262px;                                                                                             <font color="black">1055</font>     width: 262px;                                                                                        </pre>
<pre>     <font color="black">892</font>     height: 444px;                                                                                            <font color="black">1056</font>     height: 444px;                                                                                       </pre>
<pre>     <font color="black">893</font>     opacity: 0.56;                                                                                            <font color="black">1057</font>     opacity: 0.56;                                                                                       </pre>
<pre>     <font color="black">894</font>                                                                                                               <font color="black">1058</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">910</font>     }                                                                                                         <font color="black">1074</font>     }                                                                                                    </pre>
<pre>     <font color="black">911</font>     &.clearformat {                                                                                           <font color="black">1075</font>     &.clearformat {                                                                                      </pre>
<pre>     <font color="black">912</font>       left: -4 * @icon-size;                                                                                  <font color="black">1076</font>       left: -4 * @icon-size;                                                                             </pre>
<pre>     <font color="black">913</font>       top: 0;                                                                                                 <font color="black">1077</font>       top: 0;                                                                                            </pre>
<pre>     <font color="black">914</font>     }                                                                                                         <font color="black">1078</font>     }                                                                                                    </pre>
<pre>     <font color="black">915</font>     &.bold {                                                                                                  <font color="black">1079</font>     &.<font color="green">font-</font>bold {                                                                                        </pre>
<pre>     <font color="black">916</font>       left: -5 * @icon-size;                                                                                  <font color="black">1080</font>       left: -5 * @icon-size;                                                                             </pre>
<pre>     <font color="black">917</font>       top: 0;                                                                                                 <font color="black">1081</font>       top: 0;                                                                                            </pre>
<pre>     <font color="black">918</font>     }                                                                                                         <font color="black">1082</font>     }                                                                                                    </pre>
<pre>     <font color="black">919</font>     &.italic {                                                                                                <font color="black">1083</font>     &.<font color="green">font-</font>italic {                                                                                      </pre>
<pre>     <font color="black">920</font>       left: -6 * @icon-size;                                                                                  <font color="black">1084</font>       left: -6 * @icon-size;                                                                             </pre>
<pre>     <font color="black">921</font>       top: 0;                                                                                                 <font color="black">1085</font>       top: 0;                                                                                            </pre>
<pre>     <font color="black">922</font>     }                                                                                                         <font color="black">1086</font>     }                                                                                                    </pre>
<pre>     <font color="black">923</font>     &.underline {                                                                                             <font color="black">1087</font>     &.underline {                                                                                        </pre>
<pre>     <font color="black">924</font>       left: -7 * @icon-size;                                                                                  <font color="black">1088</font>       left: -7 * @icon-size;                                                                             </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">926</font>     }                                                                                                         <font color="black">1090</font>     }                                                                                                    </pre>
<pre>     <font color="black">927</font>     &.strike {                                                                                                <font color="black">1091</font>     &.strike {                                                                                           </pre>
<pre>     <font color="black">928</font>       left: -8 * @icon-size;                                                                                  <font color="black">1092</font>       left: -8 * @icon-size;                                                                             </pre>
<pre>     <font color="black">929</font>       top: 0;                                                                                                 <font color="black">1093</font>       top: 0;                                                                                            </pre>
<pre>     <font color="black">930</font>     }                                                                                                         <font color="black">1094</font>     }                                                                                                    </pre>
<pre>     <font color="black">931</font>     &.<font color="red">text-</font>color {                                                                                            <font color="black">1095</font>     &.color {                                                                                            </pre>
<pre>     <font color="black">932</font>       left: -9 * @icon-size;                                                                                  <font color="black">1096</font>       left: -9 * @icon-size;                                                                             </pre>
<pre>     <font color="black">933</font>       top: 0;                                                                                                 <font color="black">1097</font>       top: 0;                                                                                            </pre>
<pre>     <font color="black">934</font>     }                                                                                                         <font color="black">1098</font>     }                                                                                                    </pre>
<pre>     <font color="black">935</font>     &.<font color="orange">fill-</font>color {                                                                                            <font color="black">1099</font>     &.<font color="orange">bg</font>color {                                                                                          </pre>
<pre>     <font color="black">936</font>       left: -10 * @icon-size;                                                                                 <font color="black">1100</font>       left: -10 * @icon-size;                                                                            </pre>
<pre>     <font color="black">937</font>       top: 0;                                                                                                 <font color="black">1101</font>       top: 0;                                                                                            </pre>
<pre>     <font color="black">938</font>     }                                                                                                         <font color="black">1102</font>     }                                                                                                    </pre>
<pre>     <font color="black">939</font>     &.merge {                                                                                                 <font color="black">1103</font>     &.merge {                                                                                            </pre>
<pre>     <font color="black">940</font>       left: -11 * @icon-size;                                                                                 <font color="black">1104</font>       left: -11 * @icon-size;                                                                            </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>    <font color="black">1070</font>     }                                                                                                         <font color="black">1234</font>     }                                                                                                    </pre>
<pre>    <font color="black">1071</font>     &.chevron-right {                                                                                         <font color="black">1235</font>     &.chevron-right {                                                                                    </pre>
<pre>    <font color="black">1072</font>       left: -3 * @icon-size;                                                                                  <font color="black">1236</font>       left: -3 * @icon-size;                                                                             </pre>
<pre>    <font color="black">1073</font>       top: -3 * @icon-size;                                                                                   <font color="black">1237</font>       top: -3 * @icon-size;                                                                              </pre>
<pre>    <font color="black">1074</font>     }                                                                                                         <font color="black">1238</font>     }                                                                                                    </pre>
<pre>    <font color="black">1075</font> <font color="red">    &.overlayer {</font>                                                                                                                                                                                                           </pre>
<pre>    <font color="black">1076</font> <font color="red">      left: -6 * @icon-size;</font>                                                                                                                                                                                                </pre>
<pre>    <font color="black">1077</font> <font color="red">      top: -3 * @icon-size;</font>                                                                                                                                                                                                 </pre>
<pre>    <font color="black">1078</font> <font color="red">  </font>  }                                                                                                         <font color="black">1239</font>   }                                                                                                      </pre>
<pre>    <font color="black">1079</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>    <font color="black">1080</font> }                                                                                                             <font color="black">1240</font> }                                                                                                        </pre>
<pre><font color="blue">../src/index.js</font>                                                                                                    <font color="blue">../../x-spreadsheet/src/index.js</font>                                                                                  </pre>
<pre>       <font color="black">1</font> /* global window, document */                                                                                    <font color="black">1</font> /* global window, document */                                                                            </pre>
<pre>       <font color="black">2</font> import { h } from './component/element';                                                                         <font color="black">2</font> import { h } from './component/element';                                                                 </pre>
<pre>       <font color="black">3</font> import DataProxy from './core/data_proxy';                                                                       <font color="black">3</font> import DataProxy from './core/data_proxy';                                                               </pre>
<pre>       <font color="black">4</font> import Sheet from './component/sheet';                                                                           <font color="black">4</font> import Sheet from './component/sheet';                                                                   </pre>
<pre>                                                                                                                          <font color="black">5</font> <font color="green">import Bottombar from './component/bottombar';</font>                                                           </pre>
<pre>       <font color="black">5</font> import { cssPrefix } from './config';                                                                            <font color="black">6</font> import { cssPrefix } from './config';                                                                    </pre>
<pre>       <font color="black">6</font> import { locale } from './locale/locale';                                                                        <font color="black">7</font> import { locale } from './locale/locale';                                                                </pre>
<pre>       <font color="black">7</font> import './index.less';                                                                                           <font color="black">8</font> import './index.less';                                                                                   </pre>
<pre>       <font color="black">8</font> <font color="red">import Tweakpane from 'tweakpane';</font>                                                                               <font color="black">9</font> <font color="green"> </font>                                                                                                        </pre>
<pre>       <font color="black">9</font>                                                                                                                 <font color="black">10</font>                                                                                                          </pre>
<pre>      <font color="black">10</font> class Spreadsheet {                                                                                             <font color="black">11</font> class Spreadsheet {                                                                                      </pre>
<pre>      <font color="black">11</font> <font color="red">   </font>                                                                                                                                                                                                                         </pre>
<pre>      <font color="black">12</font>   constructor(selectors, options = {}) {                                                                        <font color="black">12</font>   constructor(selectors, options = {}) {                                                                 </pre>
<pre>      <font color="black">13</font>     let targetEl = selectors;                                                                                   <font color="black">13</font>     let targetEl = selectors;                                                                            </pre>
<pre>      <font color="black">14</font> <font color="red">    let targetEl2 = selectors;</font>                                                                                  <font color="black">14</font> <font color="green">    this.options = options;</font>                                                                              </pre>
<pre>                                                                                                                         <font color="black">15</font> <font color="green">    this.sheetIndex = 1;</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">16</font> <font color="green">    this.datas = [];</font>                                                                                     </pre>
<pre>      <font color="black">15</font>     if (typeof selectors === 'string') {                                                                        <font color="black">17</font>     if (typeof selectors === 'string') {                                                                 </pre>
<pre>      <font color="black">16</font>       targetEl = document.querySelector(selectors);                                                             <font color="black">18</font>       targetEl = document.querySelector(selectors);                                                      </pre>
<pre>      <font color="black">17</font> <font color="red">      targetEl2 = document.querySelector(selectors+'2');</font>                                                                                                                                                                    </pre>
<pre>      <font color="black">18</font>     }                                                                                                           <font color="black">19</font>     }                                                                                                    </pre>
<pre>      <font color="black">19</font> <font color="red">    this.data = new DataProxy('sheet1', options);</font>                                                               <font color="black">20</font> <font color="green">    this.bottombar = new Bottombar(() => {</font>                                                               </pre>
<pre>      <font color="black">20</font> <font color="red">    this.data2 = new DataProxy('sheet2', options);</font>                                                              <font color="black">21</font> <font color="green">      const d = this.addSheet();</font>                                                                         </pre>
<pre>      <font color="black">21</font> <font color="red"> </font>                                                                                                               <font color="black">22</font> <font color="green">      this.sheet.resetData(d);</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">23</font> <font color="green">    }, (index) => {</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">24</font> <font color="green">      const d = this.datas[index];</font>                                                                       </pre>
<pre>                                                                                                                         <font color="black">25</font> <font color="green">      this.sheet.resetData(d);</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">26</font> <font color="green">    }, () => {</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">27</font> <font color="green">      this.deleteSheet();</font>                                                                                </pre>
<pre>                                                                                                                         <font color="black">28</font> <font color="green">    }, (index, value) => {</font>                                                                               </pre>
<pre>                                                                                                                         <font color="black">29</font> <font color="green">      this.datas[index].name = value;</font>                                                                    </pre>
<pre>                                                                                                                         <font color="black">30</font> <font color="green">    });</font>                                                                                                  </pre>
<pre>                                                                                                                         <font color="black">31</font> <font color="green">    this.data = this.addSheet();</font>                                                                         </pre>
<pre>      <font color="black">22</font>     const rootEl = h('div', `${cssPrefix}`)                                                                     <font color="black">32</font>     const rootEl = h('div', `${cssPrefix}`)                                                              </pre>
<pre>      <font color="black">23</font> <font color="red">      .on('contextmenu', evt => evt.preventDefault());</font>                                                                                                                                                                      </pre>
<pre>      <font color="black">24</font> <font color="red">    const rootEl2 = h('div', `${cssPrefix}`)</font>                                                                                                                                                                                </pre>
<pre>      <font color="black">25</font>       .on('contextmenu', evt => evt.preventDefault());                                                          <font color="black">33</font>       .on('contextmenu', evt => evt.preventDefault());                                                   </pre>
<pre>      <font color="black">26</font>     // create canvas element                                                                                    <font color="black">34</font>     // create canvas element                                                                             </pre>
<pre>      <font color="black">27</font>     targetEl.appendChild(rootEl.el);                                                                            <font color="black">35</font>     targetEl.appendChild(rootEl.el);                                                                     </pre>
<pre>      <font color="black">28</font> <font color="red">    targetEl2.appendChild(rootEl2.el);</font>                                                                                                                                                                                      </pre>
<pre>      <font color="black">29</font>     this.sheet = new Sheet(rootEl, this.data);                                                                  <font color="black">36</font>     this.sheet = new Sheet(rootEl, this.data);                                                           </pre>
<pre>      <font color="black">30</font> <font color="red">    this.sheet2 = new Sheet(rootEl2, this.data2);</font>                                                               <font color="black">37</font> <font color="green">    rootEl.child(this.bottombar.el);</font>                                                                     </pre>
<pre>      <font color="black">31</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">32</font> <font color="red">    this.data.verticalAddSplitSheet(this.sheet2);</font>                                                                                                                                                                           </pre>
<pre>      <font color="black">33</font> <font color="red">    this.data2.verticalAddSplitSheet(this.sheet);</font>                                                                                                                                                                           </pre>
<pre>      <font color="black">34</font> <font color="red">    //this.data.horizontalAddSplitSheet(this.sheet2);</font>                                                                                                                                                                       </pre>
<pre>      <font color="black">35</font> <font color="red">    //this.data2.horizontalAddSplitSheet(this.sheet);</font>                                                                                                                                                                       </pre>
<pre>      <font color="black">36</font>   }                                                                                                             <font color="black">38</font>   }                                                                                                      </pre>
<pre>      <font color="black">37</font>                                                                                                                 <font color="black">39</font>                                                                                                          </pre>
<pre>      <font color="black">38</font> <font color="red">  getEl() {</font>                                                                                                     <font color="black">40</font> <font color="green">  addSheet(name) {</font>                                                                                       </pre>
<pre>      <font color="black">39</font> <font color="red">     return this.rootEl2;</font>                                                                                       <font color="black">41</font> <font color="green">    const n = name || `sheet${this.sheetIndex}`;</font>                                                         </pre>
<pre>                                                                                                                         <font color="black">42</font> <font color="green">    const d = new DataProxy(n, this.options);</font>                                                            </pre>
<pre>                                                                                                                         <font color="black">43</font> <font color="green">    this.datas.push(d);</font>                                                                                  </pre>
<pre>                                                                                                                         <font color="black">44</font> <font color="green">    // console.log('d:', n, d, this.datas);</font>                                                              </pre>
<pre>                                                                                                                         <font color="black">45</font> <font color="green">    this.bottombar.addItem(n, true);</font>                                                                     </pre>
<pre>                                                                                                                         <font color="black">46</font> <font color="green">    this.sheetIndex += 1;</font>                                                                                </pre>
<pre>                                                                                                                         <font color="black">47</font> <font color="green">    return d;</font>                                                                                            </pre>
<pre>      <font color="black">40</font>   }                                                                                                             <font color="black">48</font>   }                                                                                                      </pre>
<pre>      <font color="black">41</font>                                                                                                                 <font color="black">49</font>                                                                                                          </pre>
<pre>                                                                                                                         <font color="black">50</font> <font color="green">  deleteSheet() {</font>                                                                                        </pre>
<pre>                                                                                                                         <font color="black">51</font> <font color="green">    const [oldIndex, nindex] = this.bottombar.deleteItem();</font>                                              </pre>
<pre>                                                                                                                         <font color="black">52</font> <font color="green">    if (oldIndex >= 0) {</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">53</font> <font color="green">      this.datas.splice(oldIndex, 1);</font>                                                                    </pre>
<pre>                                                                                                                         <font color="black">54</font> <font color="green">      if (nindex >= 0) this.sheet.resetData(this.datas[nindex]);</font>                                         </pre>
<pre>                                                                                                                         <font color="black">55</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                         <font color="black">56</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">57</font> <font color="green"> </font>                                                                                                        </pre>
<pre>      <font color="black">42</font>   loadData(data<font color="red"> </font>) {                                                                                             <font color="black">58</font>   loadData(data) {                                                                                       </pre>
<pre>      <font color="black">43</font> <font color="red">    this.sheet.loadData(data);  //splitsheet 同じdataをロードする</font>                                               <font color="black">59</font> <font color="green">    const d = Array.isArray(data) ? data[0] : data;</font>                                                      </pre>
<pre>      <font color="black">44</font>     this.sheet<font color="red">2</font>.loadData(d<font color="red">ata</font>);                                                                                 <font color="black">60</font>     this.sheet.loadData(d);                                                                              </pre>
<pre>      <font color="black">45</font> <font color="red">    //this.sheet2.loadData(this.sheet.exportData());</font>                                                                                                                                                                        </pre>
<pre>      <font color="black">46</font>     return this;                                                                                                <font color="black">61</font>     return this;                                                                                         </pre>
<pre>      <font color="black">47</font>   }                                                                                                             <font color="black">62</font>   }                                                                                                      </pre>
<pre>      <font color="black">48</font>                                                                                                                 <font color="black">63</font>                                                                                                          </pre>
<pre>      <font color="black">49</font>   getData() {                                                                                                   <font color="black">64</font>   getData() {                                                                                            </pre>
<pre>      <font color="black">50</font>     return this.data.getData();                                                                                 <font color="black">65</font>     return this.data<font color="green">s.map(it => it</font>.getData()<font color="green">)</font>;                                                           </pre>
<pre>      <font color="black">51</font>   }                                                                                                             <font color="black">66</font>   }                                                                                                      </pre>
<pre>      <font color="black">52</font>                                                                                                                 <font color="black">67</font>                                                                                                          </pre>
<pre>      <font color="black">53</font>   validate() {                                                                                                  <font color="black">68</font>   validate() {                                                                                           </pre>
<pre>      <font color="black">54</font>     const { validations } = this.data;                                                                          <font color="black">69</font>     const { validations } = this.data;                                                                   </pre>
<pre>      <font color="black">55</font>     return validations.errors.size <= 0;                                                                        <font color="black">70</font>     return validations.errors.size <= 0;                                                                 </pre>
<pre>      <font color="black">56</font>   }                                                                                                             <font color="black">71</font>   }                                                                                                      </pre>
<pre>      <font color="black">57</font>                                                                                                                 <font color="black">72</font>                                                                                                          </pre>
<pre>      <font color="black">58</font>   change(cb) {                                                                                                  <font color="black">73</font>   change(cb) {                                                                                           </pre>
<pre>      <font color="black">59</font> <font color="red">    console.log("Spreadsheet change");</font>                                                                                                                                                                                      </pre>
<pre>      <font color="black">60</font>     this.data.change = cb;                                                                                      <font color="black">74</font>     this.data.change = cb;                                                                               </pre>
<pre>      <font color="black">61</font>     return this;                                                                                                <font color="black">75</font>     return this;                                                                                         </pre>
<pre>      <font color="black">62</font>   }                                                                                                             <font color="black">76</font>   }                                                                                                      </pre>
<pre>      <font color="black">63</font>                                                                                                                 <font color="black">77</font>                                                                                                          </pre>
<pre>      <font color="black">64</font>   static locale(lang, message) {                                                                                <font color="black">78</font>   static locale(lang, message) {                                                                         </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">72</font>   window.x = window.x || {};                                                                                    <font color="black">86</font>   window.x = window.x || {};                                                                             </pre>
<pre>      <font color="black">73</font>   window.x.spreadsheet = spreadsheet;                                                                           <font color="black">87</font>   window.x.spreadsheet = spreadsheet;                                                                    </pre>
<pre>      <font color="black">74</font>   window.x.spreadsheet.locale = (lang, message) => locale(lang, message);                                       <font color="black">88</font>   window.x.spreadsheet.locale = (lang, message) => locale(lang, message);                                </pre>
<pre>      <font color="black">75</font> }                                                                                                               <font color="black">89</font> }                                                                                                        </pre>
<pre>      <font color="black">76</font>                                                                                                                 <font color="black">90</font>                                                                                                          </pre>
<pre>      <font color="black">77</font> <font color="red">//--------------------------------</font>                                                                                                                                                                                          </pre>
<pre>      <font color="black">78</font> <font color="red">//const pane = new Tweakpane({container: spreadsheet.getEl(),});</font>                                                                                                                                                            </pre>
<pre>      <font color="black">79</font> <font color="red">    const pane = new Tweakpane();</font>                                                                                                                                                                                           </pre>
<pre>      <font color="black">80</font> <font color="red">        const PARAMS = {</font>                                                                                                                                                                                                    </pre>
<pre>      <font color="black">81</font> <font color="red">                b: true,</font>                                                                                                                                                                                                    </pre>
<pre>      <font color="black">82</font> <font color="red">                c: '#ff8800',</font>                                                                                                                                                                                               </pre>
<pre>      <font color="black">83</font> <font color="red">                n: 50,</font>                                                                                                                                                                                                      </pre>
<pre>      <font color="black">84</font> <font color="red">                s: 'string',</font>                                                                                                                                                                                                </pre>
<pre>      <font color="black">85</font> <font color="red">        };</font>                                                                                                                                                                                                                  </pre>
<pre>      <font color="black">86</font> <font color="red">        const nf = pane.addFolder({</font>                                                                                                                                                                                         </pre>
<pre>      <font color="black">87</font> <font color="red">                title: 'Number',</font>                                                                                                                                                                                            </pre>
<pre>      <font color="black">88</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>      <font color="black">89</font> <font color="red">        nf.addInput(PARAMS, 'n', {</font>                                                                                                                                                                                          </pre>
<pre>      <font color="black">90</font> <font color="red">                label: 'text',</font>                                                                                                                                                                                              </pre>
<pre>      <font color="black">91</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>      <font color="black">92</font> <font color="red">        nf.addInput(PARAMS, 'n', {</font>                                                                                                                                                                                          </pre>
<pre>      <font color="black">93</font> <font color="red">                label: 'slider',</font>                                                                                                                                                                                            </pre>
<pre>      <font color="black">94</font> <font color="red">                max: 100,</font>                                                                                                                                                                                                   </pre>
<pre>      <font color="black">95</font> <font color="red">                min: 0,</font>                                                                                                                                                                                                     </pre>
<pre>      <font color="black">96</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>      <font color="black">97</font> <font color="red">        nf.addInput(PARAMS, 'n', {</font>                                                                                                                                                                                          </pre>
<pre>      <font color="black">98</font> <font color="red">                label: 'list',</font>                                                                                                                                                                                              </pre>
<pre>      <font color="black">99</font> <font color="red">                options: {</font>                                                                                                                                                                                                  </pre>
<pre>     <font color="black">100</font> <font color="red">                        low: 0,</font>                                                                                                                                                                                             </pre>
<pre>     <font color="black">101</font> <font color="red">                        medium: 50,</font>                                                                                                                                                                                         </pre>
<pre>     <font color="black">102</font> <font color="red">                        high: 100,</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">103</font> <font color="red">                },</font>                                                                                                                                                                                                          </pre>
<pre>     <font color="black">104</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">105</font> <font color="red">        const sf = pane.addFolder({</font>                                                                                                                                                                                         </pre>
<pre>     <font color="black">106</font> <font color="red">                title: 'String',</font>                                                                                                                                                                                            </pre>
<pre>     <font color="black">107</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">108</font> <font color="red">        sf.addInput(PARAMS, 's', {</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">109</font> <font color="red">                label: 'text',</font>                                                                                                                                                                                              </pre>
<pre>     <font color="black">110</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">111</font> <font color="red">        sf.addInput(PARAMS, 's', {</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">112</font> <font color="red">                label: 'list',</font>                                                                                                                                                                                              </pre>
<pre>     <font color="black">113</font> <font color="red">                options: {</font>                                                                                                                                                                                                  </pre>
<pre>     <font color="black">114</font> <font color="red">                        dark: 'Dark',</font>                                                                                                                                                                                       </pre>
<pre>     <font color="black">115</font> <font color="red">                        light: 'Light',</font>                                                                                                                                                                                     </pre>
<pre>     <font color="black">116</font> <font color="red">                },</font>                                                                                                                                                                                                          </pre>
<pre>     <font color="black">117</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">118</font> <font color="red">        const bf = pane.addFolder({</font>                                                                                                                                                                                         </pre>
<pre>     <font color="black">119</font> <font color="red">                title: 'Boolean',</font>                                                                                                                                                                                           </pre>
<pre>     <font color="black">120</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">121</font> <font color="red">        bf.addInput(PARAMS, 'b', {</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">122</font> <font color="red">                label: 'checkbox',</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">123</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">124</font> <font color="red">        const cf = pane.addFolder({</font>                                                                                                                                                                                         </pre>
<pre>     <font color="black">125</font> <font color="red">                title: 'Color',</font>                                                                                                                                                                                             </pre>
<pre>     <font color="black">126</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">127</font> <font color="red">        cf.addInput(PARAMS, 'c', {</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">128</font> <font color="red">                label: 'text',</font>                                                                                                                                                                                              </pre>
<pre>     <font color="black">129</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">130</font> <font color="red">//--------------------------------</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">131</font> export default Spreadsheet;                                                                                     <font color="black">91</font> export default Spreadsheet;                                                                              </pre>
<pre>     <font color="black">132</font> export {                                                                                                        <font color="black">92</font> export {                                                                                                 </pre>
<pre>     <font color="black">133</font>   spreadsheet,                                                                                                  <font color="black">93</font>   spreadsheet,                                                                                           </pre>
<pre>     <font color="black">134</font> };                                                                                                              <font color="black">94</font> };                                                                                                       </pre>
<pre><font color="blue">../src/core/col.js</font>                                                                                                 <font color="blue">../../x-spreadsheet/src/core/col.js</font>                                                                               </pre>
<pre>      <font color="black">10</font>     this.indexWidth = indexWidth;                                                                               <font color="black">10</font>     this.indexWidth = indexWidth;                                                                        </pre>
<pre>      <font color="black">11</font>     this.minWidth = minWidth;                                                                                   <font color="black">11</font>     this.minWidth = minWidth;                                                                            </pre>
<pre>      <font color="black">12</font>   }                                                                                                             <font color="black">12</font>   }                                                                                                      </pre>
<pre>      <font color="black">13</font>                                                                                                                 <font color="black">13</font>                                                                                                          </pre>
<pre>      <font color="black">14</font>   setData(d) {                                                                                                  <font color="black">14</font>   setData(d) {                                                                                           </pre>
<pre>      <font color="black">15</font> <font color="red">    console.log("col setData:", d);</font>                                                                                                                                                                                         </pre>
<pre>      <font color="black">16</font>     if (d.len) {                                                                                                <font color="black">15</font>     if (d.len) {                                                                                         </pre>
<pre>      <font color="black">17</font>       this.len = d.len;                                                                                         <font color="black">16</font>       this.len = d.len;                                                                                  </pre>
<pre>      <font color="black">18</font>       delete d.len;                                                                                             <font color="black">17</font>       delete d.len;                                                                                      </pre>
<pre>      <font color="black">19</font>     }                                                                                                           <font color="black">18</font>     }                                                                                                    </pre>
<pre>      <font color="black">20</font>     this._ = d;                                                                                                 <font color="black">19</font>     this._ = d;                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">28</font>   getWidth(i) {                                                                                                 <font color="black">27</font>   getWidth(i) {                                                                                          </pre>
<pre>      <font color="black">29</font>     const col = this._[i];                                                                                      <font color="black">28</font>     const col = this._[i];                                                                               </pre>
<pre>      <font color="black">30</font>     if (col && col.width) {                                                                                     <font color="black">29</font>     if (col && col.width) {                                                                              </pre>
<pre>      <font color="black">31</font>       return col.width;                                                                                         <font color="black">30</font>       return col.width;                                                                                  </pre>
<pre>      <font color="black">32</font>     }                                                                                                           <font color="black">31</font>     }                                                                                                    </pre>
<pre>      <font color="black">33</font> <font color="red">    //console.log("col gwtWidth: ", this.width);</font>                                                                                                                                                                            </pre>
<pre>      <font color="black">34</font>     return this.width;                                                                                          <font color="black">32</font>     return this.width;                                                                                   </pre>
<pre>      <font color="black">35</font>   }                                                                                                             <font color="black">33</font>   }                                                                                                      </pre>
<pre>      <font color="black">36</font>                                                                                                                 <font color="black">34</font>                                                                                                          </pre>
<pre>      <font color="black">37</font>   getOrNew(ci) {                                                                                                <font color="black">35</font>   getOrNew(ci) {                                                                                         </pre>
<pre>      <font color="black">38</font>     this._[ci] = this._[ci] || {};                                                                              <font color="black">36</font>     this._[ci] = this._[ci] || {};                                                                       </pre>
<pre>      <font color="black">39</font>     return this._[ci];                                                                                          <font color="black">37</font>     return this._[ci];                                                                                   </pre>
<pre>      <font color="black">40</font>   }                                                                                                             <font color="black">38</font>   }                                                                                                      </pre>
<pre>      <font color="black">41</font>                                                                                                                 <font color="black">39</font>                                                                                                          </pre>
<pre>      <font color="black">42</font>   setWidth(ci, width) {                                                                                         <font color="black">40</font>   setWidth(ci, width) {                                                                                  </pre>
<pre>      <font color="black">43</font> <font color="red">    console.log("col setWidth: ", ci, width);</font>                                                                                                                                                                               </pre>
<pre>      <font color="black">44</font>     const col = this.getOrNew(ci);                                                                              <font color="black">41</font>     const col = this.getOrNew(ci);                                                                       </pre>
<pre>      <font color="black">45</font>     col.width = width;                                                                                          <font color="black">42</font>     col.width = width;                                                                                   </pre>
<pre>      <font color="black">46</font>   }                                                                                                             <font color="black">43</font>   }                                                                                                      </pre>
<pre>      <font color="black">47</font>                                                                                                                 <font color="black">44</font>                                                                                                          </pre>
<pre>      <font color="black">48</font>   setStyle(ci, style) {                                                                                         <font color="black">45</font>   setStyle(ci, style) {                                                                                  </pre>
<pre><font color="blue">../src/core/data_proxy.js</font>                                                                                          <font color="blue">../../x-spreadsheet/src/core/data_proxy.js</font>                                                                        </pre>
<pre>      <font color="black">11</font> import { Cols } from './col';                                                                                   <font color="black">11</font> import { Cols } from './col';                                                                            </pre>
<pre>      <font color="black">12</font> import { Validations } from './validation';                                                                     <font color="black">12</font> import { Validations } from './validation';                                                              </pre>
<pre>      <font color="black">13</font> import { CellRange } from './cell_range';                                                                       <font color="black">13</font> import { CellRange } from './cell_range';                                                                </pre>
<pre>      <font color="black">14</font> import { expr2xy, xy2expr } from './alphabet';                                                                  <font color="black">14</font> import { expr2xy, xy2expr } from './alphabet';                                                           </pre>
<pre>      <font color="black">15</font> import { t } from '../locale/locale';                                                                           <font color="black">15</font> import { t } from '../locale/locale';                                                                    </pre>
<pre>      <font color="black">16</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">17</font> <font color="red">import { Shapes } from './shape';  //GUSA</font>                                                                                                                                                                                   </pre>
<pre>      <font color="black">18</font>                                                                                                                 <font color="black">16</font>                                                                                                          </pre>
<pre>      <font color="black">19</font> // private methods                                                                                              <font color="black">17</font> // private methods                                                                                       </pre>
<pre>      <font color="black">20</font> /*                                                                                                              <font color="black">18</font> /*                                                                                                       </pre>
<pre>      <font color="black">21</font>  * {                                                                                                            <font color="black">19</font>  * {                                                                                                     </pre>
<pre>      <font color="black">22</font>  *  name: ''                                                                                                    <font color="black">20</font>  *  name: ''                                                                                             </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">37</font>  *        right: [style, color],                                                                                <font color="black">35</font>  *        right: [style, color],                                                                         </pre>
<pre>      <font color="black">38</font>  *        top: [style, color],                                                                                  <font color="black">36</font>  *        top: [style, color],                                                                           </pre>
<pre>      <font color="black">39</font>  *        bottom: [style, color],                                                                               <font color="black">37</font>  *        bottom: [style, color],                                                                        </pre>
<pre>      <font color="black">40</font>  *      },                                                                                                      <font color="black">38</font>  *      },                                                                                               </pre>
<pre>      <font color="black">41</font>  *      font: {                                                                                                 <font color="black">39</font>  *      font: {                                                                                          </pre>
<pre>      <font color="black">42</font>  *        <font color="orange">f</font>am<font color="orange">ily</font>: 'Helvetica',                                                                                  <font color="black">40</font>  *        <font color="orange">n</font>am<font color="orange">e</font>: 'Helvetica',                                                                             </pre>
<pre>      <font color="black">43</font>  *        size: 10,                                                                                             <font color="black">41</font>  *        size: 10,                                                                                      </pre>
<pre>      <font color="black">44</font>  *        bold: false,                                                                                          <font color="black">42</font>  *        bold: false,                                                                                   </pre>
<pre>      <font color="black">45</font>  *        italic: false,                                                                                        <font color="black">43</font>  *        italic: false,                                                                                 </pre>
<pre>      <font color="black">46</font>  *      }                                                                                                       <font color="black">44</font>  *      }                                                                                                </pre>
<pre>      <font color="black">47</font>  *    }                                                                                                         <font color="black">45</font>  *    }                                                                                                  </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">77</font>   },                                                                                                            <font color="black">75</font>   },                                                                                                     </pre>
<pre>      <font color="black">78</font>   showGrid: true,                                                                                               <font color="black">76</font>   showGrid: true,                                                                                        </pre>
<pre>      <font color="black">79</font>   showToolbar: true,                                                                                            <font color="black">77</font>   showToolbar: true,                                                                                     </pre>
<pre>      <font color="black">80</font>   showContextmenu: true,                                                                                        <font color="black">78</font>   showContextmenu: true,                                                                                 </pre>
<pre>      <font color="black">81</font>   row: {                                                                                                        <font color="black">79</font>   row: {                                                                                                 </pre>
<pre>      <font color="black">82</font> <font color="red">//    len: 100,</font>                                                                                                                                                                                                             </pre>
<pre>      <font color="black">83</font>     len: 100<font color="red">0</font>,                                                                                                  <font color="black">80</font>     len: 100,                                                                                            </pre>
<pre>      <font color="black">84</font>     height: 2<font color="orange">0</font>,                                                                                                 <font color="black">81</font>     height: 2<font color="orange">5</font>,                                                                                          </pre>
<pre>      <font color="black">85</font>   },                                                                                                            <font color="black">82</font>   },                                                                                                     </pre>
<pre>      <font color="black">86</font>   col: {                                                                                                        <font color="black">83</font>   col: {                                                                                                 </pre>
<pre>      <font color="black">87</font> <font color="red">//</font>    len: 26,                                                                                                  <font color="black">84</font>     len: 26,                                                                                             </pre>
<pre>      <font color="black">88</font> <font color="red">    len: 1000,</font>                                                                                                                                                                                                              </pre>
<pre>      <font color="black">89</font>     width: 100,                                                                                                 <font color="black">85</font>     width: 100,                                                                                          </pre>
<pre>      <font color="black">90</font>     indexWidth: 60,                                                                                             <font color="black">86</font>     indexWidth: 60,                                                                                      </pre>
<pre>      <font color="black">91</font>     minWidth: 60,                                                                                               <font color="black">87</font>     minWidth: 60,                                                                                        </pre>
<pre>      <font color="black">92</font> <font color="red">  },</font>                                                                                                                                                                                                                        </pre>
<pre>      <font color="black">93</font> <font color="red">  shape: {</font>                                                                                                                                                                                                                  </pre>
<pre>      <font color="black">94</font> <font color="red">    draggable: true,</font>                                                                                                                                                                                                        </pre>
<pre>      <font color="black">95</font>   },                                                                                                            <font color="black">88</font>   },                                                                                                     </pre>
<pre>      <font color="black">96</font>   style: {                                                                                                      <font color="black">89</font>   style: {                                                                                               </pre>
<pre>      <font color="black">97</font>     bgcolor: '#ffffff',                                                                                         <font color="black">90</font>     bgcolor: '#ffffff',                                                                                  </pre>
<pre>      <font color="black">98</font>     align: 'left',                                                                                              <font color="black">91</font>     align: 'left',                                                                                       </pre>
<pre>      <font color="black">99</font>     valign: 'middle',                                                                                           <font color="black">92</font>     valign: 'middle',                                                                                    </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">109</font>     },                                                                                                         <font color="black">102</font>     },                                                                                                   </pre>
<pre>     <font color="black">110</font>   },                                                                                                           <font color="black">103</font>   },                                                                                                     </pre>
<pre>     <font color="black">111</font> };                                                                                                             <font color="black">104</font> };                                                                                                       </pre>
<pre>     <font color="black">112</font>                                                                                                                <font color="black">105</font>                                                                                                          </pre>
<pre>     <font color="black">113</font> const toolbarHeight = 41;                                                                                      <font color="black">106</font> const toolbarHeight = 41;                                                                                </pre>
<pre>                                                                                                                        <font color="black">107</font> <font color="green">const bottombarHeight = 41;</font>                                                                              </pre>
<pre>     <font color="black">114</font>                                                                                                                <font color="black">108</font>                                                                                                          </pre>
<pre>     <font color="black">115</font>                                                                                                                <font color="black">109</font>                                                                                                          </pre>
<pre>     <font color="black">116</font> // src: cellRange                                                                                              <font color="black">110</font> // src: cellRange                                                                                        </pre>
<pre>     <font color="black">117</font> // dst: cellRange                                                                                              <font color="black">111</font> // dst: cellRange                                                                                        </pre>
<pre>     <font color="black">118</font> function canPaste(src, dst, error = () => {}) {                                                                <font color="black">112</font> function canPaste(src, dst, error = () => {}) {                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">334</font>     this.freeze = [0, 0];                                                                                      <font color="black">328</font>     this.freeze = [0, 0];                                                                                </pre>
<pre>     <font color="black">335</font>     this.styles = []; // Array<Style>                                                                          <font color="black">329</font>     this.styles = []; // Array<Style>                                                                    </pre>
<pre>     <font color="black">336</font>     this.merges = new Merges(); // [CellRange, ...]                                                            <font color="black">330</font>     this.merges = new Merges(); // [CellRange, ...]                                                      </pre>
<pre>     <font color="black">337</font>     this.rows = new Rows(this.settings.row);                                                                   <font color="black">331</font>     this.rows = new Rows(this.settings.row);                                                             </pre>
<pre>     <font color="black">338</font>     this.cols = new Cols(this.settings.col);                                                                   <font color="black">332</font>     this.cols = new Cols(this.settings.col);                                                             </pre>
<pre>     <font color="black">339</font> <font color="red">//    console.log("rows: ",this.rows);</font>                                                                                                                                                                                      </pre>
<pre>     <font color="black">340</font> <font color="red">//    console.log("cols: ",this.cols);</font>                                                                                                                                                                                      </pre>
<pre>     <font color="black">341</font> <font color="red">    this.shapes = new Shapes(this.settings.shape);//GUSA</font>                                                                                                                                                                    </pre>
<pre>     <font color="black">342</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">343</font> <font color="red">    console.log(this.rows);</font>                                                                                                                                                                                                 </pre>
<pre>     <font color="black">344</font> <font color="red">    console.log(this.cols);</font>                                                                                                                                                                                                 </pre>
<pre>     <font color="black">345</font> <font color="red">    console.log(this.shapes);</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">346</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">347</font>     this.validations = new Validations();                                                                      <font color="black">333</font>     this.validations = new Validations();                                                                </pre>
<pre>     <font color="black">348</font>     this.hyperlinks = {};                                                                                      <font color="black">334</font>     this.hyperlinks = {};                                                                                </pre>
<pre>     <font color="black">349</font>     this.comments = {};                                                                                        <font color="black">335</font>     this.comments = {};                                                                                  </pre>
<pre>     <font color="black">350</font>     // save data end                                                                                           <font color="black">336</font>     // save data end                                                                                     </pre>
<pre>     <font color="black">351</font>                                                                                                                <font color="black">337</font>                                                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">357</font>     this.autoFilter = new AutoFilter();                                                                        <font color="black">343</font>     this.autoFilter = new AutoFilter();                                                                  </pre>
<pre>     <font color="black">358</font>     this.change = () => {};                                                                                    <font color="black">344</font>     this.change = () => {};                                                                              </pre>
<pre>     <font color="black">359</font>     this.exceptRowSet = new Set();                                                                             <font color="black">345</font>     this.exceptRowSet = new Set();                                                                       </pre>
<pre>     <font color="black">360</font>     this.sortedRowMap = new Map();                                                                             <font color="black">346</font>     this.sortedRowMap = new Map();                                                                       </pre>
<pre>     <font color="black">361</font>     this.unsortedRowMap = new Map();                                                                           <font color="black">347</font>     this.unsortedRowMap = new Map();                                                                     </pre>
<pre>     <font color="black">362</font> <font color="red">    this.h_splitSheets = new Array();</font>                                                                                                                                                                                       </pre>
<pre>     <font color="black">363</font> <font color="red">    this.v_splitSheets = new Array();</font>                                                                                                                                                                                       </pre>
<pre>     <font color="black">364</font>   }                                                                                                            <font color="black">348</font>   }                                                                                                      </pre>
<pre>     <font color="black">365</font>                                                                                                                <font color="black">349</font>                                                                                                          </pre>
<pre>     <font color="black">366</font>   addValidation(mode, ref, validator) {                                                                        <font color="black">350</font>   addValidation(mode, ref, validator) {                                                                  </pre>
<pre>     <font color="black">367</font>     // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);                                   <font color="black">351</font>     // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);                             </pre>
<pre>     <font color="black">368</font>     this.changeData(() => {                                                                                    <font color="black">352</font>     this.changeData(() => {                                                                              </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">435</font>       } else if (clipboard.isCut()) {                                                                          <font color="black">419</font>       } else if (clipboard.isCut()) {                                                                    </pre>
<pre>     <font color="black">436</font>         cutPaste.call(this, clipboard.range, selector.range);                                                  <font color="black">420</font>         cutPaste.call(this, clipboard.range, selector.range);                                            </pre>
<pre>     <font color="black">437</font>       }                                                                                                        <font color="black">421</font>       }                                                                                                  </pre>
<pre>     <font color="black">438</font>     });                                                                                                        <font color="black">422</font>     });                                                                                                  </pre>
<pre>     <font color="black">439</font>     return true;                                                                                               <font color="black">423</font>     return true;                                                                                         </pre>
<pre>                                                                                                                        <font color="black">424</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">425</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">426</font> <font color="green">  pasteFromText(txt) {</font>                                                                                   </pre>
<pre>                                                                                                                        <font color="black">427</font> <font color="green">    const lines = txt.split('\r\n').map(it => it.replace(/"/g, '').split('\t'));</font>                         </pre>
<pre>                                                                                                                        <font color="black">428</font> <font color="green">    if (lines.length > 0) lines.length -= 1;</font>                                                             </pre>
<pre>                                                                                                                        <font color="black">429</font> <font color="green">    const { rows, selector } = this;</font>                                                                     </pre>
<pre>                                                                                                                        <font color="black">430</font> <font color="green">    this.changeData(() => {</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">431</font> <font color="green">      rows.paste(lines, selector.range);</font>                                                                 </pre>
<pre>                                                                                                                        <font color="black">432</font> <font color="green">    });</font>                                                                                                  </pre>
<pre>     <font color="black">440</font>   }                                                                                                            <font color="black">433</font>   }                                                                                                      </pre>
<pre>     <font color="black">441</font>                                                                                                                <font color="black">434</font>                                                                                                          </pre>
<pre>     <font color="black">442</font>   autofill(cellRange, what, error = () => {}) {                                                                <font color="black">435</font>   autofill(cellRange, what, error = () => {}) {                                                          </pre>
<pre>     <font color="black">443</font>     const srcRange = this.selector.range;                                                                      <font color="black">436</font>     const srcRange = this.selector.range;                                                                </pre>
<pre>     <font color="black">444</font>     if (!canPaste.call(this, srcRange, cellRange, error)) return false;                                        <font color="black">437</font>     if (!canPaste.call(this, srcRange, cellRange, error)) return false;                                  </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">504</font>         if (value) this.merge();                                                                               <font color="black">497</font>         if (value) this.merge();                                                                         </pre>
<pre>     <font color="black">505</font>         else this.unmerge();                                                                                   <font color="black">498</font>         else this.unmerge();                                                                             </pre>
<pre>     <font color="black">506</font>       } else if (property === 'border') {                                                                      <font color="black">499</font>       } else if (property === 'border') {                                                                </pre>
<pre>     <font color="black">507</font>         setStyleBorders.call(this, value);                                                                     <font color="black">500</font>         setStyleBorders.call(this, value);                                                               </pre>
<pre>     <font color="black">508</font>       } else if (property === 'formula') {                                                                     <font color="black">501</font>       } else if (property === 'formula') {                                                               </pre>
<pre>                                                                                                                        <font color="black">502</font> <font color="green">        // console.log('>>>', selector.multiple());</font>                                                      </pre>
<pre>                                                                                                                        <font color="black">503</font> <font color="green">        const { ri, ci, range } = selector;</font>                                                              </pre>
<pre>                                                                                                                        <font color="black">504</font> <font color="green">        if (selector.multiple()) {</font>                                                                       </pre>
<pre>                                                                                                                        <font color="black">505</font> <font color="green">          const [rn, cn] = selector.size();</font>                                                              </pre>
<pre>                                                                                                                        <font color="black">506</font> <font color="green">          const {</font>                                                                                        </pre>
<pre>                                                                                                                        <font color="black">507</font> <font color="green">            sri, sci, eri, eci,</font>                                                                          </pre>
<pre>                                                                                                                        <font color="black">508</font> <font color="green">          } = range;</font>                                                                                     </pre>
<pre>                                                                                                                        <font color="black">509</font> <font color="green">          if (rn > 1) {</font>                                                                                  </pre>
<pre>                                                                                                                        <font color="black">510</font> <font color="green">            for (let i = sci; i <= eci; i += 1) {</font>                                                        </pre>
<pre>                                                                                                                        <font color="black">511</font> <font color="green">              const cell = rows.getCellOrNew(eri + 1, i);</font>                                                </pre>
<pre>                                                                                                                        <font color="black">512</font> <font color="green">              cell.text = `=${value}(${xy2expr(i, sri)}:${xy2expr(i, eri)})`;</font>                            </pre>
<pre>                                                                                                                        <font color="black">513</font> <font color="green">            }</font>                                                                                            </pre>
<pre>                                                                                                                        <font color="black">514</font> <font color="green">          } else if (cn > 1) {</font>                                                                           </pre>
<pre>                                                                                                                        <font color="black">515</font> <font color="green">            const cell = rows.getCellOrNew(ri, eci + 1);</font>                                                 </pre>
<pre>                                                                                                                        <font color="black">516</font> <font color="green">            cell.text = `=${value}(${xy2expr(sci, ri)}:${xy2expr(eci, ri)})`;</font>                            </pre>
<pre>                                                                                                                        <font color="black">517</font> <font color="green">          }</font>                                                                                              </pre>
<pre>                                                                                                                        <font color="black">518</font> <font color="green">        } else {</font>                                                                                         </pre>
<pre>     <font color="black">509</font>         const cell = rows.getCellOrNew(<font color="red">selector.</font>ri, <font color="red">selector.</font>ci);                                              <font color="black">519</font> <font color="green">  </font>        const cell = rows.getCellOrNew(ri, ci);                                                        </pre>
<pre>     <font color="black">510</font>         cell.text = `=${value}()`;                                                                             <font color="black">520</font> <font color="green">  </font>        cell.text = `=${value}()`;                                                                     </pre>
<pre>                                                                                                                        <font color="black">521</font> <font color="green">        }</font>                                                                                                </pre>
<pre>     <font color="black">511</font>       } else {                                                                                                 <font color="black">522</font>       } else {                                                                                           </pre>
<pre>     <font color="black">512</font>         selector.range.each((ri, ci) => {                                                                      <font color="black">523</font>         selector.range.each((ri, ci) => {                                                                </pre>
<pre>     <font color="black">513</font>           const cell = rows.getCellOrNew(ri, ci);                                                              <font color="black">524</font>           const cell = rows.getCellOrNew(ri, ci);                                                        </pre>
<pre>     <font color="black">514</font>           let cstyle = {};                                                                                     <font color="black">525</font>           let cstyle = {};                                                                               </pre>
<pre>     <font color="black">515</font>           if (cell.style !== undefined) {                                                                      <font color="black">526</font>           if (cell.style !== undefined) {                                                                </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">528</font>             || property === 'underline'                                                                        <font color="black">539</font>             || property === 'underline'                                                                  </pre>
<pre>     <font color="black">529</font>             || property === 'align' || property === 'valign'                                                   <font color="black">540</font>             || property === 'align' || property === 'valign'                                             </pre>
<pre>     <font color="black">530</font>             || property === 'color' || property === 'bgcolor') {                                               <font color="black">541</font>             || property === 'color' || property === 'bgcolor') {                                         </pre>
<pre>     <font color="black">531</font>             cstyle[property] = value;                                                                          <font color="black">542</font>             cstyle[property] = value;                                                                    </pre>
<pre>     <font color="black">532</font>             cell.style = this.addStyle(cstyle);                                                                <font color="black">543</font>             cell.style = this.addStyle(cstyle);                                                          </pre>
<pre>                                                                                                                        <font color="black">544</font> <font color="green">          } else {</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">545</font> <font color="green">            cell[property] = value;</font>                                                                      </pre>
<pre>     <font color="black">533</font>           }                                                                                                    <font color="black">546</font>           }                                                                                              </pre>
<pre>     <font color="black">534</font>         });                                                                                                    <font color="black">547</font>         });                                                                                              </pre>
<pre>     <font color="black">535</font>       }                                                                                                        <font color="black">548</font>       }                                                                                                  </pre>
<pre>     <font color="black">536</font>     });                                                                                                        <font color="black">549</font>     });                                                                                                  </pre>
<pre>     <font color="black">537</font>   }                                                                                                            <font color="black">550</font>   }                                                                                                      </pre>
<pre>     <font color="black">538</font>                                                                                                                <font color="black">551</font>                                                                                                          </pre>
<pre>     <font color="black">539</font>   // state: input | finished                                                                                   <font color="black">552</font>   // state: input | finished                                                                             </pre>
<pre>     <font color="black">540</font>   setSelectedCellText(text, state = 'input') {                                                                 <font color="black">553</font>   setSelectedCellText(text, state = 'input') {                                                           </pre>
<pre>                                                                                                                        <font color="black">554</font> <font color="green">    const { autoFilter, selector, rows } = this;</font>                                                         </pre>
<pre>     <font color="black">541</font>     const { ri, ci } = <font color="red">this.</font>selector;                                                                          <font color="black">555</font>     const { ri, ci } = selector;                                                                         </pre>
<pre>     <font color="black">542</font>     let nri = ri;                                                                                              <font color="black">556</font>     let nri = ri;                                                                                        </pre>
<pre>     <font color="black">543</font>     if (this.unsortedRowMap.has(ri)) {                                                                         <font color="black">557</font>     if (this.unsortedRowMap.has(ri)) {                                                                   </pre>
<pre>     <font color="black">544</font>       nri = this.unsortedRowMap.get(ri);                                                                       <font color="black">558</font>       nri = this.unsortedRowMap.get(ri);                                                                 </pre>
<pre>     <font color="black">545</font>     }                                                                                                          <font color="black">559</font>     }                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">560</font> <font color="green">    const oldCell = rows.getCell(nri, ci);</font>                                                               </pre>
<pre>                                                                                                                        <font color="black">561</font> <font color="green">    const oldText = oldCell ? oldCell.text : '';</font>                                                         </pre>
<pre>     <font color="black">546</font>     this.setCellText(nri, ci, text, state);                                                                    <font color="black">562</font>     this.setCellText(nri, ci, text, state);                                                              </pre>
<pre>                                                                                                                        <font color="black">563</font> <font color="green">    // replace filter.value</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">564</font> <font color="green">    if (autoFilter.active()) {</font>                                                                           </pre>
<pre>                                                                                                                        <font color="black">565</font> <font color="green">      const filter = autoFilter.getFilter(ci);</font>                                                           </pre>
<pre>                                                                                                                        <font color="black">566</font> <font color="green">      if (filter) {</font>                                                                                      </pre>
<pre>                                                                                                                        <font color="black">567</font> <font color="green">        const vIndex = filter.value.findIndex(v => v === oldText);</font>                                       </pre>
<pre>                                                                                                                        <font color="black">568</font> <font color="green">        if (vIndex >= 0) {</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">569</font> <font color="green">          filter.value.splice(vIndex, 1, text);</font>                                                          </pre>
<pre>                                                                                                                        <font color="black">570</font> <font color="green">        }</font>                                                                                                </pre>
<pre>                                                                                                                        <font color="black">571</font> <font color="green">        // console.log('filter:', filter, oldCell);</font>                                                      </pre>
<pre>                                                                                                                        <font color="black">572</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">573</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>     <font color="black">547</font>     this.resetAutoFilter();                                                                                    <font color="black">574</font>    <font color="green"> //</font> this.resetAutoFilter();                                                                           </pre>
<pre>     <font color="black">548</font>   }                                                                                                            <font color="black">575</font>   }                                                                                                      </pre>
<pre>     <font color="black">549</font>                                                                                                                <font color="black">576</font>                                                                                                          </pre>
<pre>     <font color="black">550</font>   getSelectedCell() {                                                                                          <font color="black">577</font>   getSelectedCell() {                                                                                    </pre>
<pre>     <font color="black">551</font>     const { ri, ci } = this.selector;                                                                          <font color="black">578</font>     const { ri, ci } = this.selector;                                                                    </pre>
<pre>     <font color="black">552</font>     let nri = ri;                                                                                              <font color="black">579</font>     let nri = ri;                                                                                        </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">811</font>       });                                                                                                      <font color="black">838</font>       });                                                                                                </pre>
<pre>     <font color="black">812</font>     });                                                                                                        <font color="black">839</font>     });                                                                                                  </pre>
<pre>     <font color="black">813</font>   }                                                                                                            <font color="black">840</font>   }                                                                                                      </pre>
<pre>     <font color="black">814</font>                                                                                                                <font color="black">841</font>                                                                                                          </pre>
<pre>     <font color="black">815</font>   scrollx(x, cb) {                                                                                             <font color="black">842</font>   scrollx(x, cb) {                                                                                       </pre>
<pre>     <font color="black">816</font> <font color="red">    console.log("scrollx: ");</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">817</font>     const { scroll, freeze, cols } = this;                                                                     <font color="black">843</font>     const { scroll, freeze, cols } = this;                                                               </pre>
<pre>     <font color="black">818</font>     const [, fci] = freeze;                                                                                    <font color="black">844</font>     const [, fci] = freeze;                                                                              </pre>
<pre>     <font color="black">819</font>     const [                                                                                                    <font color="black">845</font>     const [                                                                                              </pre>
<pre>     <font color="black">820</font>       ci, left, width,                                                                                         <font color="black">846</font>       ci, left, width,                                                                                   </pre>
<pre>     <font color="black">821</font>     ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));                                   <font color="black">847</font>     ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));                             </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">825</font>     if (scroll.x !== x1) {                                                                                     <font color="black">851</font>     if (scroll.x !== x1) {                                                                               </pre>
<pre>     <font color="black">826</font>       scroll.ci = x > 0 ? ci : 0;                                                                              <font color="black">852</font>       scroll.ci = x > 0 ? ci : 0;                                                                        </pre>
<pre>     <font color="black">827</font>       scroll.x = x1;                                                                                           <font color="black">853</font>       scroll.x = x1;                                                                                     </pre>
<pre>     <font color="black">828</font>       cb();                                                                                                    <font color="black">854</font>       cb();                                                                                              </pre>
<pre>     <font color="black">829</font>     }                                                                                                          <font color="black">855</font>     }                                                                                                    </pre>
<pre>     <font color="black">830</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">831</font> <font color="red">    this.v_splitSheets.forEach(function(sheet) { </font>                                                                                                                                                                           </pre>
<pre>     <font color="black">832</font> <font color="red">        console.log("movex: ", x);</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">833</font> <font color="red">       sheet.sync_movex(x); </font>                                                                                                                                                                                                </pre>
<pre>     <font color="black">834</font> <font color="red">     });</font>                                                                                                                                                                                                                    </pre>
<pre>     <font color="black">835</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>     <font color="black">836</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">837</font> <font color="red">  sync_scrollx(x, cb) {</font>                                                                                                                                                                                                     </pre>
<pre>     <font color="black">838</font> <font color="red">    const { scroll, freeze, cols } = this;</font>                                                                                                                                                                                  </pre>
<pre>     <font color="black">839</font> <font color="red">    const [, fci] = freeze;</font>                                                                                                                                                                                                 </pre>
<pre>     <font color="black">840</font> <font color="red">    const [</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">841</font> <font color="red">      ci, left, width,</font>                                                                                                                                                                                                      </pre>
<pre>     <font color="black">842</font> <font color="red">    ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i => cols.getWidth(i));</font>                                                                                                                                                </pre>
<pre>     <font color="black">843</font> <font color="red">    // console.log('fci:', fci, ', ci:', ci);</font>                                                                                                                                                                               </pre>
<pre>     <font color="black">844</font> <font color="red">    let x1 = left;</font>                                                                                                                                                                                                          </pre>
<pre>     <font color="black">845</font> <font color="red">    if (x > 0) x1 += width;</font>                                                                                                                                                                                                 </pre>
<pre>     <font color="black">846</font> <font color="red">    if (scroll.x !== x1) {</font>                                                                                                                                                                                                  </pre>
<pre>     <font color="black">847</font> <font color="red">      scroll.ci = x > 0 ? ci : 0;</font>                                                                                                                                                                                           </pre>
<pre>     <font color="black">848</font> <font color="red">      scroll.x = x1;</font>                                                                                                                                                                                                        </pre>
<pre>     <font color="black">849</font> <font color="red">      cb();</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">850</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre>
<pre>     <font color="black">851</font>   }                                                                                                            <font color="black">856</font>   }                                                                                                      </pre>
<pre>     <font color="black">852</font>                                                                                                                <font color="black">857</font>                                                                                                          </pre>
<pre>     <font color="black">853</font>   scrolly(y, cb) {                                                                                             <font color="black">858</font>   scrolly(y, cb) {                                                                                       </pre>
<pre>     <font color="black">854</font> <font color="red">    console.log("scrolly: ");</font>                                                                                                                                                                                               </pre>
<pre>     <font color="black">855</font>     const { scroll, freeze, rows } = this;                                                                     <font color="black">859</font>     const { scroll, freeze, rows } = this;                                                               </pre>
<pre>     <font color="black">856</font>     const [fri] = freeze;                                                                                      <font color="black">860</font>     const [fri] = freeze;                                                                                </pre>
<pre>     <font color="black">857</font>     const [                                                                                                    <font color="black">861</font>     const [                                                                                              </pre>
<pre>     <font color="black">858</font>       ri, top, height,                                                                                         <font color="black">862</font>       ri, top, height,                                                                                   </pre>
<pre>     <font color="black">859</font>     ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));                                  <font color="black">863</font>     ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));                            </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">863</font>     if (scroll.y !== y1) {                                                                                     <font color="black">867</font>     if (scroll.y !== y1) {                                                                               </pre>
<pre>     <font color="black">864</font>       scroll.ri = y > 0 ? ri : 0;                                                                              <font color="black">868</font>       scroll.ri = y > 0 ? ri : 0;                                                                        </pre>
<pre>     <font color="black">865</font>       scroll.y = y1;                                                                                           <font color="black">869</font>       scroll.y = y1;                                                                                     </pre>
<pre>     <font color="black">866</font>       cb();                                                                                                    <font color="black">870</font>       cb();                                                                                              </pre>
<pre>     <font color="black">867</font>     }                                                                                                          <font color="black">871</font>     }                                                                                                    </pre>
<pre>     <font color="black">868</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">869</font> <font color="red">   this.h_splitSheets.forEach(function(sheet) {</font>                                                                                                                                                                             </pre>
<pre>     <font color="black">870</font> <font color="red">      console.log("movey: ", y);</font>                                                                                                                                                                                            </pre>
<pre>     <font color="black">871</font> <font color="red">     sheet.sync_movey(y);</font>                                                                                                                                                                                                   </pre>
<pre>     <font color="black">872</font> <font color="red">    });</font>                                                                                                                                                                                                                     </pre>
<pre>     <font color="black">873</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>     <font color="black">874</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">875</font> <font color="red">  sync_scrolly(y, cb) {</font>                                                                                                                                                                                                     </pre>
<pre>     <font color="black">876</font> <font color="red">    const { scroll, freeze, rows } = this;</font>                                                                                                                                                                                  </pre>
<pre>     <font color="black">877</font> <font color="red">    const [fri] = freeze;</font>                                                                                                                                                                                                   </pre>
<pre>     <font color="black">878</font> <font color="red">    const [</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">879</font> <font color="red">      ri, top, height,</font>                                                                                                                                                                                                      </pre>
<pre>     <font color="black">880</font> <font color="red">    ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i => rows.getHeight(i));</font>                                                                                                                                               </pre>
<pre>     <font color="black">881</font> <font color="red">    let y1 = top;</font>                                                                                                                                                                                                           </pre>
<pre>     <font color="black">882</font> <font color="red">    if (y > 0) y1 += height;</font>                                                                                                                                                                                                </pre>
<pre>     <font color="black">883</font> <font color="red">    // console.log('ri:', ri, ' ,y:', y1);</font>                                                                                                                                                                                  </pre>
<pre>     <font color="black">884</font> <font color="red">    if (scroll.y !== y1) {</font>                                                                                                                                                                                                  </pre>
<pre>     <font color="black">885</font> <font color="red">      scroll.ri = y > 0 ? ri : 0;</font>                                                                                                                                                                                           </pre>
<pre>     <font color="black">886</font> <font color="red">      scroll.y = y1;</font>                                                                                                                                                                                                        </pre>
<pre>     <font color="black">887</font> <font color="red">      cb();</font>                                                                                                                                                                                                                 </pre>
<pre>     <font color="black">888</font> <font color="red">  </font>  }                                                                                                          <font color="black">872</font>   }                                                                                                      </pre>
<pre>     <font color="black">889</font> <font color="red">  }</font>                                                                                                            <font color="black">873</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">890</font>   cellRect(ri, ci) {                                                                                           <font color="black">874</font>   cellRect(ri, ci) {                                                                                     </pre>
<pre>     <font color="black">891</font>     const { rows, cols } = this;                                                                               <font color="black">875</font>     const { rows, cols } = this;                                                                         </pre>
<pre>     <font color="black">892</font>     const left = cols.sumWidth(0, ci);                                                                         <font color="black">876</font>     const left = cols.sumWidth(0, ci);                                                                   </pre>
<pre>     <font color="black">893</font>     const top = rows.sumHeight(0, ri);                                                                         <font color="black">877</font>     const top = rows.sumHeight(0, ri);                                                                   </pre>
<pre>     <font color="black">894</font>     const cell = rows.getCell(ri, ci);                                                                         <font color="black">878</font>     const cell = rows.getCell(ri, ci);                                                                   </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">949</font>   setCellText(ri, ci, text, state) {                                                                           <font color="black">933</font>   setCellText(ri, ci, text, state) {                                                                     </pre>
<pre>     <font color="black">950</font>     const { rows, history, validations } = this;                                                               <font color="black">934</font>     const { rows, history, validations } = this;                                                         </pre>
<pre>     <font color="black">951</font>     if (state === 'finished') {                                                                                <font color="black">935</font>     if (state === 'finished') {                                                                          </pre>
<pre>     <font color="black">952</font>       rows.setCellText(ri, ci, '');                                                                            <font color="black">936</font>       rows.setCellText(ri, ci, '');                                                                      </pre>
<pre>     <font color="black">953</font>       history.add(this.getData());                                                                             <font color="black">937</font>       history.add(this.getData());                                                                       </pre>
<pre>     <font color="black">954</font>       <font color="red">//</font>rows.setCellText(ri, ci, text);                                                                        <font color="black">938</font>       rows.setCellText(ri, ci, text);                                                                    </pre>
<pre>     <font color="black">955</font> <font color="red">      //console.log("*** setCellText: ", text);</font>                                                                                                                                                                             </pre>
<pre>     <font color="black">956</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">957</font> <font color="red">      this.changeData(() => { </font>                                                                                                                                                                                              </pre>
<pre>     <font color="black">958</font> <font color="red">         this.rows.setCellText(ri, ci, text);</font>                                                                                                                                                                               </pre>
<pre>     <font color="black">959</font> <font color="red">      }); </font>                                                                                                                                                                                                                  </pre>
<pre>     <font color="black">960</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>     <font color="black">961</font>     } else {                                                                                                   <font color="black">939</font>     } else {                                                                                             </pre>
<pre>     <font color="black">962</font>       rows.setCellText(ri, ci, text);                                                                          <font color="black">940</font>       rows.setCellText(ri, ci, text);                                                                    </pre>
<pre>     <font color="black">963</font>       this.change(this.getData());                                                                             <font color="black">941</font>       this.change(this.getData());                                                                       </pre>
<pre>     <font color="black">964</font>     }                                                                                                          <font color="black">942</font>     }                                                                                                    </pre>
<pre>     <font color="black">965</font>     // validator                                                                                               <font color="black">943</font>     // validator                                                                                         </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">984</font>   freezeTotalHeight() {                                                                                        <font color="black">962</font>   freezeTotalHeight() {                                                                                  </pre>
<pre>     <font color="black">985</font>     return this.rows.sumHeight(0, this.freeze[0]);                                                             <font color="black">963</font>     return this.rows.sumHeight(0, this.freeze[0]);                                                       </pre>
<pre>     <font color="black">986</font>   }                                                                                                            <font color="black">964</font>   }                                                                                                      </pre>
<pre>     <font color="black">987</font>                                                                                                                <font color="black">965</font>                                                                                                          </pre>
<pre>     <font color="black">988</font>   setRowHeight(ri, height) {                                                                                   <font color="black">966</font>   setRowHeight(ri, height) {                                                                             </pre>
<pre>     <font color="black">989</font> <font color="red">//    console.log("setRowHeight");</font>                                                                                                                                                                                          </pre>
<pre>     <font color="black">990</font>     this.changeData(() => {                                                                                    <font color="black">967</font>     this.changeData(() => {                                                                              </pre>
<pre>     <font color="black">991</font>       this.rows.setHeight(ri, height);                                                                         <font color="black">968</font>       this.rows.setHeight(ri, height);                                                                   </pre>
<pre>     <font color="black">992</font>     });                                                                                                        <font color="black">969</font>     });                                                                                                  </pre>
<pre>     <font color="black">993</font>   }                                                                                                            <font color="black">970</font>   }                                                                                                      </pre>
<pre>     <font color="black">994</font>                                                                                                                <font color="black">971</font>                                                                                                          </pre>
<pre>     <font color="black">995</font>   setColWidth(ci, width) {                                                                                     <font color="black">972</font>   setColWidth(ci, width) {                                                                               </pre>
<pre>     <font color="black">996</font> <font color="red">//    console.log("setColWidth");</font>                                                                                                                                                                                           </pre>
<pre>     <font color="black">997</font>     this.changeData(() => {                                                                                    <font color="black">973</font>     this.changeData(() => {                                                                              </pre>
<pre>     <font color="black">998</font>       this.cols.setWidth(ci, width);                                                                           <font color="black">974</font>       this.cols.setWidth(ci, width);                                                                     </pre>
<pre>     <font color="black">999</font>     });                                                                                                        <font color="black">975</font>     });                                                                                                  </pre>
<pre>    <font color="black">1000</font>   }                                                                                                            <font color="black">976</font>   }                                                                                                      </pre>
<pre>    <font color="black">1001</font>                                                                                                                <font color="black">977</font>                                                                                                          </pre>
<pre>    <font color="black">1002</font>   viewHeight() {                                                                                               <font color="black">978</font>   viewHeight() {                                                                                         </pre>
<pre>    <font color="black">1003</font>     const { view, showToolbar } = this.settings;                                                               <font color="black">979</font>     const { view, showToolbar } = this.settings;                                                         </pre>
<pre>    <font color="black">1004</font>     let h = view.height();                                                                                     <font color="black">980</font>     let h = view.height();                                                                               </pre>
<pre>                                                                                                                        <font color="black">981</font> <font color="green">    h -= bottombarHeight;</font>                                                                                </pre>
<pre>    <font color="black">1005</font>     if (showToolbar) {                                                                                         <font color="black">982</font>     if (showToolbar) {                                                                                   </pre>
<pre>    <font color="black">1006</font>       h -= toolbarHeight;                                                                                      <font color="black">983</font>       h -= toolbarHeight;                                                                                </pre>
<pre>    <font color="black">1007</font>     }                                                                                                          <font color="black">984</font>     }                                                                                                    </pre>
<pre>    <font color="black">1008</font>     return h;                                                                                                  <font color="black">985</font>     return h;                                                                                            </pre>
<pre>    <font color="black">1009</font>   }                                                                                                            <font color="black">986</font>   }                                                                                                      </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>    <font color="black">1015</font>   freezeViewRange() {                                                                                          <font color="black">992</font>   freezeViewRange() {                                                                                    </pre>
<pre>    <font color="black">1016</font>     const [ri, ci] = this.freeze;                                                                              <font color="black">993</font>     const [ri, ci] = this.freeze;                                                                        </pre>
<pre>    <font color="black">1017</font>     return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());             <font color="black">994</font>     return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());       </pre>
<pre>    <font color="black">1018</font>   }                                                                                                            <font color="black">995</font>   }                                                                                                      </pre>
<pre>    <font color="black">1019</font>                                                                                                                <font color="black">996</font>                                                                                                          </pre>
<pre>                                                                                                                        <font color="black">997</font> <font color="green">  contentRange() {</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">998</font> <font color="green">    const { rows, cols } = this;</font>                                                                         </pre>
<pre>                                                                                                                        <font color="black">999</font> <font color="green">    const [ri, ci] = rows.maxCell();</font>                                                                     </pre>
<pre>                                                                                                                       <font color="black">1000</font> <font color="green">    const h = rows.sumHeight(0, ri + 1);</font>                                                                 </pre>
<pre>                                                                                                                       <font color="black">1001</font> <font color="green">    const w = cols.sumWidth(0, ci + 1);</font>                                                                  </pre>
<pre>                                                                                                                       <font color="black">1002</font> <font color="green">    return new CellRange(0, 0, ri, ci, w, h);</font>                                                            </pre>
<pre>                                                                                                                       <font color="black">1003</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                       <font color="black">1004</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                       <font color="black">1005</font> <font color="green">  exceptRowTotalHeight(sri, eri) {</font>                                                                       </pre>
<pre>                                                                                                                       <font color="black">1006</font> <font color="green">    const { exceptRowSet, rows } = this;</font>                                                                 </pre>
<pre>                                                                                                                       <font color="black">1007</font> <font color="green">    const exceptRows = Array.from(exceptRowSet);</font>                                                         </pre>
<pre>                                                                                                                       <font color="black">1008</font> <font color="green">    let exceptRowTH = 0;</font>                                                                                 </pre>
<pre>                                                                                                                       <font color="black">1009</font> <font color="green">    exceptRows.forEach((ri) => {</font>                                                                         </pre>
<pre>                                                                                                                       <font color="black">1010</font> <font color="green">      if (ri < sri || ri > eri) {</font>                                                                        </pre>
<pre>                                                                                                                       <font color="black">1011</font> <font color="green">        const height = rows.getHeight(ri);</font>                                                               </pre>
<pre>                                                                                                                       <font color="black">1012</font> <font color="green">        exceptRowTH += height;</font>                                                                           </pre>
<pre>                                                                                                                       <font color="black">1013</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>                                                                                                                       <font color="black">1014</font> <font color="green">    });</font>                                                                                                  </pre>
<pre>                                                                                                                       <font color="black">1015</font> <font color="green">    return exceptRowTH;</font>                                                                                  </pre>
<pre>                                                                                                                       <font color="black">1016</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                       <font color="black">1017</font> <font color="green"> </font>                                                                                                        </pre>
<pre>    <font color="black">1020</font>   viewRange() {                                                                                               <font color="black">1018</font>   viewRange() {                                                                                          </pre>
<pre>    <font color="black">1021</font>     const {                                                                                                   <font color="black">1019</font>     const {                                                                                              </pre>
<pre>    <font color="black">1022</font>       scroll, rows, cols, freeze,                                                                             <font color="black">1020</font>       scroll, rows, cols, freeze,<font color="green"> exceptRowSet,</font>                                                          </pre>
<pre>    <font color="black">1023</font>     } = this;                                                                                                 <font color="black">1021</font>     } = this;                                                                                            </pre>
<pre>    <font color="black">1024</font>     let { ri, ci } = scroll;                                                                                  <font color="black">1022</font>     let { ri, ci } = scroll;                                                                             </pre>
<pre>    <font color="black">1025</font>     if (ri <= 0) [ri] = freeze;                                                                               <font color="black">1023</font>     if (ri <= 0) [ri] = freeze;                                                                          </pre>
<pre>    <font color="black">1026</font>     if (ci <= 0) [, ci] = freeze;                                                                             <font color="black">1024</font>     if (ci <= 0) [, ci] = freeze;                                                                        </pre>
<pre>    <font color="black">1027</font>                                                                                                               <font color="black">1025</font>                                                                                                          </pre>
<pre>    <font color="black">1028</font>     let [x, y] = [0, 0];                                                                                      <font color="black">1026</font>     let [x, y] = [0, 0];                                                                                 </pre>
<pre>    <font color="black">1029</font>     let [eri, eci] = [rows.len, cols.len];                                                                    <font color="black">1027</font>     let [eri, eci] = [rows.len, cols.len];                                                               </pre>
<pre>    <font color="black">1030</font>     for (let i = ri; i < rows.len; i += 1) {                                                                  <font color="black">1028</font>     for (let i = ri; i < rows.len; i += 1) {                                                             </pre>
<pre>                                                                                                                       <font color="black">1029</font> <font color="green">      if (!exceptRowSet.has(i)) {</font>                                                                        </pre>
<pre>    <font color="black">1031</font>       y += rows.getHeight(i);                                                                                 <font color="black">1030</font> <font color="green">  </font>      y += rows.getHeight(i);                                                                          </pre>
<pre>    <font color="black">1032</font>       eri = i;                                                                                                <font color="black">1031</font> <font color="green">  </font>      eri = i;                                                                                         </pre>
<pre>                                                                                                                       <font color="black">1032</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>    <font color="black">1033</font>       if (y > this.viewHeight()) break;                                                                       <font color="black">1033</font>       if (y > this.viewHeight()) break;                                                                  </pre>
<pre>    <font color="black">1034</font>     }                                                                                                         <font color="black">1034</font>     }                                                                                                    </pre>
<pre>    <font color="black">1035</font>     for (let j = ci; j < cols.len; j += 1) {                                                                  <font color="black">1035</font>     for (let j = ci; j < cols.len; j += 1) {                                                             </pre>
<pre>    <font color="black">1036</font>       x += cols.getWidth(j);                                                                                  <font color="black">1036</font>       x += cols.getWidth(j);                                                                             </pre>
<pre>    <font color="black">1037</font>       eci = j;                                                                                                <font color="black">1037</font>       eci = j;                                                                                           </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>    <font color="black">1051</font>     const { rows } = this;                                                                                    <font color="black">1051</font>     const { rows } = this;                                                                               </pre>
<pre>    <font color="black">1052</font>     const frset = this.exceptRowSet;                                                                          <font color="black">1052</font>     const frset = this.exceptRowSet;                                                                     </pre>
<pre>    <font color="black">1053</font>     const frary = [...frset];                                                                                 <font color="black">1053</font>     const frary = [...frset];                                                                            </pre>
<pre>    <font color="black">1054</font>     let offset = 0;                                                                                           <font color="black">1054</font>     let offset = 0;                                                                                      </pre>
<pre>    <font color="black">1055</font>     for (let i = 0; i < frary.length; i += 1) {                                                               <font color="black">1055</font>     for (let i = 0; i < frary.length; i += 1) {                                                          </pre>
<pre>    <font color="black">1056</font>       if (frary[i] < min) <font color="orange">offset += 1;</font>                                                                        <font color="black">1056</font>       if (frary[i] < min) <font color="orange">{</font>                                                                              </pre>
<pre>                                                                                                                       <font color="black">1057</font> <font color="green">        offset += 1;</font>                                                                                     </pre>
<pre>                                                                                                                       <font color="black">1058</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>    <font color="black">1057</font>     }                                                                                                         <font color="black">1059</font>     }                                                                                                    </pre>
<pre>    <font color="black">1058</font>     // console.log('min:', min, ', max:', max, ', scroll:', scroll);                                          <font color="black">1060</font>     // console.log('min:', min, ', max:', max, ', scroll:', scroll);                                     </pre>
<pre>    <font color="black">1059</font>     for (let i = min + offset; i <= max + offset; i += 1) {                                                   <font color="black">1061</font>     for (let i = min + offset; i <= max + offset; i += 1) {                                              </pre>
<pre>    <font color="black">1060</font>       if (frset.has(i)) {                                                                                     <font color="black">1062</font>       if (frset.has(i)) {                                                                                </pre>
<pre>    <font color="black">1061</font>         offset += 1;                                                                                          <font color="black">1063</font>         offset += 1;                                                                                     </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>    <font color="black">1093</font>     styles.push(nstyle);                                                                                      <font color="black">1095</font>     styles.push(nstyle);                                                                                 </pre>
<pre>    <font color="black">1094</font>     return styles.length - 1;                                                                                 <font color="black">1096</font>     return styles.length - 1;                                                                            </pre>
<pre>    <font color="black">1095</font>   }                                                                                                           <font color="black">1097</font>   }                                                                                                      </pre>
<pre>    <font color="black">1096</font>                                                                                                               <font color="black">1098</font>                                                                                                          </pre>
<pre>    <font color="black">1097</font>   changeData(cb) {                                                                                            <font color="black">1099</font>   changeData(cb) {                                                                                       </pre>
<pre>    <font color="black">1098</font> <font color="red">//    console.log("***changeData");</font>                                                                                                                                                                                         </pre>
<pre>    <font color="black">1099</font>     this.history.add(this.getData());                                                                         <font color="black">1100</font>     this.history.add(this.getData());                                                                    </pre>
<pre>    <font color="black">1100</font>     cb();                                                                                                     <font color="black">1101</font>     cb();                                                                                                </pre>
<pre>    <font color="black">1101</font>     this.change(this.getData());                                                                              <font color="black">1102</font>     this.change(this.getData());                                                                         </pre>
<pre>    <font color="black">1102</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>    <font color="black">1103</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre>
<pre>    <font color="black">1104</font> <font color="red">    //splitSheets.length</font>                                                                                                                                                                                                    </pre>
<pre>    <font color="black">1105</font> <font color="red">    this.v_splitSheets.forEach(function(sheet) {</font>                                                                                                                                                                            </pre>
<pre>    <font color="black">1106</font> <font color="red">      sheet.sync();</font>                                                                                                                                                                                                         </pre>
<pre>    <font color="black">1107</font> <font color="red">    });</font>                                                                                                                                                                                                                     </pre>
<pre>    <font color="black">1108</font> <font color="red">    this.h_splitSheets.forEach(function(sheet) {</font>                                                                                                                                                                            </pre>
<pre>    <font color="black">1109</font> <font color="red">      sheet.sync();</font>                                                                                                                                                                                                         </pre>
<pre>    <font color="black">1110</font> <font color="red">    });</font>                                                                                                                                                                                                                     </pre>
<pre>    <font color="black">1111</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre>
<pre>    <font color="black">1112</font>   }                                                                                                           <font color="black">1103</font>   }                                                                                                      </pre>
<pre>    <font color="black">1113</font>                                                                                                               <font color="black">1104</font>                                                                                                          </pre>
<pre>    <font color="black">1114</font>   setData(d) {                                                                                                <font color="black">1105</font>   setData(d) {                                                                                           </pre>
<pre>    <font color="black">1115</font> <font color="red">//    console.log("***setData");</font>                                                                                                                                                                                            </pre>
<pre>    <font color="black">1116</font>     Object.keys(d).forEach((property) => {                                                                    <font color="black">1106</font>     Object.keys(d).forEach((property) => {                                                               </pre>
<pre>    <font color="black">1117</font>       if (property === 'merges' || property === 'rows'                                                        <font color="black">1107</font>       if (property === 'merges' || property === 'rows'                                                   </pre>
<pre>    <font color="black">1118</font>         || property === 'cols' || property === 'validations'                                                  <font color="black">1108</font>         || property === 'cols' || property === 'validations'<font color="green">) {</font>                                          </pre>
<pre>    <font color="black">1119</font> <font color="red">         || property === 'shapes' </font>                                                                                                                                                                                          </pre>
<pre>    <font color="black">1120</font> <font color="red">      ) {</font>                                                                                                                                                                                                                   </pre>
<pre>    <font color="black">1121</font>         this[property].setData(d[property]);                                                                  <font color="black">1109</font>         this[property].setData(d[property]);                                                             </pre>
<pre>    <font color="black">1122</font>       } else if (property === 'freeze') {                                                                     <font color="black">1110</font>       } else if (property === 'freeze') {                                                                </pre>
<pre>    <font color="black">1123</font>         const [x, y] = expr2xy(d[property]);                                                                  <font color="black">1111</font>         const [x, y] = expr2xy(d[property]);                                                             </pre>
<pre>    <font color="black">1124</font>         this.freeze = [y, x];                                                                                 <font color="black">1112</font>         this.freeze = [y, x];                                                                            </pre>
<pre>    <font color="black">1125</font>       } else if (d[property] !== undefined) {                                                                 <font color="black">1113</font>       } else if (d[property] !== undefined) {                                                            </pre>
<pre>    <font color="black">1126</font>         this[property] = d[property];                                                                         <font color="black">1114</font>         this[property] = d[property];                                                                    </pre>
<pre>    <font color="black">1127</font>       }                                                                                                       <font color="black">1115</font>       }                                                                                                  </pre>
<pre>    <font color="black">1128</font>     });                                                                                                       <font color="black">1116</font>     });                                                                                                  </pre>
<pre>    <font color="black">1129</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>    <font color="black">1130</font> <font color="red">//   console.log(this['cols'].getData()) ;</font>                                                                                                                                                                                  </pre>
<pre>    <font color="black">1131</font> <font color="red">//   let c = this['cols'].getData();</font>                                                                                                                                                                                        </pre>
<pre>    <font color="black">1132</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre>
<pre>    <font color="black">1133</font> <font color="red">   if  (!(c.[])) {</font>                                                                                                                                                                                                          </pre>
<pre>    <font color="black">1134</font> <font color="red">        console.log("col setdata ok");</font>                                                                                                                                                                                      </pre>
<pre>    <font color="black">1135</font> <font color="red">  //      const d = this['cols'].getData();</font>                                                                                                                                                                                 </pre>
<pre>    <font color="black">1136</font> <font color="red">  //       Object.assign([{width: 100}], d);</font>                                                                                                                                                                                </pre>
<pre>    <font color="black">1137</font> <font color="red">  //      this['cols'].setData(d);</font>                                                                                                                                                                                          </pre>
<pre>    <font color="black">1138</font> <font color="red">   }  else {</font>                                                                                                                                                                                                                </pre>
<pre>    <font color="black">1139</font> <font color="red">        console.log("col setdata ng");</font>                                                                                                                                                                                      </pre>
<pre>    <font color="black">1140</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>    <font color="black">1141</font> <font color="red">   }</font>                                                                                                                                                                                                                        </pre>
<pre>    <font color="black">1142</font> <font color="red">  */ </font>                                                                                                                                                                                                                       </pre>
<pre>    <font color="black">1143</font>     return this;                                                                                              <font color="black">1117</font>     return this;                                                                                         </pre>
<pre>    <font color="black">1144</font>   }                                                                                                           <font color="black">1118</font>   }                                                                                                      </pre>
<pre>    <font color="black">1145</font>                                                                                                               <font color="black">1119</font>                                                                                                          </pre>
<pre>    <font color="black">1146</font>   getData() {                                                                                                 <font color="black">1120</font>   getData() {                                                                                            </pre>
<pre>    <font color="black">1147</font>     const {                                                                                                   <font color="black">1121</font>     const {                                                                                              </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>    <font color="black">1156</font>       cols: cols.getData(),                                                                                   <font color="black">1130</font>       cols: cols.getData(),                                                                              </pre>
<pre>    <font color="black">1157</font>       validations: validations.getData(),                                                                     <font color="black">1131</font>       validations: validations.getData(),                                                                </pre>
<pre>    <font color="black">1158</font>       autofilter: autoFilter.getData(),                                                                       <font color="black">1132</font>       autofilter: autoFilter.getData(),                                                                  </pre>
<pre>    <font color="black">1159</font>     };                                                                                                        <font color="black">1133</font>     };                                                                                                   </pre>
<pre>    <font color="black">1160</font>   }                                                                                                           <font color="black">1134</font>   }                                                                                                      </pre>
<pre>    <font color="black">1161</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>    <font color="black">1162</font> <font color="red">  horizontalAddSplitSheet(seet){ //GUSA</font>                                                                                                                                                                                     </pre>
<pre>    <font color="black">1163</font> <font color="red">     const {</font>                                                                                                                                                                                                                </pre>
<pre>    <font color="black">1164</font> <font color="red">       h_splitSheets,</font>                                                                                                                                                                                                       </pre>
<pre>    <font color="black">1165</font> <font color="red">     } = this;</font>                                                                                                                                                                                                              </pre>
<pre>    <font color="black">1166</font> <font color="red">     h_splitSheets.push(seet);</font>                                                                                                                                                                                              </pre>
<pre>    <font color="black">1167</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre>
<pre>    <font color="black">1168</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>    <font color="black">1169</font> <font color="red">  verticalAddSplitSheet(seet){ //GUSA</font>                                                                                                                                                                                       </pre>
<pre>    <font color="black">1170</font> <font color="red">     const {</font>                                                                                                                                                                                                                </pre>
<pre>    <font color="black">1171</font> <font color="red">       v_splitSheets,</font>                                                                                                                                                                                                       </pre>
<pre>    <font color="black">1172</font> <font color="red">     } = this;</font>                                                                                                                                                                                                              </pre>
<pre>    <font color="black">1173</font> <font color="red">     v_splitSheets.push(seet);</font>                                                                                                                                                                                              </pre>
<pre>    <font color="black">1174</font> <font color="red">//     console.log("addSplitSheet: ", splitSheets.length);</font>                                                                                                                                                                  </pre>
<pre>    <font color="black">1175</font> <font color="red">  };</font>                                                                                                                                                                                                                        </pre>
<pre>    <font color="black">1176</font> }                                                                                                             <font color="black">1135</font> }                                                                                                        </pre>
<pre><font color="blue">../src/core/font.js</font>                                                                                                <font color="blue">../../x-spreadsheet/src/core/font.js</font>                                                                              </pre>
<pre>                                                                                                                          <font color="black">1</font> <font color="green">// docs</font>                                                                                                  </pre>
<pre>                                                                                                                          <font color="black">2</font> <font color="green">import './_.prototypes';</font>                                                                                 </pre>
<pre>                                                                                                                          <font color="black">3</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                          <font color="black">4</font> <font color="green">/** default font list</font>                                                                                    </pre>
<pre>                                                                                                                          <font color="black">5</font> <font color="green"> * @type {BaseFont[]}</font>                                                                                    </pre>
<pre>                                                                                                                          <font color="black">6</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>       <font color="black">1</font> const baseFonts = [                                                                                              <font color="black">7</font> const baseFonts = [                                                                                      </pre>
<pre>       <font color="black">2</font>   { key: 'Arial', title: 'Arial' },                                                                              <font color="black">8</font>   { key: 'Arial', title: 'Arial' },                                                                      </pre>
<pre>       <font color="black">3</font>   { key: 'Helvetica', title: 'Helvetica' },                                                                      <font color="black">9</font>   { key: 'Helvetica', title: 'Helvetica' },                                                              </pre>
<pre>       <font color="black">4</font>   { key: 'Source Sans Pro', title: 'Source Sans Pro' },                                                         <font color="black">10</font>   { key: 'Source Sans Pro', title: 'Source Sans Pro' },                                                  </pre>
<pre>       <font color="black">5</font>   { key: 'Comic Sans MS', title: 'Comic Sans MS' },                                                             <font color="black">11</font>   { key: 'Comic Sans MS', title: 'Comic Sans MS' },                                                      </pre>
<pre>       <font color="black">6</font>   { key: 'Courier New', title: 'Courier New' },                                                                 <font color="black">12</font>   { key: 'Courier New', title: 'Courier New' },                                                          </pre>
<pre>       <font color="black">7</font>   { key: 'Verdana', title: 'Verdana' },                                                                         <font color="black">13</font>   { key: 'Verdana', title: 'Verdana' },                                                                  </pre>
<pre>       <font color="black">8</font>   { key: 'Lato', title: 'Lato' },                                                                               <font color="black">14</font>   { key: 'Lato', title: 'Lato' },                                                                        </pre>
<pre>       <font color="black">9</font> ];                                                                                                              <font color="black">15</font> ];                                                                                                       </pre>
<pre>      <font color="black">10</font>                                                                                                                 <font color="black">16</font>                                                                                                          </pre>
<pre>                                                                                                                         <font color="black">17</font> <font color="green">/** default fontSize list</font>                                                                                </pre>
<pre>                                                                                                                         <font color="black">18</font> <font color="green"> * @type {FontSize[]}</font>                                                                                    </pre>
<pre>                                                                                                                         <font color="black">19</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>      <font color="black">11</font> const fontSizes = [                                                                                             <font color="black">20</font> const fontSizes = [                                                                                      </pre>
<pre>      <font color="black">12</font>   { pt: 7.5, px: 10 },                                                                                          <font color="black">21</font>   { pt: 7.5, px: 10 },                                                                                   </pre>
<pre>      <font color="black">13</font>   { pt: 8, px: 11 },                                                                                            <font color="black">22</font>   { pt: 8, px: 11 },                                                                                     </pre>
<pre>      <font color="black">14</font>   { pt: 9, px: 12 },                                                                                            <font color="black">23</font>   { pt: 9, px: 12 },                                                                                     </pre>
<pre>      <font color="black">15</font>   { pt: 10, px: 13 },                                                                                           <font color="black">24</font>   { pt: 10, px: 13 },                                                                                    </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">28</font>   // { pt: 54, px: 71.7 },                                                                                      <font color="black">37</font>   // { pt: 54, px: 71.7 },                                                                               </pre>
<pre>      <font color="black">29</font>   // { pt: 63, px: 83.7 },                                                                                      <font color="black">38</font>   // { pt: 63, px: 83.7 },                                                                               </pre>
<pre>      <font color="black">30</font>   // { pt: 72, px: 95.6 },                                                                                      <font color="black">39</font>   // { pt: 72, px: 95.6 },                                                                               </pre>
<pre>      <font color="black">31</font> ];                                                                                                              <font color="black">40</font> ];                                                                                                       </pre>
<pre>      <font color="black">32</font>                                                                                                                 <font color="black">41</font>                                                                                                          </pre>
<pre>                                                                                                                         <font color="black">42</font> <font color="green">/** map pt to px</font>                                                                                         </pre>
<pre>                                                                                                                         <font color="black">43</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">44</font> <font color="green"> * @param {fontsizePT} pt</font>                                                                                </pre>
<pre>                                                                                                                         <font color="black">45</font> <font color="green"> * @returns {fontsizePX}</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">46</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>      <font color="black">33</font> function getFontSizePxByPt(pt) {                                                                                <font color="black">47</font> function getFontSizePxByPt(pt) {                                                                         </pre>
<pre>      <font color="black">34</font>   for (let i = 0; i < fontSizes.length; i += 1) {                                                               <font color="black">48</font>   for (let i = 0; i < fontSizes.length; i += 1) {                                                        </pre>
<pre>      <font color="black">35</font>     const fontSize = fontSizes[i];                                                                              <font color="black">49</font>     const fontSize = fontSizes[i];                                                                       </pre>
<pre>      <font color="black">36</font>     if (fontSize.pt === pt) {                                                                                   <font color="black">50</font>     if (fontSize.pt === pt) {                                                                            </pre>
<pre>      <font color="black">37</font>       return fontSize.px;                                                                                       <font color="black">51</font>       return fontSize.px;                                                                                </pre>
<pre>      <font color="black">38</font>     }                                                                                                           <font color="black">52</font>     }                                                                                                    </pre>
<pre>      <font color="black">39</font>   }                                                                                                             <font color="black">53</font>   }                                                                                                      </pre>
<pre>      <font color="black">40</font>   return pt;                                                                                                    <font color="black">54</font>   return pt;                                                                                             </pre>
<pre>      <font color="black">41</font> }                                                                                                               <font color="black">55</font> }                                                                                                        </pre>
<pre>      <font color="black">42</font>                                                                                                                 <font color="black">56</font>                                                                                                          </pre>
<pre>                                                                                                                         <font color="black">57</font> <font color="green">/** transform baseFonts to map</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">58</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">59</font> <font color="green"> * @param {BaseFont[]} [ary=[]]</font>                                                                          </pre>
<pre>                                                                                                                         <font color="black">60</font> <font color="green"> * @returns {object}</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">61</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>      <font color="black">43</font> con<font color="red">st</font> fonts<font color="red"> = </font>(ary = []) <font color="red">=> </font>{                                                                                   <font color="black">62</font> <font color="green">fun</font>c<font color="green">ti</font>on fonts(ary = []) {                                                                               </pre>
<pre>      <font color="black">44</font>   const map = {};                                                                                               <font color="black">63</font>   const map = {};                                                                                        </pre>
<pre>      <font color="black">45</font>   baseFonts.concat(ary).forEach((f) => {                                                                        <font color="black">64</font>   baseFonts.concat(ary).forEach((f) => {                                                                 </pre>
<pre>      <font color="black">46</font>     map[f.key] = f;                                                                                             <font color="black">65</font>     map[f.key] = f;                                                                                      </pre>
<pre>      <font color="black">47</font>   });                                                                                                           <font color="black">66</font>   });                                                                                                    </pre>
<pre>      <font color="black">48</font>   return map;                                                                                                   <font color="black">67</font>   return map;                                                                                            </pre>
<pre>      <font color="black">49</font> <font color="red">};</font>                                                                                                              <font color="black">68</font> <font color="green">}</font>                                                                                                        </pre>
<pre>      <font color="black">50</font>                                                                                                                 <font color="black">69</font>                                                                                                          </pre>
<pre>      <font color="black">51</font> export default {};                                                                                              <font color="black">70</font> export default {};                                                                                       </pre>
<pre>      <font color="black">52</font> export {                                                                                                        <font color="black">71</font> export {                                                                                                 </pre>
<pre>      <font color="black">53</font>   fontSizes,                                                                                                    <font color="black">72</font>   fontSizes,                                                                                             </pre>
<pre>      <font color="black">54</font>   fonts,                                                                                                        <font color="black">73</font>   fonts,                                                                                                 </pre>
<pre><font color="blue">../src/core/history.js</font>                                                                                             <font color="blue">../../x-spreadsheet/src/core/history.js</font>                                                                           </pre>
<pre>       <font color="black">7</font>   }                                                                                                              <font color="black">7</font>   }                                                                                                      </pre>
<pre>       <font color="black">8</font>                                                                                                                  <font color="black">8</font>                                                                                                          </pre>
<pre>       <font color="black">9</font>   add(data) {                                                                                                    <font color="black">9</font>   add(data) {                                                                                            </pre>
<pre>      <font color="black">10</font>     this.undoItems.push(JSON.stringify(data));                                                                  <font color="black">10</font>     this.undoItems.push(JSON.stringify(data));                                                           </pre>
<pre>      <font color="black">11</font>     this.redoItems = [];                                                                                        <font color="black">11</font>     this.redoItems = [];                                                                                 </pre>
<pre>      <font color="black">12</font> <font color="red">    //console.log("histry add");</font>                                                                                                                                                                                            </pre>
<pre>      <font color="black">13</font>   }                                                                                                             <font color="black">12</font>   }                                                                                                      </pre>
<pre>      <font color="black">14</font>                                                                                                                 <font color="black">13</font>                                                                                                          </pre>
<pre>      <font color="black">15</font>   canUndo() {                                                                                                   <font color="black">14</font>   canUndo() {                                                                                            </pre>
<pre>      <font color="black">16</font>     return this.undoItems.length > 0;                                                                           <font color="black">15</font>     return this.undoItems.length > 0;                                                                    </pre>
<pre>      <font color="black">17</font>   }                                                                                                             <font color="black">16</font>   }                                                                                                      </pre>
<pre><font color="blue">../src/core/formula.js</font>                                                                                             <font color="blue">../../x-spreadsheet/src/core/formula.js</font>                                                                           </pre>
<pre>       <font color="black">2</font>   formula:                                                                                                       <font color="black">2</font>   formula:                                                                                               </pre>
<pre>       <font color="black">3</font>     key                                                                                                          <font color="black">3</font>     key                                                                                                  </pre>
<pre>       <font color="black">4</font>     title                                                                                                        <font color="black">4</font>     title                                                                                                </pre>
<pre>       <font color="black">5</font>     render                                                                                                       <font color="black">5</font>     render                                                                                               </pre>
<pre>       <font color="black">6</font> */                                                                                                               <font color="black">6</font> */                                                                                                       </pre>
<pre>                                                                                                                          <font color="black">7</font> <font color="green">/**</font>                                                                                                      </pre>
<pre>                                                                                                                          <font color="black">8</font> <font color="green"> * @typedef {object} Formula</font>                                                                             </pre>
<pre>                                                                                                                          <font color="black">9</font> <font color="green"> * @property {string} key</font>                                                                                </pre>
<pre>                                                                                                                         <font color="black">10</font> <font color="green"> * @property {function} title</font>                                                                            </pre>
<pre>                                                                                                                         <font color="black">11</font> <font color="green"> * @property {function} render</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">12</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>       <font color="black">7</font> import { tf } from '../locale/locale';                                                                          <font color="black">13</font> import { tf } from '../locale/locale';                                                                   </pre>
<pre>       <font color="black">8</font>                                                                                                                 <font color="black">14</font>                                                                                                          </pre>
<pre>                                                                                                                         <font color="black">15</font> <font color="green">/** @type {Formula[]} */</font>                                                                                 </pre>
<pre>       <font color="black">9</font> const baseFormulas = [                                                                                          <font color="black">16</font> const baseFormulas = [                                                                                   </pre>
<pre>      <font color="black">10</font>   {                                                                                                             <font color="black">17</font>   {                                                                                                      </pre>
<pre>      <font color="black">11</font>     key: 'SUM',                                                                                                 <font color="black">18</font>     key: 'SUM',                                                                                          </pre>
<pre>      <font color="black">12</font>     title: tf('formula.sum'),                                                                                   <font color="black">19</font>     title: tf('formula.sum'),                                                                            </pre>
<pre>      <font color="black">13</font>     render: ary => ary.reduce((a, b) => Number(a) + Number(b), 0),                                              <font color="black">20</font>     render: ary => ary.reduce((a, b) => Number(a) + Number(b), 0),                                       </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">26</font>     key: 'MIN',                                                                                                 <font color="black">33</font>     key: 'MIN',                                                                                          </pre>
<pre>      <font color="black">27</font>     title: tf('formula.min'),                                                                                   <font color="black">34</font>     title: tf('formula.min'),                                                                            </pre>
<pre>      <font color="black">28</font>     render: ary => Math.min(...ary.map(v => Number(v))),                                                        <font color="black">35</font>     render: ary => Math.min(...ary.map(v => Number(v))),                                                 </pre>
<pre>      <font color="black">29</font>   },                                                                                                            <font color="black">36</font>   },                                                                                                     </pre>
<pre>      <font color="black">30</font>   {                                                                                                             <font color="black">37</font>   {                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">38</font> <font color="green">    key: 'IF',</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">39</font> <font color="green">    title: tf('formula._if'),</font>                                                                            </pre>
<pre>                                                                                                                         <font color="black">40</font> <font color="green">    render: ([b, t, f]) => (b ? t : f),</font>                                                                  </pre>
<pre>                                                                                                                         <font color="black">41</font> <font color="green">  },</font>                                                                                                     </pre>
<pre>                                                                                                                         <font color="black">42</font> <font color="green">  {</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">43</font> <font color="green">    key: 'AND',</font>                                                                                          </pre>
<pre>                                                                                                                         <font color="black">44</font> <font color="green">    title: tf('formula.and'),</font>                                                                            </pre>
<pre>                                                                                                                         <font color="black">45</font> <font color="green">    render: ary => ary.every(it => it),</font>                                                                  </pre>
<pre>                                                                                                                         <font color="black">46</font> <font color="green">  },</font>                                                                                                     </pre>
<pre>                                                                                                                         <font color="black">47</font> <font color="green">  {</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">48</font> <font color="green">    key: 'OR',</font>                                                                                           </pre>
<pre>                                                                                                                         <font color="black">49</font> <font color="green">    title: tf('formula.or'),</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">50</font> <font color="green">    render: ary => ary.some(it => it),</font>                                                                   </pre>
<pre>                                                                                                                         <font color="black">51</font> <font color="green">  },</font>                                                                                                     </pre>
<pre>                                                                                                                         <font color="black">52</font> <font color="green">  {</font>                                                                                                      </pre>
<pre>      <font color="black">31</font>     key: 'CONCAT',                                                                                              <font color="black">53</font>     key: 'CONCAT',                                                                                       </pre>
<pre>      <font color="black">32</font>     title: tf('formula.concat'),                                                                                <font color="black">54</font>     title: tf('formula.concat'),                                                                         </pre>
<pre>      <font color="black">33</font>     render: ary => ary.join(''),                                                                                <font color="black">55</font>     render: ary => ary.join(''),                                                                         </pre>
<pre>      <font color="black">34</font>   },                                                                                                            <font color="black">56</font>   },                                                                                                     </pre>
<pre>                                                                                                                         <font color="black">57</font> <font color="green">  /* support:  1 + A1 + B2 * 3</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">58</font> <font color="green">  {</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">59</font> <font color="green">    key: 'DIVIDE',</font>                                                                                       </pre>
<pre>                                                                                                                         <font color="black">60</font> <font color="green">    title: tf('formula.divide'),</font>                                                                         </pre>
<pre>                                                                                                                         <font color="black">61</font> <font color="green">    render: ary => ary.reduce((a, b) => Number(a) / Number(b)),</font>                                          </pre>
<pre>                                                                                                                         <font color="black">62</font> <font color="green">  },</font>                                                                                                     </pre>
<pre>                                                                                                                         <font color="black">63</font> <font color="green">  {</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">64</font> <font color="green">    key: 'PRODUCT',</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">65</font> <font color="green">    title: tf('formula.product'),</font>                                                                        </pre>
<pre>                                                                                                                         <font color="black">66</font> <font color="green">    render: ary => ary.reduce((a, b) => Number(a) * Number(b),1),</font>                                        </pre>
<pre>                                                                                                                         <font color="black">67</font> <font color="green">  },</font>                                                                                                     </pre>
<pre>                                                                                                                         <font color="black">68</font> <font color="green">  {</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">69</font> <font color="green">    key: 'SUBTRACT',</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">70</font> <font color="green">    title: tf('formula.subtract'),</font>                                                                       </pre>
<pre>                                                                                                                         <font color="black">71</font> <font color="green">    render: ary => ary.reduce((a, b) => Number(a) - Number(b)),</font>                                          </pre>
<pre>                                                                                                                         <font color="black">72</font> <font color="green">  },</font>                                                                                                     </pre>
<pre>                                                                                                                         <font color="black">73</font> <font color="green">  */</font>                                                                                                     </pre>
<pre>      <font color="black">35</font> ];                                                                                                              <font color="black">74</font> ];                                                                                                       </pre>
<pre>      <font color="black">36</font>                                                                                                                 <font color="black">75</font>                                                                                                          </pre>
<pre>      <font color="black">37</font> const formulas = baseFormulas;                                                                                  <font color="black">76</font> const formulas = baseFormulas;                                                                           </pre>
<pre>      <font color="black">38</font>                                                                                                                 <font color="black">77</font>                                                                                                          </pre>
<pre>      <font color="black">39</font> // const formulas = (formulaAry = []) => {                                                                      <font color="black">78</font> // const formulas = (formulaAry = []) => {                                                               </pre>
<pre><font color="blue">../src/core/row.js</font>                                                                                                 <font color="blue">../../x-spreadsheet/src/core/row.js</font>                                                                               </pre>
<pre>      <font color="black">16</font>     }                                                                                                           <font color="black">16</font>     }                                                                                                    </pre>
<pre>      <font color="black">17</font>     return this.height;                                                                                         <font color="black">17</font>     return this.height;                                                                                  </pre>
<pre>      <font color="black">18</font>   }                                                                                                             <font color="black">18</font>   }                                                                                                      </pre>
<pre>      <font color="black">19</font>                                                                                                                 <font color="black">19</font>                                                                                                          </pre>
<pre>      <font color="black">20</font>   setHeight(ri, v) {                                                                                            <font color="black">20</font>   setHeight(ri, v) {                                                                                     </pre>
<pre>      <font color="black">21</font> <font color="red">//    console.log("row setHeight");</font>                                                                                                                                                                                         </pre>
<pre>      <font color="black">22</font>     const row = this.getOrNew(ri);                                                                              <font color="black">21</font>     const row = this.getOrNew(ri);                                                                       </pre>
<pre>      <font color="black">23</font>     row.height = v;                                                                                             <font color="black">22</font>     row.height = v;                                                                                      </pre>
<pre>      <font color="black">24</font>   }                                                                                                             <font color="black">23</font>   }                                                                                                      </pre>
<pre>      <font color="black">25</font>                                                                                                                 <font color="black">24</font>                                                                                                          </pre>
<pre>      <font color="black">26</font>   setStyle(ri, style) {                                                                                         <font color="black">25</font>   setStyle(ri, style) {                                                                                  </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">105</font>     if (deri < sri || deci < sci) {                                                                            <font color="black">104</font>     if (deri < sri || deci < sci) {                                                                      </pre>
<pre>     <font color="black">106</font>       isAdd = false;                                                                                           <font color="black">105</font>       isAdd = false;                                                                                     </pre>
<pre>     <font color="black">107</font>       if (deri < sri) dn = drn;                                                                                <font color="black">106</font>       if (deri < sri) dn = drn;                                                                          </pre>
<pre>     <font color="black">108</font>       else dn = dcn;                                                                                           <font color="black">107</font>       else dn = dcn;                                                                                     </pre>
<pre>     <font color="black">109</font>     }                                                                                                          <font color="black">108</font>     }                                                                                                    </pre>
<pre>     <font color="black">110</font>     // console.log('drn:', drn, ', dcn:', dcn);                                                                <font color="black">109</font>     // console.log('drn:', drn, ', dcn:', dcn<font color="green">, dn, isAdd</font>);                                               </pre>
<pre>     <font color="black">111</font>     for (let i = sri; i <= eri; i += 1) {                                                                      <font color="black">110</font>     for (let i = sri; i <= eri; i += 1) {                                                                </pre>
<pre>     <font color="black">112</font>       if (this._[i]) {                                                                                         <font color="black">111</font>       if (this._[i]) {                                                                                   </pre>
<pre>     <font color="black">113</font>         for (let j = sci; j <= eci; j += 1) {                                                                  <font color="black">112</font>         for (let j = sci; j <= eci; j += 1) {                                                            </pre>
<pre>     <font color="black">114</font>           if (this._[i].cells && this._[i].cells[j]) {                                                         <font color="black">113</font>           if (this._[i].cells && this._[i].cells[j]) {                                                   </pre>
<pre>     <font color="black">115</font>             for (let ii = dsri; ii <= deri; ii += rn) {                                                        <font color="black">114</font>             for (let ii = dsri; ii <= deri; ii += rn) {                                                  </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">118</font>                 const nci = jj + (j - sci);                                                                    <font color="black">117</font>                 const nci = jj + (j - sci);                                                              </pre>
<pre>     <font color="black">119</font>                 const ncell = helper.cloneDeep(this._[i].cells[j]);                                            <font color="black">118</font>                 const ncell = helper.cloneDeep(this._[i].cells[j]);                                      </pre>
<pre>     <font color="black">120</font>                 // ncell.text                                                                                  <font color="black">119</font>                 // ncell.text                                                                            </pre>
<pre>     <font color="black">121</font>                 if (autofill && ncell && ncell.text && ncell.text.length > 0) {                                <font color="black">120</font>                 if (autofill && ncell && ncell.text && ncell.text.length > 0) {                          </pre>
<pre>     <font color="black">122</font>                   const { text } = ncell;                                                                      <font color="black">121</font>                   const { text } = ncell;                                                                </pre>
<pre>     <font color="black">123</font>                   let n = (jj - dsci) + (ii - dsri) + <font color="orange">1</font>;                                                       <font color="black">122</font>                   let n = (jj - dsci) + (ii - dsri) + <font color="orange">2</font>;                                                 </pre>
<pre>     <font color="black">124</font> <font color="red">                  // console.log('n:', n);</font>                                                                                                                                                                                  </pre>
<pre>     <font color="black">125</font>                   if (!isAdd) {                                                                                <font color="black">123</font>                   if (!isAdd) {                                                                          </pre>
<pre>     <font color="black">126</font>                     n -= dn + 1;                                                                               <font color="black">124</font>                     n -= dn + 1;                                                                         </pre>
<pre>     <font color="black">127</font>                   }                                                                                            <font color="black">125</font>                   }                                                                                      </pre>
<pre>     <font color="black">128</font>                   if (text[0] === '=') {                                                                       <font color="black">126</font>                   if (text[0] === '=') {                                                                 </pre>
<pre>     <font color="black">129</font>                     ncell.text = text.replace(/\w{1,3}\d/g, (word) => {                                        <font color="black">127</font>                     ncell.text = text.replace(/\w{1,3}\d/g, (word) => {                                  </pre>
<pre>     <font color="black">130</font>                       let [xn, yn] = [0, 0];                                                                   <font color="black">128</font>                       let [xn, yn] = [0, 0];                                                             </pre>
<pre>     <font color="black">131</font>                       if (sri === dsri) {                                                                      <font color="black">129</font>                       if (sri === dsri) {                                                                </pre>
<pre>     <font color="black">132</font>                         xn = n;                                                                                <font color="black">130</font>                         xn = n<font color="green"> - 1</font>;                                                                      </pre>
<pre>                                                                                                                        <font color="black">131</font> <font color="green">                        // if (isAdd) xn -= 1;</font>                                                           </pre>
<pre>     <font color="black">133</font>                       } else {                                                                                 <font color="black">132</font>                       } else {                                                                           </pre>
<pre>     <font color="black">134</font>                         yn = n;                                                                                <font color="black">133</font>                         yn = n<font color="green"> - 1</font>;                                                                      </pre>
<pre>     <font color="black">135</font>                       }                                                                                        <font color="black">134</font>                       }                                                                                  </pre>
<pre>     <font color="black">136</font>                       // console.log('xn:', xn, ', yn:', yn, expr2expr(word, xn, yn));                         <font color="black">135</font>                       // console.log('xn:', xn, ', yn:', yn,<font color="green"> word,</font> expr2expr(word, xn, yn));             </pre>
<pre>     <font color="black">137</font>                       return expr2expr(word, xn, yn);                                                          <font color="black">136</font>                       return expr2expr(word, xn, yn);                                                    </pre>
<pre>     <font color="black">138</font>                     });                                                                                        <font color="black">137</font>                     });                                                                                  </pre>
<pre>     <font color="black">139</font>                   } else {                                                                                     <font color="black">138</font>                   } else {                                                                               </pre>
<pre>     <font color="black">140</font>                     const result = /[\\.\d]+$/.exec(text);                                                     <font color="black">139</font>                     const result = /[\\.\d]+$/.exec(text);                                               </pre>
<pre>     <font color="black">141</font>                     // console.log('result:', result);                                                         <font color="black">140</font>                     // console.log('result:', result);                                                   </pre>
<pre>     <font color="black">142</font>                     if (result !== null) {                                                                     <font color="black">141</font>                     if (result !== null) {                                                               </pre>
<pre>     <font color="black">143</font>                       const index = Number(result[0]) + n;                                                     <font color="black">142</font>                       const index = Number(result[0]) + n<font color="green"> - 1</font>;                                           </pre>
<pre>     <font color="black">144</font>                       ncell.text = text.substring(0, result.index) + index;                                    <font color="black">143</font>                       ncell.text = text.substring(0, result.index) + index;                              </pre>
<pre>     <font color="black">145</font>                     }                                                                                          <font color="black">144</font>                     }                                                                                    </pre>
<pre>     <font color="black">146</font>                   }                                                                                            <font color="black">145</font>                   }                                                                                      </pre>
<pre>     <font color="black">147</font>                 }                                                                                              <font color="black">146</font>                 }                                                                                        </pre>
<pre>     <font color="black">148</font>                 // console.log('ncell:', nri, nci, ncell);                                                     <font color="black">147</font>                 // console.log('ncell:', nri, nci, ncell);                                               </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">169</font>         ncellmm[nri] = ncellmm[nri] || { cells: {} };                                                          <font color="black">168</font>         ncellmm[nri] = ncellmm[nri] || { cells: {} };                                                    </pre>
<pre>     <font color="black">170</font>         ncellmm[nri].cells[nci] = this._[ri].cells[ci];                                                        <font color="black">169</font>         ncellmm[nri].cells[nci] = this._[ri].cells[ci];                                                  </pre>
<pre>     <font color="black">171</font>       });                                                                                                      <font color="black">170</font>       });                                                                                                </pre>
<pre>     <font color="black">172</font>     });                                                                                                        <font color="black">171</font>     });                                                                                                  </pre>
<pre>     <font color="black">173</font>     this._ = ncellmm;                                                                                          <font color="black">172</font>     this._ = ncellmm;                                                                                    </pre>
<pre>                                                                                                                        <font color="black">173</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">174</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                        <font color="black">175</font> <font color="green">  // src: Array<Array<String>></font>                                                                           </pre>
<pre>                                                                                                                        <font color="black">176</font> <font color="green">  paste(src, dstCellRange) {</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">177</font> <font color="green">    if (src.length <= 0) return;</font>                                                                         </pre>
<pre>                                                                                                                        <font color="black">178</font> <font color="green">    const { sri, sci } = dstCellRange;</font>                                                                   </pre>
<pre>                                                                                                                        <font color="black">179</font> <font color="green">    src.forEach((row, i) => {</font>                                                                            </pre>
<pre>                                                                                                                        <font color="black">180</font> <font color="green">      const ri = sri + i;</font>                                                                                </pre>
<pre>                                                                                                                        <font color="black">181</font> <font color="green">      row.forEach((cell, j) => {</font>                                                                         </pre>
<pre>                                                                                                                        <font color="black">182</font> <font color="green">        const ci = sci + j;</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">183</font> <font color="green">        this.setCellText(ri, ci, cell);</font>                                                                  </pre>
<pre>                                                                                                                        <font color="black">184</font> <font color="green">      });</font>                                                                                                </pre>
<pre>                                                                                                                        <font color="black">185</font> <font color="green">    });</font>                                                                                                  </pre>
<pre>     <font color="black">174</font>   }                                                                                                            <font color="black">186</font>   }                                                                                                      </pre>
<pre>     <font color="black">175</font>                                                                                                                <font color="black">187</font>                                                                                                          </pre>
<pre>     <font color="black">176</font>   insert(sri, n = 1) {                                                                                         <font color="black">188</font>   insert(sri, n = 1) {                                                                                   </pre>
<pre>     <font color="black">177</font>     const ndata = {};                                                                                          <font color="black">189</font>     const ndata = {};                                                                                    </pre>
<pre>     <font color="black">178</font>     this.each((ri, row) => {                                                                                   <font color="black">190</font>     this.each((ri, row) => {                                                                             </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">257</font>         }                                                                                                      <font color="black">269</font>         }                                                                                                </pre>
<pre>     <font color="black">258</font>       }                                                                                                        <font color="black">270</font>       }                                                                                                  </pre>
<pre>     <font color="black">259</font>     }                                                                                                          <font color="black">271</font>     }                                                                                                    </pre>
<pre>     <font color="black">260</font>   }                                                                                                            <font color="black">272</font>   }                                                                                                      </pre>
<pre>     <font color="black">261</font>                                                                                                                <font color="black">273</font>                                                                                                          </pre>
<pre>                                                                                                                        <font color="black">274</font> <font color="green">  maxCell() {</font>                                                                                            </pre>
<pre>                                                                                                                        <font color="black">275</font> <font color="green">    const keys = Object.keys(this._);</font>                                                                    </pre>
<pre>                                                                                                                        <font color="black">276</font> <font color="green">    const ri = keys[keys.length - 1];</font>                                                                    </pre>
<pre>                                                                                                                        <font color="black">277</font> <font color="green">    const col = this._[ri];</font>                                                                              </pre>
<pre>                                                                                                                        <font color="black">278</font> <font color="green">    if (col) {</font>                                                                                           </pre>
<pre>                                                                                                                        <font color="black">279</font> <font color="green">      const { cells } = col;</font>                                                                             </pre>
<pre>                                                                                                                        <font color="black">280</font> <font color="green">      const ks = Object.keys(cells);</font>                                                                     </pre>
<pre>                                                                                                                        <font color="black">281</font> <font color="green">      const ci = ks[ks.length - 1];</font>                                                                      </pre>
<pre>                                                                                                                        <font color="black">282</font> <font color="green">      return [parseInt(ri, 10), parseInt(ci, 10)];</font>                                                       </pre>
<pre>                                                                                                                        <font color="black">283</font> <font color="green">    }</font>                                                                                                    </pre>
<pre>                                                                                                                        <font color="black">284</font> <font color="green">    return [0, 0];</font>                                                                                       </pre>
<pre>                                                                                                                        <font color="black">285</font> <font color="green">  }</font>                                                                                                      </pre>
<pre>                                                                                                                        <font color="black">286</font> <font color="green"> </font>                                                                                                        </pre>
<pre>     <font color="black">262</font>   each(cb) {                                                                                                   <font color="black">287</font>   each(cb) {                                                                                             </pre>
<pre>     <font color="black">263</font>     Object.entries(this._).forEach(([ri, row]) => {                                                            <font color="black">288</font>     Object.entries(this._).forEach(([ri, row]) => {                                                      </pre>
<pre>     <font color="black">264</font>       cb(ri, row);                                                                                             <font color="black">289</font>       cb(ri, row);                                                                                       </pre>
<pre>     <font color="black">265</font>     });                                                                                                        <font color="black">290</font>     });                                                                                                  </pre>
<pre>     <font color="black">266</font>   }                                                                                                            <font color="black">291</font>   }                                                                                                      </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">272</font>       });                                                                                                      <font color="black">297</font>       });                                                                                                </pre>
<pre>     <font color="black">273</font>     }                                                                                                          <font color="black">298</font>     }                                                                                                    </pre>
<pre>     <font color="black">274</font>   }                                                                                                            <font color="black">299</font>   }                                                                                                      </pre>
<pre>     <font color="black">275</font>                                                                                                                <font color="black">300</font>                                                                                                          </pre>
<pre>     <font color="black">276</font>   setData(d) {                                                                                                 <font color="black">301</font>   setData(d) {                                                                                           </pre>
<pre>     <font color="black">277</font> <font color="red">//    console.log("row setData: ",d);</font>                                                                                                                                                                                       </pre>
<pre>     <font color="black">278</font>     if (d.len) {                                                                                               <font color="black">302</font>     if (d.len) {                                                                                         </pre>
<pre>     <font color="black">279</font>       this.len = d.len;                                                                                        <font color="black">303</font>       this.len = d.len;                                                                                  </pre>
<pre>     <font color="black">280</font>       delete d.len;                                                                                            <font color="black">304</font>       delete d.len;                                                                                      </pre>
<pre>     <font color="black">281</font>     }                                                                                                          <font color="black">305</font>     }                                                                                                    </pre>
<pre>     <font color="black">282</font>     this._ = d;                                                                                                <font color="black">306</font>     this._ = d;                                                                                          </pre>
<pre><font color="blue">../src/core/cell.js</font>                                                                                                <font color="blue">../../x-spreadsheet/src/core/cell.js</font>                                                                              </pre>
<pre>       <font color="black">6</font> const infixExprToSuffixExpr = (src) => {                                                                         <font color="black">6</font> const infixExprToSuffixExpr = (src) => {                                                                 </pre>
<pre>       <font color="black">7</font>   const operatorStack = [];                                                                                      <font color="black">7</font>   const operatorStack = [];                                                                              </pre>
<pre>       <font color="black">8</font>   const stack = [];                                                                                              <font color="black">8</font>   const stack = [];                                                                                      </pre>
<pre>       <font color="black">9</font>   let subStrs = []; // SUM, A1, B2, 50 ...                                                                       <font color="black">9</font>   let subStrs = []; // SUM, A1, B2, 50 ...                                                               </pre>
<pre>      <font color="black">10</font>   let fnArgType = 0; // 1 => , 2 => :                                                                           <font color="black">10</font>   let fnArgType = 0; // 1 => , 2 => :                                                                    </pre>
<pre>                                                                                                                         <font color="black">11</font> <font color="green">  let fnArgOperator = '';</font>                                                                                </pre>
<pre>      <font color="black">11</font>   let fnArgsLen = 1; // A1,A2,A3...                                                                             <font color="black">12</font>   let fnArgsLen = 1; // A1,A2,A3...                                                                      </pre>
<pre>      <font color="black">12</font>   for (let i = 0; i < src.length; i += 1) {                                                                     <font color="black">13</font>   for (let i = 0; i < src.length; i += 1) {                                                              </pre>
<pre>      <font color="black">13</font>     const c = src.charAt(i);                                                                                    <font color="black">14</font>     const c = src.charAt(i);                                                                             </pre>
<pre>      <font color="black">14</font>     // console.log('c:', c);                                                                                    <font color="black">15</font>     // console.log('c:', c);                                                                             </pre>
<pre>      <font color="black">15</font>     if (c !== ' ') {                                                                                            <font color="black">16</font>     if (c !== ' ') {                                                                                     </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">47</font>               }                                                                                                 <font color="black">48</font>               }                                                                                          </pre>
<pre>      <font color="black">48</font>               stack.push([c1, rangelen]);                                                                       <font color="black">49</font>               stack.push([c1, rangelen]);                                                                </pre>
<pre>      <font color="black">49</font>             } catch (e) {                                                                                       <font color="black">50</font>             } catch (e) {                                                                                </pre>
<pre>      <font color="black">50</font>               // console.log(e);                                                                                <font color="black">51</font>               // console.log(e);                                                                         </pre>
<pre>      <font color="black">51</font>             }                                                                                                   <font color="black">52</font>             }                                                                                            </pre>
<pre>      <font color="black">52</font>           } else if (fnArgType === 1) {                                                                         <font color="black">53</font>           } else if (fnArgType === 1<font color="green"> || fnArgType === 3</font>) {                                               </pre>
<pre>                                                                                                                         <font color="black">54</font> <font color="green">            if (fnArgType === 3) stack.push(fnArgOperator);</font>                                              </pre>
<pre>      <font color="black">53</font>             // fn argument => A1,A2,B5                                                                          <font color="black">55</font>             // fn argument => A1,A2,B5                                                                   </pre>
<pre>      <font color="black">54</font>             stack.push([c1, fnArgsLen]);                                                                        <font color="black">56</font>             stack.push([c1, fnArgsLen]);                                                                 </pre>
<pre>      <font color="black">55</font>             fnArgsLen = 1;                                                                                      <font color="black">57</font>             fnArgsLen = 1;                                                                               </pre>
<pre>      <font color="black">56</font>           } else {                                                                                              <font color="black">58</font>           } else {                                                                                       </pre>
<pre>      <font color="black">57</font>             // console.log('c1:', c1, fnArgType, stack, operatorStack);                                         <font color="black">59</font>             // console.log('c1:', c1, fnArgType, stack, operatorStack);                                  </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">60</font>               if (operatorStack.length <= 0) break;                                                             <font color="black">62</font>               if (operatorStack.length <= 0) break;                                                      </pre>
<pre>      <font color="black">61</font>               c1 = operatorStack.pop();                                                                         <font color="black">63</font>               c1 = operatorStack.pop();                                                                  </pre>
<pre>      <font color="black">62</font>             }                                                                                                   <font color="black">64</font>             }                                                                                            </pre>
<pre>      <font color="black">63</font>           }                                                                                                     <font color="black">65</font>           }                                                                                              </pre>
<pre>      <font color="black">64</font>           fnArgType = 0;                                                                                        <font color="black">66</font>           fnArgType = 0;                                                                                 </pre>
<pre>                                                                                                                         <font color="black">67</font> <font color="green">        } else if (c === '=' || c === '>' || c === '<') {</font>                                                </pre>
<pre>                                                                                                                         <font color="black">68</font> <font color="green">          const nc = src.charAt(i + 1);</font>                                                                  </pre>
<pre>                                                                                                                         <font color="black">69</font> <font color="green">          fnArgOperator = c;</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">70</font> <font color="green">          if (nc === '=' || nc === '-') {</font>                                                                </pre>
<pre>                                                                                                                         <font color="black">71</font> <font color="green">            fnArgOperator += nc;</font>                                                                         </pre>
<pre>                                                                                                                         <font color="black">72</font> <font color="green">            i += 1;</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">73</font> <font color="green">          }</font>                                                                                              </pre>
<pre>                                                                                                                         <font color="black">74</font> <font color="green">          fnArgType = 3;</font>                                                                                 </pre>
<pre>      <font color="black">65</font>         } else if (c === ':') {                                                                                 <font color="black">75</font>         } else if (c === ':') {                                                                          </pre>
<pre>      <font color="black">66</font>           fnArgType = 2;                                                                                        <font color="black">76</font>           fnArgType = 2;                                                                                 </pre>
<pre>      <font color="black">67</font>         } else if (c === ',') {                                                                                 <font color="black">77</font>         } else if (c === ',') {                                                                          </pre>
<pre>                                                                                                                         <font color="black">78</font> <font color="green">          if (fnArgType === 3) {</font>                                                                         </pre>
<pre>                                                                                                                         <font color="black">79</font> <font color="green">            stack.push(fnArgOperator);</font>                                                                   </pre>
<pre>                                                                                                                         <font color="black">80</font> <font color="green">          }</font>                                                                                              </pre>
<pre>      <font color="black">68</font>           fnArgType = 1;                                                                                        <font color="black">81</font>           fnArgType = 1;                                                                                 </pre>
<pre>      <font color="black">69</font>           fnArgsLen += 1;                                                                                       <font color="black">82</font>           fnArgsLen += 1;                                                                                </pre>
<pre>      <font color="black">70</font>         } else if (c === '(' && subStrs.length > 0) {                                                           <font color="black">83</font>         } else if (c === '(' && subStrs.length > 0) {                                                    </pre>
<pre>      <font color="black">71</font>           // function                                                                                           <font color="black">84</font>           // function                                                                                    </pre>
<pre>      <font color="black">72</font>           operatorStack.push(subStrs.join(''));                                                                 <font color="black">85</font>           operatorStack.push(subStrs.join(''));                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>     <font color="black">117</font> const evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {                                       <font color="black">130</font> const evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) => {                                 </pre>
<pre>     <font color="black">118</font>   const stack = [];                                                                                            <font color="black">131</font>   const stack = [];                                                                                      </pre>
<pre>     <font color="black">119</font>   // console.log(':::::formulaMap:', formulaMap);                                                              <font color="black">132</font>   // console.log(':::::formulaMap:', formulaMap);                                                        </pre>
<pre>     <font color="black">120</font>   for (let i = 0; i < srcStack.length; i += 1) {                                                               <font color="black">133</font>   for (let i = 0; i < srcStack.length; i += 1) {                                                         </pre>
<pre>     <font color="black">121</font>     // console.log(':::>>>', srcStack[i]);                                                                     <font color="black">134</font>     // console.log(':::>>>', srcStack[i]);                                                               </pre>
<pre>                                                                                                                        <font color="black">135</font> <font color="green">    const expr = srcStack[i];</font>                                                                            </pre>
<pre>                                                                                                                        <font color="black">136</font> <font color="green">    const fc = expr[0];</font>                                                                                  </pre>
<pre>     <font color="black">122</font>     if (<font color="orange">s</font>r<font color="red">cStack[i]</font> === '+') {                                                                                 <font color="black">137</font>     if (<font color="orange">exp</font>r === '+') {                                                                                  </pre>
<pre>     <font color="black">123</font>       const top = stack.pop();                                                                                 <font color="black">138</font>       const top = stack.pop();                                                                           </pre>
<pre>     <font color="black">124</font>       stack.push(Number(stack.pop()) + Number(top));                                                           <font color="black">139</font>       stack.push(Number(stack.pop()) + Number(top));                                                     </pre>
<pre>     <font color="black">125</font>     } else if (<font color="orange">s</font>r<font color="red">cStack[i]</font> === '-') {                                                                          <font color="black">140</font>     } else if (<font color="orange">exp</font>r === '-') {                                                                           </pre>
<pre>                                                                                                                        <font color="black">141</font> <font color="green">      if (stack.length === 1) {</font>                                                                          </pre>
<pre>     <font color="black">126</font>       const top = stack.pop();                                                                                 <font color="black">142</font> <font color="green">  </font>      const top = stack.pop();                                                                         </pre>
<pre>                                                                                                                        <font color="black">143</font> <font color="green">        stack.push(Number(top) * -1);</font>                                                                    </pre>
<pre>                                                                                                                        <font color="black">144</font> <font color="green">      } else {</font>                                                                                           </pre>
<pre>                                                                                                                        <font color="black">145</font> <font color="green">        const top = stack.pop();</font>                                                                         </pre>
<pre>     <font color="black">127</font>       stack.push(Number(stack.pop()) - Number(top));                                                           <font color="black">146</font> <font color="green">  </font>      stack.push(Number(stack.pop()) - Number(top));                                                   </pre>
<pre>                                                                                                                        <font color="black">147</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>     <font color="black">128</font>     } else if (<font color="orange">s</font>r<font color="red">cStack[i]</font> === '*') {                                                                          <font color="black">148</font>     } else if (<font color="orange">exp</font>r === '*') {                                                                           </pre>
<pre>     <font color="black">129</font>       stack.push(Number(stack.pop()) * Number(stack.pop()));                                                   <font color="black">149</font>       stack.push(Number(stack.pop()) * Number(stack.pop()));                                             </pre>
<pre>     <font color="black">130</font>     } else if (<font color="orange">s</font>r<font color="red">cStack[i]</font> === '/') {                                                                          <font color="black">150</font>     } else if (<font color="orange">exp</font>r === '/') {                                                                           </pre>
<pre>     <font color="black">131</font>       const top = stack.pop();                                                                                 <font color="black">151</font>       const top = stack.pop();                                                                           </pre>
<pre>     <font color="black">132</font>       stack.push(Number(stack.pop()) / Number(top));                                                           <font color="black">152</font>       stack.push(Number(stack.pop()) / Number(top));                                                     </pre>
<pre>                                                                                                                        <font color="black">153</font> <font color="green">    } else if (fc === '=' || fc === '>' || fc === '<') {</font>                                                 </pre>
<pre>                                                                                                                        <font color="black">154</font> <font color="green">      const top = stack.pop();</font>                                                                           </pre>
<pre>                                                                                                                        <font color="black">155</font> <font color="green">      const Fn = Function;</font>                                                                               </pre>
<pre>                                                                                                                        <font color="black">156</font> <font color="green">      stack.push(new Fn(`return ${stack.pop()} ${expr === '=' ? '==' : expr} ${top}`)());</font>                </pre>
<pre>     <font color="black">133</font>     } else if (Array.isArray(<font color="orange">s</font>r<font color="red">cStack[i]</font>)) {                                                                   <font color="black">157</font>     } else if (Array.isArray(<font color="orange">exp</font>r)) {                                                                    </pre>
<pre>     <font color="black">134</font>       const [formula, len] = <font color="orange">s</font>r<font color="red">cStack[i]</font>;                                                                      <font color="black">158</font>       const [formula, len] = <font color="orange">exp</font>r;                                                                       </pre>
<pre>     <font color="black">135</font>       const params = [];                                                                                       <font color="black">159</font>       const params = [];                                                                                 </pre>
<pre>     <font color="black">136</font>       for (let j = 0; j < len; j += 1) {                                                                       <font color="black">160</font>       for (let j = 0; j < len; j += 1) {                                                                 </pre>
<pre>     <font color="black">137</font>         params.push(stack.pop());                                                                              <font color="black">161</font>         params.push(stack.pop());                                                                        </pre>
<pre>     <font color="black">138</font>       }                                                                                                        <font color="black">162</font>       }                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">163</font> <font color="green">      // console.log('::::params:', formulaMap, expr,  formula, params);</font>                                 </pre>
<pre>     <font color="black">139</font>       stack.push(formulaMap[formula].render(params.reverse()));                                                <font color="black">164</font>       stack.push(formulaMap[formula].render(params.reverse()));                                          </pre>
<pre>     <font color="black">140</font>     } else {                                                                                                   <font color="black">165</font>     } else {                                                                                             </pre>
<pre>                                                                                                                        <font color="black">166</font> <font color="green">      // console.log('cellList:', cellList, expr);</font>                                                       </pre>
<pre>     <font color="black">141</font>       if (cellList.includes(<font color="orange">s</font>r<font color="red">cStack[i]</font>)) {                                                                    <font color="black">167</font>       if (cellList.includes(<font color="orange">exp</font>r)) {                                                                     </pre>
<pre>     <font color="black">142</font>         return 0;                                                                                              <font color="black">168</font>         return 0;                                                                                        </pre>
<pre>     <font color="black">143</font>       }                                                                                                        <font color="black">169</font>       }                                                                                                  </pre>
<pre>                                                                                                                        <font color="black">170</font> <font color="green">      if ((fc >= 'a' && fc <= 'z') || (fc >= 'A' && fc <= 'Z')) {</font>                                        </pre>
<pre>     <font color="black">144</font>       cellList.push(<font color="orange">s</font>r<font color="red">cStack[i]</font>);                                                                              <font color="black">171</font> <font color="green">  </font>      cellList.push(<font color="orange">exp</font>r);                                                                             </pre>
<pre>                                                                                                                        <font color="black">172</font> <font color="green">      }</font>                                                                                                  </pre>
<pre>     <font color="black">145</font>       stack.push(evalSubExpr(<font color="orange">s</font>r<font color="red">cStack[i]</font>, cellRender));                                                        <font color="black">173</font>       stack.push(evalSubExpr(<font color="orange">exp</font>r, cellRender));                                                         </pre>
<pre>     <font color="black">146</font>     }                                                                                                          <font color="black">174</font>     }                                                                                                    </pre>
<pre>     <font color="black">147</font>     // console.log('stack:', stack);                                                                           <font color="black">175</font>     // console.log('stack:', stack);                                                                     </pre>
<pre>     <font color="black">148</font>   }                                                                                                            <font color="black">176</font>   }                                                                                                      </pre>
<pre>     <font color="black">149</font>   return stack[0];                                                                                             <font color="black">177</font>   return stack[0];                                                                                       </pre>
<pre>     <font color="black">150</font> };                                                                                                             <font color="black">178</font> };                                                                                                       </pre>
<pre><font color="blue">../src/core/alphabet.js</font>                                                                                            <font color="blue">../../x-spreadsheet/src/core/alphabet.js</font>                                                                          </pre>
<pre>                                                                                                                          <font color="black">1</font> <font color="green">import './_.prototypes';</font>                                                                                 </pre>
<pre>                                                                                                                          <font color="black">2</font> <font color="green"> </font>                                                                                                        </pre>
<pre>       <font color="black">1</font> const alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', '        <font color="black">3</font> const alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', '</pre>
<pre>R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];                                                                       R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];                                                                      </pre>
<pre>       <font color="black">2</font>                                                                                                                  <font color="black">4</font>                                                                                                          </pre>
<pre>                                                                                                                          <font color="black">5</font> <font color="green">/** index number 2 letters</font>                                                                               </pre>
<pre>                                                                                                                          <font color="black">6</font> <font color="green"> * @example stringAt(26) ==> 'AA'</font>                                                                        </pre>
<pre>                                                                                                                          <font color="black">7</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre>
<pre>                                                                                                                          <font color="black">8</font> <font color="green"> * @export</font>                                                                                               </pre>
<pre>                                                                                                                          <font color="black">9</font> <font color="green"> * @param {number} index</font>                                                                                 </pre>
<pre>                                                                                                                         <font color="black">10</font> <font color="green"> * @returns {string}</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">11</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>       <font color="black">3</font> export function stringAt(index) {                                                                               <font color="black">12</font> export function stringAt(index) {                                                                        </pre>
<pre>       <font color="black">4</font>   let str = '';                                                                                                 <font color="black">13</font>   let str = '';                                                                                          </pre>
<pre>       <font color="black">5</font>   let cindex = index;                                                                                           <font color="black">14</font>   let cindex = index;                                                                                    </pre>
<pre>       <font color="black">6</font>   while (cindex >= alphabets.length) {                                                                          <font color="black">15</font>   while (cindex >= alphabets.length) {                                                                   </pre>
<pre>       <font color="black">7</font>     cindex /= alphabets.length;                                                                                 <font color="black">16</font>     cindex /= alphabets.length;                                                                          </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">11</font>   const last = index % alphabets.length;                                                                        <font color="black">20</font>   const last = index % alphabets.length;                                                                 </pre>
<pre>      <font color="black">12</font>   str += alphabets[last];                                                                                       <font color="black">21</font>   str += alphabets[last];                                                                                </pre>
<pre>      <font color="black">13</font>   return str;                                                                                                   <font color="black">22</font>   return str;                                                                                            </pre>
<pre>      <font color="black">14</font> }                                                                                                               <font color="black">23</font> }                                                                                                        </pre>
<pre>      <font color="black">15</font>                                                                                                                 <font color="black">24</font>                                                                                                          </pre>
<pre>                                                                                                                         <font color="black">25</font> <font color="green">/** translate letter in A1-tag to number</font>                                                                 </pre>
<pre>                                                                                                                         <font color="black">26</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">27</font> <font color="green"> * @export</font>                                                                                               </pre>
<pre>                                                                                                                         <font color="black">28</font> <font color="green"> * @param {string} str "AA" in A1-tag "AA1"</font>                                                              </pre>
<pre>                                                                                                                         <font color="black">29</font> <font color="green"> * @returns {number}</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">30</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>      <font color="black">16</font> export function indexAt(str) {                                                                                  <font color="black">31</font> export function indexAt(str) {                                                                           </pre>
<pre>      <font color="black">17</font>   let ret = 0;                                                                                                  <font color="black">32</font>   let ret = 0;                                                                                           </pre>
<pre>      <font color="black">18</font>   for (let i = 0; i < str.length - 1; i += 1) {                                                                 <font color="black">33</font>   for (let i = 0; i < str.length - 1; i += 1) {                                                          </pre>
<pre>      <font color="black">19</font>     const cindex = str.charCodeAt(i) - 65;                                                                      <font color="black">34</font>     const cindex = str.charCodeAt(i) - 65;                                                               </pre>
<pre>      <font color="black">20</font>     const exponet = str.length - 1 - i;                                                                         <font color="black">35</font>     const exponet = str.length - 1 - i;                                                                  </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">23</font>   ret += str.charCodeAt(str.length - 1) - 65;                                                                   <font color="black">38</font>   ret += str.charCodeAt(str.length - 1) - 65;                                                            </pre>
<pre>      <font color="black">24</font>   return ret;                                                                                                   <font color="black">39</font>   return ret;                                                                                            </pre>
<pre>      <font color="black">25</font> }                                                                                                               <font color="black">40</font> }                                                                                                        </pre>
<pre>      <font color="black">26</font>                                                                                                                 <font color="black">41</font>                                                                                                          </pre>
<pre>      <font color="black">27</font> // B10 => x,y                                                                                                   <font color="black">42</font> // B10 => x,y                                                                                            </pre>
<pre>                                                                                                                         <font color="black">43</font> <font color="green">/** translate A1-tag to XY-tag</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">44</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">45</font> <font color="green"> * @export</font>                                                                                               </pre>
<pre>                                                                                                                         <font color="black">46</font> <font color="green"> * @param {tagA1} src</font>                                                                                    </pre>
<pre>                                                                                                                         <font color="black">47</font> <font color="green"> * @returns {tagXY}</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">48</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>      <font color="black">28</font> export function expr2xy(src) {                                                                                  <font color="black">49</font> export function expr2xy(src) {                                                                           </pre>
<pre>      <font color="black">29</font>   let x = '';                                                                                                   <font color="black">50</font>   let x = '';                                                                                            </pre>
<pre>      <font color="black">30</font>   let y = '';                                                                                                   <font color="black">51</font>   let y = '';                                                                                            </pre>
<pre>      <font color="black">31</font>   for (let i = 0; i < src.length; i += 1) {                                                                     <font color="black">52</font>   for (let i = 0; i < src.length; i += 1) {                                                              </pre>
<pre>      <font color="black">32</font>     if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {                                                         <font color="black">53</font>     if (src.charAt(i) >= '0' && src.charAt(i) <= '9') {                                                  </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">36</font>     }                                                                                                           <font color="black">57</font>     }                                                                                                    </pre>
<pre>      <font color="black">37</font>   }                                                                                                             <font color="black">58</font>   }                                                                                                      </pre>
<pre>      <font color="black">38</font>   return [indexAt(x), parseInt(y, 10) - 1];                                                                     <font color="black">59</font>   return [indexAt(x), parseInt(y, 10) - 1];                                                              </pre>
<pre>      <font color="black">39</font> }                                                                                                               <font color="black">60</font> }                                                                                                        </pre>
<pre>      <font color="black">40</font>                                                                                                                 <font color="black">61</font>                                                                                                          </pre>
<pre>                                                                                                                         <font color="black">62</font> <font color="green">/** translate XY-tag to A1-tag</font>                                                                           </pre>
<pre>                                                                                                                         <font color="black">63</font> <font color="green"> * @example x,y => B10</font>                                                                                   </pre>
<pre>                                                                                                                         <font color="black">64</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">65</font> <font color="green"> * @export</font>                                                                                               </pre>
<pre>                                                                                                                         <font color="black">66</font> <font color="green"> * @param {number} x</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">67</font> <font color="green"> * @param {number} y</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">68</font> <font color="green"> * @returns {tagA1}</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">69</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">70</font> <font color="green">export function xy2expr(x, y) {</font>                                                                          </pre>
<pre>                                                                                                                         <font color="black">71</font> <font color="green">  return `${stringAt(x)}${y + 1}`;</font>                                                                       </pre>
<pre>                                                                                                                         <font color="black">72</font> <font color="green">}</font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">73</font> <font color="green"> </font>                                                                                                        </pre>
<pre>                                                                                                                         <font color="black">74</font> <font color="green">/** translate A1-tag src by (xn, yn)</font>                                                                     </pre>
<pre>                                                                                                                         <font color="black">75</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">76</font> <font color="green"> * @export</font>                                                                                               </pre>
<pre>                                                                                                                         <font color="black">77</font> <font color="green"> * @param {tagA1} src</font>                                                                                    </pre>
<pre>                                                                                                                         <font color="black">78</font> <font color="green"> * @param {number} xn</font>                                                                                    </pre>
<pre>                                                                                                                         <font color="black">79</font> <font color="green"> * @param {number} yn</font>                                                                                    </pre>
<pre>                                                                                                                         <font color="black">80</font> <font color="green"> * @returns {tagA1}</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">81</font> <font color="green"> */</font>                                                                                                      </pre>
<pre>      <font color="black">41</font> export function expr2expr(src, xn, yn) {                                                                        <font color="black">82</font> export function expr2expr(src, xn, yn) {                                                                 </pre>
<pre>      <font color="black">42</font>   const [x, y] = expr2xy(src);                                                                                  <font color="black">83</font>   const [x, y] = expr2xy(src);                                                                           </pre>
<pre>      <font color="black">43</font> <font color="red">  return stringAt(x + xn) + (y + yn);</font>                                                                           <font color="black">84</font> <font color="green">  return xy2expr(x + xn, y + yn);</font>                                                                        </pre>
<pre>      <font color="black">44</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">45</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre>
<pre>      <font color="black">46</font> <font color="red">// x,y => B10</font>                                                                                                                                                                                                               </pre>
<pre>      <font color="black">47</font> <font color="red">export function xy2expr(x, y) {</font>                                                                                                                                                                                             </pre>
<pre>      <font color="black">48</font> <font color="red">  return `${stringAt(x)}${y + 1}`;</font>                                                                                                                                                                                          </pre>
<pre>      <font color="black">49</font> }                                                                                                               <font color="black">85</font> }                                                                                                        </pre>
<pre>      <font color="black">50</font>                                                                                                                 <font color="black">86</font>                                                                                                          </pre>
<pre>      <font color="black">51</font> export default {                                                                                                <font color="black">87</font> export default {                                                                                         </pre>
<pre>      <font color="black">52</font>   stringAt,                                                                                                     <font color="black">88</font>   stringAt,                                                                                              </pre>
<pre>      <font color="black">53</font>   indexAt,                                                                                                      <font color="black">89</font>   indexAt,                                                                                               </pre>
<pre><font color="blue">../src/core/format.js</font>                                                                                              <font color="blue">../../x-spreadsheet/src/core/format.js</font>                                                                            </pre>
<pre>       <font color="black">1</font> import { tf } from '../locale/locale';                                                                           <font color="black">1</font> import { tf } from '../locale/locale';                                                                   </pre>
<pre>       <font color="black">2</font>                                                                                                                  <font color="black">2</font>                                                                                                          </pre>
<pre>       <font color="black">3</font> const formatStringRender = v => v;                                                                               <font color="black">3</font> const formatStringRender = v => v;                                                                       </pre>
<pre>       <font color="black">4</font>                                                                                                                  <font color="black">4</font>                                                                                                          </pre>
<pre>       <font color="black">5</font> const formatNumberRender = (v) => {                                                                              <font color="black">5</font> const formatNumberRender = (v) => {                                                                      </pre>
<pre>                                                                                                                          <font color="black">6</font> <font color="green">  // match "-12.1" or "12" or "12.1"</font>                                                                     </pre>
<pre>       <font color="black">6</font>   if (/^(-?\d*.?\d*)$/.test(v)) {                                                                                <font color="black">7</font>   if (/^(-?\d*.?\d*)$/.test(v)) {                                                                        </pre>
<pre>       <font color="black">7</font>     const v1 = Number(v).toFixed(2).toString();                                                                  <font color="black">8</font>     const v1 = Number(v).toFixed(2).toString();                                                          </pre>
<pre>       <font color="black">8</font>     const [first, ...parts] = v1.split('\\.');                                                                   <font color="black">9</font>     const [first, ...parts] = v1.split('\\.');                                                           </pre>
<pre>       <font color="black">9</font>     return [first.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,'), ...parts];                                         <font color="black">10</font>     return [first.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,'), ...parts];                                  </pre>
<pre>      <font color="black">10</font>   }                                                                                                             <font color="black">11</font>   }                                                                                                      </pre>
<pre><font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre>
<pre>      <font color="black">51</font>     type: 'number',                                                                                             <font color="black">52</font>     type: 'number',                                                                                      </pre>
<pre>      <font color="black">52</font>     label: '$10.00',                                                                                            <font color="black">53</font>     label: '$10.00',                                                                                     </pre>
<pre>      <font color="black">53</font>     render: v => `$${formatNumberRender(v)}`,                                                                   <font color="black">54</font>     render: v => `$${formatNumberRender(v)}`,                                                            </pre>
<pre>      <font color="black">54</font>   },                                                                                                            <font color="black">55</font>   },                                                                                                     </pre>
<pre>      <font color="black">55</font>   {                                                                                                             <font color="black">56</font>   {                                                                                                      </pre>
<pre>                                                                                                                         <font color="black">57</font> <font color="green">    key: 'eur',</font>                                                                                          </pre>
<pre>                                                                                                                         <font color="black">58</font> <font color="green">    title: tf('format.eur'),</font>                                                                             </pre>
<pre>                                                                                                                         <font color="black">59</font> <font color="green">    type: 'number',</font>                                                                                      </pre>
<pre>                                                                                                                         <font color="black">60</font> <font color="green">    label: '€10.00',</font>                                                                                     </pre>
<pre>                                                                                                                         <font color="black">61</font> <font color="green">    render: v => `€${formatNumberRender(v)}`,</font>                                                            </pre>
<pre>                                                                                                                         <font color="black">62</font> <font color="green">  },</font>                                                                                                     </pre>
<pre>                                                                                                                         <font color="black">63</font> <font color="green">  {</font>                                                                                                      </pre>
<pre>      <font color="black">56</font>     key: 'date',                                                                                                <font color="black">64</font>     key: 'date',                                                                                         </pre>
<pre>      <font color="black">57</font>     title: tf('format.date'),                                                                                   <font color="black">65</font>     title: tf('format.date'),                                                                            </pre>
<pre>      <font color="black">58</font>     type: 'date',                                                                                               <font color="black">66</font>     type: 'date',                                                                                        </pre>
<pre>      <font color="black">59</font>     label: '26/09/2008',                                                                                        <font color="black">67</font>     label: '26/09/2008',                                                                                 </pre>
<pre>      <font color="black">60</font>     render: formatStringRender,                                                                                 <font color="black">68</font>     render: formatStringRender,                                                                          </pre>

</body>
</html>

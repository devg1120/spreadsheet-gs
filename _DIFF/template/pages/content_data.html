<div id="id-config_js"  class="pagelink" row="1"><pre class="pagehead" row="1">0001 id-config_js</pre></div>
<div><pre row="2"><code =class"javascript">0002 ../src/config.js             ../../x-spreadsheet/src/config.js</code></pre></div>
<div id="id-index_js"  class="pagelink" row="3"><pre class="pagehead" row="3">0003 id-index_js</pre></div>
<div row="4"><pre row="4">0004 <font color="blue">../src/index.js</font>                                                                                                    <font color="blue">../../x-spreadsheet/src/index.js</font>                                                                                  </pre></div>
<div row="5"><pre row="5">0005        <font color="black">1</font> /* global window, document */                                                                                    <font color="black">1</font> /* global window, document */                                                                            </pre></div>
<div row="6"><pre row="6">0006        <font color="black">2</font> import { h } from './component/element';                                                                         <font color="black">2</font> import { h } from './component/element';                                                                 </pre></div>
<div row="7"><pre row="7">0007        <font color="black">3</font> import DataProxy from './core/data_proxy';                                                                       <font color="black">3</font> import DataProxy from './core/data_proxy';                                                               </pre></div>
<div row="8"><pre row="8">0008        <font color="black">4</font> import Sheet from './component/sheet';                                                                           <font color="black">4</font> import Sheet from './component/sheet';                                                                   </pre></div>
<div row="9"><pre row="9">0009                                                                                                                           <font color="black">5</font> <font color="green">import Bottombar from './component/bottombar';</font>                                                           </pre></div>
<div row="10"><pre row="10">0010        <font color="black">5</font> import { cssPrefix } from './config';                                                                            <font color="black">6</font> import { cssPrefix } from './config';                                                                    </pre></div>
<div row="11"><pre row="11">0011        <font color="black">6</font> import { locale } from './locale/locale';                                                                        <font color="black">7</font> import { locale } from './locale/locale';                                                                </pre></div>
<div row="12"><pre row="12">0012        <font color="black">7</font> import './index.less';                                                                                           <font color="black">8</font> import './index.less';                                                                                   </pre></div>
<div row="13"><pre row="13">0013        <font color="black">8</font> <font color="red">import Tweakpane from 'tweakpane';</font>                                                                               <font color="black">9</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="14"><pre row="14">0014        <font color="black">9</font>                                                                                                                 <font color="black">10</font>                                                                                                          </pre></div>
<div row="15"><pre row="15">0015       <font color="black">10</font> class Spreadsheet {                                                                                             <font color="black">11</font> class Spreadsheet {                                                                                      </pre></div>
<div row="16"><pre row="16">0016       <font color="black">11</font> <font color="red">   </font>                                                                                                                                                                                                                         </pre></div>
<div row="17"><pre row="17">0017       <font color="black">12</font>   constructor(selectors, options = {}) {                                                                        <font color="black">12</font>   constructor(selectors, options = {}) {                                                                 </pre></div>
<div row="18"><pre row="18">0018       <font color="black">13</font>     let targetEl = selectors;                                                                                   <font color="black">13</font>     let targetEl = selectors;                                                                            </pre></div>
<div row="19"><pre row="19">0019       <font color="black">14</font> <font color="red">    let targetEl2 = selectors;</font>                                                                                  <font color="black">14</font> <font color="green">    this.options = options;</font>                                                                              </pre></div>
<div row="20"><pre row="20">0020                                                                                                                          <font color="black">15</font> <font color="green">    this.sheetIndex = 1;</font>                                                                                 </pre></div>
<div row="21"><pre row="21">0021                                                                                                                          <font color="black">16</font> <font color="green">    this.datas = [];</font>                                                                                     </pre></div>
<div row="22"><pre row="22">0022       <font color="black">15</font>     if (typeof selectors === 'string') {                                                                        <font color="black">17</font>     if (typeof selectors === 'string') {                                                                 </pre></div>
<div row="23"><pre row="23">0023       <font color="black">16</font>       targetEl = document.querySelector(selectors);                                                             <font color="black">18</font>       targetEl = document.querySelector(selectors);                                                      </pre></div>
<div row="24"><pre row="24">0024       <font color="black">17</font> <font color="red">      targetEl2 = document.querySelector(selectors+'2');</font>                                                                                                                                                                    </pre></div>
<div row="25"><pre row="25">0025       <font color="black">18</font>     }                                                                                                           <font color="black">19</font>     }                                                                                                    </pre></div>
<div row="26"><pre row="26">0026       <font color="black">19</font> <font color="red">    this.data = new DataProxy('sheet1', options);</font>                                                               <font color="black">20</font> <font color="green">    this.bottombar = new Bottombar(() =&gt; {</font>                                                               </pre></div>
<div row="27"><pre row="27">0027       <font color="black">20</font> <font color="red">    this.data2 = new DataProxy('sheet2', options);</font>                                                              <font color="black">21</font> <font color="green">      const d = this.addSheet();</font>                                                                         </pre></div>
<div row="28"><pre row="28">0028       <font color="black">21</font> <font color="red"> </font>                                                                                                               <font color="black">22</font> <font color="green">      this.sheet.resetData(d);</font>                                                                           </pre></div>
<div row="29"><pre row="29">0029                                                                                                                          <font color="black">23</font> <font color="green">    }, (index) =&gt; {</font>                                                                                      </pre></div>
<div row="30"><pre row="30">0030                                                                                                                          <font color="black">24</font> <font color="green">      const d = this.datas[index];</font>                                                                       </pre></div>
<div row="31"><pre row="31">0031                                                                                                                          <font color="black">25</font> <font color="green">      this.sheet.resetData(d);</font>                                                                           </pre></div>
<div row="32"><pre row="32">0032                                                                                                                          <font color="black">26</font> <font color="green">    }, () =&gt; {</font>                                                                                           </pre></div>
<div row="33"><pre row="33">0033                                                                                                                          <font color="black">27</font> <font color="green">      this.deleteSheet();</font>                                                                                </pre></div>
<div row="34"><pre row="34">0034                                                                                                                          <font color="black">28</font> <font color="green">    }, (index, value) =&gt; {</font>                                                                               </pre></div>
<div row="35"><pre row="35">0035                                                                                                                          <font color="black">29</font> <font color="green">      this.datas[index].name = value;</font>                                                                    </pre></div>
<div row="36"><pre row="36">0036                                                                                                                          <font color="black">30</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="37"><pre row="37">0037                                                                                                                          <font color="black">31</font> <font color="green">    this.data = this.addSheet();</font>                                                                         </pre></div>
<div row="38"><pre row="38">0038       <font color="black">22</font>     const rootEl = h('div', `${cssPrefix}`)                                                                     <font color="black">32</font>     const rootEl = h('div', `${cssPrefix}`)                                                              </pre></div>
<div row="39"><pre row="39">0039       <font color="black">23</font> <font color="red">      .on('contextmenu', evt =&gt; evt.preventDefault());</font>                                                                                                                                                                      </pre></div>
<div row="40"><pre row="40">0040       <font color="black">24</font> <font color="red">    const rootEl2 = h('div', `${cssPrefix}`)</font>                                                                                                                                                                                </pre></div>
<div row="41"><pre row="41">0041       <font color="black">25</font>       .on('contextmenu', evt =&gt; evt.preventDefault());                                                          <font color="black">33</font>       .on('contextmenu', evt =&gt; evt.preventDefault());                                                   </pre></div>
<div row="42"><pre row="42">0042       <font color="black">26</font>     // create canvas element                                                                                    <font color="black">34</font>     // create canvas element                                                                             </pre></div>
<div row="43"><pre row="43">0043       <font color="black">27</font>     targetEl.appendChild(rootEl.el);                                                                            <font color="black">35</font>     targetEl.appendChild(rootEl.el);                                                                     </pre></div>
<div row="44"><pre row="44">0044       <font color="black">28</font> <font color="red">    targetEl2.appendChild(rootEl2.el);</font>                                                                                                                                                                                      </pre></div>
<div row="45"><pre row="45">0045       <font color="black">29</font>     this.sheet = new Sheet(rootEl, this.data);                                                                  <font color="black">36</font>     this.sheet = new Sheet(rootEl, this.data);                                                           </pre></div>
<div row="46"><pre row="46">0046       <font color="black">30</font> <font color="red">    this.sheet2 = new Sheet(rootEl2, this.data2);</font>                                                               <font color="black">37</font> <font color="green">    rootEl.child(this.bottombar.el);</font>                                                                     </pre></div>
<div row="47"><pre row="47">0047       <font color="black">31</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="48"><pre row="48">0048       <font color="black">32</font> <font color="red">    this.data.verticalAddSplitSheet(this.sheet2);</font>                                                                                                                                                                           </pre></div>
<div row="49"><pre row="49">0049       <font color="black">33</font> <font color="red">    this.data2.verticalAddSplitSheet(this.sheet);</font>                                                                                                                                                                           </pre></div>
<div row="50"><pre row="50">0050       <font color="black">34</font> <font color="red">    //this.data.horizontalAddSplitSheet(this.sheet2);</font>                                                                                                                                                                       </pre></div>
<div row="51"><pre row="51">0051       <font color="black">35</font> <font color="red">    //this.data2.horizontalAddSplitSheet(this.sheet);</font>                                                                                                                                                                       </pre></div>
<div row="52"><pre row="52">0052       <font color="black">36</font>   }                                                                                                             <font color="black">38</font>   }                                                                                                      </pre></div>
<div row="53"><pre row="53">0053       <font color="black">37</font>                                                                                                                 <font color="black">39</font>                                                                                                          </pre></div>
<div row="54"><pre row="54">0054       <font color="black">38</font> <font color="red">  getEl() {</font>                                                                                                     <font color="black">40</font> <font color="green">  addSheet(name) {</font>                                                                                       </pre></div>
<div row="55"><pre row="55">0055       <font color="black">39</font> <font color="red">     return this.rootEl2;</font>                                                                                       <font color="black">41</font> <font color="green">    const n = name || `sheet${this.sheetIndex}`;</font>                                                         </pre></div>
<div row="56"><pre row="56">0056                                                                                                                          <font color="black">42</font> <font color="green">    const d = new DataProxy(n, this.options);</font>                                                            </pre></div>
<div row="57"><pre row="57">0057                                                                                                                          <font color="black">43</font> <font color="green">    this.datas.push(d);</font>                                                                                  </pre></div>
<div row="58"><pre row="58">0058                                                                                                                          <font color="black">44</font> <font color="green">    // console.log('d:', n, d, this.datas);</font>                                                              </pre></div>
<div row="59"><pre row="59">0059                                                                                                                          <font color="black">45</font> <font color="green">    this.bottombar.addItem(n, true);</font>                                                                     </pre></div>
<div row="60"><pre row="60">0060                                                                                                                          <font color="black">46</font> <font color="green">    this.sheetIndex += 1;</font>                                                                                </pre></div>
<div row="61"><pre row="61">0061                                                                                                                          <font color="black">47</font> <font color="green">    return d;</font>                                                                                            </pre></div>
<div row="62"><pre row="62">0062       <font color="black">40</font>   }                                                                                                             <font color="black">48</font>   }                                                                                                      </pre></div>
<div row="63"><pre row="63">0063       <font color="black">41</font>                                                                                                                 <font color="black">49</font>                                                                                                          </pre></div>
<div row="64"><pre row="64">0064                                                                                                                          <font color="black">50</font> <font color="green">  deleteSheet() {</font>                                                                                        </pre></div>
<div row="65"><pre row="65">0065                                                                                                                          <font color="black">51</font> <font color="green">    const [oldIndex, nindex] = this.bottombar.deleteItem();</font>                                              </pre></div>
<div row="66"><pre row="66">0066                                                                                                                          <font color="black">52</font> <font color="green">    if (oldIndex &gt;= 0) {</font>                                                                                 </pre></div>
<div row="67"><pre row="67">0067                                                                                                                          <font color="black">53</font> <font color="green">      this.datas.splice(oldIndex, 1);</font>                                                                    </pre></div>
<div row="68"><pre row="68">0068                                                                                                                          <font color="black">54</font> <font color="green">      if (nindex &gt;= 0) this.sheet.resetData(this.datas[nindex]);</font>                                         </pre></div>
<div row="69"><pre row="69">0069                                                                                                                          <font color="black">55</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="70"><pre row="70">0070                                                                                                                          <font color="black">56</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="71"><pre row="71">0071                                                                                                                          <font color="black">57</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="72"><pre row="72">0072       <font color="black">42</font>   loadData(data<font color="red"> </font>) {                                                                                             <font color="black">58</font>   loadData(data) {                                                                                       </pre></div>
<div row="73"><pre row="73">0073       <font color="black">43</font> <font color="red">    this.sheet.loadData(data);  //splitsheet 同じdataをロードする</font>                                               <font color="black">59</font> <font color="green">    const d = Array.isArray(data) ? data[0] : data;</font>                                                      </pre></div>
<div row="74"><pre row="74">0074       <font color="black">44</font>     this.sheet<font color="red">2</font>.loadData(d<font color="red">ata</font>);                                                                                 <font color="black">60</font>     this.sheet.loadData(d);                                                                              </pre></div>
<div row="75"><pre row="75">0075       <font color="black">45</font> <font color="red">    //this.sheet2.loadData(this.sheet.exportData());</font>                                                                                                                                                                        </pre></div>
<div row="76"><pre row="76">0076       <font color="black">46</font>     return this;                                                                                                <font color="black">61</font>     return this;                                                                                         </pre></div>
<div row="77"><pre row="77">0077       <font color="black">47</font>   }                                                                                                             <font color="black">62</font>   }                                                                                                      </pre></div>
<div row="78"><pre row="78">0078       <font color="black">48</font>                                                                                                                 <font color="black">63</font>                                                                                                          </pre></div>
<div row="79"><pre row="79">0079       <font color="black">49</font>   getData() {                                                                                                   <font color="black">64</font>   getData() {                                                                                            </pre></div>
<div row="80"><pre row="80">0080       <font color="black">50</font>     return this.data.getData();                                                                                 <font color="black">65</font>     return this.data<font color="green">s.map(it =&gt; it</font>.getData()<font color="green">)</font>;                                                           </pre></div>
<div row="81"><pre row="81">0081                                                                                                                          <font color="black">66</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="82"><pre row="82">0082                                                                                                                          <font color="black">67</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="83"><pre row="83">0083                                                                                                                          <font color="black">68</font> <font color="green">  on(eventName, func) {</font>                                                                                  </pre></div>
<div row="84"><pre row="84">0084                                                                                                                          <font color="black">69</font> <font color="green">    this.sheet.on(eventName, func);</font>                                                                      </pre></div>
<div row="85"><pre row="85">0085                                                                                                                          <font color="black">70</font> <font color="green">    return this;</font>                                                                                         </pre></div>
<div row="86"><pre row="86">0086       <font color="black">51</font>   }                                                                                                             <font color="black">71</font>   }                                                                                                      </pre></div>
<div row="87"><pre row="87">0087       <font color="black">52</font>                                                                                                                 <font color="black">72</font>                                                                                                          </pre></div>
<div row="88"><pre row="88">0088       <font color="black">53</font>   validate() {                                                                                                  <font color="black">73</font>   validate() {                                                                                           </pre></div>
<div row="89"><pre row="89">0089       <font color="black">54</font>     const { validations } = this.data;                                                                          <font color="black">74</font>     const { validations } = this.data;                                                                   </pre></div>
<div row="90"><pre row="90">0090       <font color="black">55</font>     return validations.errors.size &lt;= 0;                                                                        <font color="black">75</font>     return validations.errors.size &lt;= 0;                                                                 </pre></div>
<div row="91"><pre row="91">0091       <font color="black">56</font>   }                                                                                                             <font color="black">76</font>   }                                                                                                      </pre></div>
<div row="92"><pre row="92">0092       <font color="black">57</font>                                                                                                                 <font color="black">77</font>                                                                                                          </pre></div>
<div row="93"><pre row="93">0093       <font color="black">58</font>   change(cb) {                                                                                                  <font color="black">78</font>   change(cb) {                                                                                           </pre></div>
<div row="94"><pre row="94">0094       <font color="black">59</font> <font color="red">    console.log("Spreadsheet change");</font>                                                                                                                                                                                      </pre></div>
<div row="95"><pre row="95">0095       <font color="black">60</font>     this.data.change = cb;                                                                                      <font color="black">79</font>     this.data.change = cb;                                                                               </pre></div>
<div row="96"><pre row="96">0096       <font color="black">61</font>     return this;                                                                                                <font color="black">80</font>     return this;                                                                                         </pre></div>
<div row="97"><pre row="97">0097       <font color="black">62</font>   }                                                                                                             <font color="black">81</font>   }                                                                                                      </pre></div>
<div row="98"><pre row="98">0098       <font color="black">63</font>                                                                                                                 <font color="black">82</font>                                                                                                          </pre></div>
<div row="99"><pre row="99">0099       <font color="black">64</font>   static locale(lang, message) {                                                                                <font color="black">83</font>   static locale(lang, message) {                                                                         </pre></div>
<div row="100"><pre row="100">0100 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="101"><pre row="101">0101       <font color="black">72</font>   window.x = window.x || {};                                                                                    <font color="black">91</font>   window.x = window.x || {};                                                                             </pre></div>
<div row="102"><pre row="102">0102       <font color="black">73</font>   window.x.spreadsheet = spreadsheet;                                                                           <font color="black">92</font>   window.x.spreadsheet = spreadsheet;                                                                    </pre></div>
<div row="103"><pre row="103">0103       <font color="black">74</font>   window.x.spreadsheet.locale = (lang, message) =&gt; locale(lang, message);                                       <font color="black">93</font>   window.x.spreadsheet.locale = (lang, message) =&gt; locale(lang, message);                                </pre></div>
<div row="104"><pre row="104">0104       <font color="black">75</font> }                                                                                                               <font color="black">94</font> }                                                                                                        </pre></div>
<div row="105"><pre row="105">0105       <font color="black">76</font>                                                                                                                 <font color="black">95</font>                                                                                                          </pre></div>
<div row="106"><pre row="106">0106       <font color="black">77</font> <font color="red">//--------------------------------</font>                                                                                                                                                                                          </pre></div>
<div row="107"><pre row="107">0107       <font color="black">78</font> <font color="red">//const pane = new Tweakpane({container: spreadsheet.getEl(),});</font>                                                                                                                                                            </pre></div>
<div row="108"><pre row="108">0108       <font color="black">79</font> <font color="red">    const pane = new Tweakpane();</font>                                                                                                                                                                                           </pre></div>
<div row="109"><pre row="109">0109       <font color="black">80</font> <font color="red">        const PARAMS = {</font>                                                                                                                                                                                                    </pre></div>
<div row="110"><pre row="110">0110       <font color="black">81</font> <font color="red">                b: true,</font>                                                                                                                                                                                                    </pre></div>
<div row="111"><pre row="111">0111       <font color="black">82</font> <font color="red">                c: '#ff8800',</font>                                                                                                                                                                                               </pre></div>
<div row="112"><pre row="112">0112       <font color="black">83</font> <font color="red">                n: 50,</font>                                                                                                                                                                                                      </pre></div>
<div row="113"><pre row="113">0113       <font color="black">84</font> <font color="red">                s: 'string',</font>                                                                                                                                                                                                </pre></div>
<div row="114"><pre row="114">0114       <font color="black">85</font> <font color="red">        };</font>                                                                                                                                                                                                                  </pre></div>
<div row="115"><pre row="115">0115       <font color="black">86</font> <font color="red">        const nf = pane.addFolder({</font>                                                                                                                                                                                         </pre></div>
<div row="116"><pre row="116">0116       <font color="black">87</font> <font color="red">                title: 'Number',</font>                                                                                                                                                                                            </pre></div>
<div row="117"><pre row="117">0117       <font color="black">88</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="118"><pre row="118">0118       <font color="black">89</font> <font color="red">        nf.addInput(PARAMS, 'n', {</font>                                                                                                                                                                                          </pre></div>
<div row="119"><pre row="119">0119       <font color="black">90</font> <font color="red">                label: 'text',</font>                                                                                                                                                                                              </pre></div>
<div row="120"><pre row="120">0120       <font color="black">91</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="121"><pre row="121">0121       <font color="black">92</font> <font color="red">        nf.addInput(PARAMS, 'n', {</font>                                                                                                                                                                                          </pre></div>
<div row="122"><pre row="122">0122       <font color="black">93</font> <font color="red">                label: 'slider',</font>                                                                                                                                                                                            </pre></div>
<div row="123"><pre row="123">0123       <font color="black">94</font> <font color="red">                max: 100,</font>                                                                                                                                                                                                   </pre></div>
<div row="124"><pre row="124">0124       <font color="black">95</font> <font color="red">                min: 0,</font>                                                                                                                                                                                                     </pre></div>
<div row="125"><pre row="125">0125       <font color="black">96</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="126"><pre row="126">0126       <font color="black">97</font> <font color="red">        nf.addInput(PARAMS, 'n', {</font>                                                                                                                                                                                          </pre></div>
<div row="127"><pre row="127">0127       <font color="black">98</font> <font color="red">                label: 'list',</font>                                                                                                                                                                                              </pre></div>
<div row="128"><pre row="128">0128       <font color="black">99</font> <font color="red">                options: {</font>                                                                                                                                                                                                  </pre></div>
<div row="129"><pre row="129">0129      <font color="black">100</font> <font color="red">                        low: 0,</font>                                                                                                                                                                                             </pre></div>
<div row="130"><pre row="130">0130      <font color="black">101</font> <font color="red">                        medium: 50,</font>                                                                                                                                                                                         </pre></div>
<div row="131"><pre row="131">0131      <font color="black">102</font> <font color="red">                        high: 100,</font>                                                                                                                                                                                          </pre></div>
<div row="132"><pre row="132">0132      <font color="black">103</font> <font color="red">                },</font>                                                                                                                                                                                                          </pre></div>
<div row="133"><pre row="133">0133      <font color="black">104</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="134"><pre row="134">0134      <font color="black">105</font> <font color="red">        const sf = pane.addFolder({</font>                                                                                                                                                                                         </pre></div>
<div row="135"><pre row="135">0135      <font color="black">106</font> <font color="red">                title: 'String',</font>                                                                                                                                                                                            </pre></div>
<div row="136"><pre row="136">0136      <font color="black">107</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="137"><pre row="137">0137      <font color="black">108</font> <font color="red">        sf.addInput(PARAMS, 's', {</font>                                                                                                                                                                                          </pre></div>
<div row="138"><pre row="138">0138      <font color="black">109</font> <font color="red">                label: 'text',</font>                                                                                                                                                                                              </pre></div>
<div row="139"><pre row="139">0139      <font color="black">110</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="140"><pre row="140">0140      <font color="black">111</font> <font color="red">        sf.addInput(PARAMS, 's', {</font>                                                                                                                                                                                          </pre></div>
<div row="141"><pre row="141">0141      <font color="black">112</font> <font color="red">                label: 'list',</font>                                                                                                                                                                                              </pre></div>
<div row="142"><pre row="142">0142      <font color="black">113</font> <font color="red">                options: {</font>                                                                                                                                                                                                  </pre></div>
<div row="143"><pre row="143">0143      <font color="black">114</font> <font color="red">                        dark: 'Dark',</font>                                                                                                                                                                                       </pre></div>
<div row="144"><pre row="144">0144      <font color="black">115</font> <font color="red">                        light: 'Light',</font>                                                                                                                                                                                     </pre></div>
<div row="145"><pre row="145">0145      <font color="black">116</font> <font color="red">                },</font>                                                                                                                                                                                                          </pre></div>
<div row="146"><pre row="146">0146      <font color="black">117</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="147"><pre row="147">0147      <font color="black">118</font> <font color="red">        const bf = pane.addFolder({</font>                                                                                                                                                                                         </pre></div>
<div row="148"><pre row="148">0148      <font color="black">119</font> <font color="red">                title: 'Boolean',</font>                                                                                                                                                                                           </pre></div>
<div row="149"><pre row="149">0149      <font color="black">120</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="150"><pre row="150">0150      <font color="black">121</font> <font color="red">        bf.addInput(PARAMS, 'b', {</font>                                                                                                                                                                                          </pre></div>
<div row="151"><pre row="151">0151      <font color="black">122</font> <font color="red">                label: 'checkbox',</font>                                                                                                                                                                                          </pre></div>
<div row="152"><pre row="152">0152      <font color="black">123</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="153"><pre row="153">0153      <font color="black">124</font> <font color="red">        const cf = pane.addFolder({</font>                                                                                                                                                                                         </pre></div>
<div row="154"><pre row="154">0154      <font color="black">125</font> <font color="red">                title: 'Color',</font>                                                                                                                                                                                             </pre></div>
<div row="155"><pre row="155">0155      <font color="black">126</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="156"><pre row="156">0156      <font color="black">127</font> <font color="red">        cf.addInput(PARAMS, 'c', {</font>                                                                                                                                                                                          </pre></div>
<div row="157"><pre row="157">0157      <font color="black">128</font> <font color="red">                label: 'text',</font>                                                                                                                                                                                              </pre></div>
<div row="158"><pre row="158">0158      <font color="black">129</font> <font color="red">        });</font>                                                                                                                                                                                                                 </pre></div>
<div row="159"><pre row="159">0159      <font color="black">130</font> <font color="red">//--------------------------------</font>                                                                                                                                                                                          </pre></div>
<div row="160"><pre row="160">0160      <font color="black">131</font> export default Spreadsheet;                                                                                     <font color="black">96</font> export default Spreadsheet;                                                                              </pre></div>
<div row="161"><pre row="161">0161      <font color="black">132</font> export {                                                                                                        <font color="black">97</font> export {                                                                                                 </pre></div>
<div row="162"><pre row="162">0162      <font color="black">133</font>   spreadsheet,                                                                                                  <font color="black">98</font>   spreadsheet,                                                                                           </pre></div>
<div row="163"><pre row="163">0163      <font color="black">134</font> };                                                                                                              <font color="black">99</font> };                                                                                                       </pre></div>
<div id="id-algorithm-bitmap_js"  class="pagelink" row="164"><pre class="pagehead" row="164">0164 id-algorithm-bitmap_js</pre></div>
<div><pre row="165"><code =class"javascript">0165 ../src/algorithm/bitmap.js             ../../x-spreadsheet/src/algorithm/bitmap.js</code></pre></div>
<div id="id-algorithm-expression_js"  class="pagelink" row="166"><pre class="pagehead" row="166">0166 id-algorithm-expression_js</pre></div>
<div><pre row="167"><code =class"javascript">0167 ../src/algorithm/expression.js             ../../x-spreadsheet/src/algorithm/expression.js</code></pre></div>
<div id="id-canvas-draw_js"  class="pagelink" row="168"><pre class="pagehead" row="168">0168 id-canvas-draw_js</pre></div>
<div row="169"><pre row="169">0169 <font color="blue">../src/canvas/draw.js</font>                                                                                              <font color="blue">../../x-spreadsheet/src/canvas/draw.js</font>                                                                            </pre></div>
<div row="170"><pre row="170">0170       <font color="black">39</font>     if (bottom) this.borderBottom = bottom;                                                                     <font color="black">39</font>     if (bottom) this.borderBottom = bottom;                                                              </pre></div>
<div row="171"><pre row="171">0171       <font color="black">40</font>     if (left) this.borderLeft = left;                                                                           <font color="black">40</font>     if (left) this.borderLeft = left;                                                                    </pre></div>
<div row="172"><pre row="172">0172       <font color="black">41</font>   }                                                                                                             <font color="black">41</font>   }                                                                                                      </pre></div>
<div row="173"><pre row="173">0173       <font color="black">42</font>                                                                                                                 <font color="black">42</font>                                                                                                          </pre></div>
<div row="174"><pre row="174">0174       <font color="black">43</font>   innerWidth() {                                                                                                <font color="black">43</font>   innerWidth() {                                                                                         </pre></div>
<div row="175"><pre row="175">0175       <font color="black">44</font>     return this.width - (this.padding * 2);                                                                     <font color="black">44</font>     return this.width - (this.padding * 2)<font color="green"> - 2</font>;                                                          </pre></div>
<div row="176"><pre row="176">0176       <font color="black">45</font>   }                                                                                                             <font color="black">45</font>   }                                                                                                      </pre></div>
<div row="177"><pre row="177">0177       <font color="black">46</font>                                                                                                                 <font color="black">46</font>                                                                                                          </pre></div>
<div row="178"><pre row="178">0178       <font color="black">47</font>   innerHeight() {                                                                                               <font color="black">47</font>   innerHeight() {                                                                                        </pre></div>
<div row="179"><pre row="179">0179       <font color="black">48</font>     return this.height - (this.padding * 2);                                                                    <font color="black">48</font>     return this.height - (this.padding * 2)<font color="green"> - 2</font>;                                                         </pre></div>
<div row="180"><pre row="180">0180       <font color="black">49</font>   }                                                                                                             <font color="black">49</font>   }                                                                                                      </pre></div>
<div row="181"><pre row="181">0181       <font color="black">50</font>                                                                                                                 <font color="black">50</font>                                                                                                          </pre></div>
<div row="182"><pre row="182">0182       <font color="black">51</font>   textx(align) {                                                                                                <font color="black">51</font>   textx(align) {                                                                                         </pre></div>
<div row="183"><pre row="183">0183       <font color="black">52</font>     const { width, padding } = this;                                                                            <font color="black">52</font>     const { width, padding } = this;                                                                     </pre></div>
<div row="184"><pre row="184">0184       <font color="black">53</font>     let { x } = this;                                                                                           <font color="black">53</font>     let { x } = this;                                                                                    </pre></div>
<div row="185"><pre row="185">0185 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="186"><pre row="186">0186       <font color="black">59</font>       x += width - padding;                                                                                     <font color="black">59</font>       x += width - padding;                                                                              </pre></div>
<div row="187"><pre row="187">0187       <font color="black">60</font>     }                                                                                                           <font color="black">60</font>     }                                                                                                    </pre></div>
<div row="188"><pre row="188">0188       <font color="black">61</font>     return x;                                                                                                   <font color="black">61</font>     return x;                                                                                            </pre></div>
<div row="189"><pre row="189">0189       <font color="black">62</font>   }                                                                                                             <font color="black">62</font>   }                                                                                                      </pre></div>
<div row="190"><pre row="190">0190       <font color="black">63</font>                                                                                                                 <font color="black">63</font>                                                                                                          </pre></div>
<div row="191"><pre row="191">0191       <font color="black">64</font> <font color="red">  texty(align, fontSize, hoffset) {</font>                                                                             <font color="black">64</font> <font color="green">  texty(align, h) {</font>                                                                                      </pre></div>
<div row="192"><pre row="192">0192       <font color="black">65</font>     const { height, padding } = this;                                                                           <font color="black">65</font>     const { height, padding } = this;                                                                    </pre></div>
<div row="193"><pre row="193">0193       <font color="black">66</font>     let { y } = this;                                                                                           <font color="black">66</font>     let { y } = this;                                                                                    </pre></div>
<div row="194"><pre row="194">0194       <font color="black">67</font>     if (align === 'top') {                                                                                      <font color="black">67</font>     if (align === 'top') {                                                                               </pre></div>
<div row="195"><pre row="195">0195       <font color="black">68</font>       y += padding;                                                                                             <font color="black">68</font>       y += padding;                                                                                      </pre></div>
<div row="196"><pre row="196">0196       <font color="black">69</font>     } else if (align === 'middle') {                                                                            <font color="black">69</font>     } else if (align === 'middle') {                                                                     </pre></div>
<div row="197"><pre row="197">0197       <font color="black">70</font>       y =<font color="red"> y +</font> height / 2 - h<font color="orange">offset</font>;                                                                             <font color="black">70</font>       y <font color="green">+</font>= height / 2 - h<font color="orange"> / 2</font>;                                                                           </pre></div>
<div row="198"><pre row="198">0198       <font color="black">71</font> <font color="red">      // y = y1;</font>                                                                                                                                                                                                            </pre></div>
<div row="199"><pre row="199">0199       <font color="black">72</font> <font color="red">      // const y2 = y + padding + fontSize / 2 + 1;</font>                                                                                                                                                                         </pre></div>
<div row="200"><pre row="200">0200       <font color="black">73</font> <font color="red">      // if (y1 &lt; y2) y = y2;</font>                                                                                                                                                                                               </pre></div>
<div row="201"><pre row="201">0201       <font color="black">74</font> <font color="red">      // else y = y1;</font>                                                                                                                                                                                                       </pre></div>
<div row="202"><pre row="202">0202       <font color="black">75</font>     } else if (align === 'bottom') {                                                                            <font color="black">71</font>     } else if (align === 'bottom') {                                                                     </pre></div>
<div row="203"><pre row="203">0203       <font color="black">76</font>       y += height -<font color="red"> hoffset * 2 -</font> padding;                                                                      <font color="black">72</font>       y += height - padding<font color="green"> - h</font>;                                                                         </pre></div>
<div row="204"><pre row="204">0204       <font color="black">77</font>     }                                                                                                           <font color="black">73</font>     }                                                                                                    </pre></div>
<div row="205"><pre row="205">0205       <font color="black">78</font>     return y;                                                                                                   <font color="black">74</font>     return y;                                                                                            </pre></div>
<div row="206"><pre row="206">0206       <font color="black">79</font>   }                                                                                                             <font color="black">75</font>   }                                                                                                      </pre></div>
<div row="207"><pre row="207">0207       <font color="black">80</font>                                                                                                                 <font color="black">76</font>                                                                                                          </pre></div>
<div row="208"><pre row="208">0208       <font color="black">81</font>   topxys() {                                                                                                    <font color="black">77</font>   topxys() {                                                                                             </pre></div>
<div row="209"><pre row="209">0209 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="210"><pre row="210">0210      <font color="black">212</font>         italic: false,                                                                                         <font color="black">208</font>         italic: false,                                                                                   </pre></div>
<div row="211"><pre row="211">0211      <font color="black">213</font>       }                                                                                                        <font color="black">209</font>       }                                                                                                  </pre></div>
<div row="212"><pre row="212">0212      <font color="black">214</font>     }                                                                                                          <font color="black">210</font>     }                                                                                                    </pre></div>
<div row="213"><pre row="213">0213      <font color="black">215</font>     textWrap: text wrapping                                                                                    <font color="black">211</font>     textWrap: text wrapping                                                                              </pre></div>
<div row="214"><pre row="214">0214      <font color="black">216</font>   */                                                                                                           <font color="black">212</font>   */                                                                                                     </pre></div>
<div row="215"><pre row="215">0215      <font color="black">217</font>   text(txt, box, attr = {}, textWrap = true) {                                                                 <font color="black">213</font>   text(<font color="green">m</font>txt, box, attr = {}, textWrap = true) {                                                          </pre></div>
<div row="216"><pre row="216">0216      <font color="black">218</font>     const { ctx } = this;                                                                                      <font color="black">214</font>     const { ctx } = this;                                                                                </pre></div>
<div row="217"><pre row="217">0217      <font color="black">219</font>     const {                                                                                                    <font color="black">215</font>     const {                                                                                              </pre></div>
<div row="218"><pre row="218">0218      <font color="black">220</font>       align, valign, font, color, strike, underline,                                                           <font color="black">216</font>       align, valign, font, color, strike, underline,                                                     </pre></div>
<div row="219"><pre row="219">0219      <font color="black">221</font>     } = attr;                                                                                                  <font color="black">217</font>     } = attr;                                                                                            </pre></div>
<div row="220"><pre row="220">0220      <font color="black">222</font>     const tx = box.textx(align);                                                                               <font color="black">218</font>     const tx = box.textx(align);                                                                         </pre></div>
<div row="221"><pre row="221">0221 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="222"><pre row="222">0222      <font color="black">227</font>       textBaseline: valign,                                                                                    <font color="black">223</font>       textBaseline: valign,                                                                              </pre></div>
<div row="223"><pre row="223">0223      <font color="black">228</font>       font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,      <font color="black">224</font>       font: `${font.italic ? 'italic' : ''} ${font.bold ? 'bold' : ''} ${npx(font.size)}px ${font.name}`,</pre></div>
<div row="224"><pre row="224">0224      <font color="black">229</font>       fillStyle: color,                                                                                        <font color="black">225</font>       fillStyle: color,                                                                                  </pre></div>
<div row="225"><pre row="225">0225      <font color="black">230</font>       strokeStyle: color,                                                                                      <font color="black">226</font>       strokeStyle: color,                                                                                </pre></div>
<div row="226"><pre row="226">0226      <font color="black">231</font>     });                                                                                                        <font color="black">227</font>     });                                                                                                  </pre></div>
<div row="227"><pre row="227">0227                                                                                                                         <font color="black">228</font> <font color="green">    const txts = `${mtxt}`.split('\n');</font>                                                                  </pre></div>
<div row="228"><pre row="228">0228                                                                                                                         <font color="black">229</font> <font color="green">    const biw = box.innerWidth();</font>                                                                        </pre></div>
<div row="229"><pre row="229">0229                                                                                                                         <font color="black">230</font> <font color="green">    const ntxts = [];</font>                                                                                    </pre></div>
<div row="230"><pre row="230">0230                                                                                                                         <font color="black">231</font> <font color="green">    txts.forEach((it) =&gt; {</font>                                                                               </pre></div>
<div row="231"><pre row="231">0231      <font color="black">232</font>     const txtWidth = ctx.measureText(<font color="orange">tx</font>t).width;                                                               <font color="black">232</font> <font color="green">  </font>    const txtWidth = ctx.measureText(<font color="orange">i</font>t).width;                                                        </pre></div>
<div row="232"><pre row="232">0232      <font color="black">233</font> <font color="red">    let hoffset = 0;</font>                                                                                                                                                                                                        </pre></div>
<div row="233"><pre row="233">0233      <font color="black">234</font> <font color="red">    if (textWrap) {</font>                                                                                                                                                                                                         </pre></div>
<div row="234"><pre row="234">0234      <font color="black">235</font> <font color="red">      const n = Math.ceil(txtWidth / box.innerWidth());</font>                                                                                                                                                                     </pre></div>
<div row="235"><pre row="235">0235      <font color="black">236</font> <font color="red">      hoffset = ((n - 1) * font.size) / 2;</font>                                                                                                                                                                                  </pre></div>
<div row="236"><pre row="236">0236      <font color="black">237</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre></div>
<div row="237"><pre row="237">0237      <font color="black">238</font> <font color="red">    let ty = box.texty(valign, font.size, hoffset);</font>                                                                                                                                                                         </pre></div>
<div row="238"><pre row="238">0238      <font color="black">239</font> <font color="red">    // console.log('tx: ', tx, ', ty:', ty);</font>                                                                                                                                                                                </pre></div>
<div row="239"><pre row="239">0239      <font color="black">240</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre></div>
<div row="240"><pre row="240">0240      <font color="black">241</font>     if (textWrap && txtWidth &gt; b<font color="red">ox.</font>i<font color="orange">nnerWidth(</font>)<font color="red">)</font> {                                                             <font color="black">233</font> <font color="green">  </font>    if (textWrap && txtWidth &gt; bi<font color="orange">w</font>) {                                                                  </pre></div>
<div row="241"><pre row="241">0241      <font color="black">242</font>       <font color="orange">cons</font>t textLine = { len: 0, start: 0 };                                                                   <font color="black">234</font>       <font color="orange">  le</font>t textLine = {<font color="green"> w: 0,</font> len: 0, start: 0 };                                                       </pre></div>
<div row="242"><pre row="242">0242      <font color="black">243</font>       for (let i = 0; i &lt; <font color="orange">tx</font>t.length; i += 1) {                                                                <font color="black">235</font> <font color="green">  </font>      for (let i = 0; i &lt; <font color="orange">i</font>t.length; i += 1) {                                                         </pre></div>
<div row="243"><pre row="243">0243      <font color="black">244</font> <font color="red">        if (textLine.len &gt;= box.innerWidth()) {</font>                                                                <font color="black">236</font> <font color="green">          if (textLine.w &gt;= biw) {</font>                                                                       </pre></div>
<div row="244"><pre row="244">0244      <font color="black">245</font> <font color="red">          this.fillText(txt.substring(textLine.start, i), tx, ty);</font>                                             <font color="black">237</font> <font color="green">            ntxts.push(it.substr(textLine.start, textLine.len));</font>                                         </pre></div>
<div row="245"><pre row="245">0245      <font color="black">246</font> <font color="red">          if (strike) {</font>                                                                                        <font color="black">238</font> <font color="green">            textLine = { w: 0, len: 0, start: i };</font>                                                       </pre></div>
<div row="246"><pre row="246">0246      <font color="black">247</font> <font color="red">            drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                              </pre></div>
<div row="247"><pre row="247">0247      <font color="black">248</font>           }                                                                                                    <font color="black">239</font>           }                                                                                              </pre></div>
<div row="248"><pre row="248">0248      <font color="black">249</font> <font color="red">          if (underline) {</font>                                                                                                                                                                                                  </pre></div>
<div row="249"><pre row="249">0249      <font color="black">250</font> <font color="red">            drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                           </pre></div>
<div row="250"><pre row="250">0250      <font color="black">251</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre></div>
<div row="251"><pre row="251">0251      <font color="black">252</font> <font color="red">          ty += font.size + 2;</font>                                                                                                                                                                                              </pre></div>
<div row="252"><pre row="252">0252      <font color="black">253</font>           textLine.len = <font color="orange">0</font>;                                                                                    <font color="black">240</font>           textLine.len <font color="green">+</font>= <font color="orange">1</font>;                                                                             </pre></div>
<div row="253"><pre row="253">0253      <font color="black">254</font> <font color="red">          textLine.start = i;</font>                                                                                  <font color="black">241</font> <font color="green">          textLine.w += ctx.measureText(it[i]).width + 1;</font>                                                </pre></div>
<div row="254"><pre row="254">0254      <font color="black">255</font>         }                                                                                                      <font color="black">242</font>         }                                                                                                </pre></div>
<div row="255"><pre row="255">0255      <font color="black">256</font> <font color="red">        textLine.len += ctx.measureText(txt[i]).width;</font>                                                                                                                                                                      </pre></div>
<div row="256"><pre row="256">0256      <font color="black">257</font> <font color="red">      }</font>                                                                                                                                                                                                                     </pre></div>
<div row="257"><pre row="257">0257      <font color="black">258</font>       if (textLine.len &gt; 0) {                                                                                  <font color="black">243</font> <font color="green">  </font>      if (textLine.len &gt; 0) {                                                                          </pre></div>
<div row="258"><pre row="258">0258      <font color="black">259</font> <font color="red">        this.fillText(txt.substring(textLine.start), tx, ty);</font>                                                  <font color="black">244</font> <font color="green">          ntxts.push(it.substr(textLine.start, textLine.len));</font>                                           </pre></div>
<div row="259"><pre row="259">0259      <font color="black">260</font> <font color="red">        if (strike) {</font>                                                                                                                                                                                                       </pre></div>
<div row="260"><pre row="260">0260      <font color="black">261</font> <font color="red">          drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                                </pre></div>
<div row="261"><pre row="261">0261      <font color="black">262</font>         }                                                                                                      <font color="black">245</font>         }                                                                                                </pre></div>
<div row="262"><pre row="262">0262      <font color="black">263</font> <font color="red">        if (underline) {</font>                                                                                                                                                                                                    </pre></div>
<div row="263"><pre row="263">0263      <font color="black">264</font> <font color="red">          drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                             </pre></div>
<div row="264"><pre row="264">0264      <font color="black">265</font> <font color="red">        }</font>                                                                                                                                                                                                                   </pre></div>
<div row="265"><pre row="265">0265      <font color="black">266</font> <font color="red">      }</font>                                                                                                                                                                                                                     </pre></div>
<div row="266"><pre row="266">0266      <font color="black">267</font> <font color="red">*/</font>                                                                                                                                                                                                                          </pre></div>
<div row="267"><pre row="267">0267      <font color="black">268</font> <font color="red">//    } else if ( txtWidth &gt; box.innerWidth()){</font>                                                                                                                                                                             </pre></div>
<div row="268"><pre row="268">0268      <font color="black">269</font> <font color="red">//     } else {</font>                                                                                                                                                                                                             </pre></div>
<div row="269"><pre row="269">0269      <font color="black">270</font> <font color="red">      const textLine = { len: 0, start: 0 };</font>                                                                                                                                                                                </pre></div>
<div row="270"><pre row="270">0270      <font color="black">271</font> <font color="red">//      console.log(txt);</font>                                                                                                                                                                                                   </pre></div>
<div row="271"><pre row="271">0271      <font color="black">272</font> <font color="red">      for (let i = 0; i &lt; txt.length; i += 1) {</font>                                                                                                                                                                             </pre></div>
<div row="272"><pre row="272">0272      <font color="black">273</font> <font color="red">        //console.log(txt.substring(textLine.start, i));</font>                                                                                                                                                                    </pre></div>
<div row="273"><pre row="273">0273      <font color="black">274</font> <font color="red">        //console.log(txt.substr(textLine.start+i, 1));</font>                                                                                                                                                                     </pre></div>
<div row="274"><pre row="274">0274      <font color="black">275</font> <font color="red">        //if (txt.substr(textLine.start+i, 1) == 'R') {</font>                                                                                                                                                                     </pre></div>
<div row="275"><pre row="275">0275      <font color="black">276</font> <font color="red">         let x = i - textLine.start;</font>                                                                                                                                                                                        </pre></div>
<div row="276"><pre row="276">0276      <font color="black">277</font> <font color="red">//        console.log("+ ",txt.substr(textLine.start+x, 1));</font>                                                                                                                                                                </pre></div>
<div row="277"><pre row="277">0277      <font color="black">278</font> <font color="red">        if (txt.substr(textLine.start+x, 1) == '\n') {</font>                                                                                                                                                                      </pre></div>
<div row="278"><pre row="278">0278      <font color="black">279</font> <font color="red">          this.fillText(txt.substring(textLine.start, i), tx, ty);</font>                                                                                                                                                          </pre></div>
<div row="279"><pre row="279">0279      <font color="black">280</font> <font color="red">          if (strike) {</font>                                                                                                                                                                                                     </pre></div>
<div row="280"><pre row="280">0280      <font color="black">281</font> <font color="red">            drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                              </pre></div>
<div row="281"><pre row="281">0281      <font color="black">282</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre></div>
<div row="282"><pre row="282">0282      <font color="black">283</font> <font color="red">          if (underline) {</font>                                                                                                                                                                                                  </pre></div>
<div row="283"><pre row="283">0283      <font color="black">284</font> <font color="red">            drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                           </pre></div>
<div row="284"><pre row="284">0284      <font color="black">285</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre></div>
<div row="285"><pre row="285">0285      <font color="black">286</font> <font color="red">          ty += font.size + 2; // next line</font>                                                                                                                                                                                 </pre></div>
<div row="286"><pre row="286">0286      <font color="black">287</font> <font color="red">          textLine.len = 0;</font>                                                                                                                                                                                                 </pre></div>
<div row="287"><pre row="287">0287      <font color="black">288</font> <font color="red">          i++;                 // \n skip</font>                                                                                                                                                                                   </pre></div>
<div row="288"><pre row="288">0288      <font color="black">289</font> <font color="red">          textLine.start = i;</font>                                                                                                                                                                                               </pre></div>
<div row="289"><pre row="289">0289      <font color="black">290</font> <font color="red">         /*else if (textLine.len &gt;= box.innerWidth()) {</font>                                                                                                                                                                     </pre></div>
<div row="290"><pre row="290">0290      <font color="black">291</font> <font color="red">          this.fillText(txt.substring(textLine.start, i), tx, ty);</font>                                                                                                                                                          </pre></div>
<div row="291"><pre row="291">0291      <font color="black">292</font> <font color="red">          if (strike) {</font>                                                                                                                                                                                                     </pre></div>
<div row="292"><pre row="292">0292      <font color="black">293</font> <font color="red">            drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                              </pre></div>
<div row="293"><pre row="293">0293      <font color="black">294</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre></div>
<div row="294"><pre row="294">0294      <font color="black">295</font> <font color="red">          if (underline) {</font>                                                                                                                                                                                                  </pre></div>
<div row="295"><pre row="295">0295      <font color="black">296</font> <font color="red">            drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                           </pre></div>
<div row="296"><pre row="296">0296      <font color="black">297</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre></div>
<div row="297"><pre row="297">0297      <font color="black">298</font> <font color="red">          ty += font.size + 2;</font>                                                                                                                                                                                              </pre></div>
<div row="298"><pre row="298">0298      <font color="black">299</font> <font color="red">          textLine.len = 0;</font>                                                                                                                                                                                                 </pre></div>
<div row="299"><pre row="299">0299      <font color="black">300</font> <font color="red">          textLine.start = i;</font>                                                                                                                                                                                               </pre></div>
<div row="300"><pre row="300">0300      <font color="black">301</font> <font color="red">        }*/</font>                                                                                                                                                                                                                 </pre></div>
<div row="301"><pre row="301">0301      <font color="black">302</font> <font color="red">        }else{</font>                                                                                                                                                                                                              </pre></div>
<div row="302"><pre row="302">0302      <font color="black">303</font> <font color="red">        textLine.len += ctx.measureText(txt[i]).width;</font>                                                                                                                                                                      </pre></div>
<div row="303"><pre row="303">0303      <font color="black">304</font> <font color="red">        }</font>                                                                                                                                                                                                                   </pre></div>
<div row="304"><pre row="304">0304      <font color="black">305</font> <font color="red">      } //for</font>                                                                                                                                                                                                               </pre></div>
<div row="305"><pre row="305">0305      <font color="black">306</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre></div>
<div row="306"><pre row="306">0306      <font color="black">307</font> <font color="red">      if (textLine.len &gt; 0) {</font>                                                                                                                                                                                               </pre></div>
<div row="307"><pre row="307">0307      <font color="black">308</font> <font color="red">//        console.log("&gt;&gt;",txt.substring(textLine.start));</font>                                                                                                                                                                  </pre></div>
<div row="308"><pre row="308">0308      <font color="black">309</font> <font color="red">          this.fillText(txt.substring(textLine.start), tx, ty);</font>                                                                                                                                                             </pre></div>
<div row="309"><pre row="309">0309      <font color="black">310</font> <font color="red">          if (strike) {</font>                                                                                                                                                                                                     </pre></div>
<div row="310"><pre row="310">0310      <font color="black">311</font> <font color="red">            drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                              </pre></div>
<div row="311"><pre row="311">0311      <font color="black">312</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre></div>
<div row="312"><pre row="312">0312      <font color="black">313</font> <font color="red">          if (underline) {</font>                                                                                                                                                                                                  </pre></div>
<div row="313"><pre row="313">0313      <font color="black">314</font> <font color="red">            drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, textLine.len);</font>                                                                                                                           </pre></div>
<div row="314"><pre row="314">0314      <font color="black">315</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre></div>
<div row="315"><pre row="315">0315      <font color="black">316</font> <font color="red">        }</font>                                                                                                                                                                                                                   </pre></div>
<div row="316"><pre row="316">0316      <font color="black">317</font> <font color="red">        </font>                                                                                                                                                                                                                    </pre></div>
<div row="317"><pre row="317">0317      <font color="black">318</font> <font color="red"> //     }</font>                                                                                                                                                                                                                   </pre></div>
<div row="318"><pre row="318">0318      <font color="black">319</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="319"><pre row="319">0319      <font color="black">320</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre></div>
<div row="320"><pre row="320">0320      <font color="black">321</font>     } else {                                                                                                   <font color="black">246</font> <font color="green">  </font>    } else {                                                                                           </pre></div>
<div row="321"><pre row="321">0321                                                                                                                         <font color="black">247</font> <font color="green">        ntxts.push(it);</font>                                                                                  </pre></div>
<div row="322"><pre row="322">0322                                                                                                                         <font color="black">248</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="323"><pre row="323">0323                                                                                                                         <font color="black">249</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="324"><pre row="324">0324                                                                                                                         <font color="black">250</font> <font color="green">    const txtHeight = (ntxts.length - 1) * (font.size + 2);</font>                                              </pre></div>
<div row="325"><pre row="325">0325                                                                                                                         <font color="black">251</font> <font color="green">    let ty = box.texty(valign, txtHeight);</font>                                                               </pre></div>
<div row="326"><pre row="326">0326                                                                                                                         <font color="black">252</font> <font color="green">    ntxts.forEach((txt) =&gt; {</font>                                                                             </pre></div>
<div row="327"><pre row="327">0327                                                                                                                         <font color="black">253</font> <font color="green">      const txtWidth = ctx.measureText(txt).width;</font>                                                       </pre></div>
<div row="328"><pre row="328">0328      <font color="black">322</font>       this.fillText(txt, tx, ty);                                                                              <font color="black">254</font>       this.fillText(txt, tx, ty);                                                                        </pre></div>
<div row="329"><pre row="329">0329      <font color="black">323</font>       if (strike) {                                                                                            <font color="black">255</font>       if (strike) {                                                                                      </pre></div>
<div row="330"><pre row="330">0330      <font color="black">324</font>         drawFontLine.call(this, 'strike<font color="red">t</font>', tx, ty, align, valign, font.size, txtWidth);                        <font color="black">256</font>         drawFontLine.call(this, 'strike', tx, ty, align, valign, font.size, txtWidth);                   </pre></div>
<div row="331"><pre row="331">0331      <font color="black">325</font>       }                                                                                                        <font color="black">257</font>       }                                                                                                  </pre></div>
<div row="332"><pre row="332">0332      <font color="black">326</font>       if (underline) {                                                                                         <font color="black">258</font>       if (underline) {                                                                                   </pre></div>
<div row="333"><pre row="333">0333      <font color="black">327</font>         drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);                      <font color="black">259</font>         drawFontLine.call(this, 'underline', tx, ty, align, valign, font.size, txtWidth);                </pre></div>
<div row="334"><pre row="334">0334      <font color="black">328</font>       }                                                                                                        <font color="black">260</font>       }                                                                                                  </pre></div>
<div row="335"><pre row="335">0335      <font color="black">329</font> <font color="red">*/</font>                                                                                                             <font color="black">261</font> <font color="green">      ty += font.size + 2;</font>                                                                               </pre></div>
<div row="336"><pre row="336">0336      <font color="black">330</font> <font color="red">//    }</font>                                                                                                        <font color="black">262</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="337"><pre row="337">0337      <font color="black">331</font>     ctx.restore();                                                                                             <font color="black">263</font>     ctx.restore();                                                                                       </pre></div>
<div row="338"><pre row="338">0338      <font color="black">332</font>     return this;                                                                                               <font color="black">264</font>     return this;                                                                                         </pre></div>
<div row="339"><pre row="339">0339      <font color="black">333</font>   }                                                                                                            <font color="black">265</font>   }                                                                                                      </pre></div>
<div row="340"><pre row="340">0340      <font color="black">334</font>                                                                                                                <font color="black">266</font>                                                                                                          </pre></div>
<div row="341"><pre row="341">0341      <font color="black">335</font>   border(style, color) {                                                                                       <font color="black">267</font>   border(style, color) {                                                                                 </pre></div>
<div row="342"><pre row="342">0342 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="343"><pre row="343">0343      <font color="black">424</font>     ctx.fillStyle = 'rgba(255, 0, 0, .65)';                                                                    <font color="black">356</font>     ctx.fillStyle = 'rgba(255, 0, 0, .65)';                                                              </pre></div>
<div row="344"><pre row="344">0344      <font color="black">425</font>     ctx.fill();                                                                                                <font color="black">357</font>     ctx.fill();                                                                                          </pre></div>
<div row="345"><pre row="345">0345      <font color="black">426</font>     ctx.restore();                                                                                             <font color="black">358</font>     ctx.restore();                                                                                       </pre></div>
<div row="346"><pre row="346">0346      <font color="black">427</font>   }                                                                                                            <font color="black">359</font>   }                                                                                                      </pre></div>
<div row="347"><pre row="347">0347      <font color="black">428</font>                                                                                                                <font color="black">360</font>                                                                                                          </pre></div>
<div row="348"><pre row="348">0348                                                                                                                         <font color="black">361</font> <font color="green">  frozen(box) {</font>                                                                                          </pre></div>
<div row="349"><pre row="349">0349                                                                                                                         <font color="black">362</font> <font color="green">    const { ctx } = this;</font>                                                                                </pre></div>
<div row="350"><pre row="350">0350                                                                                                                         <font color="black">363</font> <font color="green">    const { x, y, width } = box;</font>                                                                         </pre></div>
<div row="351"><pre row="351">0351                                                                                                                         <font color="black">364</font> <font color="green">    const sx = x + width - 1;</font>                                                                            </pre></div>
<div row="352"><pre row="352">0352                                                                                                                         <font color="black">365</font> <font color="green">    ctx.save();</font>                                                                                          </pre></div>
<div row="353"><pre row="353">0353                                                                                                                         <font color="black">366</font> <font color="green">    ctx.beginPath();</font>                                                                                     </pre></div>
<div row="354"><pre row="354">0354                                                                                                                         <font color="black">367</font> <font color="green">    ctx.moveTo(npx(sx - 8), npx(y - 1));</font>                                                                 </pre></div>
<div row="355"><pre row="355">0355                                                                                                                         <font color="black">368</font> <font color="green">    ctx.lineTo(npx(sx), npx(y - 1));</font>                                                                     </pre></div>
<div row="356"><pre row="356">0356                                                                                                                         <font color="black">369</font> <font color="green">    ctx.lineTo(npx(sx), npx(y + 8));</font>                                                                     </pre></div>
<div row="357"><pre row="357">0357                                                                                                                         <font color="black">370</font> <font color="green">    ctx.closePath();</font>                                                                                     </pre></div>
<div row="358"><pre row="358">0358                                                                                                                         <font color="black">371</font> <font color="green">    ctx.fillStyle = 'rgba(0, 255, 0, .85)';</font>                                                              </pre></div>
<div row="359"><pre row="359">0359                                                                                                                         <font color="black">372</font> <font color="green">    ctx.fill();</font>                                                                                          </pre></div>
<div row="360"><pre row="360">0360                                                                                                                         <font color="black">373</font> <font color="green">    ctx.restore();</font>                                                                                       </pre></div>
<div row="361"><pre row="361">0361                                                                                                                         <font color="black">374</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="362"><pre row="362">0362                                                                                                                         <font color="black">375</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="363"><pre row="363">0363      <font color="black">429</font>   rect(box, dtextcb) {                                                                                         <font color="black">376</font>   rect(box, dtextcb) {                                                                                   </pre></div>
<div row="364"><pre row="364">0364      <font color="black">430</font>     const { ctx } = this;                                                                                      <font color="black">377</font>     const { ctx } = this;                                                                                </pre></div>
<div row="365"><pre row="365">0365      <font color="black">431</font>     const {                                                                                                    <font color="black">378</font>     const {                                                                                              </pre></div>
<div row="366"><pre row="366">0366      <font color="black">432</font>       x, y, width, height, bgcolor,                                                                            <font color="black">379</font>       x, y, width, height, bgcolor,                                                                      </pre></div>
<div row="367"><pre row="367">0367      <font color="black">433</font>     } = box;                                                                                                   <font color="black">380</font>     } = box;                                                                                             </pre></div>
<div id="id-canvas-draw2_js"  class="pagelink" row="368"><pre class="pagehead" row="368">0368 id-canvas-draw2_js</pre></div>
<div><pre row="369"><code =class"javascript">0369 ../src/canvas/draw2.js             ../../x-spreadsheet/src/canvas/draw2.js</code></pre></div>
<div id="id-component-border_palette_js"  class="pagelink" row="370"><pre class="pagehead" row="370">0370 id-component-border_palette_js</pre></div>
<div><pre row="371"><code =class"javascript">0371 ../src/component/border_palette.js             ../../x-spreadsheet/src/component/border_palette.js</code></pre></div>
<div id="id-component-bottombar_js"  class="pagelink" row="372"><pre class="pagehead" row="372">0372 id-component-bottombar_js</pre></div>
<div row="373"><pre row="373">0373 <font color="blue">../src/component/bottombar.js</font>                                                                                      <font color="blue">../../x-spreadsheet/src/component/bottombar.js</font>                                                                    </pre></div>
<div row="374"><pre row="374">0374        <font color="black">1</font> import { h } from './element';                                                                                   <font color="black">1</font> import { h } from './element';                                                                           </pre></div>
<div row="375"><pre row="375">0375                                                                                                                           <font color="black">2</font> <font color="green">import { bindClickoutside, unbindClickoutside } from './event';</font>                                          </pre></div>
<div row="376"><pre row="376">0376        <font color="black">2</font> import { cssPrefix } from '../config';                                                                           <font color="black">3</font> import { cssPrefix } from '../config';                                                                   </pre></div>
<div row="377"><pre row="377">0377                                                                                                                           <font color="black">4</font> <font color="green">import Icon from './icon';</font>                                                                               </pre></div>
<div row="378"><pre row="378">0378                                                                                                                           <font color="black">5</font> <font color="green">import FormInput from './form_input';</font>                                                                    </pre></div>
<div row="379"><pre row="379">0379                                                                                                                           <font color="black">6</font> <font color="green">import Dropdown from './dropdown';</font>                                                                       </pre></div>
<div row="380"><pre row="380">0380                                                                                                                           <font color="black">7</font> <font color="green">import { xtoast } from './message';</font>                                                                      </pre></div>
<div row="381"><pre row="381">0381                                                                                                                           <font color="black">8</font> <font color="green">import { tf } from '../locale/locale';</font>                                                                   </pre></div>
<div row="382"><pre row="382">0382                                                                                                                           <font color="black">9</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="383"><pre row="383">0383                                                                                                                          <font color="black">10</font> <font color="green">class DropdownMore extends Dropdown {</font>                                                                    </pre></div>
<div row="384"><pre row="384">0384                                                                                                                          <font color="black">11</font> <font color="green">  constructor(click) {</font>                                                                                   </pre></div>
<div row="385"><pre row="385">0385                                                                                                                          <font color="black">12</font> <font color="green">    const icon = new Icon('ellipsis');</font>                                                                   </pre></div>
<div row="386"><pre row="386">0386                                                                                                                          <font color="black">13</font> <font color="green">    super(icon, 'auto', false, 'top-left');</font>                                                              </pre></div>
<div row="387"><pre row="387">0387                                                                                                                          <font color="black">14</font> <font color="green">    this.contentClick = click;</font>                                                                           </pre></div>
<div row="388"><pre row="388">0388                                                                                                                          <font color="black">15</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="389"><pre row="389">0389                                                                                                                          <font color="black">16</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="390"><pre row="390">0390                                                                                                                          <font color="black">17</font> <font color="green">  reset(items) {</font>                                                                                         </pre></div>
<div row="391"><pre row="391">0391                                                                                                                          <font color="black">18</font> <font color="green">    const eles = items.map((it, i) =&gt; h('div', `${cssPrefix}-item`)</font>                                      </pre></div>
<div row="392"><pre row="392">0392                                                                                                                          <font color="black">19</font> <font color="green">      .css('width', '150px')</font>                                                                             </pre></div>
<div row="393"><pre row="393">0393                                                                                                                          <font color="black">20</font> <font color="green">      .css('font-weight', 'normal')</font>                                                                      </pre></div>
<div row="394"><pre row="394">0394                                                                                                                          <font color="black">21</font> <font color="green">      .on('click', () =&gt; {</font>                                                                               </pre></div>
<div row="395"><pre row="395">0395                                                                                                                          <font color="black">22</font> <font color="green">        this.contentClick(i);</font>                                                                            </pre></div>
<div row="396"><pre row="396">0396                                                                                                                          <font color="black">23</font> <font color="green">        this.hide();</font>                                                                                     </pre></div>
<div row="397"><pre row="397">0397                                                                                                                          <font color="black">24</font> <font color="green">      })</font>                                                                                                 </pre></div>
<div row="398"><pre row="398">0398                                                                                                                          <font color="black">25</font> <font color="green">      .child(it));</font>                                                                                       </pre></div>
<div row="399"><pre row="399">0399                                                                                                                          <font color="black">26</font> <font color="green">    this.setContentChildren(...eles);</font>                                                                    </pre></div>
<div row="400"><pre row="400">0400                                                                                                                          <font color="black">27</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="401"><pre row="401">0401                                                                                                                          <font color="black">28</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="402"><pre row="402">0402                                                                                                                          <font color="black">29</font> <font color="green">  setTitle() {}</font>                                                                                          </pre></div>
<div row="403"><pre row="403">0403                                                                                                                          <font color="black">30</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="404"><pre row="404">0404                                                                                                                          <font color="black">31</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="405"><pre row="405">0405                                                                                                                          <font color="black">32</font> <font color="green">const menuItems = [</font>                                                                                      </pre></div>
<div row="406"><pre row="406">0406                                                                                                                          <font color="black">33</font> <font color="green">  { key: 'delete', title: tf('contextmenu.deleteSheet') },</font>                                               </pre></div>
<div row="407"><pre row="407">0407                                                                                                                          <font color="black">34</font> <font color="green">];</font>                                                                                                       </pre></div>
<div row="408"><pre row="408">0408                                                                                                                          <font color="black">35</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="409"><pre row="409">0409                                                                                                                          <font color="black">36</font> <font color="green">function buildMenuItem(item) {</font>                                                                           </pre></div>
<div row="410"><pre row="410">0410                                                                                                                          <font color="black">37</font> <font color="green">  return h('div', `${cssPrefix}-item`)</font>                                                                   </pre></div>
<div row="411"><pre row="411">0411                                                                                                                          <font color="black">38</font> <font color="green">    .child(item.title())</font>                                                                                 </pre></div>
<div row="412"><pre row="412">0412                                                                                                                          <font color="black">39</font> <font color="green">    .on('click', () =&gt; {</font>                                                                                 </pre></div>
<div row="413"><pre row="413">0413                                                                                                                          <font color="black">40</font> <font color="green">      this.itemClick(item.key);</font>                                                                          </pre></div>
<div row="414"><pre row="414">0414                                                                                                                          <font color="black">41</font> <font color="green">      this.hide();</font>                                                                                       </pre></div>
<div row="415"><pre row="415">0415                                                                                                                          <font color="black">42</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="416"><pre row="416">0416                                                                                                                          <font color="black">43</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="417"><pre row="417">0417                                                                                                                          <font color="black">44</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="418"><pre row="418">0418                                                                                                                          <font color="black">45</font> <font color="green">function buildMenu() {</font>                                                                                   </pre></div>
<div row="419"><pre row="419">0419                                                                                                                          <font color="black">46</font> <font color="green">  return menuItems.map(it =&gt; buildMenuItem.call(this, it));</font>                                              </pre></div>
<div row="420"><pre row="420">0420                                                                                                                          <font color="black">47</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="421"><pre row="421">0421                                                                                                                          <font color="black">48</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="422"><pre row="422">0422                                                                                                                          <font color="black">49</font> <font color="green">class ContextMenu {</font>                                                                                      </pre></div>
<div row="423"><pre row="423">0423                                                                                                                          <font color="black">50</font> <font color="green">  constructor() {</font>                                                                                        </pre></div>
<div row="424"><pre row="424">0424                                                                                                                          <font color="black">51</font> <font color="green">    this.el = h('div', `${cssPrefix}-contextmenu`)</font>                                                       </pre></div>
<div row="425"><pre row="425">0425                                                                                                                          <font color="black">52</font> <font color="green">      .css('width', '160px')</font>                                                                             </pre></div>
<div row="426"><pre row="426">0426                                                                                                                          <font color="black">53</font> <font color="green">      .children(...buildMenu.call(this))</font>                                                                 </pre></div>
<div row="427"><pre row="427">0427                                                                                                                          <font color="black">54</font> <font color="green">      .hide();</font>                                                                                           </pre></div>
<div row="428"><pre row="428">0428                                                                                                                          <font color="black">55</font> <font color="green">    this.itemClick = () =&gt; {};</font>                                                                           </pre></div>
<div row="429"><pre row="429">0429                                                                                                                          <font color="black">56</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="430"><pre row="430">0430                                                                                                                          <font color="black">57</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="431"><pre row="431">0431                                                                                                                          <font color="black">58</font> <font color="green">  hide() {</font>                                                                                               </pre></div>
<div row="432"><pre row="432">0432                                                                                                                          <font color="black">59</font> <font color="green">    const { el } = this;</font>                                                                                 </pre></div>
<div row="433"><pre row="433">0433                                                                                                                          <font color="black">60</font> <font color="green">    el.hide();</font>                                                                                           </pre></div>
<div row="434"><pre row="434">0434                                                                                                                          <font color="black">61</font> <font color="green">    unbindClickoutside(el);</font>                                                                              </pre></div>
<div row="435"><pre row="435">0435                                                                                                                          <font color="black">62</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="436"><pre row="436">0436                                                                                                                          <font color="black">63</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="437"><pre row="437">0437                                                                                                                          <font color="black">64</font> <font color="green">  setOffset(offset) {</font>                                                                                    </pre></div>
<div row="438"><pre row="438">0438                                                                                                                          <font color="black">65</font> <font color="green">    const { el } = this;</font>                                                                                 </pre></div>
<div row="439"><pre row="439">0439                                                                                                                          <font color="black">66</font> <font color="green">    el.offset(offset);</font>                                                                                   </pre></div>
<div row="440"><pre row="440">0440                                                                                                                          <font color="black">67</font> <font color="green">    el.show();</font>                                                                                           </pre></div>
<div row="441"><pre row="441">0441                                                                                                                          <font color="black">68</font> <font color="green">    bindClickoutside(el);</font>                                                                                </pre></div>
<div row="442"><pre row="442">0442                                                                                                                          <font color="black">69</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="443"><pre row="443">0443                                                                                                                          <font color="black">70</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="444"><pre row="444">0444        <font color="black">3</font>                                                                                                                 <font color="black">71</font>                                                                                                          </pre></div>
<div row="445"><pre row="445">0445        <font color="black">4</font> export default class Bottombar {                                                                                <font color="black">72</font> export default class Bottombar {                                                                         </pre></div>
<div row="446"><pre row="446">0446        <font color="black">5</font> <font color="red">  constructor(datas) {</font>                                                                                          <font color="black">73</font> <font color="green">  constructor(addFunc = () =&gt; {},</font>                                                                        </pre></div>
<div row="447"><pre row="447">0447                                                                                                                          <font color="black">74</font> <font color="green">    swapFunc = () =&gt; {},</font>                                                                                 </pre></div>
<div row="448"><pre row="448">0448                                                                                                                          <font color="black">75</font> <font color="green">    deleteFunc = () =&gt; {},</font>                                                                               </pre></div>
<div row="449"><pre row="449">0449                                                                                                                          <font color="black">76</font> <font color="green">    updateFunc = () =&gt; {}) {</font>                                                                             </pre></div>
<div row="450"><pre row="450">0450                                                                                                                          <font color="black">77</font> <font color="green">    this.swapFunc = swapFunc;</font>                                                                            </pre></div>
<div row="451"><pre row="451">0451                                                                                                                          <font color="black">78</font> <font color="green">    this.updateFunc = updateFunc;</font>                                                                        </pre></div>
<div row="452"><pre row="452">0452        <font color="black">6</font>     this.datas = <font color="orange">datas</font>;                                                                                         <font color="black">79</font>     this.data<font color="green">Name</font>s = <font color="orange">[]</font>;                                                                                 </pre></div>
<div row="453"><pre row="453">0453                                                                                                                          <font color="black">80</font> <font color="green">    this.activeEl = null;</font>                                                                                </pre></div>
<div row="454"><pre row="454">0454                                                                                                                          <font color="black">81</font> <font color="green">    this.deleteEl = null;</font>                                                                                </pre></div>
<div row="455"><pre row="455">0455                                                                                                                          <font color="black">82</font> <font color="green">    this.items = [];</font>                                                                                     </pre></div>
<div row="456"><pre row="456">0456                                                                                                                          <font color="black">83</font> <font color="green">    this.moreEl = new DropdownMore((i) =&gt; {</font>                                                              </pre></div>
<div row="457"><pre row="457">0457                                                                                                                          <font color="black">84</font> <font color="green">      this.clickSwap2(this.items[i]);</font>                                                                    </pre></div>
<div row="458"><pre row="458">0458                                                                                                                          <font color="black">85</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="459"><pre row="459">0459                                                                                                                          <font color="black">86</font> <font color="green">    this.contextMenu = new ContextMenu();</font>                                                                </pre></div>
<div row="460"><pre row="460">0460                                                                                                                          <font color="black">87</font> <font color="green">    this.contextMenu.itemClick = deleteFunc;</font>                                                             </pre></div>
<div row="461"><pre row="461">0461        <font color="black">7</font>     this.el = h('div', `${cssPrefix}-bottombar`)<font color="orange">;</font>                                                               <font color="black">88</font>     this.el = h('div', `${cssPrefix}-bottombar`)<font color="orange">.children(</font>                                               </pre></div>
<div row="462"><pre row="462">0462                                                                                                                          <font color="black">89</font> <font color="green">      this.contextMenu.el,</font>                                                                               </pre></div>
<div row="463"><pre row="463">0463                                                                                                                          <font color="black">90</font> <font color="green">      this.menuEl = h('ul', `${cssPrefix}-menu`).child(</font>                                                  </pre></div>
<div row="464"><pre row="464">0464                                                                                                                          <font color="black">91</font> <font color="green">        h('li', '').children(</font>                                                                            </pre></div>
<div row="465"><pre row="465">0465                                                                                                                          <font color="black">92</font> <font color="green">          new Icon('add').on('click', () =&gt; {</font>                                                            </pre></div>
<div row="466"><pre row="466">0466                                                                                                                          <font color="black">93</font> <font color="green">            if (this.dataNames.length &lt; 10) {</font>                                                            </pre></div>
<div row="467"><pre row="467">0467                                                                                                                          <font color="black">94</font> <font color="green">              addFunc();</font>                                                                                 </pre></div>
<div row="468"><pre row="468">0468                                                                                                                          <font color="black">95</font> <font color="green">            } else {</font>                                                                                     </pre></div>
<div row="469"><pre row="469">0469                                                                                                                          <font color="black">96</font> <font color="green">              xtoast('tip', 'it less than or equal to 10');</font>                                              </pre></div>
<div row="470"><pre row="470">0470                                                                                                                          <font color="black">97</font> <font color="green">            }</font>                                                                                            </pre></div>
<div row="471"><pre row="471">0471                                                                                                                          <font color="black">98</font> <font color="green">          }),</font>                                                                                            </pre></div>
<div row="472"><pre row="472">0472                                                                                                                          <font color="black">99</font> <font color="green">          h('span', '').child(this.moreEl),</font>                                                              </pre></div>
<div row="473"><pre row="473">0473                                                                                                                         <font color="black">100</font> <font color="green">        ),</font>                                                                                               </pre></div>
<div row="474"><pre row="474">0474                                                                                                                         <font color="black">101</font> <font color="green">      ),</font>                                                                                                 </pre></div>
<div row="475"><pre row="475">0475                                                                                                                         <font color="black">102</font> <font color="green">    );</font>                                                                                                   </pre></div>
<div row="476"><pre row="476">0476                                                                                                                         <font color="black">103</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="477"><pre row="477">0477                                                                                                                         <font color="black">104</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="478"><pre row="478">0478                                                                                                                         <font color="black">105</font> <font color="green">  addItem(name, active) {</font>                                                                                </pre></div>
<div row="479"><pre row="479">0479                                                                                                                         <font color="black">106</font> <font color="green">    this.dataNames.push(name);</font>                                                                           </pre></div>
<div row="480"><pre row="480">0480                                                                                                                         <font color="black">107</font> <font color="green">    const item = h('li', active ? 'active' : '').child(name);</font>                                            </pre></div>
<div row="481"><pre row="481">0481                                                                                                                         <font color="black">108</font> <font color="green">    item.on('click', () =&gt; {</font>                                                                             </pre></div>
<div row="482"><pre row="482">0482                                                                                                                         <font color="black">109</font> <font color="green">      this.clickSwap2(item);</font>                                                                             </pre></div>
<div row="483"><pre row="483">0483                                                                                                                         <font color="black">110</font> <font color="green">    }).on('contextmenu', (evt) =&gt; {</font>                                                                      </pre></div>
<div row="484"><pre row="484">0484                                                                                                                         <font color="black">111</font> <font color="green">      const { offsetLeft, offsetHeight } = evt.target;</font>                                                   </pre></div>
<div row="485"><pre row="485">0485                                                                                                                         <font color="black">112</font> <font color="green">      this.contextMenu.setOffset({ left: offsetLeft, bottom: offsetHeight + 1 });</font>                        </pre></div>
<div row="486"><pre row="486">0486                                                                                                                         <font color="black">113</font> <font color="green">      this.deleteEl = item;</font>                                                                              </pre></div>
<div row="487"><pre row="487">0487                                                                                                                         <font color="black">114</font> <font color="green">    }).on('dblclick', () =&gt; {</font>                                                                            </pre></div>
<div row="488"><pre row="488">0488                                                                                                                         <font color="black">115</font> <font color="green">      const v = item.html();</font>                                                                             </pre></div>
<div row="489"><pre row="489">0489                                                                                                                         <font color="black">116</font> <font color="green">      const input = new FormInput('auto', '');</font>                                                           </pre></div>
<div row="490"><pre row="490">0490                                                                                                                         <font color="black">117</font> <font color="green">      input.val(v);</font>                                                                                      </pre></div>
<div row="491"><pre row="491">0491                                                                                                                         <font color="black">118</font> <font color="green">      input.input.on('blur', ({ target }) =&gt; {</font>                                                           </pre></div>
<div row="492"><pre row="492">0492                                                                                                                         <font color="black">119</font> <font color="green">        const { value } = target;</font>                                                                        </pre></div>
<div row="493"><pre row="493">0493                                                                                                                         <font color="black">120</font> <font color="green">        const nindex = this.dataNames.findIndex(it =&gt; it === v);</font>                                         </pre></div>
<div row="494"><pre row="494">0494                                                                                                                         <font color="black">121</font> <font color="green">        this.dataNames.splice(nindex, 1, value);</font>                                                         </pre></div>
<div row="495"><pre row="495">0495                                                                                                                         <font color="black">122</font> <font color="green">        this.moreEl.reset(this.dataNames);</font>                                                               </pre></div>
<div row="496"><pre row="496">0496                                                                                                                         <font color="black">123</font> <font color="green">        item.html('').child(value);</font>                                                                      </pre></div>
<div row="497"><pre row="497">0497                                                                                                                         <font color="black">124</font> <font color="green">        this.updateFunc(nindex, value);</font>                                                                  </pre></div>
<div row="498"><pre row="498">0498                                                                                                                         <font color="black">125</font> <font color="green">      });</font>                                                                                                </pre></div>
<div row="499"><pre row="499">0499                                                                                                                         <font color="black">126</font> <font color="green">      item.html('').child(input.el);</font>                                                                     </pre></div>
<div row="500"><pre row="500">0500                                                                                                                         <font color="black">127</font> <font color="green">      input.focus();</font>                                                                                     </pre></div>
<div row="501"><pre row="501">0501                                                                                                                         <font color="black">128</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="502"><pre row="502">0502                                                                                                                         <font color="black">129</font> <font color="green">    if (active) {</font>                                                                                        </pre></div>
<div row="503"><pre row="503">0503                                                                                                                         <font color="black">130</font> <font color="green">      this.clickSwap(item);</font>                                                                              </pre></div>
<div row="504"><pre row="504">0504                                                                                                                         <font color="black">131</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="505"><pre row="505">0505                                                                                                                         <font color="black">132</font> <font color="green">    this.items.push(item);</font>                                                                               </pre></div>
<div row="506"><pre row="506">0506                                                                                                                         <font color="black">133</font> <font color="green">    this.menuEl.child(item);</font>                                                                             </pre></div>
<div row="507"><pre row="507">0507                                                                                                                         <font color="black">134</font> <font color="green">    this.moreEl.reset(this.dataNames);</font>                                                                   </pre></div>
<div row="508"><pre row="508">0508                                                                                                                         <font color="black">135</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="509"><pre row="509">0509                                                                                                                         <font color="black">136</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="510"><pre row="510">0510                                                                                                                         <font color="black">137</font> <font color="green">  deleteItem() {</font>                                                                                         </pre></div>
<div row="511"><pre row="511">0511                                                                                                                         <font color="black">138</font> <font color="green">    const { activeEl, deleteEl } = this;</font>                                                                 </pre></div>
<div row="512"><pre row="512">0512                                                                                                                         <font color="black">139</font> <font color="green">    if (this.items.length &gt; 1) {</font>                                                                         </pre></div>
<div row="513"><pre row="513">0513                                                                                                                         <font color="black">140</font> <font color="green">      const index = this.items.findIndex(it =&gt; it === deleteEl);</font>                                         </pre></div>
<div row="514"><pre row="514">0514                                                                                                                         <font color="black">141</font> <font color="green">      this.items.splice(index, 1);</font>                                                                       </pre></div>
<div row="515"><pre row="515">0515                                                                                                                         <font color="black">142</font> <font color="green">      this.dataNames.splice(index, 1);</font>                                                                   </pre></div>
<div row="516"><pre row="516">0516                                                                                                                         <font color="black">143</font> <font color="green">      this.menuEl.removeChild(deleteEl.el);</font>                                                              </pre></div>
<div row="517"><pre row="517">0517                                                                                                                         <font color="black">144</font> <font color="green">      this.moreEl.reset(this.dataNames);</font>                                                                 </pre></div>
<div row="518"><pre row="518">0518                                                                                                                         <font color="black">145</font> <font color="green">      if (activeEl === deleteEl) {</font>                                                                       </pre></div>
<div row="519"><pre row="519">0519                                                                                                                         <font color="black">146</font> <font color="green">        const [f] = this.items;</font>                                                                          </pre></div>
<div row="520"><pre row="520">0520                                                                                                                         <font color="black">147</font> <font color="green">        this.activeEl = f;</font>                                                                               </pre></div>
<div row="521"><pre row="521">0521                                                                                                                         <font color="black">148</font> <font color="green">        this.activeEl.toggle();</font>                                                                          </pre></div>
<div row="522"><pre row="522">0522                                                                                                                         <font color="black">149</font> <font color="green">        return [index, 0];</font>                                                                               </pre></div>
<div row="523"><pre row="523">0523                                                                                                                         <font color="black">150</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="524"><pre row="524">0524                                                                                                                         <font color="black">151</font> <font color="green">      return [index, -1];</font>                                                                                </pre></div>
<div row="525"><pre row="525">0525                                                                                                                         <font color="black">152</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="526"><pre row="526">0526                                                                                                                         <font color="black">153</font> <font color="green">    return [-1];</font>                                                                                         </pre></div>
<div row="527"><pre row="527">0527                                                                                                                         <font color="black">154</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="528"><pre row="528">0528                                                                                                                         <font color="black">155</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="529"><pre row="529">0529                                                                                                                         <font color="black">156</font> <font color="green">  clickSwap2(item) {</font>                                                                                     </pre></div>
<div row="530"><pre row="530">0530                                                                                                                         <font color="black">157</font> <font color="green">    const index = this.items.findIndex(it =&gt; it === item);</font>                                               </pre></div>
<div row="531"><pre row="531">0531                                                                                                                         <font color="black">158</font> <font color="green">    this.clickSwap(item);</font>                                                                                </pre></div>
<div row="532"><pre row="532">0532                                                                                                                         <font color="black">159</font> <font color="green">    this.activeEl.toggle();</font>                                                                              </pre></div>
<div row="533"><pre row="533">0533                                                                                                                         <font color="black">160</font> <font color="green">    this.swapFunc(index);</font>                                                                                </pre></div>
<div row="534"><pre row="534">0534                                                                                                                         <font color="black">161</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="535"><pre row="535">0535                                                                                                                         <font color="black">162</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="536"><pre row="536">0536                                                                                                                         <font color="black">163</font> <font color="green">  clickSwap(item) {</font>                                                                                      </pre></div>
<div row="537"><pre row="537">0537                                                                                                                         <font color="black">164</font> <font color="green">    if (this.activeEl !== null) {</font>                                                                        </pre></div>
<div row="538"><pre row="538">0538                                                                                                                         <font color="black">165</font> <font color="green">      this.activeEl.toggle();</font>                                                                            </pre></div>
<div row="539"><pre row="539">0539                                                                                                                         <font color="black">166</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="540"><pre row="540">0540                                                                                                                         <font color="black">167</font> <font color="green">    this.activeEl = item;</font>                                                                                </pre></div>
<div row="541"><pre row="541">0541        <font color="black">8</font>   }                                                                                                            <font color="black">168</font>   }                                                                                                      </pre></div>
<div row="542"><pre row="542">0542        <font color="black">9</font> }                                                                                                              <font color="black">169</font> }                                                                                                        </pre></div>
<div id="id-component-button_js"  class="pagelink" row="543"><pre class="pagehead" row="543">0543 id-component-button_js</pre></div>
<div><pre row="544"><code =class"javascript">0544 ../src/component/button.js             ../../x-spreadsheet/src/component/button.js</code></pre></div>
<div id="id-component-calendar_js"  class="pagelink" row="545"><pre class="pagehead" row="545">0545 id-component-calendar_js</pre></div>
<div><pre row="546"><code =class"javascript">0546 ../src/component/calendar.js             ../../x-spreadsheet/src/component/calendar.js</code></pre></div>
<div id="id-component-color_palette_js"  class="pagelink" row="547"><pre class="pagehead" row="547">0547 id-component-color_palette_js</pre></div>
<div><pre row="548"><code =class"javascript">0548 ../src/component/color_palette.js             ../../x-spreadsheet/src/component/color_palette.js</code></pre></div>
<div id="id-component-contextmenu_js"  class="pagelink" row="549"><pre class="pagehead" row="549">0549 id-component-contextmenu_js</pre></div>
<div row="550"><pre row="550">0550 <font color="blue">../src/component/contextmenu.js</font>                                                                                    <font color="blue">../../x-spreadsheet/src/component/contextmenu.js</font>                                                                  </pre></div>
<div row="551"><pre row="551">0551       <font color="black">14</font>   { key: 'insert-column', title: tf('contextmenu.insertColumn') },                                              <font color="black">14</font>   { key: 'insert-column', title: tf('contextmenu.insertColumn') },                                       </pre></div>
<div row="552"><pre row="552">0552       <font color="black">15</font>   { key: 'divider' },                                                                                           <font color="black">15</font>   { key: 'divider' },                                                                                    </pre></div>
<div row="553"><pre row="553">0553       <font color="black">16</font>   { key: 'delete-row', title: tf('contextmenu.deleteRow') },                                                    <font color="black">16</font>   { key: 'delete-row', title: tf('contextmenu.deleteRow') },                                             </pre></div>
<div row="554"><pre row="554">0554       <font color="black">17</font>   { key: 'delete-column', title: tf('contextmenu.deleteColumn') },                                              <font color="black">17</font>   { key: 'delete-column', title: tf('contextmenu.deleteColumn') },                                       </pre></div>
<div row="555"><pre row="555">0555       <font color="black">18</font>   { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },                                         <font color="black">18</font>   { key: 'delete-cell-text', title: tf('contextmenu.deleteCellText') },                                  </pre></div>
<div row="556"><pre row="556">0556                                                                                                                          <font color="black">19</font> <font color="green">  { key: 'hide', title: tf('contextmenu.hide') },</font>                                                        </pre></div>
<div row="557"><pre row="557">0557       <font color="black">19</font>   { key: 'divider' },                                                                                           <font color="black">20</font>   { key: 'divider' },                                                                                    </pre></div>
<div row="558"><pre row="558">0558       <font color="black">20</font>   { key: 'validation', title: tf('contextmenu.validation') },                                                   <font color="black">21</font>   { key: 'validation', title: tf('contextmenu.validation') },                                            </pre></div>
<div row="559"><pre row="559">0559                                                                                                                          <font color="black">22</font> <font color="green">  { key: 'divider' },</font>                                                                                    </pre></div>
<div row="560"><pre row="560">0560                                                                                                                          <font color="black">23</font> <font color="green">  { key: 'cell-printable', title: tf('contextmenu.cellprintable') },</font>                                     </pre></div>
<div row="561"><pre row="561">0561                                                                                                                          <font color="black">24</font> <font color="green">  { key: 'cell-non-printable', title: tf('contextmenu.cellnonprintable') },</font>                              </pre></div>
<div row="562"><pre row="562">0562                                                                                                                          <font color="black">25</font> <font color="green">  { key: 'divider' },</font>                                                                                    </pre></div>
<div row="563"><pre row="563">0563                                                                                                                          <font color="black">26</font> <font color="green">  { key: 'cell-editable', title: tf('contextmenu.celleditable') },</font>                                       </pre></div>
<div row="564"><pre row="564">0564                                                                                                                          <font color="black">27</font> <font color="green">  { key: 'cell-non-editable', title: tf('contextmenu.cellnoneditable') },</font>                                </pre></div>
<div row="565"><pre row="565">0565       <font color="black">21</font> ];                                                                                                              <font color="black">28</font> ];                                                                                                       </pre></div>
<div row="566"><pre row="566">0566       <font color="black">22</font>                                                                                                                 <font color="black">29</font>                                                                                                          </pre></div>
<div row="567"><pre row="567">0567       <font color="black">23</font> function buildMenuItem(item) {                                                                                  <font color="black">30</font> function buildMenuItem(item) {                                                                           </pre></div>
<div row="568"><pre row="568">0568       <font color="black">24</font>   if (item.key === 'divider') {                                                                                 <font color="black">31</font>   if (item.key === 'divider') {                                                                          </pre></div>
<div row="569"><pre row="569">0569       <font color="black">25</font>     return h('div', `${cssPrefix}-item divider`);                                                               <font color="black">32</font>     return h('div', `${cssPrefix}-item divider`);                                                        </pre></div>
<div row="570"><pre row="570">0570 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="571"><pre row="571">0571       <font color="black">39</font>   return menuItems.map(it =&gt; buildMenuItem.call(this, it));                                                     <font color="black">46</font>   return menuItems.map(it =&gt; buildMenuItem.call(this, it));                                              </pre></div>
<div row="572"><pre row="572">0572       <font color="black">40</font> }                                                                                                               <font color="black">47</font> }                                                                                                        </pre></div>
<div row="573"><pre row="573">0573       <font color="black">41</font>                                                                                                                 <font color="black">48</font>                                                                                                          </pre></div>
<div row="574"><pre row="574">0574       <font color="black">42</font> export default class ContextMenu {                                                                              <font color="black">49</font> export default class ContextMenu {                                                                       </pre></div>
<div row="575"><pre row="575">0575       <font color="black">43</font>   constructor(viewFn, isHide = false) {                                                                         <font color="black">50</font>   constructor(viewFn, isHide = false) {                                                                  </pre></div>
<div row="576"><pre row="576">0576                                                                                                                          <font color="black">51</font> <font color="green">    this.menuItems = buildMenu.call(this);</font>                                                               </pre></div>
<div row="577"><pre row="577">0577       <font color="black">44</font>     this.el = h('div', `${cssPrefix}-contextmenu`)                                                              <font color="black">52</font>     this.el = h('div', `${cssPrefix}-contextmenu`)                                                       </pre></div>
<div row="578"><pre row="578">0578       <font color="black">45</font> <font color="red">      .children(...buildMenu.call(this))</font>                                                                        <font color="black">53</font> <font color="green">      .children(...this.menuItems)</font>                                                                       </pre></div>
<div row="579"><pre row="579">0579       <font color="black">46</font>       .hide();                                                                                                  <font color="black">54</font>       .hide();                                                                                           </pre></div>
<div row="580"><pre row="580">0580       <font color="black">47</font>     this.viewFn = viewFn;                                                                                       <font color="black">55</font>     this.viewFn = viewFn;                                                                                </pre></div>
<div row="581"><pre row="581">0581       <font color="black">48</font>     this.itemClick = () =&gt; {};                                                                                  <font color="black">56</font>     this.itemClick = () =&gt; {};                                                                           </pre></div>
<div row="582"><pre row="582">0582       <font color="black">49</font>     this.isHide = isHide;                                                                                       <font color="black">57</font>     this.isHide = isHide;                                                                                </pre></div>
<div row="583"><pre row="583">0583                                                                                                                          <font color="black">58</font> <font color="green">    this.setMode('range');</font>                                                                               </pre></div>
<div row="584"><pre row="584">0584                                                                                                                          <font color="black">59</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="585"><pre row="585">0585                                                                                                                          <font color="black">60</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="586"><pre row="586">0586                                                                                                                          <font color="black">61</font> <font color="green">  // row-col: the whole rows or the whole cols</font>                                                           </pre></div>
<div row="587"><pre row="587">0587                                                                                                                          <font color="black">62</font> <font color="green">  // range: select range</font>                                                                                 </pre></div>
<div row="588"><pre row="588">0588                                                                                                                          <font color="black">63</font> <font color="green">  setMode(mode) {</font>                                                                                        </pre></div>
<div row="589"><pre row="589">0589                                                                                                                          <font color="black">64</font> <font color="green">    const hideEl = this.menuItems[12];</font>                                                                   </pre></div>
<div row="590"><pre row="590">0590                                                                                                                          <font color="black">65</font> <font color="green">    if (mode === 'row-col') {</font>                                                                            </pre></div>
<div row="591"><pre row="591">0591                                                                                                                          <font color="black">66</font> <font color="green">      hideEl.show();</font>                                                                                     </pre></div>
<div row="592"><pre row="592">0592                                                                                                                          <font color="black">67</font> <font color="green">    } else {</font>                                                                                             </pre></div>
<div row="593"><pre row="593">0593                                                                                                                          <font color="black">68</font> <font color="green">      hideEl.hide();</font>                                                                                     </pre></div>
<div row="594"><pre row="594">0594                                                                                                                          <font color="black">69</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="595"><pre row="595">0595       <font color="black">50</font>   }                                                                                                             <font color="black">70</font>   }                                                                                                      </pre></div>
<div row="596"><pre row="596">0596       <font color="black">51</font>                                                                                                                 <font color="black">71</font>                                                                                                          </pre></div>
<div row="597"><pre row="597">0597       <font color="black">52</font>   hide() {                                                                                                      <font color="black">72</font>   hide() {                                                                                               </pre></div>
<div row="598"><pre row="598">0598       <font color="black">53</font>     const { el } = this;                                                                                        <font color="black">73</font>     const { el } = this;                                                                                 </pre></div>
<div row="599"><pre row="599">0599       <font color="black">54</font>     el.hide();                                                                                                  <font color="black">74</font>     el.hide();                                                                                           </pre></div>
<div row="600"><pre row="600">0600 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="601"><pre row="601">0601       <font color="black">56</font>   }                                                                                                             <font color="black">76</font>   }                                                                                                      </pre></div>
<div row="602"><pre row="602">0602       <font color="black">57</font>                                                                                                                 <font color="black">77</font>                                                                                                          </pre></div>
<div row="603"><pre row="603">0603       <font color="black">58</font>   setPosition(x, y) {                                                                                           <font color="black">78</font>   setPosition(x, y) {                                                                                    </pre></div>
<div row="604"><pre row="604">0604       <font color="black">59</font>     if (this.isHide) return;                                                                                    <font color="black">79</font>     if (this.isHide) return;                                                                             </pre></div>
<div row="605"><pre row="605">0605       <font color="black">60</font>     const { el } = this;                                                                                        <font color="black">80</font>     const { el } = this;                                                                                 </pre></div>
<div row="606"><pre row="606">0606       <font color="black">61</font>     const {<font color="red"> height,</font> width } = el.show().offset();                                                               <font color="black">81</font>     const { width } = el.show().offset();                                                                </pre></div>
<div row="607"><pre row="607">0607       <font color="black">62</font>     const view = this.viewFn();                                                                                 <font color="black">82</font>     const view = this.viewFn();                                                                          </pre></div>
<div row="608"><pre row="608">0608       <font color="black">63</font> <font color="red">    let top = y;</font>                                                                                                <font color="black">83</font> <font color="green">    const vhf = view.height / 2;</font>                                                                         </pre></div>
<div row="609"><pre row="609">0609       <font color="black">64</font>     let left = x;                                                                                               <font color="black">84</font>     let left = x;                                                                                        </pre></div>
<div row="610"><pre row="610">0610       <font color="black">65</font> <font color="red">    if (view.height - y &lt;= height) {</font>                                                                                                                                                                                        </pre></div>
<div row="611"><pre row="611">0611       <font color="black">66</font> <font color="red">      top -= height;</font>                                                                                                                                                                                                        </pre></div>
<div row="612"><pre row="612">0612       <font color="black">67</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre></div>
<div row="613"><pre row="613">0613       <font color="black">68</font>     if (view.width - x &lt;= width) {                                                                              <font color="black">85</font>     if (view.width - x &lt;= width) {                                                                       </pre></div>
<div row="614"><pre row="614">0614       <font color="black">69</font>       left -= width;                                                                                            <font color="black">86</font>       left -= width;                                                                                     </pre></div>
<div row="615"><pre row="615">0615       <font color="black">70</font>     }                                                                                                           <font color="black">87</font>     }                                                                                                    </pre></div>
<div row="616"><pre row="616">0616       <font color="black">71</font> <font color="red">    el.offset({ left, top });</font>                                                                                   <font color="black">88</font> <font color="green">    el.css('left', `${left}px`);</font>                                                                         </pre></div>
<div row="617"><pre row="617">0617                                                                                                                          <font color="black">89</font> <font color="green">    if (y &gt; vhf) {</font>                                                                                       </pre></div>
<div row="618"><pre row="618">0618                                                                                                                          <font color="black">90</font> <font color="green">      el.css('bottom', `${view.height - y}px`)</font>                                                           </pre></div>
<div row="619"><pre row="619">0619                                                                                                                          <font color="black">91</font> <font color="green">        .css('max-height', `${y}px`)</font>                                                                     </pre></div>
<div row="620"><pre row="620">0620                                                                                                                          <font color="black">92</font> <font color="green">        .css('top', 'auto');</font>                                                                             </pre></div>
<div row="621"><pre row="621">0621                                                                                                                          <font color="black">93</font> <font color="green">    } else {</font>                                                                                             </pre></div>
<div row="622"><pre row="622">0622                                                                                                                          <font color="black">94</font> <font color="green">      el.css('top', `${y}px`)</font>                                                                            </pre></div>
<div row="623"><pre row="623">0623                                                                                                                          <font color="black">95</font> <font color="green">        .css('max-height', `${view.height - y}px`)</font>                                                       </pre></div>
<div row="624"><pre row="624">0624                                                                                                                          <font color="black">96</font> <font color="green">        .css('bottom', 'auto');</font>                                                                          </pre></div>
<div row="625"><pre row="625">0625                                                                                                                          <font color="black">97</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="626"><pre row="626">0626       <font color="black">72</font>     bindClickoutside(el);                                                                                       <font color="black">98</font>     bindClickoutside(el);                                                                                </pre></div>
<div row="627"><pre row="627">0627       <font color="black">73</font>   }                                                                                                             <font color="black">99</font>   }                                                                                                      </pre></div>
<div row="628"><pre row="628">0628       <font color="black">74</font> }                                                                                                              <font color="black">100</font> }                                                                                                        </pre></div>
<div id="id-component-datepicker_js"  class="pagelink" row="629"><pre class="pagehead" row="629">0629 id-component-datepicker_js</pre></div>
<div><pre row="630"><code =class"javascript">0630 ../src/component/datepicker.js             ../../x-spreadsheet/src/component/datepicker.js</code></pre></div>
<div id="id-component-dropdown_js"  class="pagelink" row="631"><pre class="pagehead" row="631">0631 id-component-dropdown_js</pre></div>
<div row="632"><pre row="632">0632 <font color="blue">../src/component/dropdown.js</font>                                                                                       <font color="blue">../../x-spreadsheet/src/component/dropdown.js</font>                                                                     </pre></div>
<div row="633"><pre row="633">0633        <font color="black">5</font> export default class Dropdown extends Element {                                                                  <font color="black">5</font> export default class Dropdown extends Element {                                                          </pre></div>
<div row="634"><pre row="634">0634        <font color="black">6</font>   constructor(title, width, showArrow, placement, ...children) {                                                 <font color="black">6</font>   constructor(title, width, showArrow, placement, ...children) {                                         </pre></div>
<div row="635"><pre row="635">0635        <font color="black">7</font>     super('div', `${cssPrefix}-dropdown ${placement}`);                                                          <font color="black">7</font>     super('div', `${cssPrefix}-dropdown ${placement}`);                                                  </pre></div>
<div row="636"><pre row="636">0636        <font color="black">8</font>     this.title = title;                                                                                          <font color="black">8</font>     this.title = title;                                                                                  </pre></div>
<div row="637"><pre row="637">0637        <font color="black">9</font>     this.change = () =&gt; {};                                                                                      <font color="black">9</font>     this.change = () =&gt; {};                                                                              </pre></div>
<div row="638"><pre row="638">0638                                                                                                                          <font color="black">10</font> <font color="green">    this.headerClick = () =&gt; {};</font>                                                                         </pre></div>
<div row="639"><pre row="639">0639       <font color="black">10</font>     if (typeof title === 'string') {                                                                            <font color="black">11</font>     if (typeof title === 'string') {                                                                     </pre></div>
<div row="640"><pre row="640">0640       <font color="black">11</font>       this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);                                        <font color="black">12</font>       this.title = h('div', `${cssPrefix}-dropdown-title`).child(title);                                 </pre></div>
<div row="641"><pre row="641">0641       <font color="black">12</font>     } else if (showArrow) {                                                                                     <font color="black">13</font>     } else if (showArrow) {                                                                              </pre></div>
<div row="642"><pre row="642">0642       <font color="black">13</font>       this.title.addClass('arrow-left');                                                                        <font color="black">14</font>       this.title.addClass('arrow-left');                                                                 </pre></div>
<div row="643"><pre row="643">0643       <font color="black">14</font>     }                                                                                                           <font color="black">15</font>     }                                                                                                    </pre></div>
<div row="644"><pre row="644">0644       <font color="black">15</font>     this.contentEl = h('div', `${cssPrefix}-dropdown-content`)                                                  <font color="black">16</font>     this.contentEl = h('div', `${cssPrefix}-dropdown-content`)                                           </pre></div>
<div row="645"><pre row="645">0645       <font color="black">16</font> <font color="red">      .children(...children)</font>                                                                                                                                                                                                </pre></div>
<div row="646"><pre row="646">0646       <font color="black">17</font>       .css('width', width)                                                                                      <font color="black">17</font>       .css('width', width)                                                                               </pre></div>
<div row="647"><pre row="647">0647       <font color="black">18</font>       .hide();                                                                                                  <font color="black">18</font>       .hide();                                                                                           </pre></div>
<div row="648"><pre row="648">0648                                                                                                                          <font color="black">19</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="649"><pre row="649">0649                                                                                                                          <font color="black">20</font> <font color="green">    this.setContentChildren(...children);</font>                                                                </pre></div>
<div row="650"><pre row="650">0650       <font color="black">19</font>                                                                                                                 <font color="black">21</font>                                                                                                          </pre></div>
<div row="651"><pre row="651">0651       <font color="black">20</font>     this.headerEl = h('div', `${cssPrefix}-dropdown-header`);                                                   <font color="black">22</font>     this.headerEl = h('div', `${cssPrefix}-dropdown-header`);                                            </pre></div>
<div row="652"><pre row="652">0652       <font color="black">21</font>     this.headerEl.on('click', () =&gt; {                                                                           <font color="black">23</font>     this.headerEl.on('click', () =&gt; {                                                                    </pre></div>
<div row="653"><pre row="653">0653       <font color="black">22</font>       if (this.contentEl.css('display') !== 'block') {                                                          <font color="black">24</font>       if (this.contentEl.css('display') !== 'block') {                                                   </pre></div>
<div row="654"><pre row="654">0654       <font color="black">23</font>         this.show();                                                                                            <font color="black">25</font>         this.show();                                                                                     </pre></div>
<div row="655"><pre row="655">0655 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="656"><pre row="656">0656       <font color="black">29</font>       showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(                                              <font color="black">31</font>       showArrow ? h('div', `${cssPrefix}-icon arrow-right`).child(                                       </pre></div>
<div row="657"><pre row="657">0657       <font color="black">30</font>         h('div', `${cssPrefix}-icon-img arrow-down`),                                                           <font color="black">32</font>         h('div', `${cssPrefix}-icon-img arrow-down`),                                                    </pre></div>
<div row="658"><pre row="658">0658       <font color="black">31</font>       ) : '',                                                                                                   <font color="black">33</font>       ) : '',                                                                                            </pre></div>
<div row="659"><pre row="659">0659       <font color="black">32</font>     );                                                                                                          <font color="black">34</font>     );                                                                                                   </pre></div>
<div row="660"><pre row="660">0660       <font color="black">33</font>     this.children(this.headerEl, this.contentEl);                                                               <font color="black">35</font>     this.children(this.headerEl, this.contentEl);                                                        </pre></div>
<div row="661"><pre row="661">0661                                                                                                                          <font color="black">36</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="662"><pre row="662">0662                                                                                                                          <font color="black">37</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="663"><pre row="663">0663                                                                                                                          <font color="black">38</font> <font color="green">  setContentChildren(...children) {</font>                                                                      </pre></div>
<div row="664"><pre row="664">0664                                                                                                                          <font color="black">39</font> <font color="green">    this.contentEl.html('');</font>                                                                             </pre></div>
<div row="665"><pre row="665">0665                                                                                                                          <font color="black">40</font> <font color="green">    if (children.length &gt; 0) {</font>                                                                           </pre></div>
<div row="666"><pre row="666">0666                                                                                                                          <font color="black">41</font> <font color="green">      this.contentEl.children(...children);</font>                                                              </pre></div>
<div row="667"><pre row="667">0667                                                                                                                          <font color="black">42</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="668"><pre row="668">0668       <font color="black">34</font>   }                                                                                                             <font color="black">43</font>   }                                                                                                      </pre></div>
<div row="669"><pre row="669">0669       <font color="black">35</font>                                                                                                                 <font color="black">44</font>                                                                                                          </pre></div>
<div row="670"><pre row="670">0670       <font color="black">36</font>   setTitle(title) {                                                                                             <font color="black">45</font>   setTitle(title) {                                                                                      </pre></div>
<div row="671"><pre row="671">0671       <font color="black">37</font>     this.title.html(title);                                                                                     <font color="black">46</font>     this.title.html(title);                                                                              </pre></div>
<div row="672"><pre row="672">0672       <font color="black">38</font>     this.hide();                                                                                                <font color="black">47</font>     this.hide();                                                                                         </pre></div>
<div id="id-component-dropdown_align_js"  class="pagelink" row="673"><pre class="pagehead" row="673">0673 id-component-dropdown_align_js</pre></div>
<div><pre row="674"><code =class"javascript">0674 ../src/component/dropdown_align.js             ../../x-spreadsheet/src/component/dropdown_align.js</code></pre></div>
<div id="id-component-dropdown_border_js"  class="pagelink" row="675"><pre class="pagehead" row="675">0675 id-component-dropdown_border_js</pre></div>
<div><pre row="676"><code =class"javascript">0676 ../src/component/dropdown_border.js             ../../x-spreadsheet/src/component/dropdown_border.js</code></pre></div>
<div id="id-component-dropdown_color_js"  class="pagelink" row="677"><pre class="pagehead" row="677">0677 id-component-dropdown_color_js</pre></div>
<div><pre row="678"><code =class"javascript">0678 ../src/component/dropdown_color.js             ../../x-spreadsheet/src/component/dropdown_color.js</code></pre></div>
<div id="id-component-dropdown_font_js"  class="pagelink" row="679"><pre class="pagehead" row="679">0679 id-component-dropdown_font_js</pre></div>
<div><pre row="680"><code =class"javascript">0680 ../src/component/dropdown_font.js             ../../x-spreadsheet/src/component/dropdown_font.js</code></pre></div>
<div id="id-component-dropdown_fontsize_js"  class="pagelink" row="681"><pre class="pagehead" row="681">0681 id-component-dropdown_fontsize_js</pre></div>
<div><pre row="682"><code =class"javascript">0682 ../src/component/dropdown_fontsize.js             ../../x-spreadsheet/src/component/dropdown_fontsize.js</code></pre></div>
<div id="id-component-dropdown_format_js"  class="pagelink" row="683"><pre class="pagehead" row="683">0683 id-component-dropdown_format_js</pre></div>
<div row="684"><pre row="684">0684 <font color="blue">../src/component/dropdown_format.js</font>                                                                                <font color="blue">../../x-spreadsheet/src/component/dropdown_format.js</font>                                                              </pre></div>
<div row="685"><pre row="685">0685        <font color="black">5</font>                                                                                                                  <font color="black">5</font>                                                                                                          </pre></div>
<div row="686"><pre row="686">0686        <font color="black">6</font> export default class DropdownFormat extends Dropdown {                                                           <font color="black">6</font> export default class DropdownFormat extends Dropdown {                                                   </pre></div>
<div row="687"><pre row="687">0687        <font color="black">7</font>   constructor() {                                                                                                <font color="black">7</font>   constructor() {                                                                                        </pre></div>
<div row="688"><pre row="688">0688        <font color="black">8</font>     let nformats = baseFormats.slice(0);                                                                         <font color="black">8</font>     let nformats = baseFormats.slice(0);                                                                 </pre></div>
<div row="689"><pre row="689">0689        <font color="black">9</font>     nformats.splice(2, 0, { key: 'divider' });                                                                   <font color="black">9</font>     nformats.splice(2, 0, { key: 'divider' });                                                           </pre></div>
<div row="690"><pre row="690">0690       <font color="black">10</font>     nformats.splice(<font color="orange">7</font>, 0, { key: 'divider' });                                                                  <font color="black">10</font>     nformats.splice(<font color="orange">8</font>, 0, { key: 'divider' });                                                           </pre></div>
<div row="691"><pre row="691">0691       <font color="black">11</font>     nformats = nformats.map((it) =&gt; {                                                                           <font color="black">11</font>     nformats = nformats.map((it) =&gt; {                                                                    </pre></div>
<div row="692"><pre row="692">0692       <font color="black">12</font>       const item = h('div', `${cssPrefix}-item`);                                                               <font color="black">12</font>       const item = h('div', `${cssPrefix}-item`);                                                        </pre></div>
<div row="693"><pre row="693">0693       <font color="black">13</font>       if (it.key === 'divider') {                                                                               <font color="black">13</font>       if (it.key === 'divider') {                                                                        </pre></div>
<div row="694"><pre row="694">0694       <font color="black">14</font>         item.addClass('divider');                                                                               <font color="black">14</font>         item.addClass('divider');                                                                        </pre></div>
<div row="695"><pre row="695">0695       <font color="black">15</font>       } else {                                                                                                  <font color="black">15</font>       } else {                                                                                           </pre></div>
<div id="id-component-dropdown_formula_js"  class="pagelink" row="696"><pre class="pagehead" row="696">0696 id-component-dropdown_formula_js</pre></div>
<div><pre row="697"><code =class"javascript">0697 ../src/component/dropdown_formula.js             ../../x-spreadsheet/src/component/dropdown_formula.js</code></pre></div>
<div id="id-component-dropdown_linetype_js"  class="pagelink" row="698"><pre class="pagehead" row="698">0698 id-component-dropdown_linetype_js</pre></div>
<div><pre row="699"><code =class"javascript">0699 ../src/component/dropdown_linetype.js             ../../x-spreadsheet/src/component/dropdown_linetype.js</code></pre></div>
<div id="id-component-editor_js"  class="pagelink" row="700"><pre class="pagehead" row="700">0700 id-component-editor_js</pre></div>
<div row="701"><pre row="701">0701 <font color="blue">../src/component/editor.js</font>                                                                                         <font color="blue">../../x-spreadsheet/src/component/editor.js</font>                                                                       </pre></div>
<div row="702"><pre row="702">0702        <font color="black">4</font> import Datepicker from './datepicker';                                                                           <font color="black">4</font> import Datepicker from './datepicker';                                                                   </pre></div>
<div row="703"><pre row="703">0703        <font color="black">5</font> import { cssPrefix } from '../config';                                                                           <font color="black">5</font> import { cssPrefix } from '../config';                                                                   </pre></div>
<div row="704"><pre row="704">0704        <font color="black">6</font> // import { mouseMoveUp } from '../event';                                                                       <font color="black">6</font> // import { mouseMoveUp } from '../event';                                                               </pre></div>
<div row="705"><pre row="705">0705        <font color="black">7</font>                                                                                                                  <font color="black">7</font>                                                                                                          </pre></div>
<div row="706"><pre row="706">0706        <font color="black">8</font> function resetTextareaSize() {                                                                                   <font color="black">8</font> function resetTextareaSize() {                                                                           </pre></div>
<div row="707"><pre row="707">0707                                                                                                                           <font color="black">9</font> <font color="green">  const { inputText } = this;</font>                                                                            </pre></div>
<div row="708"><pre row="708">0708        <font color="black">9</font> <font color="red">//</font>  if (!/^\s*$/.test(<font color="red">this.</font>inputText)) {                                                                        <font color="black">10</font>   if (!/^\s*$/.test(inputText)) {                                                                        </pre></div>
<div row="709"><pre row="709">0709       <font color="black">10</font>     const {                                                                                                     <font color="black">11</font>     const {                                                                                              </pre></div>
<div row="710"><pre row="710">0710       <font color="black">11</font>       textlineEl, textEl, areaOffset,                                                                           <font color="black">12</font>       textlineEl, textEl, areaOffset,                                                                    </pre></div>
<div row="711"><pre row="711">0711       <font color="black">12</font>     } = this;                                                                                                   <font color="black">13</font>     } = this;                                                                                            </pre></div>
<div row="712"><pre row="712">0712                                                                                                                          <font color="black">14</font> <font color="green">    const txts = inputText.split('\n');</font>                                                                  </pre></div>
<div row="713"><pre row="713">0713                                                                                                                          <font color="black">15</font> <font color="green">    const maxTxtSize = Math.max(...txts.map(it =&gt; it.length));</font>                                           </pre></div>
<div row="714"><pre row="714">0714       <font color="black">13</font>     const tl<font color="orange">in</font>e<font color="red">Wid</font>t<font color="red">h</font> = textlineEl.offset()<font color="red">.width + 9</font>;                                                           <font color="black">16</font>     const tl<font color="orange">Offs</font>et = textlineEl.offset();                                                                </pre></div>
<div row="715"><pre row="715">0715                                                                                                                          <font color="black">17</font> <font color="green">    const fontWidth = tlOffset.width / inputText.length;</font>                                                 </pre></div>
<div row="716"><pre row="716">0716                                                                                                                          <font color="black">18</font> <font color="green">    const tlineWidth = (maxTxtSize + 1) * fontWidth + 5;</font>                                                 </pre></div>
<div row="717"><pre row="717">0717       <font color="black">14</font>     const maxWidth = this.viewFn().width - areaOffset.left - <font color="orange">9</font>;                                                 <font color="black">19</font>     const maxWidth = this.viewFn().width - areaOffset.left - <font color="orange">fontWidth</font>;                                  </pre></div>
<div row="718"><pre row="718">0718       <font color="black">15</font> <font color="red">    // console.log('tlineWidth:', tlineWidth, ':', maxWidth);</font>                                                   <font color="black">20</font> <font color="green">    let h1 = txts.length;</font>                                                                                </pre></div>
<div row="719"><pre row="719">0719       <font color="black">16</font>     if (tlineWidth &gt; areaOffset.width) {                                                                        <font color="black">21</font>     if (tlineWidth &gt; areaOffset.width) {                                                                 </pre></div>
<div row="720"><pre row="720">0720       <font color="black">17</font>       let twidth = tlineWidth;                                                                                  <font color="black">22</font>       let twidth = tlineWidth;                                                                           </pre></div>
<div row="721"><pre row="721">0721       <font color="black">18</font>       if (tlineWidth &gt; maxWidth) {                                                                              <font color="black">23</font>       if (tlineWidth &gt; maxWidth) {                                                                       </pre></div>
<div row="722"><pre row="722">0722       <font color="black">19</font>         twidth = maxWidth;                                                                                      <font color="black">24</font>         twidth = maxWidth;                                                                               </pre></div>
<div row="723"><pre row="723">0723       <font color="black">20</font>        <font color="red"> let</font> h1 = parseInt(tlineWidth / maxWidth, 10);                                                           <font color="black">25</font>         h1 <font color="green">+</font>= parseInt(tlineWidth / maxWidth, 10);                                                       </pre></div>
<div row="724"><pre row="724">0724       <font color="black">21</font>         h1 += (tlineWidth % maxWidth) &gt; 0 ? 1 : 0;                                                              <font color="black">26</font>         h1 += (tlineWidth % maxWidth) &gt; 0 ? 1 : 0;                                                       </pre></div>
<div row="725"><pre row="725">0725                                                                                                                          <font color="black">27</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="726"><pre row="726">0726                                                                                                                          <font color="black">28</font> <font color="green">      textEl.css('width', `${twidth}px`);</font>                                                                </pre></div>
<div row="727"><pre row="727">0727                                                                                                                          <font color="black">29</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="728"><pre row="728">0728       <font color="black">22</font> <font color="red">    </font>    h1 *= this.rowHeight;                                                                                   <font color="black">30</font>     h1 *= this.rowHeight;                                                                                </pre></div>
<div row="729"><pre row="729">0729       <font color="black">23</font> <font color="red">    </font>    if (h1 &gt; areaOffset.height) {                                                                           <font color="black">31</font>     if (h1 &gt; areaOffset.height) {                                                                        </pre></div>
<div row="730"><pre row="730">0730       <font color="black">24</font> <font color="red">    </font>      textEl.css('height', `${h1}px`);                                                                      <font color="black">32</font>       textEl.css('height', `${h1}px`);                                                                   </pre></div>
<div row="731"><pre row="731">0731                                                                                                                          <font color="black">33</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="732"><pre row="732">0732                                                                                                                          <font color="black">34</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="733"><pre row="733">0733                                                                                                                          <font color="black">35</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="734"><pre row="734">0734                                                                                                                          <font color="black">36</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="735"><pre row="735">0735                                                                                                                          <font color="black">37</font> <font color="green">function inputEventHandler(evt) {</font>                                                                        </pre></div>
<div row="736"><pre row="736">0736                                                                                                                          <font color="black">38</font> <font color="green">  const v = evt.target.value;</font>                                                                            </pre></div>
<div row="737"><pre row="737">0737                                                                                                                          <font color="black">39</font> <font color="green">  // console.log(evt, 'v:', v);</font>                                                                          </pre></div>
<div row="738"><pre row="738">0738                                                                                                                          <font color="black">40</font> <font color="green">  const { suggest, textlineEl, validator } = this;</font>                                                       </pre></div>
<div row="739"><pre row="739">0739                                                                                                                          <font color="black">41</font> <font color="green">  const { cell } = this;</font>                                                                                 </pre></div>
<div row="740"><pre row="740">0740                                                                                                                          <font color="black">42</font> <font color="green">  if (cell !== null) {</font>                                                                                   </pre></div>
<div row="741"><pre row="741">0741                                                                                                                          <font color="black">43</font> <font color="green">    if (('editable' in cell && cell.editable === true) || (cell.editable === undefined)) {</font>               </pre></div>
<div row="742"><pre row="742">0742                                                                                                                          <font color="black">44</font> <font color="green">      this.inputText = v;</font>                                                                                </pre></div>
<div row="743"><pre row="743">0743                                                                                                                          <font color="black">45</font> <font color="green">      if (validator) {</font>                                                                                   </pre></div>
<div row="744"><pre row="744">0744                                                                                                                          <font color="black">46</font> <font color="green">        if (validator.type === 'list') {</font>                                                                 </pre></div>
<div row="745"><pre row="745">0745                                                                                                                          <font color="black">47</font> <font color="green">          suggest.search(v);</font>                                                                             </pre></div>
<div row="746"><pre row="746">0746                                                                                                                          <font color="black">48</font> <font color="green">        } else {</font>                                                                                         </pre></div>
<div row="747"><pre row="747">0747                                                                                                                          <font color="black">49</font> <font color="green">          suggest.hide();</font>                                                                                </pre></div>
<div row="748"><pre row="748">0748       <font color="black">25</font>         }                                                                                                       <font color="black">50</font>         }                                                                                                </pre></div>
<div row="749"><pre row="749">0749                                                                                                                          <font color="black">51</font> <font color="green">      } else {</font>                                                                                           </pre></div>
<div row="750"><pre row="750">0750                                                                                                                          <font color="black">52</font> <font color="green">        const start = v.lastIndexOf('=');</font>                                                                </pre></div>
<div row="751"><pre row="751">0751                                                                                                                          <font color="black">53</font> <font color="green">        if (start !== -1) {</font>                                                                              </pre></div>
<div row="752"><pre row="752">0752                                                                                                                          <font color="black">54</font> <font color="green">          suggest.search(v.substring(start + 1));</font>                                                        </pre></div>
<div row="753"><pre row="753">0753                                                                                                                          <font color="black">55</font> <font color="green">        } else {</font>                                                                                         </pre></div>
<div row="754"><pre row="754">0754                                                                                                                          <font color="black">56</font> <font color="green">          suggest.hide();</font>                                                                                </pre></div>
<div row="755"><pre row="755">0755       <font color="black">26</font>       }                                                                                                         <font color="black">57</font> <font color="green">  </font>      }                                                                                                </pre></div>
<div row="756"><pre row="756">0756       <font color="black">27</font> <font color="red">      textEl.css('width', `${twidth}px`);</font>                                                                                                                                                                                   </pre></div>
<div row="757"><pre row="757">0757       <font color="black">28</font>     }                                                                                                           <font color="black">58</font> <font color="green">  </font>    }                                                                                                  </pre></div>
<div row="758"><pre row="758">0758       <font color="black">29</font> <font color="red">//  }</font>                                                                                                           <font color="black">59</font> <font color="green">      textlineEl.html(v);</font>                                                                                </pre></div>
<div row="759"><pre row="759">0759       <font color="black">30</font> <font color="red">}</font>                                                                                                               <font color="black">60</font> <font color="green">      resetTextareaSize.call(this);</font>                                                                      </pre></div>
<div row="760"><pre row="760">0760       <font color="black">31</font> <font color="red"> </font>                                                                                                               <font color="black">61</font> <font color="green">      this.change('input', v);</font>                                                                           </pre></div>
<div row="761"><pre row="761">0761       <font color="black">32</font> <font color="red">function inputEventHandler(evt) {</font>                                                                                                                                                                                           </pre></div>
<div row="762"><pre row="762">0762       <font color="black">33</font> <font color="red">    const keyCode = evt.keyCode || evt.which;</font>                                                                                                                                                                               </pre></div>
<div row="763"><pre row="763">0763       <font color="black">34</font> <font color="red">    const {</font>                                                                                                                                                                                                                 </pre></div>
<div row="764"><pre row="764">0764       <font color="black">35</font> <font color="red">      key, ctrlKey, shiftKey, altKey, metaKey,</font>                                                                                                                                                                              </pre></div>
<div row="765"><pre row="765">0765       <font color="black">36</font> <font color="red">    } = evt;</font>                                                                                                                                                                                                                </pre></div>
<div row="766"><pre row="766">0766       <font color="black">37</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="767"><pre row="767">0767       <font color="black">38</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre></div>
<div row="768"><pre row="768">0768       <font color="black">39</font> <font color="red">    if (altKey) {</font>                                                                                                                                                                                                           </pre></div>
<div row="769"><pre row="769">0769       <font color="black">40</font> <font color="red">      console.log("alt:",keyCode);</font>                                                                                                                                                                                          </pre></div>
<div row="770"><pre row="770">0770       <font color="black">41</font> <font color="red">      switch (keyCode) {</font>                                                                                                                                                                                                    </pre></div>
<div row="771"><pre row="771">0771       <font color="black">42</font> <font color="red">        case 13:</font>                                                                                                                                                                                                            </pre></div>
<div row="772"><pre row="772">0772       <font color="black">43</font> <font color="red">            console.log("input alt+Enter");</font>                                                                                                                                                                                 </pre></div>
<div row="773"><pre row="773">0773       <font color="black">44</font> <font color="red">            break;</font>                                                                                                                                                                                                          </pre></div>
<div row="774"><pre row="774">0774       <font color="black">45</font> <font color="red">      }</font>                                                                                                                                                                                                                     </pre></div>
<div row="775"><pre row="775">0775       <font color="black">46</font> <font color="red">}   </font>                                                                                                                                                                                                                        </pre></div>
<div row="776"><pre row="776">0776       <font color="black">47</font> <font color="red">*/</font>                                                                                                                                                                                                                          </pre></div>
<div row="777"><pre row="777">0777       <font color="black">48</font> <font color="red">  //console.log("input:",evt);</font>                                                                                                                                                                                              </pre></div>
<div row="778"><pre row="778">0778       <font color="black">49</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="779"><pre row="779">0779       <font color="black">50</font> <font color="red">  const v = evt.target.value;</font>                                                                                                                                                                                               </pre></div>
<div row="780"><pre row="780">0780       <font color="black">51</font> <font color="red">  const { suggest, textlineEl, validator } = this;</font>                                                                                                                                                                          </pre></div>
<div row="781"><pre row="781">0781       <font color="black">52</font> <font color="red">  this.inputText =  v ;</font>                                                                                                                                                                                                     </pre></div>
<div row="782"><pre row="782">0782       <font color="black">53</font> <font color="red">  if (validator) {</font>                                                                                                                                                                                                          </pre></div>
<div row="783"><pre row="783">0783       <font color="black">54</font> <font color="red">    if (validator.type === 'list') {</font>                                                                                                                                                                                        </pre></div>
<div row="784"><pre row="784">0784       <font color="black">55</font> <font color="red">      suggest.search(v);</font>                                                                                                                                                                                                    </pre></div>
<div row="785"><pre row="785">0785       <font color="black">56</font>     } else {                                                                                                    <font color="black">62</font>     } else {                                                                                             </pre></div>
<div row="786"><pre row="786">0786       <font color="black">57</font> <font color="red">      suggest.hide();</font>                                                                                           <font color="black">63</font> <font color="green">      evt.target.value = '';</font>                                                                             </pre></div>
<div row="787"><pre row="787">0787       <font color="black">58</font>     }                                                                                                           <font color="black">64</font>     }                                                                                                    </pre></div>
<div row="788"><pre row="788">0788       <font color="black">59</font>   } else {                                                                                                      <font color="black">65</font>   } else {                                                                                               </pre></div>
<div row="789"><pre row="789">0789       <font color="black">60</font> <font color="red">    const start = v.lastIndexOf('=');</font>                                                                           <font color="black">66</font> <font color="green">    this.inputText = v;</font>                                                                                  </pre></div>
<div row="790"><pre row="790">0790       <font color="black">61</font> <font color="red">    if (start !== -1) {</font>                                                                                         <font color="black">67</font> <font color="green">    if (validator) {</font>                                                                                     </pre></div>
<div row="791"><pre row="791">0791       <font color="black">62</font> <font color="red">      suggest.search(v.substring(start + 1));</font>                                                                   <font color="black">68</font> <font color="green">      if (validator.type === 'list') {</font>                                                                   </pre></div>
<div row="792"><pre row="792">0792                                                                                                                          <font color="black">69</font> <font color="green">        suggest.search(v);</font>                                                                               </pre></div>
<div row="793"><pre row="793">0793                                                                                                                          <font color="black">70</font> <font color="green">      } else {</font>                                                                                           </pre></div>
<div row="794"><pre row="794">0794                                                                                                                          <font color="black">71</font> <font color="green">        suggest.hide();</font>                                                                                  </pre></div>
<div row="795"><pre row="795">0795                                                                                                                          <font color="black">72</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="796"><pre row="796">0796       <font color="black">63</font>     } else {                                                                                                    <font color="black">73</font>     } else {                                                                                             </pre></div>
<div row="797"><pre row="797">0797       <font color="black">64</font> <font color="red">      suggest.hide();</font>                                                                                                                                                                                                       </pre></div>
<div row="798"><pre row="798">0798       <font color="black">65</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre></div>
<div row="799"><pre row="799">0799       <font color="black">66</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="800"><pre row="800">0800       <font color="black">67</font> <font color="red">  textlineEl.html(v);</font>                                                                                                                                                                                                       </pre></div>
<div row="801"><pre row="801">0801       <font color="black">68</font> <font color="red">  resetTextareaSize.call(this);</font>                                                                                                                                                                                             </pre></div>
<div row="802"><pre row="802">0802       <font color="black">69</font> <font color="red">  this.change('input', v);</font>                                                                                                                                                                                                  </pre></div>
<div row="803"><pre row="803">0803       <font color="black">70</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre></div>
<div row="804"><pre row="804">0804       <font color="black">71</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="805"><pre row="805">0805       <font color="black">72</font> <font color="red">function keydownEventHandler(evt) {</font>                                                                                                                                                                                         </pre></div>
<div row="806"><pre row="806">0806       <font color="black">73</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="807"><pre row="807">0807       <font color="black">74</font> <font color="red">    const keyCode = evt.keyCode || evt.which;</font>                                                                                                                                                                               </pre></div>
<div row="808"><pre row="808">0808       <font color="black">75</font> <font color="red">    const {</font>                                                                                                                                                                                                                 </pre></div>
<div row="809"><pre row="809">0809       <font color="black">76</font> <font color="red">      key, ctrlKey, shiftKey, altKey, metaKey,</font>                                                                                                                                                                              </pre></div>
<div row="810"><pre row="810">0810       <font color="black">77</font> <font color="red">    } = evt;</font>                                                                                                                                                                                                                </pre></div>
<div row="811"><pre row="811">0811       <font color="black">78</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="812"><pre row="812">0812       <font color="black">79</font> <font color="red">  var v = evt.target.value;</font>                                                                                                                                                                                                 </pre></div>
<div row="813"><pre row="813">0813       <font color="black">80</font> <font color="red">  var t = evt.target;</font>                                                                                                                                                                                                       </pre></div>
<div row="814"><pre row="814">0814       <font color="black">81</font> <font color="red">                       //console.log("input :", evt);</font>                                                                                                                                                                       </pre></div>
<div row="815"><pre row="815">0815       <font color="black">82</font> <font color="red">                       //console.log("v :", t);</font>                                                                                                                                                                             </pre></div>
<div row="816"><pre row="816">0816       <font color="black">83</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="817"><pre row="817">0817       <font color="black">84</font> <font color="red">      if (altKey) {</font>                                                                                                                                                                                                         </pre></div>
<div row="818"><pre row="818">0818       <font color="black">85</font> <font color="red">            switch (keyCode) {</font>                                                                                                                                                                                              </pre></div>
<div row="819"><pre row="819">0819       <font color="black">86</font> <font color="red">                 case 13:</font>                                                                                                                                                                                                   </pre></div>
<div row="820"><pre row="820">0820       <font color="black">87</font> <font color="red">                       //console.log("input alt+Enter");</font>                                                                                                                                                                    </pre></div>
<div row="821"><pre row="821">0821       <font color="black">88</font> <font color="red">                       //v = 13;</font>                                                                                                                                                                                            </pre></div>
<div row="822"><pre row="822">0822       <font color="black">89</font> <font color="red">                       //v = '&#13';</font>                                                                                                                                                                                        </pre></div>
<div row="823"><pre row="823">0823       <font color="black">90</font> <font color="red">                       //t.value =  t.value + 13</font>                                                                                                                                                                            </pre></div>
<div row="824"><pre row="824">0824       <font color="black">91</font> <font color="red">                       //t.value =  t.value + '&#13;&#10;';</font>                                                                                                                                                                 </pre></div>
<div row="825"><pre row="825">0825       <font color="black">92</font> <font color="red">                       //t.value =  t.value + "&#10;";</font>                                                                                                                                                                      </pre></div>
<div row="826"><pre row="826">0826       <font color="black">93</font> <font color="red">                      // var newline = String.fromCharCode(13, 10);</font>                                                                                                                                                         </pre></div>
<div row="827"><pre row="827">0827       <font color="black">94</font> <font color="red">                       var newline = String.fromCharCode(13,10 );</font>                                                                                                                                                           </pre></div>
<div row="828"><pre row="828">0828       <font color="black">95</font> <font color="red">                       t.value =  t.value + newline;</font>                                                                                                                                                                        </pre></div>
<div row="829"><pre row="829">0829       <font color="black">96</font> <font color="red">                       //t.value =  t.value + "&lt;pre&gt;";</font>                                                                                                                                                                      </pre></div>
<div row="830"><pre row="830">0830       <font color="black">97</font> <font color="red">                       ;</font>                                                                                                                                                                                                    </pre></div>
<div row="831"><pre row="831">0831       <font color="black">98</font> <font color="red">                       break;</font>                                                                                                                                                                                               </pre></div>
<div row="832"><pre row="832">0832       <font color="black">99</font> <font color="red">             }</font>                                                                                                                                                                                                              </pre></div>
<div row="833"><pre row="833">0833      <font color="black">100</font> <font color="red">       }</font>                                                                                                                                                                                                                    </pre></div>
<div row="834"><pre row="834">0834      <font color="black">101</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="835"><pre row="835">0835      <font color="black">102</font> <font color="red">//  console.log("keydown:",evt);</font>                                                                                                                                                                                            </pre></div>
<div row="836"><pre row="836">0836      <font color="black">103</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="837"><pre row="837">0837      <font color="black">104</font> <font color="red">  //const v = evt.target.value;</font>                                                                                                                                                                                             </pre></div>
<div row="838"><pre row="838">0838      <font color="black">105</font> <font color="red">  const { suggest, textlineEl, validator } = this;</font>                                                                                                                                                                          </pre></div>
<div row="839"><pre row="839">0839      <font color="black">106</font> <font color="red">  this.inputText =  v ;</font>                                                                                                                                                                                                     </pre></div>
<div row="840"><pre row="840">0840      <font color="black">107</font> <font color="red">  if (validator) {</font>                                                                                                                                                                                                          </pre></div>
<div row="841"><pre row="841">0841      <font color="black">108</font> <font color="red">    if (validator.type === 'list') {</font>                                                                                                                                                                                        </pre></div>
<div row="842"><pre row="842">0842      <font color="black">109</font> <font color="red">      suggest.search(v);</font>                                                                                                                                                                                                    </pre></div>
<div row="843"><pre row="843">0843      <font color="black">110</font> <font color="red">    } else {</font>                                                                                                                                                                                                                </pre></div>
<div row="844"><pre row="844">0844      <font color="black">111</font> <font color="red">      suggest.hide();</font>                                                                                                                                                                                                       </pre></div>
<div row="845"><pre row="845">0845      <font color="black">112</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre></div>
<div row="846"><pre row="846">0846      <font color="black">113</font> <font color="red">  } else {</font>                                                                                                                                                                                                                  </pre></div>
<div row="847"><pre row="847">0847      <font color="black">114</font> <font color="red">    if (typeof v === 'string' || v instanceof String) {</font>                                                                                                                                                                     </pre></div>
<div row="848"><pre row="848">0848      <font color="black">115</font>     const start = v.lastIndexOf('=');                                                                           <font color="black">74</font> <font color="green">  </font>    const start = v.lastIndexOf('=');                                                                  </pre></div>
<div row="849"><pre row="849">0849      <font color="black">116</font>     if (start !== -1) {                                                                                         <font color="black">75</font> <font color="green">  </font>    if (start !== -1) {                                                                                </pre></div>
<div row="850"><pre row="850">0850      <font color="black">117</font>       suggest.search(v.substring(start + 1));                                                                   <font color="black">76</font> <font color="green">  </font>      suggest.search(v.substring(start + 1));                                                          </pre></div>
<div row="851"><pre row="851">0851      <font color="black">118</font>     } else {                                                                                                    <font color="black">77</font> <font color="green">  </font>    } else {                                                                                           </pre></div>
<div row="852"><pre row="852">0852      <font color="black">119</font>       suggest.hide();                                                                                           <font color="black">78</font> <font color="green">  </font>      suggest.hide();                                                                                  </pre></div>
<div row="853"><pre row="853">0853      <font color="black">120</font>     }                                                                                                           <font color="black">79</font> <font color="green">  </font>    }                                                                                                  </pre></div>
<div row="854"><pre row="854">0854      <font color="black">121</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre></div>
<div row="855"><pre row="855">0855      <font color="black">122</font>   }                                                                                                             <font color="black">80</font> <font color="green">  </font>  }                                                                                                    </pre></div>
<div row="856"><pre row="856">0856      <font color="black">123</font>   textlineEl.html(v);                                                                                           <font color="black">81</font> <font color="green">  </font>  textlineEl.html(v);                                                                                  </pre></div>
<div row="857"><pre row="857">0857      <font color="black">124</font>   resetTextareaSize.call(this);                                                                                 <font color="black">82</font> <font color="green">  </font>  resetTextareaSize.call(this);                                                                        </pre></div>
<div row="858"><pre row="858">0858      <font color="black">125</font>   this.change('t<font color="red">extarea</font>', v);                                                                                   <font color="black">83</font> <font color="green">  </font>  this.change('<font color="green">inpu</font>t', v);                                                                             </pre></div>
<div row="859"><pre row="859">0859      <font color="black">126</font> <font color="red"> </font>                                                                                                               <font color="black">84</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="860"><pre row="860">0860      <font color="black">127</font> <font color="red">  ////</font>                                                                                                                                                                                                                      </pre></div>
<div row="861"><pre row="861">0861      <font color="black">128</font> <font color="red">  /*</font>                                                                                                                                                                                                                        </pre></div>
<div row="862"><pre row="862">0862      <font color="black">129</font> <font color="red">    var el = this;</font>                                                                                                                                                                                                          </pre></div>
<div row="863"><pre row="863">0863      <font color="black">130</font> <font color="red">  setTimeout(function(){</font>                                                                                                                                                                                                    </pre></div>
<div row="864"><pre row="864">0864      <font color="black">131</font> <font color="red">    el.style.cssText = 'height:auto; padding:0';</font>                                                                                                                                                                            </pre></div>
<div row="865"><pre row="865">0865      <font color="black">132</font> <font color="red">    // for box-sizing other than "content-box" use:</font>                                                                                                                                                                         </pre></div>
<div row="866"><pre row="866">0866      <font color="black">133</font> <font color="red">    // el.style.cssText = '-moz-box-sizing:content-box';</font>                                                                                                                                                                    </pre></div>
<div row="867"><pre row="867">0867      <font color="black">134</font> <font color="red">    el.style.cssText = 'height:' + el.scrollHeight + 'px';</font>                                                                                                                                                                  </pre></div>
<div row="868"><pre row="868">0868      <font color="black">135</font> <font color="red">  },0);</font>                                                                                                                                                                                                                     </pre></div>
<div row="869"><pre row="869">0869      <font color="black">136</font> <font color="red">  */</font>                                                                                                                                                                                                                        </pre></div>
<div row="870"><pre row="870">0870      <font color="black">137</font> <font color="red">      var textarea = evt.target;</font>                                                                                                                                                                                            </pre></div>
<div row="871"><pre row="871">0871      <font color="black">138</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="872"><pre row="872">0872      <font color="black">139</font> <font color="red">   textarea.style.height = ""; /* Reset the height*/</font>                                                                                                                                                                        </pre></div>
<div row="873"><pre row="873">0873      <font color="black">140</font> <font color="red">  textarea.style.height = textarea.scrollHeight + "px";</font>                                                                                                                                                                     </pre></div>
<div row="874"><pre row="874">0874      <font color="black">141</font> }                                                                                                               <font color="black">85</font> }                                                                                                        </pre></div>
<div row="875"><pre row="875">0875      <font color="black">142</font>                                                                                                                 <font color="black">86</font>                                                                                                          </pre></div>
<div row="876"><pre row="876">0876      <font color="black">143</font> function setTextareaRange(position) {                                                                           <font color="black">87</font> function setTextareaRange(position) {                                                                    </pre></div>
<div row="877"><pre row="877">0877      <font color="black">144</font>   const { el } = this.textEl;                                                                                   <font color="black">88</font>   const { el } = this.textEl;                                                                            </pre></div>
<div row="878"><pre row="878">0878      <font color="black">145</font>   setTimeout(() =&gt; {                                                                                            <font color="black">89</font>   setTimeout(() =&gt; {                                                                                     </pre></div>
<div row="879"><pre row="879">0879 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="880"><pre row="880">0880      <font color="black">189</font>   let month = d.getMonth() + 1;                                                                                <font color="black">133</font>   let month = d.getMonth() + 1;                                                                          </pre></div>
<div row="881"><pre row="881">0881      <font color="black">190</font>   let date = d.getDate();                                                                                      <font color="black">134</font>   let date = d.getDate();                                                                                </pre></div>
<div row="882"><pre row="882">0882      <font color="black">191</font>   if (month &lt; 10) month = `0${month}`;                                                                         <font color="black">135</font>   if (month &lt; 10) month = `0${month}`;                                                                   </pre></div>
<div row="883"><pre row="883">0883      <font color="black">192</font>   if (date &lt; 10) date = `0${date}`;                                                                            <font color="black">136</font>   if (date &lt; 10) date = `0${date}`;                                                                      </pre></div>
<div row="884"><pre row="884">0884      <font color="black">193</font>   return `${d.getFullYear()}-${month}-${date}`;                                                                <font color="black">137</font>   return `${d.getFullYear()}-${month}-${date}`;                                                          </pre></div>
<div row="885"><pre row="885">0885      <font color="black">194</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre></div>
<div row="886"><pre row="886">0886      <font color="black">195</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="887"><pre row="887">0887      <font color="black">196</font> <font color="red">function textarea_autosize(){</font>                                                                                                                                                                                               </pre></div>
<div row="888"><pre row="888">0888      <font color="black">197</font> <font color="red">      var rows = parseInt(textarea.getAttribute("rows"));</font>                                                                                                                                                                   </pre></div>
<div row="889"><pre row="889">0889      <font color="black">198</font> <font color="red">    // If we don't decrease the amount of rows, the scrollHeight would show the scrollHeight for all the </font>                                                                                                                   </pre></div>
<div row="890"><pre row="890">0890 <font color="red">rows</font>                                                                                                                                                                                                                                 </pre></div>
<div row="891"><pre row="891">0891      <font color="black">199</font> <font color="red">    // even if there is no text.</font>                                                                                                                                                                                            </pre></div>
<div row="892"><pre row="892">0892      <font color="black">200</font> <font color="red">    textarea.setAttribute("rows", "1");</font>                                                                                                                                                                                     </pre></div>
<div row="893"><pre row="893">0893      <font color="black">201</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="894"><pre row="894">0894      <font color="black">202</font> <font color="red">    if (rows &lt; limitRows && textarea.scrollHeight &gt; messageLastScrollHeight) {</font>                                                                                                                                              </pre></div>
<div row="895"><pre row="895">0895      <font color="black">203</font> <font color="red">        rows++;</font>                                                                                                                                                                                                             </pre></div>
<div row="896"><pre row="896">0896      <font color="black">204</font> <font color="red">    } else if (rows &gt; 1 && textarea.scrollHeight &lt; messageLastScrollHeight) {</font>                                                                                                                                               </pre></div>
<div row="897"><pre row="897">0897      <font color="black">205</font> <font color="red">        rows--;</font>                                                                                                                                                                                                             </pre></div>
<div row="898"><pre row="898">0898      <font color="black">206</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre></div>
<div row="899"><pre row="899">0899      <font color="black">207</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="900"><pre row="900">0900      <font color="black">208</font> <font color="red">    messageLastScrollHeight = textarea.scrollHeight;</font>                                                                                                                                                                        </pre></div>
<div row="901"><pre row="901">0901      <font color="black">209</font> <font color="red">    textarea.setAttribute("rows", rows);</font>                                                                                                                                                                                    </pre></div>
<div row="902"><pre row="902">0902      <font color="black">210</font> }                                                                                                              <font color="black">138</font> }                                                                                                        </pre></div>
<div row="903"><pre row="903">0903      <font color="black">211</font>                                                                                                                <font color="black">139</font>                                                                                                          </pre></div>
<div row="904"><pre row="904">0904      <font color="black">212</font> export default class Editor {                                                                                  <font color="black">140</font> export default class Editor {                                                                            </pre></div>
<div row="905"><pre row="905">0905      <font color="black">213</font>   constructor(formulas, viewFn, rowHeight) {                                                                   <font color="black">141</font>   constructor(formulas, viewFn, rowHeight) {                                                             </pre></div>
<div row="906"><pre row="906">0906      <font color="black">214</font>     this.viewFn = viewFn;                                                                                      <font color="black">142</font>     this.viewFn = viewFn;                                                                                </pre></div>
<div row="907"><pre row="907">0907 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="908"><pre row="908">0908      <font color="black">224</font>       this.clear();                                                                                            <font color="black">152</font>       this.clear();                                                                                      </pre></div>
<div row="909"><pre row="909">0909      <font color="black">225</font>     });                                                                                                        <font color="black">153</font>     });                                                                                                  </pre></div>
<div row="910"><pre row="910">0910      <font color="black">226</font>     this.areaEl = h('div', `${cssPrefix}-editor-area`)                                                         <font color="black">154</font>     this.areaEl = h('div', `${cssPrefix}-editor-area`)                                                   </pre></div>
<div row="911"><pre row="911">0911      <font color="black">227</font>       .children(                                                                                               <font color="black">155</font>       .children(                                                                                         </pre></div>
<div row="912"><pre row="912">0912      <font color="black">228</font>         this.textEl = h('textarea', '')                                                                        <font color="black">156</font>         this.textEl = h('textarea', '')                                                                  </pre></div>
<div row="913"><pre row="913">0913      <font color="black">229</font>        <font color="red">//</font>   .on('input', evt =&gt; inputEventHandler.call(this, evt)),                                            <font color="black">157</font>           .on('input', evt =&gt; inputEventHandler.call(this, evt)),                                        </pre></div>
<div row="914"><pre row="914">0914      <font color="black">230</font> <font color="red">          .on('keydown', evt =&gt; keydownEventHandler.call(this, evt)),</font>                                                                                                                                                       </pre></div>
<div row="915"><pre row="915">0915      <font color="black">231</font> <font color="red">        //  .on('textarea', evt =&gt; textareaEventHandler.call(this, evt)),</font>                                                                                                                                                   </pre></div>
<div row="916"><pre row="916">0916      <font color="black">232</font> <font color="red">        //this.textEl.attr("rows","5"),</font>                                                                                                                                                                                     </pre></div>
<div row="917"><pre row="917">0917      <font color="black">233</font> <font color="red">        //this.textEl.attr("cols","5"),</font>                                                                                                                                                                                     </pre></div>
<div row="918"><pre row="918">0918      <font color="black">234</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="919"><pre row="919">0919      <font color="black">235</font>         this.textlineEl = h('div', 'textline'),                                                                <font color="black">158</font>         this.textlineEl = h('div', 'textline'),                                                          </pre></div>
<div row="920"><pre row="920">0920      <font color="black">236</font>         this.suggest.el,                                                                                       <font color="black">159</font>         this.suggest.el,                                                                                 </pre></div>
<div row="921"><pre row="921">0921      <font color="black">237</font>         this.datepicker.el,                                                                                    <font color="black">160</font>         this.datepicker.el,                                                                              </pre></div>
<div row="922"><pre row="922">0922      <font color="black">238</font>       )                                                                                                        <font color="black">161</font>       )                                                                                                  </pre></div>
<div row="923"><pre row="923">0923      <font color="black">239</font>       .on('mousemove.stop', () =&gt; {})                                                                          <font color="black">162</font>       .on('mousemove.stop', () =&gt; {})                                                                    </pre></div>
<div row="924"><pre row="924">0924 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="925"><pre row="925">0925      <font color="black">325</font>       }                                                                                                        <font color="black">248</font>       }                                                                                                  </pre></div>
<div row="926"><pre row="926">0926      <font color="black">326</font>     }                                                                                                          <font color="black">249</font>     }                                                                                                    </pre></div>
<div row="927"><pre row="927">0927      <font color="black">327</font>   }                                                                                                            <font color="black">250</font>   }                                                                                                      </pre></div>
<div row="928"><pre row="928">0928      <font color="black">328</font>                                                                                                                <font color="black">251</font>                                                                                                          </pre></div>
<div row="929"><pre row="929">0929      <font color="black">329</font>   setText(text) {                                                                                              <font color="black">252</font>   setText(text) {                                                                                        </pre></div>
<div row="930"><pre row="930">0930      <font color="black">330</font>     this.inputText = text<font color="red"> </font>;                                                                                    <font color="black">253</font>     this.inputText = text;                                                                               </pre></div>
<div row="931"><pre row="931">0931      <font color="black">331</font>     // console.log('text&gt;&gt;:', text);                                                                           <font color="black">254</font>     // console.log('text&gt;&gt;:', text);                                                                     </pre></div>
<div row="932"><pre row="932">0932      <font color="black">332</font>     setText.call(this, text, text.length);                                                                     <font color="black">255</font>     setText.call(this, text, text.length);                                                               </pre></div>
<div row="933"><pre row="933">0933      <font color="black">333</font>     resetTextareaSize.call(this);                                                                              <font color="black">256</font>     resetTextareaSize.call(this);                                                                        </pre></div>
<div row="934"><pre row="934">0934      <font color="black">334</font>   }                                                                                                            <font color="black">257</font>   }                                                                                                      </pre></div>
<div row="935"><pre row="935">0935      <font color="black">335</font> }                                                                                                              <font color="black">258</font> }                                                                                                        </pre></div>
<div id="id-component-element_js"  class="pagelink" row="936"><pre class="pagehead" row="936">0936 id-component-element_js</pre></div>
<div row="937"><pre row="937">0937 <font color="blue">../src/component/element.js</font>                                                                                        <font color="blue">../../x-spreadsheet/src/component/element.js</font>                                                                      </pre></div>
<div row="938"><pre row="938">0938       <font color="black">42</font>     });                                                                                                         <font color="black">42</font>     });                                                                                                  </pre></div>
<div row="939"><pre row="939">0939       <font color="black">43</font>     return this;                                                                                                <font color="black">43</font>     return this;                                                                                         </pre></div>
<div row="940"><pre row="940">0940       <font color="black">44</font>   }                                                                                                             <font color="black">44</font>   }                                                                                                      </pre></div>
<div row="941"><pre row="941">0941       <font color="black">45</font>                                                                                                                 <font color="black">45</font>                                                                                                          </pre></div>
<div row="942"><pre row="942">0942       <font color="black">46</font>   offset(value) {                                                                                               <font color="black">46</font>   offset(value) {                                                                                        </pre></div>
<div row="943"><pre row="943">0943       <font color="black">47</font> <font color="red">    //console.log("element offset value: ", value);</font>                                                                                                                                                                         </pre></div>
<div row="944"><pre row="944">0944       <font color="black">48</font>     if (value !== undefined) {                                                                                  <font color="black">47</font>     if (value !== undefined) {                                                                           </pre></div>
<div row="945"><pre row="945">0945       <font color="black">49</font>       Object.keys(value).forEach((k) =&gt; {                                                                       <font color="black">48</font>       Object.keys(value).forEach((k) =&gt; {                                                                </pre></div>
<div row="946"><pre row="946">0946       <font color="black">50</font>         this.css(k, `${value[k]}px`);                                                                           <font color="black">49</font>         this.css(k, `${value[k]}px`);                                                                    </pre></div>
<div row="947"><pre row="947">0947       <font color="black">51</font>       });                                                                                                       <font color="black">50</font>       });                                                                                                </pre></div>
<div row="948"><pre row="948">0948       <font color="black">52</font>       return this;                                                                                              <font color="black">51</font>       return this;                                                                                       </pre></div>
<div row="949"><pre row="949">0949       <font color="black">53</font>     }                                                                                                           <font color="black">52</font>     }                                                                                                    </pre></div>
<div row="950"><pre row="950">0950       <font color="black">54</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre></div>
<div row="951"><pre row="951">0951       <font color="black">55</font>     const {                                                                                                     <font color="black">53</font>     const {                                                                                              </pre></div>
<div row="952"><pre row="952">0952       <font color="black">56</font>       offsetTop, offsetLeft, offsetHeight, offsetWidth,                                                         <font color="black">54</font>       offsetTop, offsetLeft, offsetHeight, offsetWidth,                                                  </pre></div>
<div row="953"><pre row="953">0953       <font color="black">57</font>     } = this.el;                                                                                                <font color="black">55</font>     } = this.el;                                                                                         </pre></div>
<div row="954"><pre row="954">0954       <font color="black">58</font>     return {                                                                                                    <font color="black">56</font>     return {                                                                                             </pre></div>
<div row="955"><pre row="955">0955       <font color="black">59</font>       top: offsetTop,                                                                                           <font color="black">57</font>       top: offsetTop,                                                                                    </pre></div>
<div row="956"><pre row="956">0956 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="957"><pre row="957">0957       <font color="black">90</font>     }                                                                                                           <font color="black">88</font>     }                                                                                                    </pre></div>
<div row="958"><pre row="958">0958       <font color="black">91</font>     eles.forEach(ele =&gt; this.child(ele));                                                                       <font color="black">89</font>     eles.forEach(ele =&gt; this.child(ele));                                                                </pre></div>
<div row="959"><pre row="959">0959       <font color="black">92</font>     return this;                                                                                                <font color="black">90</font>     return this;                                                                                         </pre></div>
<div row="960"><pre row="960">0960       <font color="black">93</font>   }                                                                                                             <font color="black">91</font>   }                                                                                                      </pre></div>
<div row="961"><pre row="961">0961       <font color="black">94</font>                                                                                                                 <font color="black">92</font>                                                                                                          </pre></div>
<div row="962"><pre row="962">0962                                                                                                                          <font color="black">93</font> <font color="green">  removeChild(el) {</font>                                                                                      </pre></div>
<div row="963"><pre row="963">0963                                                                                                                          <font color="black">94</font> <font color="green">    this.el.removeChild(el);</font>                                                                             </pre></div>
<div row="964"><pre row="964">0964                                                                                                                          <font color="black">95</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="965"><pre row="965">0965                                                                                                                          <font color="black">96</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="966"><pre row="966">0966       <font color="black">95</font>   /*                                                                                                            <font color="black">97</font>   /*                                                                                                     </pre></div>
<div row="967"><pre row="967">0967       <font color="black">96</font>   first() {                                                                                                     <font color="black">98</font>   first() {                                                                                              </pre></div>
<div row="968"><pre row="968">0968       <font color="black">97</font>     return this.el.firstChild;                                                                                  <font color="black">99</font>     return this.el.firstChild;                                                                           </pre></div>
<div row="969"><pre row="969">0969       <font color="black">98</font>   }                                                                                                            <font color="black">100</font>   }                                                                                                      </pre></div>
<div row="970"><pre row="970">0970       <font color="black">99</font>                                                                                                                <font color="black">101</font>                                                                                                          </pre></div>
<div row="971"><pre row="971">0971 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="972"><pre row="972">0972      <font color="black">220</font>     if (v !== undefined) {                                                                                     <font color="black">222</font>     if (v !== undefined) {                                                                               </pre></div>
<div row="973"><pre row="973">0973      <font color="black">221</font>       this.el.value = v;                                                                                       <font color="black">223</font>       this.el.value = v;                                                                                 </pre></div>
<div row="974"><pre row="974">0974      <font color="black">222</font>       return this;                                                                                             <font color="black">224</font>       return this;                                                                                       </pre></div>
<div row="975"><pre row="975">0975      <font color="black">223</font>     }                                                                                                          <font color="black">225</font>     }                                                                                                    </pre></div>
<div row="976"><pre row="976">0976      <font color="black">224</font>     return this.el.value;                                                                                      <font color="black">226</font>     return this.el.value;                                                                                </pre></div>
<div row="977"><pre row="977">0977                                                                                                                         <font color="black">227</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="978"><pre row="978">0978                                                                                                                         <font color="black">228</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="979"><pre row="979">0979                                                                                                                         <font color="black">229</font> <font color="green">  focus() {</font>                                                                                              </pre></div>
<div row="980"><pre row="980">0980                                                                                                                         <font color="black">230</font> <font color="green">    this.el.focus();</font>                                                                                     </pre></div>
<div row="981"><pre row="981">0981      <font color="black">225</font>   }                                                                                                            <font color="black">231</font>   }                                                                                                      </pre></div>
<div row="982"><pre row="982">0982      <font color="black">226</font>                                                                                                                <font color="black">232</font>                                                                                                          </pre></div>
<div row="983"><pre row="983">0983      <font color="black">227</font>   cssRemoveKeys(...keys) {                                                                                     <font color="black">233</font>   cssRemoveKeys(...keys) {                                                                               </pre></div>
<div row="984"><pre row="984">0984      <font color="black">228</font>     keys.forEach(k =&gt; this.el.style.removeProperty(k));                                                        <font color="black">234</font>     keys.forEach(k =&gt; this.el.style.removeProperty(k));                                                  </pre></div>
<div row="985"><pre row="985">0985      <font color="black">229</font>     return this;                                                                                               <font color="black">235</font>     return this;                                                                                         </pre></div>
<div id="id-component-event_js"  class="pagelink" row="986"><pre class="pagehead" row="986">0986 id-component-event_js</pre></div>
<div><pre row="987"><code =class"javascript">0987 ../src/component/event.js             ../../x-spreadsheet/src/component/event.js</code></pre></div>
<div id="id-component-form_field_js"  class="pagelink" row="988"><pre class="pagehead" row="988">0988 id-component-form_field_js</pre></div>
<div><pre row="989"><code =class"javascript">0989 ../src/component/form_field.js             ../../x-spreadsheet/src/component/form_field.js</code></pre></div>
<div id="id-component-form_input_js"  class="pagelink" row="990"><pre class="pagehead" row="990">0990 id-component-form_input_js</pre></div>
<div row="991"><pre row="991">0991 <font color="blue">../src/component/form_input.js</font>                                                                                     <font color="blue">../../x-spreadsheet/src/component/form_input.js</font>                                                                   </pre></div>
<div row="992"><pre row="992">0992        <font color="black">9</font>       .on('input', evt =&gt; this.vchange(evt))                                                                     <font color="black">9</font>       .on('input', evt =&gt; this.vchange(evt))                                                             </pre></div>
<div row="993"><pre row="993">0993       <font color="black">10</font>       .attr('placeholder', hint);                                                                               <font color="black">10</font>       .attr('placeholder', hint);                                                                        </pre></div>
<div row="994"><pre row="994">0994       <font color="black">11</font>     this.el.child(this.input);                                                                                  <font color="black">11</font>     this.el.child(this.input);                                                                           </pre></div>
<div row="995"><pre row="995">0995       <font color="black">12</font>   }                                                                                                             <font color="black">12</font>   }                                                                                                      </pre></div>
<div row="996"><pre row="996">0996       <font color="black">13</font>                                                                                                                 <font color="black">13</font>                                                                                                          </pre></div>
<div row="997"><pre row="997">0997                                                                                                                          <font color="black">14</font> <font color="green">  focus() {</font>                                                                                              </pre></div>
<div row="998"><pre row="998">0998                                                                                                                          <font color="black">15</font> <font color="green">    setTimeout(() =&gt; {</font>                                                                                   </pre></div>
<div row="999"><pre row="999">0999                                                                                                                          <font color="black">16</font> <font color="green">      this.input.el.focus();</font>                                                                             </pre></div>
<div row="1000"><pre row="1000">1000                                                                                                                          <font color="black">17</font> <font color="green">    }, 10);</font>                                                                                              </pre></div>
<div row="1001"><pre row="1001">1001                                                                                                                          <font color="black">18</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="1002"><pre row="1002">1002                                                                                                                          <font color="black">19</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1003"><pre row="1003">1003       <font color="black">14</font>   hint(v) {                                                                                                     <font color="black">20</font>   hint(v) {                                                                                              </pre></div>
<div row="1004"><pre row="1004">1004       <font color="black">15</font>     this.input.attr('placeholder', v);                                                                          <font color="black">21</font>     this.input.attr('placeholder', v);                                                                   </pre></div>
<div row="1005"><pre row="1005">1005       <font color="black">16</font>   }                                                                                                             <font color="black">22</font>   }                                                                                                      </pre></div>
<div row="1006"><pre row="1006">1006       <font color="black">17</font>                                                                                                                 <font color="black">23</font>                                                                                                          </pre></div>
<div row="1007"><pre row="1007">1007       <font color="black">18</font>   val(v) {                                                                                                      <font color="black">24</font>   val(v) {                                                                                               </pre></div>
<div id="id-component-form_select_js"  class="pagelink" row="1008"><pre class="pagehead" row="1008">1008 id-component-form_select_js</pre></div>
<div><pre row="1009"><code =class"javascript">1009 ../src/component/form_select.js             ../../x-spreadsheet/src/component/form_select.js</code></pre></div>
<div id="id-component-icon_js"  class="pagelink" row="1010"><pre class="pagehead" row="1010">1010 id-component-icon_js</pre></div>
<div><pre row="1011"><code =class"javascript">1011 ../src/component/icon.js             ../../x-spreadsheet/src/component/icon.js</code></pre></div>
<div id="id-component-message_js"  class="pagelink" row="1012"><pre class="pagehead" row="1012">1012 id-component-message_js</pre></div>
<div><pre row="1013"><code =class"javascript">1013 ../src/component/message.js             ../../x-spreadsheet/src/component/message.js</code></pre></div>
<div id="id-component-modal_js"  class="pagelink" row="1014"><pre class="pagehead" row="1014">1014 id-component-modal_js</pre></div>
<div><pre row="1015"><code =class"javascript">1015 ../src/component/modal.js             ../../x-spreadsheet/src/component/modal.js</code></pre></div>
<div id="id-component-modal_validation_js"  class="pagelink" row="1016"><pre class="pagehead" row="1016">1016 id-component-modal_validation_js</pre></div>
<div><pre row="1017"><code =class"javascript">1017 ../src/component/modal_validation.js             ../../x-spreadsheet/src/component/modal_validation.js</code></pre></div>
<div id="id-component-resizer_js"  class="pagelink" row="1018"><pre class="pagehead" row="1018">1018 id-component-resizer_js</pre></div>
<div row="1019"><pre row="1019">1019 <font color="blue">../src/component/resizer.js</font>                                                                                        <font color="blue">../../x-spreadsheet/src/component/resizer.js</font>                                                                      </pre></div>
<div row="1020"><pre row="1020">1020        <font color="black">6</font> export default class Resizer {                                                                                   <font color="black">6</font> export default class Resizer {                                                                           </pre></div>
<div row="1021"><pre row="1021">1021        <font color="black">7</font>   constructor(vertical = false, minDistance) {                                                                   <font color="black">7</font>   constructor(vertical = false, minDistance) {                                                           </pre></div>
<div row="1022"><pre row="1022">1022        <font color="black">8</font>     this.moving = false;                                                                                         <font color="black">8</font>     this.moving = false;                                                                                 </pre></div>
<div row="1023"><pre row="1023">1023        <font color="black">9</font>     this.vertical = vertical;                                                                                    <font color="black">9</font>     this.vertical = vertical;                                                                            </pre></div>
<div row="1024"><pre row="1024">1024       <font color="black">10</font>     this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(                <font color="black">10</font>     this.el = h('div', `${cssPrefix}-resizer ${vertical ? 'vertical' : 'horizontal'}`).children(         </pre></div>
<div row="1025"><pre row="1025">1025                                                                                                                          <font color="black">11</font> <font color="green">      this.unhideHoverEl = h('div', `${cssPrefix}-resizer-hover`)</font>                                        </pre></div>
<div row="1026"><pre row="1026">1026                                                                                                                          <font color="black">12</font> <font color="green">        .on('dblclick.stop', evt =&gt; this.mousedblclickHandler(evt))</font>                                      </pre></div>
<div row="1027"><pre row="1027">1027                                                                                                                          <font color="black">13</font> <font color="green">        .css('position', 'absolute').hide(),</font>                                                             </pre></div>
<div row="1028"><pre row="1028">1028       <font color="black">11</font>       this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)                                                     <font color="black">14</font>       this.hoverEl = h('div', `${cssPrefix}-resizer-hover`)                                              </pre></div>
<div row="1029"><pre row="1029">1029       <font color="black">12</font>         .on('mousedown.stop', evt =&gt; this.mousedownHandler(evt)),                                               <font color="black">15</font>         .on('mousedown.stop', evt =&gt; this.mousedownHandler(evt)),                                        </pre></div>
<div row="1030"><pre row="1030">1030       <font color="black">13</font>       this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),                                               <font color="black">16</font>       this.lineEl = h('div', `${cssPrefix}-resizer-line`).hide(),                                        </pre></div>
<div row="1031"><pre row="1031">1031       <font color="black">14</font>     ).hide();                                                                                                   <font color="black">17</font>     ).hide();                                                                                            </pre></div>
<div row="1032"><pre row="1032">1032       <font color="black">15</font>     // cell rect                                                                                                <font color="black">18</font>     // cell rect                                                                                         </pre></div>
<div row="1033"><pre row="1033">1033       <font color="black">16</font>     this.cRect = null;                                                                                          <font color="black">19</font>     this.cRect = null;                                                                                   </pre></div>
<div row="1034"><pre row="1034">1034       <font color="black">17</font>     this.finishedFn = null;                                                                                     <font color="black">20</font>     this.finishedFn = null;                                                                              </pre></div>
<div row="1035"><pre row="1035">1035       <font color="black">18</font>     this.minDistance = minDistance;                                                                             <font color="black">21</font>     this.minDistance = minDistance;                                                                      </pre></div>
<div row="1036"><pre row="1036">1036                                                                                                                          <font color="black">22</font> <font color="green">    this.unhideFn = () =&gt; {};</font>                                                                            </pre></div>
<div row="1037"><pre row="1037">1037                                                                                                                          <font color="black">23</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="1038"><pre row="1038">1038                                                                                                                          <font color="black">24</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1039"><pre row="1039">1039                                                                                                                          <font color="black">25</font> <font color="green">  showUnhide(index) {</font>                                                                                    </pre></div>
<div row="1040"><pre row="1040">1040                                                                                                                          <font color="black">26</font> <font color="green">    this.unhideIndex = index;</font>                                                                            </pre></div>
<div row="1041"><pre row="1041">1041                                                                                                                          <font color="black">27</font> <font color="green">    this.unhideHoverEl.show();</font>                                                                           </pre></div>
<div row="1042"><pre row="1042">1042                                                                                                                          <font color="black">28</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="1043"><pre row="1043">1043                                                                                                                          <font color="black">29</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1044"><pre row="1044">1044                                                                                                                          <font color="black">30</font> <font color="green">  hideUnhide() {</font>                                                                                         </pre></div>
<div row="1045"><pre row="1045">1045                                                                                                                          <font color="black">31</font> <font color="green">    this.unhideHoverEl.hide();</font>                                                                           </pre></div>
<div row="1046"><pre row="1046">1046       <font color="black">19</font>   }                                                                                                             <font color="black">32</font>   }                                                                                                      </pre></div>
<div row="1047"><pre row="1047">1047       <font color="black">20</font>                                                                                                                 <font color="black">33</font>                                                                                                          </pre></div>
<div row="1048"><pre row="1048">1048       <font color="black">21</font>   // rect : {top, left, width, height}                                                                          <font color="black">34</font>   // rect : {top, left, width, height}                                                                   </pre></div>
<div row="1049"><pre row="1049">1049       <font color="black">22</font>   // line : {width, height}                                                                                     <font color="black">35</font>   // line : {width, height}                                                                              </pre></div>
<div row="1050"><pre row="1050">1050       <font color="black">23</font>   show(rect, line) {                                                                                            <font color="black">36</font>   show(rect, line) {                                                                                     </pre></div>
<div row="1051"><pre row="1051">1051       <font color="black">24</font>     const {                                                                                                     <font color="black">37</font>     const {                                                                                              </pre></div>
<div row="1052"><pre row="1052">1052       <font color="black">25</font>       moving, vertical, hoverEl, lineEl, el,                                                                    <font color="black">38</font>       moving, vertical, hoverEl, lineEl, el,                                                             </pre></div>
<div row="1053"><pre row="1053">1053                                                                                                                          <font color="black">39</font> <font color="green">      unhideHoverEl,</font>                                                                                     </pre></div>
<div row="1054"><pre row="1054">1054       <font color="black">26</font>     } = this;                                                                                                   <font color="black">40</font>     } = this;                                                                                            </pre></div>
<div row="1055"><pre row="1055">1055       <font color="black">27</font>     if (moving) return;                                                                                         <font color="black">41</font>     if (moving) return;                                                                                  </pre></div>
<div row="1056"><pre row="1056">1056       <font color="black">28</font>     this.cRect = rect;                                                                                          <font color="black">42</font>     this.cRect = rect;                                                                                   </pre></div>
<div row="1057"><pre row="1057">1057       <font color="black">29</font>     const {                                                                                                     <font color="black">43</font>     const {                                                                                              </pre></div>
<div row="1058"><pre row="1058">1058       <font color="black">30</font>       left, top, width, height,                                                                                 <font color="black">44</font>       left, top, width, height,                                                                          </pre></div>
<div row="1059"><pre row="1059">1059 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1060"><pre row="1060">1060       <font color="black">39</font>     });                                                                                                         <font color="black">53</font>     });                                                                                                  </pre></div>
<div row="1061"><pre row="1061">1061       <font color="black">40</font>     lineEl.offset({                                                                                             <font color="black">54</font>     lineEl.offset({                                                                                      </pre></div>
<div row="1062"><pre row="1062">1062       <font color="black">41</font>       width: vertical ? 0 : line.width,                                                                         <font color="black">55</font>       width: vertical ? 0 : line.width,                                                                  </pre></div>
<div row="1063"><pre row="1063">1063       <font color="black">42</font>       height: vertical ? line.height : 0,                                                                       <font color="black">56</font>       height: vertical ? line.height : 0,                                                                </pre></div>
<div row="1064"><pre row="1064">1064       <font color="black">43</font>     });                                                                                                         <font color="black">57</font>     });                                                                                                  </pre></div>
<div row="1065"><pre row="1065">1065                                                                                                                          <font color="black">58</font> <font color="green">    unhideHoverEl.offset({</font>                                                                               </pre></div>
<div row="1066"><pre row="1066">1066                                                                                                                          <font color="black">59</font> <font color="green">      left: vertical ? 5 - width : left,</font>                                                                 </pre></div>
<div row="1067"><pre row="1067">1067                                                                                                                          <font color="black">60</font> <font color="green">      top: vertical ? top : 5 - height,</font>                                                                  </pre></div>
<div row="1068"><pre row="1068">1068                                                                                                                          <font color="black">61</font> <font color="green">      width: vertical ? 5 : width,</font>                                                                       </pre></div>
<div row="1069"><pre row="1069">1069                                                                                                                          <font color="black">62</font> <font color="green">      height: vertical ? height : 5,</font>                                                                     </pre></div>
<div row="1070"><pre row="1070">1070                                                                                                                          <font color="black">63</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="1071"><pre row="1071">1071       <font color="black">44</font>   }                                                                                                             <font color="black">64</font>   }                                                                                                      </pre></div>
<div row="1072"><pre row="1072">1072       <font color="black">45</font>                                                                                                                 <font color="black">65</font>                                                                                                          </pre></div>
<div row="1073"><pre row="1073">1073       <font color="black">46</font>   hide() {                                                                                                      <font color="black">66</font>   hide() {                                                                                               </pre></div>
<div row="1074"><pre row="1074">1074       <font color="black">47</font>     this.el.offset({                                                                                            <font color="black">67</font>     this.el.offset({                                                                                     </pre></div>
<div row="1075"><pre row="1075">1075       <font color="black">48</font>       left: 0,                                                                                                  <font color="black">68</font>       left: 0,                                                                                           </pre></div>
<div row="1076"><pre row="1076">1076       <font color="black">49</font>       top: 0,                                                                                                   <font color="black">69</font>       top: 0,                                                                                            </pre></div>
<div row="1077"><pre row="1077">1077       <font color="black">50</font>     }).hide();                                                                                                  <font color="black">70</font>     }).hide();                                                                                           </pre></div>
<div row="1078"><pre row="1078">1078                                                                                                                          <font color="black">71</font> <font color="green">    this.hideUnhide();</font>                                                                                   </pre></div>
<div row="1079"><pre row="1079">1079                                                                                                                          <font color="black">72</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="1080"><pre row="1080">1080                                                                                                                          <font color="black">73</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1081"><pre row="1081">1081                                                                                                                          <font color="black">74</font> <font color="green">  mousedblclickHandler() {</font>                                                                               </pre></div>
<div row="1082"><pre row="1082">1082                                                                                                                          <font color="black">75</font> <font color="green">    if (this.unhideIndex) this.unhideFn(this.unhideIndex);</font>                                               </pre></div>
<div row="1083"><pre row="1083">1083       <font color="black">51</font>   }                                                                                                             <font color="black">76</font>   }                                                                                                      </pre></div>
<div row="1084"><pre row="1084">1084       <font color="black">52</font>                                                                                                                 <font color="black">77</font>                                                                                                          </pre></div>
<div row="1085"><pre row="1085">1085       <font color="black">53</font>   mousedownHandler(evt) {                                                                                       <font color="black">78</font>   mousedownHandler(evt) {                                                                                </pre></div>
<div row="1086"><pre row="1086">1086       <font color="black">54</font>     let startEvt = evt;                                                                                         <font color="black">79</font>     let startEvt = evt;                                                                                  </pre></div>
<div row="1087"><pre row="1087">1087       <font color="black">55</font>     const {                                                                                                     <font color="black">80</font>     const {                                                                                              </pre></div>
<div id="id-component-scrollbar_js"  class="pagelink" row="1088"><pre class="pagehead" row="1088">1088 id-component-scrollbar_js</pre></div>
<div row="1089"><pre row="1089">1089 <font color="blue">../src/component/scrollbar.js</font>                                                                                      <font color="blue">../../x-spreadsheet/src/component/scrollbar.js</font>                                                                    </pre></div>
<div row="1090"><pre row="1090">1090       <font color="black">30</font>   set(distance, contentDistance) {                                                                              <font color="black">30</font>   set(distance, contentDistance) {                                                                       </pre></div>
<div row="1091"><pre row="1091">1091       <font color="black">31</font>     const d = distance - 1;                                                                                     <font color="black">31</font>     const d = distance - 1;                                                                              </pre></div>
<div row="1092"><pre row="1092">1092       <font color="black">32</font>     // console.log('distance:', distance, ', contentDistance:', contentDistance);                               <font color="black">32</font>     // console.log('distance:', distance, ', contentDistance:', contentDistance);                        </pre></div>
<div row="1093"><pre row="1093">1093       <font color="black">33</font>     if (contentDistance &gt; d) {                                                                                  <font color="black">33</font>     if (contentDistance &gt; d) {                                                                           </pre></div>
<div row="1094"><pre row="1094">1094       <font color="black">34</font>       const cssKey = this.vertical ? 'height' : 'width';                                                        <font color="black">34</font>       const cssKey = this.vertical ? 'height' : 'width';                                                 </pre></div>
<div row="1095"><pre row="1095">1095                                                                                                                          <font color="black">35</font> <font color="green">      // console.log('d:', d);</font>                                                                           </pre></div>
<div row="1096"><pre row="1096">1096       <font color="black">35</font>       this.el.css(cssKey, `${d}px`).show();                                                                     <font color="black">36</font>       this.el.css(cssKey, `${d<font color="green"> - 15</font>}px`).show();                                                         </pre></div>
<div row="1097"><pre row="1097">1097       <font color="black">36</font>       this.contentEl                                                                                            <font color="black">37</font>       this.contentEl                                                                                     </pre></div>
<div row="1098"><pre row="1098">1098       <font color="black">37</font>         .css(this.vertical ? 'width' : 'height', '1px')                                                         <font color="black">38</font>         .css(this.vertical ? 'width' : 'height', '1px')                                                  </pre></div>
<div row="1099"><pre row="1099">1099       <font color="black">38</font>         .css(cssKey, `${contentDistance}px`);                                                                   <font color="black">39</font>         .css(cssKey, `${contentDistance}px`);                                                            </pre></div>
<div row="1100"><pre row="1100">1100       <font color="black">39</font>     } else {                                                                                                    <font color="black">40</font>     } else {                                                                                             </pre></div>
<div row="1101"><pre row="1101">1101       <font color="black">40</font>       this.el.hide();                                                                                           <font color="black">41</font>       this.el.hide();                                                                                    </pre></div>
<div id="id-component-selector_js"  class="pagelink" row="1102"><pre class="pagehead" row="1102">1102 id-component-selector_js</pre></div>
<div row="1103"><pre row="1103">1103 <font color="blue">../src/component/selector.js</font>                                                                                       <font color="blue">../../x-spreadsheet/src/component/selector.js</font>                                                                     </pre></div>
<div row="1104"><pre row="1104">1104        <font color="black">4</font>                                                                                                                  <font color="black">4</font>                                                                                                          </pre></div>
<div row="1105"><pre row="1105">1105        <font color="black">5</font> const selectorHeightBorderWidth = 2 * 2 - 1;                                                                     <font color="black">5</font> const selectorHeightBorderWidth = 2 * 2 - 1;                                                             </pre></div>
<div row="1106"><pre row="1106">1106        <font color="black">6</font> let startZIndex = 10;                                                                                            <font color="black">6</font> let startZIndex = 10;                                                                                    </pre></div>
<div row="1107"><pre row="1107">1107        <font color="black">7</font>                                                                                                                  <font color="black">7</font>                                                                                                          </pre></div>
<div row="1108"><pre row="1108">1108        <font color="black">8</font> class SelectorElement {                                                                                          <font color="black">8</font> class SelectorElement {                                                                                  </pre></div>
<div row="1109"><pre row="1109">1109        <font color="black">9</font> <font color="red">  constructor() {</font>                                                                                                <font color="black">9</font> <font color="green">  constructor(useHideInput = false) {</font>                                                                    </pre></div>
<div row="1110"><pre row="1110">1110                                                                                                                          <font color="black">10</font> <font color="green">    this.useHideInput = useHideInput;</font>                                                                    </pre></div>
<div row="1111"><pre row="1111">1111                                                                                                                          <font color="black">11</font> <font color="green">    this.inputChange = () =&gt; {};</font>                                                                         </pre></div>
<div row="1112"><pre row="1112">1112       <font color="black">10</font>     this.cornerEl = h('div', `${cssPrefix}-selector-corner`);                                                   <font color="black">12</font>     this.cornerEl = h('div', `${cssPrefix}-selector-corner`);                                            </pre></div>
<div row="1113"><pre row="1113">1113       <font color="black">11</font>     this.areaEl = h('div', `${cssPrefix}-selector-area`)                                                        <font color="black">13</font>     this.areaEl = h('div', `${cssPrefix}-selector-area`)                                                 </pre></div>
<div row="1114"><pre row="1114">1114       <font color="black">12</font>       .child(this.cornerEl).hide();                                                                             <font color="black">14</font>       .child(this.cornerEl).hide();                                                                      </pre></div>
<div row="1115"><pre row="1115">1115       <font color="black">13</font>     this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();                                      <font color="black">15</font>     this.clipboardEl = h('div', `${cssPrefix}-selector-clipboard`).hide();                               </pre></div>
<div row="1116"><pre row="1116">1116       <font color="black">14</font>     this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();                                        <font color="black">16</font>     this.autofillEl = h('div', `${cssPrefix}-selector-autofill`).hide();                                 </pre></div>
<div row="1117"><pre row="1117">1117       <font color="black">15</font>     this.el = h('div', `${cssPrefix}-selector`)                                                                 <font color="black">17</font>     this.el = h('div', `${cssPrefix}-selector`)                                                          </pre></div>
<div row="1118"><pre row="1118">1118       <font color="black">16</font>       .css('z-index', `${startZIndex}`)                                                                         <font color="black">18</font>       .css('z-index', `${startZIndex}`)                                                                  </pre></div>
<div row="1119"><pre row="1119">1119       <font color="black">17</font>       .children(this.areaEl, this.clipboardEl, this.autofillEl)                                                 <font color="black">19</font>       .children(this.areaEl, this.clipboardEl, this.autofillEl)                                          </pre></div>
<div row="1120"><pre row="1120">1120       <font color="black">18</font>       .hide();                                                                                                  <font color="black">20</font>       .hide();                                                                                           </pre></div>
<div row="1121"><pre row="1121">1121                                                                                                                          <font color="black">21</font> <font color="green">    if (useHideInput) {</font>                                                                                  </pre></div>
<div row="1122"><pre row="1122">1122                                                                                                                          <font color="black">22</font> <font color="green">      this.hideInput = h('input', '')</font>                                                                    </pre></div>
<div row="1123"><pre row="1123">1123                                                                                                                          <font color="black">23</font> <font color="green">        .on('input', (evt) =&gt; {</font>                                                                          </pre></div>
<div row="1124"><pre row="1124">1124                                                                                                                          <font color="black">24</font> <font color="green">          this.inputChange(evt.target.value);</font>                                                            </pre></div>
<div row="1125"><pre row="1125">1125                                                                                                                          <font color="black">25</font> <font color="green">        });</font>                                                                                              </pre></div>
<div row="1126"><pre row="1126">1126                                                                                                                          <font color="black">26</font> <font color="green">      this.el.child(this.hideInputDiv = h('div', 'hide-input').child(this.hideInput));</font>                   </pre></div>
<div row="1127"><pre row="1127">1127                                                                                                                          <font color="black">27</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="1128"><pre row="1128">1128       <font color="black">19</font>     startZIndex += 1;                                                                                           <font color="black">28</font>     startZIndex += 1;                                                                                    </pre></div>
<div row="1129"><pre row="1129">1129       <font color="black">20</font>   }                                                                                                             <font color="black">29</font>   }                                                                                                      </pre></div>
<div row="1130"><pre row="1130">1130       <font color="black">21</font>                                                                                                                 <font color="black">30</font>                                                                                                          </pre></div>
<div row="1131"><pre row="1131">1131       <font color="black">22</font>   setOffset(v) {                                                                                                <font color="black">31</font>   setOffset(v) {                                                                                         </pre></div>
<div row="1132"><pre row="1132">1132       <font color="black">23</font>     this.el.offset(v).show();                                                                                   <font color="black">32</font>     this.el.offset(v).show();                                                                            </pre></div>
<div row="1133"><pre row="1133">1133 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1134"><pre row="1134">1134       <font color="black">31</font>                                                                                                                 <font color="black">40</font>                                                                                                          </pre></div>
<div row="1135"><pre row="1135">1135       <font color="black">32</font>   setAreaOffset(v) {                                                                                            <font color="black">41</font>   setAreaOffset(v) {                                                                                     </pre></div>
<div row="1136"><pre row="1136">1136       <font color="black">33</font>     const {                                                                                                     <font color="black">42</font>     const {                                                                                              </pre></div>
<div row="1137"><pre row="1137">1137       <font color="black">34</font>       left, top, width, height,                                                                                 <font color="black">43</font>       left, top, width, height,                                                                          </pre></div>
<div row="1138"><pre row="1138">1138       <font color="black">35</font>     } = v;                                                                                                      <font color="black">44</font>     } = v;                                                                                               </pre></div>
<div row="1139"><pre row="1139">1139       <font color="black">36</font> <font color="red">    this.areaEl.offset({</font>                                                                                        <font color="black">45</font> <font color="green">    const of = {</font>                                                                                         </pre></div>
<div row="1140"><pre row="1140">1140       <font color="black">37</font>       width: width - selectorHeightBorderWidth + 0.8,                                                           <font color="black">46</font>       width: width - selectorHeightBorderWidth + 0.8,                                                    </pre></div>
<div row="1141"><pre row="1141">1141       <font color="black">38</font>       height: height - selectorHeightBorderWidth + 0.8,                                                         <font color="black">47</font>       height: height - selectorHeightBorderWidth + 0.8,                                                  </pre></div>
<div row="1142"><pre row="1142">1142       <font color="black">39</font>       left: left - 0.8,                                                                                         <font color="black">48</font>       left: left - 0.8,                                                                                  </pre></div>
<div row="1143"><pre row="1143">1143       <font color="black">40</font>       top: top - 0.8,                                                                                           <font color="black">49</font>       top: top - 0.8,                                                                                    </pre></div>
<div row="1144"><pre row="1144">1144       <font color="black">41</font> <font color="red">    }).show();</font>                                                                                                  <font color="black">50</font> <font color="green">    };</font>                                                                                                   </pre></div>
<div row="1145"><pre row="1145">1145                                                                                                                          <font color="black">51</font> <font color="green">    this.areaEl.offset(of).show();</font>                                                                       </pre></div>
<div row="1146"><pre row="1146">1146                                                                                                                          <font color="black">52</font> <font color="green">    if (this.useHideInput) {</font>                                                                             </pre></div>
<div row="1147"><pre row="1147">1147                                                                                                                          <font color="black">53</font> <font color="green">      this.hideInputDiv.offset(of);</font>                                                                      </pre></div>
<div row="1148"><pre row="1148">1148                                                                                                                          <font color="black">54</font> <font color="green">      this.hideInput.val('').focus();</font>                                                                    </pre></div>
<div row="1149"><pre row="1149">1149                                                                                                                          <font color="black">55</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="1150"><pre row="1150">1150       <font color="black">42</font>   }                                                                                                             <font color="black">56</font>   }                                                                                                      </pre></div>
<div row="1151"><pre row="1151">1151       <font color="black">43</font>                                                                                                                 <font color="black">57</font>                                                                                                          </pre></div>
<div row="1152"><pre row="1152">1152       <font color="black">44</font>   setClipboardOffset(v) {                                                                                       <font color="black">58</font>   setClipboardOffset(v) {                                                                                </pre></div>
<div row="1153"><pre row="1153">1153       <font color="black">45</font>     const {                                                                                                     <font color="black">59</font>     const {                                                                                              </pre></div>
<div row="1154"><pre row="1154">1154       <font color="black">46</font>       left, top, width, height,                                                                                 <font color="black">60</font>       left, top, width, height,                                                                          </pre></div>
<div row="1155"><pre row="1155">1155 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1156"><pre row="1156">1156      <font color="black">178</font>   setLClipboardOffset.call(this, offset);                                                                      <font color="black">192</font>   setLClipboardOffset.call(this, offset);                                                                </pre></div>
<div row="1157"><pre row="1157">1157      <font color="black">179</font> }                                                                                                              <font color="black">193</font> }                                                                                                        </pre></div>
<div row="1158"><pre row="1158">1158      <font color="black">180</font>                                                                                                                <font color="black">194</font>                                                                                                          </pre></div>
<div row="1159"><pre row="1159">1159      <font color="black">181</font> export default class Selector {                                                                                <font color="black">195</font> export default class Selector {                                                                          </pre></div>
<div row="1160"><pre row="1160">1160      <font color="black">182</font>   constructor(data) {                                                                                          <font color="black">196</font>   constructor(data) {                                                                                    </pre></div>
<div row="1161"><pre row="1161">1161                                                                                                                         <font color="black">197</font> <font color="green">    this.inputChange = () =&gt; {};</font>                                                                         </pre></div>
<div row="1162"><pre row="1162">1162      <font color="black">183</font>     this.data = data;                                                                                          <font color="black">198</font>     this.data = data;                                                                                    </pre></div>
<div row="1163"><pre row="1163">1163      <font color="black">184</font>     this.br = new SelectorElement();                                                                           <font color="black">199</font>     this.br = new SelectorElement(<font color="green">true</font>);                                                                 </pre></div>
<div row="1164"><pre row="1164">1164      <font color="black">185</font>     this.t = new SelectorElement();                                                                            <font color="black">200</font>     this.t = new SelectorElement();                                                                      </pre></div>
<div row="1165"><pre row="1165">1165      <font color="black">186</font>     this.l = new SelectorElement();                                                                            <font color="black">201</font>     this.l = new SelectorElement();                                                                      </pre></div>
<div row="1166"><pre row="1166">1166      <font color="black">187</font>     this.tl = new SelectorElement();                                                                           <font color="black">202</font>     this.tl = new SelectorElement();                                                                     </pre></div>
<div row="1167"><pre row="1167">1167                                                                                                                         <font color="black">203</font> <font color="green">    this.br.inputChange = (v) =&gt; {</font>                                                                       </pre></div>
<div row="1168"><pre row="1168">1168                                                                                                                         <font color="black">204</font> <font color="green">      this.inputChange(v);</font>                                                                               </pre></div>
<div row="1169"><pre row="1169">1169                                                                                                                         <font color="black">205</font> <font color="green">    };</font>                                                                                                   </pre></div>
<div row="1170"><pre row="1170">1170      <font color="black">188</font>     this.br.el.show();                                                                                         <font color="black">206</font>     this.br.el.show();                                                                                   </pre></div>
<div row="1171"><pre row="1171">1171      <font color="black">189</font>     this.offset = null;                                                                                        <font color="black">207</font>     this.offset = null;                                                                                  </pre></div>
<div row="1172"><pre row="1172">1172      <font color="black">190</font>     this.areaOffset = null;                                                                                    <font color="black">208</font>     this.areaOffset = null;                                                                              </pre></div>
<div row="1173"><pre row="1173">1173      <font color="black">191</font>     this.indexes = null;                                                                                       <font color="black">209</font>     this.indexes = null;                                                                                 </pre></div>
<div row="1174"><pre row="1174">1174      <font color="black">192</font>     this.range = null;                                                                                         <font color="black">210</font>     this.range = null;                                                                                   </pre></div>
<div row="1175"><pre row="1175">1175 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1176"><pre row="1176">1176      <font color="black">202</font>     // for performance                                                                                         <font color="black">220</font>     // for performance                                                                                   </pre></div>
<div row="1177"><pre row="1177">1177      <font color="black">203</font>     this.lastri = -1;                                                                                          <font color="black">221</font>     this.lastri = -1;                                                                                    </pre></div>
<div row="1178"><pre row="1178">1178      <font color="black">204</font>     this.lastci = -1;                                                                                          <font color="black">222</font>     this.lastci = -1;                                                                                    </pre></div>
<div row="1179"><pre row="1179">1179      <font color="black">205</font>                                                                                                                <font color="black">223</font>                                                                                                          </pre></div>
<div row="1180"><pre row="1180">1180      <font color="black">206</font>     startZIndex += 1;                                                                                          <font color="black">224</font>     startZIndex += 1;                                                                                    </pre></div>
<div row="1181"><pre row="1181">1181                                                                                                                         <font color="black">225</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="1182"><pre row="1182">1182                                                                                                                         <font color="black">226</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1183"><pre row="1183">1183                                                                                                                         <font color="black">227</font> <font color="green">  resetData(data) {</font>                                                                                      </pre></div>
<div row="1184"><pre row="1184">1184                                                                                                                         <font color="black">228</font> <font color="green">    this.data = data;</font>                                                                                    </pre></div>
<div row="1185"><pre row="1185">1185                                                                                                                         <font color="black">229</font> <font color="green">    this.range = data.selector.range;</font>                                                                    </pre></div>
<div row="1186"><pre row="1186">1186                                                                                                                         <font color="black">230</font> <font color="green">    this.resetAreaOffset();</font>                                                                              </pre></div>
<div row="1187"><pre row="1187">1187      <font color="black">207</font>   }                                                                                                            <font color="black">231</font>   }                                                                                                      </pre></div>
<div row="1188"><pre row="1188">1188      <font color="black">208</font>                                                                                                                <font color="black">232</font>                                                                                                          </pre></div>
<div row="1189"><pre row="1189">1189      <font color="black">209</font>   hide() {                                                                                                     <font color="black">233</font>   hide() {                                                                                               </pre></div>
<div row="1190"><pre row="1190">1190      <font color="black">210</font>     this.el.hide();                                                                                            <font color="black">234</font>     this.el.hide();                                                                                      </pre></div>
<div row="1191"><pre row="1191">1191      <font color="black">211</font>   }                                                                                                            <font color="black">235</font>   }                                                                                                      </pre></div>
<div id="id-component-sheet_js"  class="pagelink" row="1192"><pre class="pagehead" row="1192">1192 id-component-sheet_js</pre></div>
<div row="1193"><pre row="1193">1193 <font color="blue">../src/component/sheet.js</font>                                                                                          <font color="blue">../../x-spreadsheet/src/component/sheet.js</font>                                                                        </pre></div>
<div row="1194"><pre row="1194">1194        <font color="black">3</font> import { bind, mouseMoveUp, bindTouch } from './event';                                                          <font color="black">3</font> import { bind, mouseMoveUp, bindTouch } from './event';                                                  </pre></div>
<div row="1195"><pre row="1195">1195        <font color="black">4</font> import Resizer from './resizer';                                                                                 <font color="black">4</font> import Resizer from './resizer';                                                                         </pre></div>
<div row="1196"><pre row="1196">1196        <font color="black">5</font> import Scrollbar from './scrollbar';                                                                             <font color="black">5</font> import Scrollbar from './scrollbar';                                                                     </pre></div>
<div row="1197"><pre row="1197">1197        <font color="black">6</font> import Selector from './selector';                                                                               <font color="black">6</font> import Selector from './selector';                                                                       </pre></div>
<div row="1198"><pre row="1198">1198        <font color="black">7</font> import Editor from './editor';                                                                                   <font color="black">7</font> import Editor from './editor';                                                                           </pre></div>
<div row="1199"><pre row="1199">1199                                                                                                                           <font color="black">8</font> <font color="green">import Print from './print';</font>                                                                             </pre></div>
<div row="1200"><pre row="1200">1200        <font color="black">8</font> import ContextMenu from './contextmenu';                                                                         <font color="black">9</font> import ContextMenu from './contextmenu';                                                                 </pre></div>
<div row="1201"><pre row="1201">1201        <font color="black">9</font> <font color="red">//import Table from './table';</font>                                                                                                                                                                                              </pre></div>
<div row="1202"><pre row="1202">1202       <font color="black">10</font> import Table from './table<font color="red">2</font>';                                                                                   <font color="black">10</font> import Table from './table';                                                                             </pre></div>
<div row="1203"><pre row="1203">1203       <font color="black">11</font> import Toolbar from './toolbar';                                                                                <font color="black">11</font> import Toolbar from './toolbar<font color="green">/index</font>';                                                                   </pre></div>
<div row="1204"><pre row="1204">1204       <font color="black">12</font> import ModalValidation from './modal_validation';                                                               <font color="black">12</font> import ModalValidation from './modal_validation';                                                        </pre></div>
<div row="1205"><pre row="1205">1205       <font color="black">13</font> import SortFilter from './sort_filter';                                                                         <font color="black">13</font> import SortFilter from './sort_filter';                                                                  </pre></div>
<div row="1206"><pre row="1206">1206       <font color="black">14</font> import { xtoast } from './message';                                                                             <font color="black">14</font> import { xtoast } from './message';                                                                      </pre></div>
<div row="1207"><pre row="1207">1207       <font color="black">15</font> import { cssPrefix } from '../config';                                                                          <font color="black">15</font> import { cssPrefix } from '../config';                                                                   </pre></div>
<div row="1208"><pre row="1208">1208       <font color="black">16</font> import { formulas } from '../core/formula';                                                                     <font color="black">16</font> import { formulas } from '../core/formula';                                                              </pre></div>
<div row="1209"><pre row="1209">1209                                                                                                                          <font color="black">17</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1210"><pre row="1210">1210                                                                                                                          <font color="black">18</font> <font color="green">/**</font>                                                                                                      </pre></div>
<div row="1211"><pre row="1211">1211                                                                                                                          <font color="black">19</font> <font color="green"> * @desc throttle fn</font>                                                                                     </pre></div>
<div row="1212"><pre row="1212">1212                                                                                                                          <font color="black">20</font> <font color="green"> * @param func function</font>                                                                                  </pre></div>
<div row="1213"><pre row="1213">1213                                                                                                                          <font color="black">21</font> <font color="green"> * @param wait Delay in milliseconds</font>                                                                     </pre></div>
<div row="1214"><pre row="1214">1214                                                                                                                          <font color="black">22</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="1215"><pre row="1215">1215                                                                                                                          <font color="black">23</font> <font color="green">function throttle(func, wait) {</font>                                                                          </pre></div>
<div row="1216"><pre row="1216">1216                                                                                                                          <font color="black">24</font> <font color="green">  let timeout;</font>                                                                                           </pre></div>
<div row="1217"><pre row="1217">1217                                                                                                                          <font color="black">25</font> <font color="green">  return (...arg) =&gt; {</font>                                                                                   </pre></div>
<div row="1218"><pre row="1218">1218                                                                                                                          <font color="black">26</font> <font color="green">    const that = this;</font>                                                                                   </pre></div>
<div row="1219"><pre row="1219">1219                                                                                                                          <font color="black">27</font> <font color="green">    const args = arg;</font>                                                                                    </pre></div>
<div row="1220"><pre row="1220">1220                                                                                                                          <font color="black">28</font> <font color="green">    if (!timeout) {</font>                                                                                      </pre></div>
<div row="1221"><pre row="1221">1221                                                                                                                          <font color="black">29</font> <font color="green">      timeout = setTimeout(() =&gt; {</font>                                                                       </pre></div>
<div row="1222"><pre row="1222">1222                                                                                                                          <font color="black">30</font> <font color="green">        timeout = null;</font>                                                                                  </pre></div>
<div row="1223"><pre row="1223">1223                                                                                                                          <font color="black">31</font> <font color="green">        func.apply(that, args);</font>                                                                          </pre></div>
<div row="1224"><pre row="1224">1224                                                                                                                          <font color="black">32</font> <font color="green">      }, wait);</font>                                                                                          </pre></div>
<div row="1225"><pre row="1225">1225                                                                                                                          <font color="black">33</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="1226"><pre row="1226">1226                                                                                                                          <font color="black">34</font> <font color="green">  };</font>                                                                                                     </pre></div>
<div row="1227"><pre row="1227">1227                                                                                                                          <font color="black">35</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="1228"><pre row="1228">1228       <font color="black">17</font>                                                                                                                 <font color="black">36</font>                                                                                                          </pre></div>
<div row="1229"><pre row="1229">1229       <font color="black">18</font> function scrollbarMove() {                                                                                      <font color="black">37</font> function scrollbarMove() {                                                                               </pre></div>
<div row="1230"><pre row="1230">1230       <font color="black">19</font>   const {                                                                                                       <font color="black">38</font>   const {                                                                                                </pre></div>
<div row="1231"><pre row="1231">1231       <font color="black">20</font>     data, verticalScrollbar, horizontalScrollbar,                                                               <font color="black">39</font>     data, verticalScrollbar, horizontalScrollbar,                                                        </pre></div>
<div row="1232"><pre row="1232">1232       <font color="black">21</font>   } = this;                                                                                                     <font color="black">40</font>   } = this;                                                                                              </pre></div>
<div row="1233"><pre row="1233">1233 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1234"><pre row="1234">1234       <font color="black">43</font>   }                                                                                                             <font color="black">62</font>   }                                                                                                      </pre></div>
<div row="1235"><pre row="1235">1235       <font color="black">44</font> }                                                                                                               <font color="black">63</font> }                                                                                                        </pre></div>
<div row="1236"><pre row="1236">1236       <font color="black">45</font>                                                                                                                 <font color="black">64</font>                                                                                                          </pre></div>
<div row="1237"><pre row="1237">1237       <font color="black">46</font> function selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {                                 <font color="black">65</font> function selectorSet(multiple, ri, ci, indexesUpdated = true, moving = false) {                          </pre></div>
<div row="1238"><pre row="1238">1238       <font color="black">47</font>   if (ri === -1 && ci === -1) return;                                                                           <font color="black">66</font>   if (ri === -1 && ci === -1) return;                                                                    </pre></div>
<div row="1239"><pre row="1239">1239       <font color="black">48</font> <font color="red">  // console.log(multiple, ', ri:', ri, ', ci:', ci);</font>                                                                                                                                                                       </pre></div>
<div row="1240"><pre row="1240">1240       <font color="black">49</font>   const {                                                                                                       <font color="black">67</font>   const {                                                                                                </pre></div>
<div row="1241"><pre row="1241">1241       <font color="black">50</font>     table, selector, toolbar,                                                                                   <font color="black">68</font>     table, selector, toolbar,<font color="green"> data,</font>                                                                      </pre></div>
<div row="1242"><pre row="1242">1242                                                                                                                          <font color="black">69</font> <font color="green">    contextMenu,</font>                                                                                         </pre></div>
<div row="1243"><pre row="1243">1243       <font color="black">51</font>   } = this;                                                                                                     <font color="black">70</font>   } = this;                                                                                              </pre></div>
<div row="1244"><pre row="1244">1244                                                                                                                          <font color="black">71</font> <font color="green">  contextMenu.setMode((ri === -1 || ci === -1) ? 'row-col' : 'range');</font>                                   </pre></div>
<div row="1245"><pre row="1245">1245                                                                                                                          <font color="black">72</font> <font color="green">  const cell = data.getCell(ri, ci);</font>                                                                     </pre></div>
<div row="1246"><pre row="1246">1246       <font color="black">52</font>   if (multiple) {                                                                                               <font color="black">73</font>   if (multiple) {                                                                                        </pre></div>
<div row="1247"><pre row="1247">1247       <font color="black">53</font>     selector.setEnd(ri, ci, moving);                                                                            <font color="black">74</font>     selector.setEnd(ri, ci, moving);                                                                     </pre></div>
<div row="1248"><pre row="1248">1248                                                                                                                          <font color="black">75</font> <font color="green">    this.trigger('cells-selected', cell, selector.range);</font>                                                </pre></div>
<div row="1249"><pre row="1249">1249       <font color="black">54</font>   } else {                                                                                                      <font color="black">76</font>   } else {                                                                                               </pre></div>
<div row="1250"><pre row="1250">1250                                                                                                                          <font color="black">77</font> <font color="green">    // trigger click event</font>                                                                               </pre></div>
<div row="1251"><pre row="1251">1251       <font color="black">55</font>     selector.set(ri, ci, indexesUpdated);                                                                       <font color="black">78</font>     selector.set(ri, ci, indexesUpdated);                                                                </pre></div>
<div row="1252"><pre row="1252">1252                                                                                                                          <font color="black">79</font> <font color="green">    this.trigger('cell-selected', cell, ri, ci);</font>                                                         </pre></div>
<div row="1253"><pre row="1253">1253       <font color="black">56</font>   }                                                                                                             <font color="black">80</font>   }                                                                                                      </pre></div>
<div row="1254"><pre row="1254">1254       <font color="black">57</font>   toolbar.reset();                                                                                              <font color="black">81</font>   toolbar.reset();                                                                                       </pre></div>
<div row="1255"><pre row="1255">1255       <font color="black">58</font>   table.render();                                                                                               <font color="black">82</font>   table.render();                                                                                        </pre></div>
<div row="1256"><pre row="1256">1256       <font color="black">59</font> }                                                                                                               <font color="black">83</font> }                                                                                                        </pre></div>
<div row="1257"><pre row="1257">1257       <font color="black">60</font>                                                                                                                 <font color="black">84</font>                                                                                                          </pre></div>
<div row="1258"><pre row="1258">1258 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1259"><pre row="1259">1259      <font color="black">117</font>   if (cRect.ri &gt;= 0 && cRect.ci === -1) {                                                                      <font color="black">141</font>   if (cRect.ri &gt;= 0 && cRect.ci === -1) {                                                                </pre></div>
<div row="1260"><pre row="1260">1260      <font color="black">118</font>     cRect.width = cols.indexWidth;                                                                             <font color="black">142</font>     cRect.width = cols.indexWidth;                                                                       </pre></div>
<div row="1261"><pre row="1261">1261      <font color="black">119</font>     rowResizer.show(cRect, {                                                                                   <font color="black">143</font>     rowResizer.show(cRect, {                                                                             </pre></div>
<div row="1262"><pre row="1262">1262      <font color="black">120</font>       width: tRect.width,                                                                                      <font color="black">144</font>       width: tRect.width,                                                                                </pre></div>
<div row="1263"><pre row="1263">1263      <font color="black">121</font>     });                                                                                                        <font color="black">145</font>     });                                                                                                  </pre></div>
<div row="1264"><pre row="1264">1264                                                                                                                         <font color="black">146</font> <font color="green">    if (rows.isHide(cRect.ri - 1)) {</font>                                                                     </pre></div>
<div row="1265"><pre row="1265">1265                                                                                                                         <font color="black">147</font> <font color="green">      rowResizer.showUnhide(cRect.ri);</font>                                                                   </pre></div>
<div row="1266"><pre row="1266">1266                                                                                                                         <font color="black">148</font> <font color="green">    } else {</font>                                                                                             </pre></div>
<div row="1267"><pre row="1267">1267                                                                                                                         <font color="black">149</font> <font color="green">      rowResizer.hideUnhide();</font>                                                                           </pre></div>
<div row="1268"><pre row="1268">1268                                                                                                                         <font color="black">150</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="1269"><pre row="1269">1269      <font color="black">122</font>   } else {                                                                                                     <font color="black">151</font>   } else {                                                                                               </pre></div>
<div row="1270"><pre row="1270">1270      <font color="black">123</font>     rowResizer.hide();                                                                                         <font color="black">152</font>     rowResizer.hide();                                                                                   </pre></div>
<div row="1271"><pre row="1271">1271      <font color="black">124</font>   }                                                                                                            <font color="black">153</font>   }                                                                                                      </pre></div>
<div row="1272"><pre row="1272">1272      <font color="black">125</font>   if (cRect.ri === -1 && cRect.ci &gt;= 0) {                                                                      <font color="black">154</font>   if (cRect.ri === -1 && cRect.ci &gt;= 0) {                                                                </pre></div>
<div row="1273"><pre row="1273">1273      <font color="black">126</font>     cRect.height = rows.height;                                                                                <font color="black">155</font>     cRect.height = rows.height;                                                                          </pre></div>
<div row="1274"><pre row="1274">1274      <font color="black">127</font>     colResizer.show(cRect, {                                                                                   <font color="black">156</font>     colResizer.show(cRect, {                                                                             </pre></div>
<div row="1275"><pre row="1275">1275      <font color="black">128</font>       height: tRect.height,                                                                                    <font color="black">157</font>       height: tRect.height,                                                                              </pre></div>
<div row="1276"><pre row="1276">1276      <font color="black">129</font>     });                                                                                                        <font color="black">158</font>     });                                                                                                  </pre></div>
<div row="1277"><pre row="1277">1277                                                                                                                         <font color="black">159</font> <font color="green">    if (cols.isHide(cRect.ci - 1)) {</font>                                                                     </pre></div>
<div row="1278"><pre row="1278">1278                                                                                                                         <font color="black">160</font> <font color="green">      colResizer.showUnhide(cRect.ci);</font>                                                                   </pre></div>
<div row="1279"><pre row="1279">1279                                                                                                                         <font color="black">161</font> <font color="green">    } else {</font>                                                                                             </pre></div>
<div row="1280"><pre row="1280">1280                                                                                                                         <font color="black">162</font> <font color="green">      colResizer.hideUnhide();</font>                                                                           </pre></div>
<div row="1281"><pre row="1281">1281                                                                                                                         <font color="black">163</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="1282"><pre row="1282">1282      <font color="black">130</font>   } else {                                                                                                     <font color="black">164</font>   } else {                                                                                               </pre></div>
<div row="1283"><pre row="1283">1283      <font color="black">131</font>     colResizer.hide();                                                                                         <font color="black">165</font>     colResizer.hide();                                                                                   </pre></div>
<div row="1284"><pre row="1284">1284      <font color="black">132</font>   }                                                                                                            <font color="black">166</font>   }                                                                                                      </pre></div>
<div row="1285"><pre row="1285">1285      <font color="black">133</font> }                                                                                                              <font color="black">167</font> }                                                                                                        </pre></div>
<div row="1286"><pre row="1286">1286      <font color="black">134</font>                                                                                                                <font color="black">168</font>                                                                                                          </pre></div>
<div row="1287"><pre row="1287">1287      <font color="black">135</font> function overlayerMousescroll(evt) {                                                                           <font color="black">169</font> function overlayerMousescroll(evt) {                                                                     </pre></div>
<div row="1288"><pre row="1288">1288      <font color="black">136</font>   const { verticalScrollbar, data } = this;                                                                    <font color="black">170</font>   const { verticalScrollbar, <font color="green">horizontalScrollbar, </font>data } = this;                                         </pre></div>
<div row="1289"><pre row="1289">1289      <font color="black">137</font>   const { top } = verticalScrollbar.scroll();                                                                  <font color="black">171</font>   const { top } = verticalScrollbar.scroll();                                                            </pre></div>
<div row="1290"><pre row="1290">1290                                                                                                                         <font color="black">172</font> <font color="green">  const { left } = horizontalScrollbar.scroll();</font>                                                         </pre></div>
<div row="1291"><pre row="1291">1291      <font color="black">138</font>   // console.log('evt:::', evt.wheelDelta, evt.detail * 40);                                                   <font color="black">173</font>   // console.log('evt:::', evt.wheelDelta, evt.detail * 40);                                             </pre></div>
<div row="1292"><pre row="1292">1292      <font color="black">139</font> <font color="red">  let delta = evt.deltaY;</font>                                                                                      <font color="black">174</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1293"><pre row="1293">1293      <font color="black">140</font>   const { rows } = data;                                                                                       <font color="black">175</font>   const { rows<font color="green">, cols</font> } = data;                                                                           </pre></div>
<div row="1294"><pre row="1294">1294                                                                                                                         <font color="black">176</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1295"><pre row="1295">1295                                                                                                                         <font color="black">177</font> <font color="green">  // deltaY for vertical delta</font>                                                                           </pre></div>
<div row="1296"><pre row="1296">1296                                                                                                                         <font color="black">178</font> <font color="green">  const { deltaY, deltaX } = evt;</font>                                                                        </pre></div>
<div row="1297"><pre row="1297">1297                                                                                                                         <font color="black">179</font> <font color="green">  const loopValue = (ii, vFunc) =&gt; {</font>                                                                     </pre></div>
<div row="1298"><pre row="1298">1298                                                                                                                         <font color="black">180</font> <font color="green">    let i = ii;</font>                                                                                          </pre></div>
<div row="1299"><pre row="1299">1299                                                                                                                         <font color="black">181</font> <font color="green">    let v = 0;</font>                                                                                           </pre></div>
<div row="1300"><pre row="1300">1300                                                                                                                         <font color="black">182</font> <font color="green">    do {</font>                                                                                                 </pre></div>
<div row="1301"><pre row="1301">1301                                                                                                                         <font color="black">183</font> <font color="green">      v = vFunc(i);</font>                                                                                      </pre></div>
<div row="1302"><pre row="1302">1302                                                                                                                         <font color="black">184</font> <font color="green">      i += 1;</font>                                                                                            </pre></div>
<div row="1303"><pre row="1303">1303                                                                                                                         <font color="black">185</font> <font color="green">    } while (v &lt;= 0);</font>                                                                                    </pre></div>
<div row="1304"><pre row="1304">1304                                                                                                                         <font color="black">186</font> <font color="green">    return v;</font>                                                                                            </pre></div>
<div row="1305"><pre row="1305">1305                                                                                                                         <font color="black">187</font> <font color="green">  };</font>                                                                                                     </pre></div>
<div row="1306"><pre row="1306">1306                                                                                                                         <font color="black">188</font> <font color="green">  // console.log('deltaX', deltaX, 'evt.detail', evt.detail);</font>                                            </pre></div>
<div row="1307"><pre row="1307">1307      <font color="black">141</font>   if (evt.detail) delta = evt.detail * 40;                                                                     <font color="black">189</font>  <font color="green"> //</font> if (evt.detail) delta<font color="green">Y</font> = evt.detail * 40;                                                           </pre></div>
<div row="1308"><pre row="1308">1308      <font color="black">142</font> <font color="red">  if (delta &gt; 0) {</font>                                                                                             <font color="black">190</font> <font color="green">  const moveY = (vertical) =&gt; {</font>                                                                          </pre></div>
<div row="1309"><pre row="1309">1309                                                                                                                         <font color="black">191</font> <font color="green">    if (vertical &gt; 0) {</font>                                                                                  </pre></div>
<div row="1310"><pre row="1310">1310      <font color="black">143</font>     // up                                                                                                      <font color="black">192</font> <font color="green">  </font>    // up                                                                                              </pre></div>
<div row="1311"><pre row="1311">1311      <font color="black">144</font>     const ri = data.scroll.ri + 1;                                                                             <font color="black">193</font> <font color="green">  </font>    const ri = data.scroll.ri + 1;                                                                     </pre></div>
<div row="1312"><pre row="1312">1312      <font color="black">145</font>     if (ri &lt; rows.len) {                                                                                       <font color="black">194</font> <font color="green">  </font>    if (ri &lt; rows.len) {                                                                               </pre></div>
<div row="1313"><pre row="1313">1313                                                                                                                         <font color="black">195</font> <font color="green">        const rh = loopValue(ri, i =&gt; rows.getHeight(i));</font>                                                </pre></div>
<div row="1314"><pre row="1314">1314      <font color="black">146</font>       verticalScrollbar.move({ top: top + r<font color="red">ows.getHeig</font>h<font color="red">t(ri)</font> - 1 });                                           <font color="black">196</font> <font color="green">  </font>      verticalScrollbar.move({ top: top + rh - 1 });                                                   </pre></div>
<div row="1315"><pre row="1315">1315      <font color="black">147</font>     }                                                                                                          <font color="black">197</font> <font color="green">  </font>    }                                                                                                  </pre></div>
<div row="1316"><pre row="1316">1316      <font color="black">148</font>   } else {                                                                                                     <font color="black">198</font> <font color="green">  </font>  } else {                                                                                             </pre></div>
<div row="1317"><pre row="1317">1317      <font color="black">149</font>     // down                                                                                                    <font color="black">199</font> <font color="green">  </font>    // down                                                                                            </pre></div>
<div row="1318"><pre row="1318">1318      <font color="black">150</font>     const ri = data.scroll.ri - 1;                                                                             <font color="black">200</font> <font color="green">  </font>    const ri = data.scroll.ri - 1;                                                                     </pre></div>
<div row="1319"><pre row="1319">1319      <font color="black">151</font>     if (ri &gt;= 0) {                                                                                             <font color="black">201</font> <font color="green">  </font>    if (ri &gt;= 0) {                                                                                     </pre></div>
<div row="1320"><pre row="1320">1320                                                                                                                         <font color="black">202</font> <font color="green">        const rh = loopValue(ri, i =&gt; rows.getHeight(i));</font>                                                </pre></div>
<div row="1321"><pre row="1321">1321      <font color="black">152</font>       verticalScrollbar.move({ top: ri === 0 ? 0 : top - r<font color="red">ows.getHeig</font>h<font color="red">t(ri)</font> });                                <font color="black">203</font> <font color="green">  </font>      verticalScrollbar.move({ top: ri === 0 ? 0 : top - rh });                                        </pre></div>
<div row="1322"><pre row="1322">1322      <font color="black">153</font>     }                                                                                                          <font color="black">204</font> <font color="green">  </font>    }                                                                                                  </pre></div>
<div row="1323"><pre row="1323">1323                                                                                                                         <font color="black">205</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="1324"><pre row="1324">1324      <font color="black">154</font>   }                                                                                                            <font color="black">206</font>   }<font color="green">;</font>                                                                                                     </pre></div>
<div row="1325"><pre row="1325">1325                                                                                                                         <font color="black">207</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1326"><pre row="1326">1326                                                                                                                         <font color="black">208</font> <font color="green">  // deltaX for Mac horizontal scroll</font>                                                                    </pre></div>
<div row="1327"><pre row="1327">1327                                                                                                                         <font color="black">209</font> <font color="green">  const moveX = (horizontal) =&gt; {</font>                                                                        </pre></div>
<div row="1328"><pre row="1328">1328                                                                                                                         <font color="black">210</font> <font color="green">    if (horizontal &gt; 0) {</font>                                                                                </pre></div>
<div row="1329"><pre row="1329">1329                                                                                                                         <font color="black">211</font> <font color="green">      // left</font>                                                                                            </pre></div>
<div row="1330"><pre row="1330">1330                                                                                                                         <font color="black">212</font> <font color="green">      const ci = data.scroll.ci + 1;</font>                                                                     </pre></div>
<div row="1331"><pre row="1331">1331                                                                                                                         <font color="black">213</font> <font color="green">      if (ci &lt; cols.len) {</font>                                                                               </pre></div>
<div row="1332"><pre row="1332">1332                                                                                                                         <font color="black">214</font> <font color="green">        const cw = loopValue(ci, i =&gt; cols.getWidth(i));</font>                                                 </pre></div>
<div row="1333"><pre row="1333">1333                                                                                                                         <font color="black">215</font> <font color="green">        horizontalScrollbar.move({ left: left + cw - 1 });</font>                                               </pre></div>
<div row="1334"><pre row="1334">1334                                                                                                                         <font color="black">216</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="1335"><pre row="1335">1335                                                                                                                         <font color="black">217</font> <font color="green">    } else {</font>                                                                                             </pre></div>
<div row="1336"><pre row="1336">1336                                                                                                                         <font color="black">218</font> <font color="green">      // right</font>                                                                                           </pre></div>
<div row="1337"><pre row="1337">1337                                                                                                                         <font color="black">219</font> <font color="green">      const ci = data.scroll.ci - 1;</font>                                                                     </pre></div>
<div row="1338"><pre row="1338">1338                                                                                                                         <font color="black">220</font> <font color="green">      if (ci &gt;= 0) {</font>                                                                                     </pre></div>
<div row="1339"><pre row="1339">1339                                                                                                                         <font color="black">221</font> <font color="green">        const cw = loopValue(ci, i =&gt; cols.getWidth(i));</font>                                                 </pre></div>
<div row="1340"><pre row="1340">1340                                                                                                                         <font color="black">222</font> <font color="green">        horizontalScrollbar.move({ left: ci === 0 ? 0 : left - cw });</font>                                    </pre></div>
<div row="1341"><pre row="1341">1341                                                                                                                         <font color="black">223</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="1342"><pre row="1342">1342                                                                                                                         <font color="black">224</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="1343"><pre row="1343">1343                                                                                                                         <font color="black">225</font> <font color="green">  };</font>                                                                                                     </pre></div>
<div row="1344"><pre row="1344">1344                                                                                                                         <font color="black">226</font> <font color="green">  const tempY = Math.abs(deltaY);</font>                                                                        </pre></div>
<div row="1345"><pre row="1345">1345                                                                                                                         <font color="black">227</font> <font color="green">  const tempX = Math.abs(deltaX);</font>                                                                        </pre></div>
<div row="1346"><pre row="1346">1346                                                                                                                         <font color="black">228</font> <font color="green">  const temp = Math.max(tempY, tempX);</font>                                                                   </pre></div>
<div row="1347"><pre row="1347">1347                                                                                                                         <font color="black">229</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1348"><pre row="1348">1348                                                                                                                         <font color="black">230</font> <font color="green">  if (temp === tempX) throttle(moveX(deltaX), 50);</font>                                                       </pre></div>
<div row="1349"><pre row="1349">1349                                                                                                                         <font color="black">231</font> <font color="green">  if (temp === tempY) throttle(moveY(deltaY), 50);</font>                                                       </pre></div>
<div row="1350"><pre row="1350">1350      <font color="black">155</font> }                                                                                                              <font color="black">232</font> }                                                                                                        </pre></div>
<div row="1351"><pre row="1351">1351      <font color="black">156</font>                                                                                                                <font color="black">233</font>                                                                                                          </pre></div>
<div row="1352"><pre row="1352">1352      <font color="black">157</font> function overlayerTouch(direction, distance) {                                                                 <font color="black">234</font> function overlayerTouch(direction, distance) {                                                           </pre></div>
<div row="1353"><pre row="1353">1353      <font color="black">158</font>   const { verticalScrollbar, horizontalScrollbar } = this;                                                     <font color="black">235</font>   const { verticalScrollbar, horizontalScrollbar } = this;                                               </pre></div>
<div row="1354"><pre row="1354">1354      <font color="black">159</font>   const { top } = verticalScrollbar.scroll();                                                                  <font color="black">236</font>   const { top } = verticalScrollbar.scroll();                                                            </pre></div>
<div row="1355"><pre row="1355">1355      <font color="black">160</font>   const { left } = horizontalScrollbar.scroll();                                                               <font color="black">237</font>   const { left } = horizontalScrollbar.scroll();                                                         </pre></div>
<div row="1356"><pre row="1356">1356      <font color="black">161</font> <font color="red">  // console.log('direction:', direction, ', distance:', distance, left);</font>                                      <font color="black">238</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1357"><pre row="1357">1357      <font color="black">162</font>   if (direction === 'left' || direction === 'right') {                                                         <font color="black">239</font>   if (direction === 'left' || direction === 'right') {                                                   </pre></div>
<div row="1358"><pre row="1358">1358      <font color="black">163</font>     horizontalScrollbar.move({ left: left - distance });                                                       <font color="black">240</font>     horizontalScrollbar.move({ left: left - distance });                                                 </pre></div>
<div row="1359"><pre row="1359">1359      <font color="black">164</font>   } else if (direction === 'up' || direction === 'down') {                                                     <font color="black">241</font>   } else if (direction === 'up' || direction === 'down') {                                               </pre></div>
<div row="1360"><pre row="1360">1360      <font color="black">165</font>     verticalScrollbar.move({ top: top - distance });                                                           <font color="black">242</font>     verticalScrollbar.move({ top: top - distance });                                                     </pre></div>
<div row="1361"><pre row="1361">1361      <font color="black">166</font>   }                                                                                                            <font color="black">243</font>   }                                                                                                      </pre></div>
<div row="1362"><pre row="1362">1362      <font color="black">167</font> }                                                                                                              <font color="black">244</font> }                                                                                                        </pre></div>
<div row="1363"><pre row="1363">1363      <font color="black">168</font>                                                                                                                <font color="black">245</font>                                                                                                          </pre></div>
<div row="1364"><pre row="1364">1364      <font color="black">169</font> function verticalScrollbarSet() {                                                                              <font color="black">246</font> function verticalScrollbarSet() {                                                                        </pre></div>
<div row="1365"><pre row="1365">1365      <font color="black">170</font>   const { data, verticalScrollbar } = this;                                                                    <font color="black">247</font>   const { data, verticalScrollbar } = this;                                                              </pre></div>
<div row="1366"><pre row="1366">1366      <font color="black">171</font>   const { height } = this.getTableOffset();                                                                    <font color="black">248</font>   const { height } = this.getTableOffset();                                                              </pre></div>
<div row="1367"><pre row="1367">1367                                                                                                                         <font color="black">249</font> <font color="green">  const erth = data.exceptRowTotalHeight(0, -1);</font>                                                         </pre></div>
<div row="1368"><pre row="1368">1368                                                                                                                         <font color="black">250</font> <font color="green">  // console.log('erth:', erth);</font>                                                                         </pre></div>
<div row="1369"><pre row="1369">1369      <font color="black">172</font>   verticalScrollbar.set(height, data.rows.totalHeight());                                                      <font color="black">251</font>   verticalScrollbar.set(height, data.rows.totalHeight()<font color="green"> - erth</font>);                                         </pre></div>
<div row="1370"><pre row="1370">1370      <font color="black">173</font> }                                                                                                              <font color="black">252</font> }                                                                                                        </pre></div>
<div row="1371"><pre row="1371">1371      <font color="black">174</font>                                                                                                                <font color="black">253</font>                                                                                                          </pre></div>
<div row="1372"><pre row="1372">1372      <font color="black">175</font> function horizontalScrollbarSet() {                                                                            <font color="black">254</font> function horizontalScrollbarSet() {                                                                      </pre></div>
<div row="1373"><pre row="1373">1373      <font color="black">176</font>   const { data, horizontalScrollbar } = this;                                                                  <font color="black">255</font>   const { data, horizontalScrollbar } = this;                                                            </pre></div>
<div row="1374"><pre row="1374">1374      <font color="black">177</font>   const { width } = this.getTableOffset();                                                                     <font color="black">256</font>   const { width } = this.getTableOffset();                                                               </pre></div>
<div row="1375"><pre row="1375">1375 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1376"><pre row="1376">1376      <font color="black">191</font>     editor.setFreezeLengths(fwidth, fheight);                                                                  <font color="black">270</font>     editor.setFreezeLengths(fwidth, fheight);                                                            </pre></div>
<div row="1377"><pre row="1377">1377      <font color="black">192</font>   }                                                                                                            <font color="black">271</font>   }                                                                                                      </pre></div>
<div row="1378"><pre row="1378">1378      <font color="black">193</font>   selector.resetAreaOffset();                                                                                  <font color="black">272</font>   selector.resetAreaOffset();                                                                            </pre></div>
<div row="1379"><pre row="1379">1379      <font color="black">194</font> }                                                                                                              <font color="black">273</font> }                                                                                                        </pre></div>
<div row="1380"><pre row="1380">1380      <font color="black">195</font>                                                                                                                <font color="black">274</font>                                                                                                          </pre></div>
<div row="1381"><pre row="1381">1381      <font color="black">196</font> <font color="red">function dataSync() {  //GUSA</font>                                                                                                                                                                                               </pre></div>
<div row="1382"><pre row="1382">1382      <font color="black">197</font> <font color="red">  const {</font>                                                                                                                                                                                                                   </pre></div>
<div row="1383"><pre row="1383">1383      <font color="black">198</font> <font color="red">    table,</font>                                                                                                                                                                                                                  </pre></div>
<div row="1384"><pre row="1384">1384      <font color="black">199</font> <font color="red">  } = this;</font>                                                                                                                                                                                                                 </pre></div>
<div row="1385"><pre row="1385">1385      <font color="black">200</font> <font color="red">  table.render();</font>                                                                                                                                                                                                           </pre></div>
<div row="1386"><pre row="1386">1386      <font color="black">201</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre></div>
<div row="1387"><pre row="1387">1387      <font color="black">202</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1388"><pre row="1388">1388      <font color="black">203</font> function sheetReset() {                                                                                        <font color="black">275</font> function sheetReset() {                                                                                  </pre></div>
<div row="1389"><pre row="1389">1389      <font color="black">204</font>   const {                                                                                                      <font color="black">276</font>   const {                                                                                                </pre></div>
<div row="1390"><pre row="1390">1390      <font color="black">205</font>     tableEl,                                                                                                   <font color="black">277</font>     tableEl,                                                                                             </pre></div>
<div row="1391"><pre row="1391">1391      <font color="black">206</font>     overlayerEl,                                                                                               <font color="black">278</font>     overlayerEl,                                                                                         </pre></div>
<div row="1392"><pre row="1392">1392      <font color="black">207</font>     overlayerCEl,                                                                                              <font color="black">279</font>     overlayerCEl,                                                                                        </pre></div>
<div row="1393"><pre row="1393">1393      <font color="black">208</font>     table,                                                                                                     <font color="black">280</font>     table,                                                                                               </pre></div>
<div row="1394"><pre row="1394">1394      <font color="black">209</font>     toolbar,                                                                                                   <font color="black">281</font>     toolbar,                                                                                             </pre></div>
<div row="1395"><pre row="1395">1395      <font color="black">210</font>     selector,                                                                                                  <font color="black">282</font>     selector,                                                                                            </pre></div>
<div row="1396"><pre row="1396">1396      <font color="black">211</font>     el,                                                                                                        <font color="black">283</font>     el,                                                                                                  </pre></div>
<div row="1397"><pre row="1397">1397      <font color="black">212</font> <font color="red">//    sync_sheet, //GUSA</font>                                                                                                                                                                                                    </pre></div>
<div row="1398"><pre row="1398">1398      <font color="black">213</font>   } = this;                                                                                                    <font color="black">284</font>   } = this;                                                                                              </pre></div>
<div row="1399"><pre row="1399">1399      <font color="black">214</font>   const tOffset = this.getTableOffset();                                                                       <font color="black">285</font>   const tOffset = this.getTableOffset();                                                                 </pre></div>
<div row="1400"><pre row="1400">1400      <font color="black">215</font>   const vRect = this.getRect();                                                                                <font color="black">286</font>   const vRect = this.getRect();                                                                          </pre></div>
<div row="1401"><pre row="1401">1401      <font color="black">216</font>   tableEl.attr(vRect);                                                                                         <font color="black">287</font>   tableEl.attr(vRect);                                                                                   </pre></div>
<div row="1402"><pre row="1402">1402      <font color="black">217</font>   overlayerEl.offset(vRect);                                                                                   <font color="black">288</font>   overlayerEl.offset(vRect);                                                                             </pre></div>
<div row="1403"><pre row="1403">1403 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1404"><pre row="1404">1404      <font color="black">221</font>   horizontalScrollbarSet.call(this);                                                                           <font color="black">292</font>   horizontalScrollbarSet.call(this);                                                                     </pre></div>
<div row="1405"><pre row="1405">1405      <font color="black">222</font>   sheetFreeze.call(this);                                                                                      <font color="black">293</font>   sheetFreeze.call(this);                                                                                </pre></div>
<div row="1406"><pre row="1406">1406      <font color="black">223</font>   table.render();                                                                                              <font color="black">294</font>   table.render();                                                                                        </pre></div>
<div row="1407"><pre row="1407">1407      <font color="black">224</font>   toolbar.reset();                                                                                             <font color="black">295</font>   toolbar.reset();                                                                                       </pre></div>
<div row="1408"><pre row="1408">1408      <font color="black">225</font>   selector.reset();                                                                                            <font color="black">296</font>   selector.reset();                                                                                      </pre></div>
<div row="1409"><pre row="1409">1409      <font color="black">226</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre></div>
<div row="1410"><pre row="1410">1410      <font color="black">227</font> <font color="red">  //GUSA</font>                                                                                                                                                                                                                    </pre></div>
<div row="1411"><pre row="1411">1411      <font color="black">228</font> <font color="red">    console.log("sync_sheets !!!");</font>                                                                                                                                                                                         </pre></div>
<div row="1412"><pre row="1412">1412      <font color="black">229</font> <font color="red">  //GUSA</font>                                                                                                                                                                                                                    </pre></div>
<div row="1413"><pre row="1413">1413      <font color="black">230</font> <font color="red">  if (this.sync_sheets) { //GUSA</font>                                                                                                                                                                                            </pre></div>
<div row="1414"><pre row="1414">1414      <font color="black">231</font> <font color="red">    console.log("sync_sheets !!!");</font>                                                                                                                                                                                         </pre></div>
<div row="1415"><pre row="1415">1415      <font color="black">232</font> <font color="red">    //this.sync_sheets[0].reload(); //GUSA</font>                                                                                                                                                                                  </pre></div>
<div row="1416"><pre row="1416">1416      <font color="black">233</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="1417"><pre row="1417">1417      <font color="black">234</font> <font color="red"> */ </font>                                                                                                                                                                                                                        </pre></div>
<div row="1418"><pre row="1418">1418      <font color="black">235</font> }                                                                                                              <font color="black">297</font> }                                                                                                        </pre></div>
<div row="1419"><pre row="1419">1419      <font color="black">236</font>                                                                                                                <font color="black">298</font>                                                                                                          </pre></div>
<div row="1420"><pre row="1420">1420      <font color="black">237</font> function clearClipboard() {                                                                                    <font color="black">299</font> function clearClipboard() {                                                                              </pre></div>
<div row="1421"><pre row="1421">1421      <font color="black">238</font>   const { data, selector } = this;                                                                             <font color="black">300</font>   const { data, selector } = this;                                                                       </pre></div>
<div row="1422"><pre row="1422">1422      <font color="black">239</font>   data.clearClipboard();                                                                                       <font color="black">301</font>   data.clearClipboard();                                                                                 </pre></div>
<div row="1423"><pre row="1423">1423 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1424"><pre row="1424">1424      <font color="black">250</font>   const { data, selector } = this;                                                                             <font color="black">312</font>   const { data, selector } = this;                                                                       </pre></div>
<div row="1425"><pre row="1425">1425      <font color="black">251</font>   data.cut();                                                                                                  <font color="black">313</font>   data.cut();                                                                                            </pre></div>
<div row="1426"><pre row="1426">1426      <font color="black">252</font>   selector.showClipboard();                                                                                    <font color="black">314</font>   selector.showClipboard();                                                                              </pre></div>
<div row="1427"><pre row="1427">1427      <font color="black">253</font> }                                                                                                              <font color="black">315</font> }                                                                                                        </pre></div>
<div row="1428"><pre row="1428">1428      <font color="black">254</font>                                                                                                                <font color="black">316</font>                                                                                                          </pre></div>
<div row="1429"><pre row="1429">1429      <font color="black">255</font> function paste(what) {                                                                                         <font color="black">317</font> function paste(what<font color="green">, evt</font>) {                                                                              </pre></div>
<div row="1430"><pre row="1430">1430      <font color="black">256</font>   const { data } = this;                                                                                       <font color="black">318</font>   const { data } = this;                                                                                 </pre></div>
<div row="1431"><pre row="1431">1431      <font color="black">257</font>   if (data.paste(what, msg =&gt; xtoast('Tip', msg))) {                                                           <font color="black">319</font>   if (data.paste(what, msg =&gt; xtoast('Tip', msg))) {                                                     </pre></div>
<div row="1432"><pre row="1432">1432      <font color="black">258</font>     sheetReset.call(this);                                                                                     <font color="black">320</font>     sheetReset.call(this);                                                                               </pre></div>
<div row="1433"><pre row="1433">1433                                                                                                                         <font color="black">321</font> <font color="green">  } else if (evt) {</font>                                                                                      </pre></div>
<div row="1434"><pre row="1434">1434                                                                                                                         <font color="black">322</font> <font color="green">    const cdata = evt.clipboardData.getData('text/plain');</font>                                               </pre></div>
<div row="1435"><pre row="1435">1435                                                                                                                         <font color="black">323</font> <font color="green">    this.data.pasteFromText(cdata);</font>                                                                      </pre></div>
<div row="1436"><pre row="1436">1436                                                                                                                         <font color="black">324</font> <font color="green">    sheetReset.call(this);</font>                                                                               </pre></div>
<div row="1437"><pre row="1437">1437      <font color="black">259</font>   }                                                                                                            <font color="black">325</font>   }                                                                                                      </pre></div>
<div row="1438"><pre row="1438">1438                                                                                                                         <font color="black">326</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="1439"><pre row="1439">1439                                                                                                                         <font color="black">327</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1440"><pre row="1440">1440                                                                                                                         <font color="black">328</font> <font color="green">function hideRowsOrCols() {</font>                                                                              </pre></div>
<div row="1441"><pre row="1441">1441                                                                                                                         <font color="black">329</font> <font color="green">  this.data.hideRowsOrCols();</font>                                                                            </pre></div>
<div row="1442"><pre row="1442">1442                                                                                                                         <font color="black">330</font> <font color="green">  sheetReset.call(this);</font>                                                                                 </pre></div>
<div row="1443"><pre row="1443">1443                                                                                                                         <font color="black">331</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="1444"><pre row="1444">1444                                                                                                                         <font color="black">332</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1445"><pre row="1445">1445                                                                                                                         <font color="black">333</font> <font color="green">function unhideRowsOrCols(type, index) {</font>                                                                 </pre></div>
<div row="1446"><pre row="1446">1446                                                                                                                         <font color="black">334</font> <font color="green">  this.data.unhideRowsOrCols(type, index);</font>                                                               </pre></div>
<div row="1447"><pre row="1447">1447                                                                                                                         <font color="black">335</font> <font color="green">  sheetReset.call(this);</font>                                                                                 </pre></div>
<div row="1448"><pre row="1448">1448      <font color="black">260</font> }                                                                                                              <font color="black">336</font> }                                                                                                        </pre></div>
<div row="1449"><pre row="1449">1449      <font color="black">261</font>                                                                                                                <font color="black">337</font>                                                                                                          </pre></div>
<div row="1450"><pre row="1450">1450      <font color="black">262</font> function autofilter() {                                                                                        <font color="black">338</font> function autofilter() {                                                                                  </pre></div>
<div row="1451"><pre row="1451">1451      <font color="black">263</font>   const { data } = this;                                                                                       <font color="black">339</font>   const { data } = this;                                                                                 </pre></div>
<div row="1452"><pre row="1452">1452      <font color="black">264</font>   data.autofilter();                                                                                           <font color="black">340</font>   data.autofilter();                                                                                     </pre></div>
<div row="1453"><pre row="1453">1453 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1454"><pre row="1454">1454      <font color="black">370</font>     editorSetOffset.call(this);                                                                                <font color="black">446</font>     editorSetOffset.call(this);                                                                          </pre></div>
<div row="1455"><pre row="1455">1455      <font color="black">371</font>     table.render();                                                                                            <font color="black">447</font>     table.render();                                                                                      </pre></div>
<div row="1456"><pre row="1456">1456      <font color="black">372</font>   });                                                                                                          <font color="black">448</font>   });                                                                                                    </pre></div>
<div row="1457"><pre row="1457">1457      <font color="black">373</font> }                                                                                                              <font color="black">449</font> }                                                                                                        </pre></div>
<div row="1458"><pre row="1458">1458      <font color="black">374</font>                                                                                                                <font color="black">450</font>                                                                                                          </pre></div>
<div row="1459"><pre row="1459">1459      <font color="black">375</font> <font color="red">function sync_verticalScrollbarMove(distance) {</font>                                                                                                                                                                             </pre></div>
<div row="1460"><pre row="1460">1460      <font color="black">376</font> <font color="red">  const { data, table, selector } = this;</font>                                                                                                                                                                                   </pre></div>
<div row="1461"><pre row="1461">1461      <font color="black">377</font> <font color="red">  data.sync_scrolly(distance, () =&gt; {</font>                                                                                                                                                                                       </pre></div>
<div row="1462"><pre row="1462">1462      <font color="black">378</font> <font color="red">    selector.resetBRLAreaOffset();</font>                                                                                                                                                                                          </pre></div>
<div row="1463"><pre row="1463">1463      <font color="black">379</font> <font color="red">    editorSetOffset.call(this);</font>                                                                                                                                                                                             </pre></div>
<div row="1464"><pre row="1464">1464      <font color="black">380</font> <font color="red">    table.render();</font>                                                                                                                                                                                                         </pre></div>
<div row="1465"><pre row="1465">1465      <font color="black">381</font> <font color="red">  });</font>                                                                                                                                                                                                                       </pre></div>
<div row="1466"><pre row="1466">1466      <font color="black">382</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre></div>
<div row="1467"><pre row="1467">1467      <font color="black">383</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1468"><pre row="1468">1468      <font color="black">384</font> <font color="red">function sync_horizontalScrollbarMove(distance) {</font>                                                                                                                                                                           </pre></div>
<div row="1469"><pre row="1469">1469      <font color="black">385</font> <font color="red">  const { data, table, selector } = this;</font>                                                                                                                                                                                   </pre></div>
<div row="1470"><pre row="1470">1470      <font color="black">386</font> <font color="red">  data.sync_scrollx(distance, () =&gt; {</font>                                                                                                                                                                                       </pre></div>
<div row="1471"><pre row="1471">1471      <font color="black">387</font> <font color="red">    selector.resetBRTAreaOffset();</font>                                                                                                                                                                                          </pre></div>
<div row="1472"><pre row="1472">1472      <font color="black">388</font> <font color="red">    editorSetOffset.call(this);</font>                                                                                                                                                                                             </pre></div>
<div row="1473"><pre row="1473">1473      <font color="black">389</font> <font color="red">    table.render();</font>                                                                                                                                                                                                         </pre></div>
<div row="1474"><pre row="1474">1474      <font color="black">390</font> <font color="red">  });</font>                                                                                                                                                                                                                       </pre></div>
<div row="1475"><pre row="1475">1475      <font color="black">391</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre></div>
<div row="1476"><pre row="1476">1476      <font color="black">392</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1477"><pre row="1477">1477      <font color="black">393</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre></div>
<div row="1478"><pre row="1478">1478      <font color="black">394</font> <font color="red">function sync_shape_layer_move() {</font>                                                                                                                                                                                          </pre></div>
<div row="1479"><pre row="1479">1479      <font color="black">395</font> <font color="red">  const { data, table, selector } = this;</font>                                                                                                                                                                                   </pre></div>
<div row="1480"><pre row="1480">1480      <font color="black">396</font> <font color="red">    table.sync_move_laerd_cell();</font>                                                                                                                                                                                           </pre></div>
<div row="1481"><pre row="1481">1481      <font color="black">397</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1482"><pre row="1482">1482      <font color="black">398</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre></div>
<div row="1483"><pre row="1483">1483      <font color="black">399</font> <font color="red">*/</font>                                                                                                                                                                                                                          </pre></div>
<div row="1484"><pre row="1484">1484      <font color="black">400</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1485"><pre row="1485">1485      <font color="black">401</font> function rowResizerFinished(cRect, distance) {                                                                 <font color="black">451</font> function rowResizerFinished(cRect, distance) {                                                           </pre></div>
<div row="1486"><pre row="1486">1486      <font color="black">402</font>   const { ri } = cRect;                                                                                        <font color="black">452</font>   const { ri } = cRect;                                                                                  </pre></div>
<div row="1487"><pre row="1487">1487      <font color="black">403</font>   const { table, selector, data } = this;                                                                      <font color="black">453</font>   const { table, selector, data } = this;                                                                </pre></div>
<div row="1488"><pre row="1488">1488      <font color="black">404</font>   data.rows.setHeight(ri, distance);                                                                           <font color="black">454</font>   data.rows.setHeight(ri, distance);                                                                     </pre></div>
<div row="1489"><pre row="1489">1489      <font color="black">405</font> <font color="red">  data.setRowHeight(ri, distance);  //GUSA</font>                                                                                                                                                                                  </pre></div>
<div row="1490"><pre row="1490">1490      <font color="black">406</font>   table.render();                                                                                              <font color="black">455</font>   table.render();                                                                                        </pre></div>
<div row="1491"><pre row="1491">1491      <font color="black">407</font>   selector.resetAreaOffset();                                                                                  <font color="black">456</font>   selector.resetAreaOffset();                                                                            </pre></div>
<div row="1492"><pre row="1492">1492      <font color="black">408</font>   verticalScrollbarSet.call(this);                                                                             <font color="black">457</font>   verticalScrollbarSet.call(this);                                                                       </pre></div>
<div row="1493"><pre row="1493">1493      <font color="black">409</font>   editorSetOffset.call(this);                                                                                  <font color="black">458</font>   editorSetOffset.call(this);                                                                            </pre></div>
<div row="1494"><pre row="1494">1494      <font color="black">410</font> }                                                                                                              <font color="black">459</font> }                                                                                                        </pre></div>
<div row="1495"><pre row="1495">1495      <font color="black">411</font>                                                                                                                <font color="black">460</font>                                                                                                          </pre></div>
<div row="1496"><pre row="1496">1496      <font color="black">412</font> function colResizerFinished(cRect, distance) {                                                                 <font color="black">461</font> function colResizerFinished(cRect, distance) {                                                           </pre></div>
<div row="1497"><pre row="1497">1497      <font color="black">413</font>   const { ci } = cRect;                                                                                        <font color="black">462</font>   const { ci } = cRect;                                                                                  </pre></div>
<div row="1498"><pre row="1498">1498      <font color="black">414</font>   const { table, selector, data } = this;                                                                      <font color="black">463</font>   const { table, selector, data } = this;                                                                </pre></div>
<div row="1499"><pre row="1499">1499      <font color="black">415</font>   data.cols.setWidth(ci, distance);                                                                            <font color="black">464</font>   data.cols.setWidth(ci, distance);                                                                      </pre></div>
<div row="1500"><pre row="1500">1500      <font color="black">416</font> <font color="red">  data.setColWidth(ci, distance); //GUSA</font>                                                                                                                                                                                    </pre></div>
<div row="1501"><pre row="1501">1501      <font color="black">417</font>   // console.log('data:', data);                                                                               <font color="black">465</font>   // console.log('data:', data);                                                                         </pre></div>
<div row="1502"><pre row="1502">1502      <font color="black">418</font>   table.render();                                                                                              <font color="black">466</font>   table.render();                                                                                        </pre></div>
<div row="1503"><pre row="1503">1503      <font color="black">419</font>   selector.resetAreaOffset();                                                                                  <font color="black">467</font>   selector.resetAreaOffset();                                                                            </pre></div>
<div row="1504"><pre row="1504">1504      <font color="black">420</font>   horizontalScrollbarSet.call(this);                                                                           <font color="black">468</font>   horizontalScrollbarSet.call(this);                                                                     </pre></div>
<div row="1505"><pre row="1505">1505      <font color="black">421</font>   editorSetOffset.call(this);                                                                                  <font color="black">469</font>   editorSetOffset.call(this);                                                                            </pre></div>
<div row="1506"><pre row="1506">1506 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1507"><pre row="1507">1507      <font color="black">423</font>                                                                                                                <font color="black">471</font>                                                                                                          </pre></div>
<div row="1508"><pre row="1508">1508      <font color="black">424</font> function dataSetCellText(text, state = 'finished') {                                                           <font color="black">472</font> function dataSetCellText(text, state = 'finished') {                                                     </pre></div>
<div row="1509"><pre row="1509">1509      <font color="black">425</font>   const { data, table } = this;                                                                                <font color="black">473</font>   const { data, table } = this;                                                                          </pre></div>
<div row="1510"><pre row="1510">1510      <font color="black">426</font>   // const [ri, ci] = selector.indexes;                                                                        <font color="black">474</font>   // const [ri, ci] = selector.indexes;                                                                  </pre></div>
<div row="1511"><pre row="1511">1511      <font color="black">427</font>   data.setSelectedCellText(text, state);                                                                       <font color="black">475</font>   data.setSelectedCellText(text, state);                                                                 </pre></div>
<div row="1512"><pre row="1512">1512      <font color="black">428</font>   if (state === 'finished') <font color="orange">table.render();</font>                                                                    <font color="black">476</font>   if (state === 'finished') <font color="orange">{</font>                                                                            </pre></div>
<div row="1513"><pre row="1513">1513                                                                                                                         <font color="black">477</font> <font color="green">    const { ri, ci } = data.selector;</font>                                                                    </pre></div>
<div row="1514"><pre row="1514">1514                                                                                                                         <font color="black">478</font> <font color="green">    this.trigger('cell-edited', text, ri, ci);</font>                                                           </pre></div>
<div row="1515"><pre row="1515">1515                                                                                                                         <font color="black">479</font> <font color="green">    table.render();</font>                                                                                      </pre></div>
<div row="1516"><pre row="1516">1516                                                                                                                         <font color="black">480</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="1517"><pre row="1517">1517      <font color="black">429</font> }                                                                                                              <font color="black">481</font> }                                                                                                        </pre></div>
<div row="1518"><pre row="1518">1518      <font color="black">430</font>                                                                                                                <font color="black">482</font>                                                                                                          </pre></div>
<div row="1519"><pre row="1519">1519      <font color="black">431</font> function insertDeleteRowColumn(type) {                                                                         <font color="black">483</font> function insertDeleteRowColumn(type) {                                                                   </pre></div>
<div row="1520"><pre row="1520">1520      <font color="black">432</font>   const { data } = this;                                                                                       <font color="black">484</font>   const { data } = this;                                                                                 </pre></div>
<div row="1521"><pre row="1521">1521      <font color="black">433</font>   if (type === 'insert-row') {                                                                                 <font color="black">485</font>   if (type === 'insert-row') {                                                                           </pre></div>
<div row="1522"><pre row="1522">1522 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1523"><pre row="1523">1523      <font color="black">442</font>     data.deleteCell();                                                                                         <font color="black">494</font>     data.deleteCell();                                                                                   </pre></div>
<div row="1524"><pre row="1524">1524      <font color="black">443</font>   } else if (type === 'delete-cell-format') {                                                                  <font color="black">495</font>   } else if (type === 'delete-cell-format') {                                                            </pre></div>
<div row="1525"><pre row="1525">1525      <font color="black">444</font>     data.deleteCell('format');                                                                                 <font color="black">496</font>     data.deleteCell('format');                                                                           </pre></div>
<div row="1526"><pre row="1526">1526      <font color="black">445</font>   } else if (type === 'delete-cell-text') {                                                                    <font color="black">497</font>   } else if (type === 'delete-cell-text') {                                                              </pre></div>
<div row="1527"><pre row="1527">1527      <font color="black">446</font>     data.deleteCell('text');                                                                                   <font color="black">498</font>     data.deleteCell('text');                                                                             </pre></div>
<div row="1528"><pre row="1528">1528                                                                                                                         <font color="black">499</font> <font color="green">  } else if (type === 'cell-printable') {</font>                                                                </pre></div>
<div row="1529"><pre row="1529">1529                                                                                                                         <font color="black">500</font> <font color="green">    data.setSelectedCellAttr('printable', true);</font>                                                         </pre></div>
<div row="1530"><pre row="1530">1530                                                                                                                         <font color="black">501</font> <font color="green">  } else if (type === 'cell-non-printable') {</font>                                                            </pre></div>
<div row="1531"><pre row="1531">1531                                                                                                                         <font color="black">502</font> <font color="green">    data.setSelectedCellAttr('printable', false);</font>                                                        </pre></div>
<div row="1532"><pre row="1532">1532                                                                                                                         <font color="black">503</font> <font color="green">  } else if (type === 'cell-editable') {</font>                                                                 </pre></div>
<div row="1533"><pre row="1533">1533                                                                                                                         <font color="black">504</font> <font color="green">    data.setSelectedCellAttr('editable', true);</font>                                                          </pre></div>
<div row="1534"><pre row="1534">1534                                                                                                                         <font color="black">505</font> <font color="green">  } else if (type === 'cell-non-editable') {</font>                                                             </pre></div>
<div row="1535"><pre row="1535">1535                                                                                                                         <font color="black">506</font> <font color="green">    data.setSelectedCellAttr('editable', false);</font>                                                         </pre></div>
<div row="1536"><pre row="1536">1536      <font color="black">447</font>   }                                                                                                            <font color="black">507</font>   }                                                                                                      </pre></div>
<div row="1537"><pre row="1537">1537      <font color="black">448</font>   clearClipboard.call(this);                                                                                   <font color="black">508</font>   clearClipboard.call(this);                                                                             </pre></div>
<div row="1538"><pre row="1538">1538      <font color="black">449</font>   sheetReset.call(this);                                                                                       <font color="black">509</font>   sheetReset.call(this);                                                                                 </pre></div>
<div row="1539"><pre row="1539">1539      <font color="black">450</font> }                                                                                                              <font color="black">510</font> }                                                                                                        </pre></div>
<div row="1540"><pre row="1540">1540      <font color="black">451</font>                                                                                                                <font color="black">511</font>                                                                                                          </pre></div>
<div row="1541"><pre row="1541">1541 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1542"><pre row="1542">1542      <font color="black">454</font>   if (type === 'undo') {                                                                                       <font color="black">514</font>   if (type === 'undo') {                                                                                 </pre></div>
<div row="1543"><pre row="1543">1543      <font color="black">455</font>     this.undo();                                                                                               <font color="black">515</font>     this.undo();                                                                                         </pre></div>
<div row="1544"><pre row="1544">1544      <font color="black">456</font>   } else if (type === 'redo') {                                                                                <font color="black">516</font>   } else if (type === 'redo') {                                                                          </pre></div>
<div row="1545"><pre row="1545">1545      <font color="black">457</font>     this.redo();                                                                                               <font color="black">517</font>     this.redo();                                                                                         </pre></div>
<div row="1546"><pre row="1546">1546      <font color="black">458</font>   } else if (type === 'print') {                                                                               <font color="black">518</font>   } else if (type === 'print') {                                                                         </pre></div>
<div row="1547"><pre row="1547">1547      <font color="black">459</font> <font color="red">    // print</font>                                                                                                   <font color="black">519</font> <font color="green">    this.print.preview();</font>                                                                                </pre></div>
<div row="1548"><pre row="1548">1548      <font color="black">460</font>   } else if (type === 'paintformat') {                                                                         <font color="black">520</font>   } else if (type === 'paintformat') {                                                                   </pre></div>
<div row="1549"><pre row="1549">1549      <font color="black">461</font>     if (value === true) copy.call(this);                                                                       <font color="black">521</font>     if (value === true) copy.call(this);                                                                 </pre></div>
<div row="1550"><pre row="1550">1550      <font color="black">462</font>     else clearClipboard.call(this);                                                                            <font color="black">522</font>     else clearClipboard.call(this);                                                                      </pre></div>
<div row="1551"><pre row="1551">1551      <font color="black">463</font>   } else if (type === 'clearformat') {                                                                         <font color="black">523</font>   } else if (type === 'clearformat') {                                                                   </pre></div>
<div row="1552"><pre row="1552">1552      <font color="black">464</font>     insertDeleteRowColumn.call(this, 'delete-cell-format');                                                    <font color="black">524</font>     insertDeleteRowColumn.call(this, 'delete-cell-format');                                              </pre></div>
<div row="1553"><pre row="1553">1553 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1554"><pre row="1554">1554      <font color="black">474</font>       const { ri, ci } = data.selector;                                                                        <font color="black">534</font>       const { ri, ci } = data.selector;                                                                  </pre></div>
<div row="1555"><pre row="1555">1555      <font color="black">475</font>       this.freeze(ri, ci);                                                                                     <font color="black">535</font>       this.freeze(ri, ci);                                                                               </pre></div>
<div row="1556"><pre row="1556">1556      <font color="black">476</font>     } else {                                                                                                   <font color="black">536</font>     } else {                                                                                             </pre></div>
<div row="1557"><pre row="1557">1557      <font color="black">477</font>       this.freeze(0, 0);                                                                                       <font color="black">537</font>       this.freeze(0, 0);                                                                                 </pre></div>
<div row="1558"><pre row="1558">1558      <font color="black">478</font>     }                                                                                                          <font color="black">538</font>     }                                                                                                    </pre></div>
<div row="1559"><pre row="1559">1559      <font color="black">479</font> <font color="red">  } else if (type === 'overlayer') {</font>                                                                                                                                                                                        </pre></div>
<div row="1560"><pre row="1560">1560      <font color="black">480</font> <font color="red">     this.enableOverlayer(value);</font>                                                                                                                                                                                           </pre></div>
<div row="1561"><pre row="1561">1561      <font color="black">481</font>   } else {                                                                                                     <font color="black">539</font>   } else {                                                                                               </pre></div>
<div row="1562"><pre row="1562">1562      <font color="black">482</font>     data.setSelectedCellAttr(type, value);                                                                     <font color="black">540</font>     data.setSelectedCellAttr(type, value);                                                               </pre></div>
<div row="1563"><pre row="1563">1563      <font color="black">483</font> <font color="red">    if (type === 'formula') {</font>                                                                                  <font color="black">541</font> <font color="green">    if (type === 'formula' && !data.selector.multiple()) {</font>                                               </pre></div>
<div row="1564"><pre row="1564">1564      <font color="black">484</font>       editorSet.call(this);                                                                                    <font color="black">542</font>       editorSet.call(this);                                                                              </pre></div>
<div row="1565"><pre row="1565">1565      <font color="black">485</font>     }                                                                                                          <font color="black">543</font>     }                                                                                                    </pre></div>
<div row="1566"><pre row="1566">1566      <font color="black">486</font>     sheetReset.call(this);                                                                                     <font color="black">544</font>     sheetReset.call(this);                                                                               </pre></div>
<div row="1567"><pre row="1567">1567      <font color="black">487</font>   }                                                                                                            <font color="black">545</font>   }                                                                                                      </pre></div>
<div row="1568"><pre row="1568">1568      <font color="black">488</font> }                                                                                                              <font color="black">546</font> }                                                                                                        </pre></div>
<div row="1569"><pre row="1569">1569 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1570"><pre row="1570">1570      <font color="black">493</font>   sheetReset.call(this);                                                                                       <font color="black">551</font>   sheetReset.call(this);                                                                                 </pre></div>
<div row="1571"><pre row="1571">1571      <font color="black">494</font> }                                                                                                              <font color="black">552</font> }                                                                                                        </pre></div>
<div row="1572"><pre row="1572">1572      <font color="black">495</font>                                                                                                                <font color="black">553</font>                                                                                                          </pre></div>
<div row="1573"><pre row="1573">1573      <font color="black">496</font> function sheetInitEvents() {                                                                                   <font color="black">554</font> function sheetInitEvents() {                                                                             </pre></div>
<div row="1574"><pre row="1574">1574      <font color="black">497</font>   const {                                                                                                      <font color="black">555</font>   const {                                                                                                </pre></div>
<div row="1575"><pre row="1575">1575                                                                                                                         <font color="black">556</font> <font color="green">    selector,</font>                                                                                            </pre></div>
<div row="1576"><pre row="1576">1576      <font color="black">498</font>     overlayerEl,                                                                                               <font color="black">557</font>     overlayerEl,                                                                                         </pre></div>
<div row="1577"><pre row="1577">1577      <font color="black">499</font>     rowResizer,                                                                                                <font color="black">558</font>     rowResizer,                                                                                          </pre></div>
<div row="1578"><pre row="1578">1578      <font color="black">500</font>     colResizer,                                                                                                <font color="black">559</font>     colResizer,                                                                                          </pre></div>
<div row="1579"><pre row="1579">1579      <font color="black">501</font>     verticalScrollbar,                                                                                         <font color="black">560</font>     verticalScrollbar,                                                                                   </pre></div>
<div row="1580"><pre row="1580">1580      <font color="black">502</font>     horizontalScrollbar,                                                                                       <font color="black">561</font>     horizontalScrollbar,                                                                                 </pre></div>
<div row="1581"><pre row="1581">1581 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1582"><pre row="1582">1582      <font color="black">526</font>         editorSet.call(this);                                                                                  <font color="black">585</font>         editorSet.call(this);                                                                            </pre></div>
<div row="1583"><pre row="1583">1583      <font color="black">527</font>       } else {                                                                                                 <font color="black">586</font>       } else {                                                                                           </pre></div>
<div row="1584"><pre row="1584">1584      <font color="black">528</font>         editor.clear();                                                                                        <font color="black">587</font>         editor.clear();                                                                                  </pre></div>
<div row="1585"><pre row="1585">1585      <font color="black">529</font>         overlayerMousedown.call(this, evt);                                                                    <font color="black">588</font>         overlayerMousedown.call(this, evt);                                                              </pre></div>
<div row="1586"><pre row="1586">1586      <font color="black">530</font>       }                                                                                                        <font color="black">589</font>       }                                                                                                  </pre></div>
<div row="1587"><pre row="1587">1587                                                                                                                         <font color="black">590</font> <font color="green">    })</font>                                                                                                   </pre></div>
<div row="1588"><pre row="1588">1588      <font color="black">531</font>     <font color="red">})</font>.on('mousewheel.stop', (evt) =&gt; {                                                                        <font color="black">591</font>     .on('mousewheel.stop', (evt) =&gt; {                                                                    </pre></div>
<div row="1589"><pre row="1589">1589      <font color="black">532</font>       overlayerMousescroll.call(this, evt);                                                                    <font color="black">592</font>       overlayerMousescroll.call(this, evt);                                                              </pre></div>
<div row="1590"><pre row="1590">1590                                                                                                                         <font color="black">593</font> <font color="green">    })</font>                                                                                                   </pre></div>
<div row="1591"><pre row="1591">1591                                                                                                                         <font color="black">594</font> <font color="green">    .on('mouseout', (evt) =&gt; {</font>                                                                           </pre></div>
<div row="1592"><pre row="1592">1592                                                                                                                         <font color="black">595</font> <font color="green">      const { offsetX, offsetY } = evt;</font>                                                                  </pre></div>
<div row="1593"><pre row="1593">1593                                                                                                                         <font color="black">596</font> <font color="green">      if (offsetY &lt;= 0) colResizer.hide();</font>                                                               </pre></div>
<div row="1594"><pre row="1594">1594                                                                                                                         <font color="black">597</font> <font color="green">      if (offsetX &lt;= 0) rowResizer.hide();</font>                                                               </pre></div>
<div row="1595"><pre row="1595">1595      <font color="black">533</font>     });                                                                                                        <font color="black">598</font>     });                                                                                                  </pre></div>
<div row="1596"><pre row="1596">1596                                                                                                                         <font color="black">599</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1597"><pre row="1597">1597                                                                                                                         <font color="black">600</font> <font color="green">  selector.inputChange = (v) =&gt; {</font>                                                                        </pre></div>
<div row="1598"><pre row="1598">1598                                                                                                                         <font color="black">601</font> <font color="green">    dataSetCellText.call(this, v, 'input');</font>                                                              </pre></div>
<div row="1599"><pre row="1599">1599                                                                                                                         <font color="black">602</font> <font color="green">    editorSet.call(this);</font>                                                                                </pre></div>
<div row="1600"><pre row="1600">1600                                                                                                                         <font color="black">603</font> <font color="green">  };</font>                                                                                                     </pre></div>
<div row="1601"><pre row="1601">1601      <font color="black">534</font>                                                                                                                <font color="black">604</font>                                                                                                          </pre></div>
<div row="1602"><pre row="1602">1602      <font color="black">535</font>   // slide on mobile                                                                                           <font color="black">605</font>   // slide on mobile                                                                                     </pre></div>
<div row="1603"><pre row="1603">1603      <font color="black">536</font>   bindTouch(overlayerEl.el, {                                                                                  <font color="black">606</font>   bindTouch(overlayerEl.el, {                                                                            </pre></div>
<div row="1604"><pre row="1604">1604      <font color="black">537</font>     move: (direction, d) =&gt; {                                                                                  <font color="black">607</font>     move: (direction, d) =&gt; {                                                                            </pre></div>
<div row="1605"><pre row="1605">1605      <font color="black">538</font>       overlayerTouch.call(this, direction, d);                                                                 <font color="black">608</font>       overlayerTouch.call(this, direction, d);                                                           </pre></div>
<div row="1606"><pre row="1606">1606 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1607"><pre row="1607">1607      <font color="black">549</font>   rowResizer.finishedFn = (cRect, distance) =&gt; {                                                               <font color="black">619</font>   rowResizer.finishedFn = (cRect, distance) =&gt; {                                                         </pre></div>
<div row="1608"><pre row="1608">1608      <font color="black">550</font>     rowResizerFinished.call(this, cRect, distance);                                                            <font color="black">620</font>     rowResizerFinished.call(this, cRect, distance);                                                      </pre></div>
<div row="1609"><pre row="1609">1609      <font color="black">551</font>   };                                                                                                           <font color="black">621</font>   };                                                                                                     </pre></div>
<div row="1610"><pre row="1610">1610      <font color="black">552</font>   colResizer.finishedFn = (cRect, distance) =&gt; {                                                               <font color="black">622</font>   colResizer.finishedFn = (cRect, distance) =&gt; {                                                         </pre></div>
<div row="1611"><pre row="1611">1611      <font color="black">553</font>     colResizerFinished.call(this, cRect, distance);                                                            <font color="black">623</font>     colResizerFinished.call(this, cRect, distance);                                                      </pre></div>
<div row="1612"><pre row="1612">1612                                                                                                                         <font color="black">624</font> <font color="green">  };</font>                                                                                                     </pre></div>
<div row="1613"><pre row="1613">1613                                                                                                                         <font color="black">625</font> <font color="green">  // resizer unhide callback</font>                                                                             </pre></div>
<div row="1614"><pre row="1614">1614                                                                                                                         <font color="black">626</font> <font color="green">  rowResizer.unhideFn = (index) =&gt; {</font>                                                                     </pre></div>
<div row="1615"><pre row="1615">1615                                                                                                                         <font color="black">627</font> <font color="green">    unhideRowsOrCols.call(this, 'row', index);</font>                                                           </pre></div>
<div row="1616"><pre row="1616">1616                                                                                                                         <font color="black">628</font> <font color="green">  };</font>                                                                                                     </pre></div>
<div row="1617"><pre row="1617">1617                                                                                                                         <font color="black">629</font> <font color="green">  colResizer.unhideFn = (index) =&gt; {</font>                                                                     </pre></div>
<div row="1618"><pre row="1618">1618                                                                                                                         <font color="black">630</font> <font color="green">    unhideRowsOrCols.call(this, 'col', index);</font>                                                           </pre></div>
<div row="1619"><pre row="1619">1619      <font color="black">554</font>   };                                                                                                           <font color="black">631</font>   };                                                                                                     </pre></div>
<div row="1620"><pre row="1620">1620      <font color="black">555</font>   // scrollbar move callback                                                                                   <font color="black">632</font>   // scrollbar move callback                                                                             </pre></div>
<div row="1621"><pre row="1621">1621      <font color="black">556</font>   verticalScrollbar.moveFn = (distance, evt) =&gt; {                                                              <font color="black">633</font>   verticalScrollbar.moveFn = (distance, evt) =&gt; {                                                        </pre></div>
<div row="1622"><pre row="1622">1622      <font color="black">557</font>     verticalScrollbarMove.call(this, distance, evt);                                                           <font color="black">634</font>     verticalScrollbarMove.call(this, distance, evt);                                                     </pre></div>
<div row="1623"><pre row="1623">1623      <font color="black">558</font>   };                                                                                                           <font color="black">635</font>   };                                                                                                     </pre></div>
<div row="1624"><pre row="1624">1624 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1625"><pre row="1625">1625      <font color="black">584</font>       paste.call(this, 'all');                                                                                 <font color="black">661</font>       paste.call(this, 'all');                                                                           </pre></div>
<div row="1626"><pre row="1626">1626      <font color="black">585</font>     } else if (type === 'paste-value') {                                                                       <font color="black">662</font>     } else if (type === 'paste-value') {                                                                 </pre></div>
<div row="1627"><pre row="1627">1627      <font color="black">586</font>       paste.call(this, 'text');                                                                                <font color="black">663</font>       paste.call(this, 'text');                                                                          </pre></div>
<div row="1628"><pre row="1628">1628      <font color="black">587</font>     } else if (type === 'paste-format') {                                                                      <font color="black">664</font>     } else if (type === 'paste-format') {                                                                </pre></div>
<div row="1629"><pre row="1629">1629      <font color="black">588</font>       paste.call(this, 'format');                                                                              <font color="black">665</font>       paste.call(this, 'format');                                                                        </pre></div>
<div row="1630"><pre row="1630">1630                                                                                                                         <font color="black">666</font> <font color="green">    } else if (type === 'hide') {</font>                                                                        </pre></div>
<div row="1631"><pre row="1631">1631                                                                                                                         <font color="black">667</font> <font color="green">      hideRowsOrCols.call(this);</font>                                                                         </pre></div>
<div row="1632"><pre row="1632">1632      <font color="black">589</font>     } else {                                                                                                   <font color="black">668</font>     } else {                                                                                             </pre></div>
<div row="1633"><pre row="1633">1633      <font color="black">590</font>       insertDeleteRowColumn.call(this, type);                                                                  <font color="black">669</font>       insertDeleteRowColumn.call(this, type);                                                            </pre></div>
<div row="1634"><pre row="1634">1634      <font color="black">591</font>     }                                                                                                          <font color="black">670</font>     }                                                                                                    </pre></div>
<div row="1635"><pre row="1635">1635      <font color="black">592</font>   };                                                                                                           <font color="black">671</font>   };                                                                                                     </pre></div>
<div row="1636"><pre row="1636">1636      <font color="black">593</font>                                                                                                                <font color="black">672</font>                                                                                                          </pre></div>
<div row="1637"><pre row="1637">1637 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1638"><pre row="1638">1638      <font color="black">595</font>     this.reload();                                                                                             <font color="black">674</font>     this.reload();                                                                                       </pre></div>
<div row="1639"><pre row="1639">1639      <font color="black">596</font>   });                                                                                                          <font color="black">675</font>   });                                                                                                    </pre></div>
<div row="1640"><pre row="1640">1640      <font color="black">597</font>                                                                                                                <font color="black">676</font>                                                                                                          </pre></div>
<div row="1641"><pre row="1641">1641      <font color="black">598</font>   bind(window, 'click', (evt) =&gt; {                                                                             <font color="black">677</font>   bind(window, 'click', (evt) =&gt; {                                                                       </pre></div>
<div row="1642"><pre row="1642">1642      <font color="black">599</font>     this.focusing = overlayerEl.contains(evt.target);                                                          <font color="black">678</font>     this.focusing = overlayerEl.contains(evt.target);                                                    </pre></div>
<div row="1643"><pre row="1643">1643                                                                                                                         <font color="black">679</font> <font color="green">  });</font>                                                                                                    </pre></div>
<div row="1644"><pre row="1644">1644                                                                                                                         <font color="black">680</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1645"><pre row="1645">1645                                                                                                                         <font color="black">681</font> <font color="green">  bind(window, 'paste', (evt) =&gt; {</font>                                                                       </pre></div>
<div row="1646"><pre row="1646">1646                                                                                                                         <font color="black">682</font> <font color="green">    paste.call(this, 'all', evt);</font>                                                                        </pre></div>
<div row="1647"><pre row="1647">1647                                                                                                                         <font color="black">683</font> <font color="green">    evt.preventDefault();</font>                                                                                </pre></div>
<div row="1648"><pre row="1648">1648      <font color="black">600</font>   });                                                                                                          <font color="black">684</font>   });                                                                                                    </pre></div>
<div row="1649"><pre row="1649">1649      <font color="black">601</font>                                                                                                                <font color="black">685</font>                                                                                                          </pre></div>
<div row="1650"><pre row="1650">1650      <font color="black">602</font>   // for selector                                                                                              <font color="black">686</font>   // for selector                                                                                        </pre></div>
<div row="1651"><pre row="1651">1651      <font color="black">603</font>   bind(window, 'keydown', (evt) =&gt; {                                                                           <font color="black">687</font>   bind(window, 'keydown', (evt) =&gt; {                                                                     </pre></div>
<div row="1652"><pre row="1652">1652      <font color="black">604</font>     if (!this.focusing) return;                                                                                <font color="black">688</font>     if (!this.focusing) return;                                                                          </pre></div>
<div row="1653"><pre row="1653">1653 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1654"><pre row="1654">1654      <font color="black">607</font>       key, ctrlKey, shiftKey, altKey, metaKey,                                                                 <font color="black">691</font>       key, ctrlKey, shiftKey, altKey, metaKey,                                                           </pre></div>
<div row="1655"><pre row="1655">1655      <font color="black">608</font>     } = evt;                                                                                                   <font color="black">692</font>     } = evt;                                                                                             </pre></div>
<div row="1656"><pre row="1656">1656      <font color="black">609</font>     // console.log('keydown.evt: ', keyCode);                                                                  <font color="black">693</font>     // console.log('keydown.evt: ', keyCode);                                                            </pre></div>
<div row="1657"><pre row="1657">1657      <font color="black">610</font>     if (ctrlKey || metaKey) {                                                                                  <font color="black">694</font>     if (ctrlKey || metaKey) {                                                                            </pre></div>
<div row="1658"><pre row="1658">1658      <font color="black">611</font>       // const { sIndexes, eIndexes } = selector;                                                              <font color="black">695</font>       // const { sIndexes, eIndexes } = selector;                                                        </pre></div>
<div row="1659"><pre row="1659">1659      <font color="black">612</font>       let what = 'all';                                                                                        <font color="black">696</font>      <font color="green"> //</font> let what = 'all';                                                                               </pre></div>
<div row="1660"><pre row="1660">1660      <font color="black">613</font>       if (shiftKey) what = 'text';                                                                             <font color="black">697</font>      <font color="green"> //</font> if (shiftKey) what = 'text';                                                                    </pre></div>
<div row="1661"><pre row="1661">1661      <font color="black">614</font>       if (altKey) what = 'format';                                                                             <font color="black">698</font>      <font color="green"> //</font> if (altKey) what = 'format';                                                                    </pre></div>
<div row="1662"><pre row="1662">1662      <font color="black">615</font>       switch (keyCode) {                                                                                       <font color="black">699</font>       switch (keyCode) {                                                                                 </pre></div>
<div row="1663"><pre row="1663">1663      <font color="black">616</font>         case 90:                                                                                               <font color="black">700</font>         case 90:                                                                                         </pre></div>
<div row="1664"><pre row="1664">1664      <font color="black">617</font>           // undo: ctrl + z                                                                                    <font color="black">701</font>           // undo: ctrl + z                                                                              </pre></div>
<div row="1665"><pre row="1665">1665      <font color="black">618</font>           this.undo();                                                                                         <font color="black">702</font>           this.undo();                                                                                   </pre></div>
<div row="1666"><pre row="1666">1666      <font color="black">619</font>           evt.preventDefault();                                                                                <font color="black">703</font>           evt.preventDefault();                                                                          </pre></div>
<div row="1667"><pre row="1667">1667 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1668"><pre row="1668">1668      <font color="black">638</font>           toolbar.trigger('underline');                                                                        <font color="black">722</font>           toolbar.trigger('underline');                                                                  </pre></div>
<div row="1669"><pre row="1669">1669      <font color="black">639</font>           evt.preventDefault();                                                                                <font color="black">723</font>           evt.preventDefault();                                                                          </pre></div>
<div row="1670"><pre row="1670">1670      <font color="black">640</font>           break;                                                                                               <font color="black">724</font>           break;                                                                                         </pre></div>
<div row="1671"><pre row="1671">1671      <font color="black">641</font>         case 86:                                                                                               <font color="black">725</font>         case 86:                                                                                         </pre></div>
<div row="1672"><pre row="1672">1672      <font color="black">642</font>           // ctrl + v                                                                                          <font color="black">726</font>           // ctrl + v                                                                                    </pre></div>
<div row="1673"><pre row="1673">1673      <font color="black">643</font> <font color="red">          paste.call(this, what);</font>                                                                              <font color="black">727</font> <font color="green">          // =&gt; paste</font>                                                                                    </pre></div>
<div row="1674"><pre row="1674">1674      <font color="black">644</font>           evt.preventDefault();                                                                                <font color="black">728</font>          <font color="green"> //</font> evt.preventDefault();                                                                       </pre></div>
<div row="1675"><pre row="1675">1675      <font color="black">645</font>           break;                                                                                               <font color="black">729</font>           break;                                                                                         </pre></div>
<div row="1676"><pre row="1676">1676      <font color="black">646</font>         case 37:                                                                                               <font color="black">730</font>         case 37:                                                                                         </pre></div>
<div row="1677"><pre row="1677">1677      <font color="black">647</font>           // ctrl + left                                                                                       <font color="black">731</font>           // ctrl + left                                                                                 </pre></div>
<div row="1678"><pre row="1678">1678      <font color="black">648</font>           selectorMove.call(this, shiftKey, 'row-first');                                                      <font color="black">732</font>           selectorMove.call(this, shiftKey, 'row-first');                                                </pre></div>
<div row="1679"><pre row="1679">1679      <font color="black">649</font>           evt.preventDefault();                                                                                <font color="black">733</font>           evt.preventDefault();                                                                          </pre></div>
<div row="1680"><pre row="1680">1680 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1681"><pre row="1681">1681      <font color="black">668</font>           selectorSet.call(this, false, -1, data.selector.ci, false);                                          <font color="black">752</font>           selectorSet.call(this, false, -1, data.selector.ci, false);                                    </pre></div>
<div row="1682"><pre row="1682">1682      <font color="black">669</font>           evt.preventDefault();                                                                                <font color="black">753</font>           evt.preventDefault();                                                                          </pre></div>
<div row="1683"><pre row="1683">1683      <font color="black">670</font>           break;                                                                                               <font color="black">754</font>           break;                                                                                         </pre></div>
<div row="1684"><pre row="1684">1684      <font color="black">671</font>         case 66:                                                                                               <font color="black">755</font>         case 66:                                                                                         </pre></div>
<div row="1685"><pre row="1685">1685      <font color="black">672</font>           // ctrl + B                                                                                          <font color="black">756</font>           // ctrl + B                                                                                    </pre></div>
<div row="1686"><pre row="1686">1686      <font color="black">673</font>           toolbar.trigger('<font color="red">font-</font>bold');                                                                        <font color="black">757</font>           toolbar.trigger('bold');                                                                       </pre></div>
<div row="1687"><pre row="1687">1687      <font color="black">674</font>           break;                                                                                               <font color="black">758</font>           break;                                                                                         </pre></div>
<div row="1688"><pre row="1688">1688      <font color="black">675</font>         case 73:                                                                                               <font color="black">759</font>         case 73:                                                                                         </pre></div>
<div row="1689"><pre row="1689">1689      <font color="black">676</font>           // ctrl + I                                                                                          <font color="black">760</font>           // ctrl + I                                                                                    </pre></div>
<div row="1690"><pre row="1690">1690      <font color="black">677</font>           toolbar.trigger('<font color="red">font-</font>italic');                                                                      <font color="black">761</font>           toolbar.trigger('italic');                                                                     </pre></div>
<div row="1691"><pre row="1691">1691      <font color="black">678</font>           break;                                                                                               <font color="black">762</font>           break;                                                                                         </pre></div>
<div row="1692"><pre row="1692">1692      <font color="black">679</font>         default:                                                                                               <font color="black">763</font>         default:                                                                                         </pre></div>
<div row="1693"><pre row="1693">1693      <font color="black">680</font>           break;                                                                                               <font color="black">764</font>           break;                                                                                         </pre></div>
<div row="1694"><pre row="1694">1694      <font color="black">681</font>       }                                                                                                        <font color="black">765</font>       }                                                                                                  </pre></div>
<div row="1695"><pre row="1695">1695      <font color="black">682</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre></div>
<div row="1696"><pre row="1696">1696      <font color="black">683</font> <font color="red">    } else if (altKey) {</font>                                                                                                                                                                                                    </pre></div>
<div row="1697"><pre row="1697">1697      <font color="black">684</font> <font color="red">      switch (keyCode) {</font>                                                                                                                                                                                                    </pre></div>
<div row="1698"><pre row="1698">1698      <font color="black">685</font> <font color="red">        case 13:</font>                                                                                                                                                                                                            </pre></div>
<div row="1699"><pre row="1699">1699      <font color="black">686</font> <font color="red">        dataSetCellText.call(this, evt.key, 'input');</font>                                                                                                                                                                       </pre></div>
<div row="1700"><pre row="1700">1700      <font color="black">687</font> <font color="red">        editorSet.call(this);</font>                                                                                                                                                                                               </pre></div>
<div row="1701"><pre row="1701">1701      <font color="black">688</font> <font color="red">            break;</font>                                                                                                                                                                                                          </pre></div>
<div row="1702"><pre row="1702">1702      <font color="black">689</font> <font color="red">      }</font>                                                                                                                                                                                                                     </pre></div>
<div row="1703"><pre row="1703">1703      <font color="black">690</font> <font color="red">*/</font>                                                                                                                                                                                                                          </pre></div>
<div row="1704"><pre row="1704">1704      <font color="black">691</font>     } else {                                                                                                   <font color="black">766</font>     } else {                                                                                             </pre></div>
<div row="1705"><pre row="1705">1705      <font color="black">692</font>       // console.log('evt.keyCode:', evt.keyCode);                                                             <font color="black">767</font>       // console.log('evt.keyCode:', evt.keyCode);                                                       </pre></div>
<div row="1706"><pre row="1706">1706      <font color="black">693</font>       switch (keyCode) {                                                                                       <font color="black">768</font>       switch (keyCode) {                                                                                 </pre></div>
<div row="1707"><pre row="1707">1707      <font color="black">694</font>         case 32:                                                                                               <font color="black">769</font>         case 32:                                                                                         </pre></div>
<div row="1708"><pre row="1708">1708      <font color="black">695</font>           if (shiftKey) {                                                                                      <font color="black">770</font>           if (shiftKey) {                                                                                </pre></div>
<div row="1709"><pre row="1709">1709 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1710"><pre row="1710">1710      <font color="black">721</font>           editor.clear();                                                                                      <font color="black">796</font>           editor.clear();                                                                                </pre></div>
<div row="1711"><pre row="1711">1711      <font color="black">722</font>           // shift + tab =&gt; move left                                                                          <font color="black">797</font>           // shift + tab =&gt; move left                                                                    </pre></div>
<div row="1712"><pre row="1712">1712      <font color="black">723</font>           // tab =&gt; move right                                                                                 <font color="black">798</font>           // tab =&gt; move right                                                                           </pre></div>
<div row="1713"><pre row="1713">1713      <font color="black">724</font>           selectorMove.call(this, false, shiftKey ? 'left' : 'right');                                         <font color="black">799</font>           selectorMove.call(this, false, shiftKey ? 'left' : 'right');                                   </pre></div>
<div row="1714"><pre row="1714">1714      <font color="black">725</font>           evt.preventDefault();                                                                                <font color="black">800</font>           evt.preventDefault();                                                                          </pre></div>
<div row="1715"><pre row="1715">1715      <font color="black">726</font>         break;                                                                                                 <font color="black">801</font> <font color="green">  </font>        break;                                                                                         </pre></div>
<div row="1716"><pre row="1716">1716      <font color="black">727</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1717"><pre row="1717">1717      <font color="black">728</font>         case 13: // enter                                                                                      <font color="black">802</font>         case 13: // enter                                                                                </pre></div>
<div row="1718"><pre row="1718">1718      <font color="black">729</font>           if (<font color="red">!</font>altKey) {                                                                                       <font color="black">803</font>           if (altKey) {                                                                                  </pre></div>
<div row="1719"><pre row="1719">1719                                                                                                                         <font color="black">804</font> <font color="green">            const c = data.getSelectedCell();</font>                                                            </pre></div>
<div row="1720"><pre row="1720">1720                                                                                                                         <font color="black">805</font> <font color="green">            const ntxt = c.text || '';</font>                                                                   </pre></div>
<div row="1721"><pre row="1721">1721                                                                                                                         <font color="black">806</font> <font color="green">            dataSetCellText.call(this, `${ntxt}\n`, 'input');</font>                                            </pre></div>
<div row="1722"><pre row="1722">1722                                                                                                                         <font color="black">807</font> <font color="green">            editorSet.call(this);</font>                                                                        </pre></div>
<div row="1723"><pre row="1723">1723                                                                                                                         <font color="black">808</font> <font color="green">            break;</font>                                                                                       </pre></div>
<div row="1724"><pre row="1724">1724                                                                                                                         <font color="black">809</font> <font color="green">          }</font>                                                                                              </pre></div>
<div row="1725"><pre row="1725">1725      <font color="black">730</font>           editor.clear();                                                                                      <font color="black">810</font>           editor.clear();                                                                                </pre></div>
<div row="1726"><pre row="1726">1726      <font color="black">731</font>           // shift + enter =&gt; move up                                                                          <font color="black">811</font>           // shift + enter =&gt; move up                                                                    </pre></div>
<div row="1727"><pre row="1727">1727      <font color="black">732</font>           // enter =&gt; move down                                                                                <font color="black">812</font>           // enter =&gt; move down                                                                          </pre></div>
<div row="1728"><pre row="1728">1728      <font color="black">733</font>           selectorMove.call(this, false, shiftKey ? 'up' : 'down');                                            <font color="black">813</font>           selectorMove.call(this, false, shiftKey ? 'up' : 'down');                                      </pre></div>
<div row="1729"><pre row="1729">1729      <font color="black">734</font>           evt.preventDefault();                                                                                <font color="black">814</font>           evt.preventDefault();                                                                          </pre></div>
<div row="1730"><pre row="1730">1730      <font color="black">735</font> <font color="red">          }</font>                                                                                                                                                                                                                 </pre></div>
<div row="1731"><pre row="1731">1731      <font color="black">736</font>           break;                                                                                               <font color="black">815</font>           break;                                                                                         </pre></div>
<div row="1732"><pre row="1732">1732      <font color="black">737</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1733"><pre row="1733">1733      <font color="black">738</font>         case 8: // backspace                                                                                   <font color="black">816</font>         case 8: // backspace                                                                             </pre></div>
<div row="1734"><pre row="1734">1734      <font color="black">739</font>           insertDeleteRowColumn.call(this, 'delete-cell-text');                                                <font color="black">817</font>           insertDeleteRowColumn.call(this, 'delete-cell-text');                                          </pre></div>
<div row="1735"><pre row="1735">1735      <font color="black">740</font>           evt.preventDefault();                                                                                <font color="black">818</font>           evt.preventDefault();                                                                          </pre></div>
<div row="1736"><pre row="1736">1736      <font color="black">741</font>           break;                                                                                               <font color="black">819</font>           break;                                                                                         </pre></div>
<div row="1737"><pre row="1737">1737      <font color="black">742</font>         default:                                                                                               <font color="black">820</font>         default:                                                                                         </pre></div>
<div row="1738"><pre row="1738">1738 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1739"><pre row="1739">1739      <font color="black">761</font>   });                                                                                                          <font color="black">839</font>   });                                                                                                    </pre></div>
<div row="1740"><pre row="1740">1740      <font color="black">762</font> }                                                                                                              <font color="black">840</font> }                                                                                                        </pre></div>
<div row="1741"><pre row="1741">1741      <font color="black">763</font>                                                                                                                <font color="black">841</font>                                                                                                          </pre></div>
<div row="1742"><pre row="1742">1742      <font color="black">764</font> export default class Sheet {                                                                                   <font color="black">842</font> export default class Sheet {                                                                             </pre></div>
<div row="1743"><pre row="1743">1743      <font color="black">765</font>   constructor(targetEl, data) {                                                                                <font color="black">843</font>   constructor(targetEl, data) {                                                                          </pre></div>
<div row="1744"><pre row="1744">1744                                                                                                                         <font color="black">844</font> <font color="green">    this.eventMap = new Map();</font>                                                                           </pre></div>
<div row="1745"><pre row="1745">1745      <font color="black">766</font>     const { view, showToolbar, showContextmenu } = data.settings;                                              <font color="black">845</font>     const { view, showToolbar, showContextmenu } = data.settings;                                        </pre></div>
<div row="1746"><pre row="1746">1746      <font color="black">767</font>     this.el = h('div', `${cssPrefix}-sheet`);                                                                  <font color="black">846</font>     this.el = h('div', `${cssPrefix}-sheet`);                                                            </pre></div>
<div row="1747"><pre row="1747">1747      <font color="black">768</font>     this.toolbar = new Toolbar(data, view.width, !showToolbar);                                                <font color="black">847</font>     this.toolbar = new Toolbar(data, view.width, !showToolbar);                                          </pre></div>
<div row="1748"><pre row="1748">1748                                                                                                                         <font color="black">848</font> <font color="green">    this.print = new Print(data);</font>                                                                        </pre></div>
<div row="1749"><pre row="1749">1749      <font color="black">769</font>     targetEl.children(this.toolbar.el, this.el);                                                               <font color="black">849</font>     targetEl.children(this.toolbar.el, this.el<font color="green">, this.print.el</font>);                                          </pre></div>
<div row="1750"><pre row="1750">1750      <font color="black">770</font>     this.data = data;                                                                                          <font color="black">850</font>     this.data = data;                                                                                    </pre></div>
<div row="1751"><pre row="1751">1751      <font color="black">771</font>     // table                                                                                                   <font color="black">851</font>     // table                                                                                             </pre></div>
<div row="1752"><pre row="1752">1752      <font color="black">772</font>     <font color="red">//</font>this.tableEl = h('canvas', `${cssPrefix}-table`);                                                        <font color="black">852</font>     this.tableEl = h('canvas', `${cssPrefix}-table`);                                                    </pre></div>
<div row="1753"><pre row="1753">1753      <font color="black">773</font> <font color="red">    this.tableEl = h('div', `${cssPrefix}-table`);</font>                                                                                                                                                                          </pre></div>
<div row="1754"><pre row="1754">1754      <font color="black">774</font>     // resizer                                                                                                 <font color="black">853</font>     // resizer                                                                                           </pre></div>
<div row="1755"><pre row="1755">1755      <font color="black">775</font>     this.rowResizer = new Resizer(false, data.rows.height);                                                    <font color="black">854</font>     this.rowResizer = new Resizer(false, data.rows.height);                                              </pre></div>
<div row="1756"><pre row="1756">1756      <font color="black">776</font>     this.colResizer = new Resizer(true, data.cols.minWidth);                                                   <font color="black">855</font>     this.colResizer = new Resizer(true, data.cols.minWidth);                                             </pre></div>
<div row="1757"><pre row="1757">1757      <font color="black">777</font>     // scrollbar                                                                                               <font color="black">856</font>     // scrollbar                                                                                         </pre></div>
<div row="1758"><pre row="1758">1758      <font color="black">778</font>     this.verticalScrollbar = new Scrollbar(true);                                                              <font color="black">857</font>     this.verticalScrollbar = new Scrollbar(true);                                                        </pre></div>
<div row="1759"><pre row="1759">1759 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1760"><pre row="1760">1760      <font color="black">784</font>       data.rows.height,                                                                                        <font color="black">863</font>       data.rows.height,                                                                                  </pre></div>
<div row="1761"><pre row="1761">1761      <font color="black">785</font>     );                                                                                                         <font color="black">864</font>     );                                                                                                   </pre></div>
<div row="1762"><pre row="1762">1762      <font color="black">786</font>     // data validation                                                                                         <font color="black">865</font>     // data validation                                                                                   </pre></div>
<div row="1763"><pre row="1763">1763      <font color="black">787</font>     this.modalValidation = new ModalValidation();                                                              <font color="black">866</font>     this.modalValidation = new ModalValidation();                                                        </pre></div>
<div row="1764"><pre row="1764">1764      <font color="black">788</font>     // contextMenu                                                                                             <font color="black">867</font>     // contextMenu                                                                                       </pre></div>
<div row="1765"><pre row="1765">1765      <font color="black">789</font>     this.contextMenu = new ContextMenu(() =&gt; this.get<font color="orange">Tabl</font>e<font color="orange">Offse</font>t(), !showContextmenu);                         <font color="black">868</font>     this.contextMenu = new ContextMenu(() =&gt; this.get<font color="orange">R</font>e<font color="orange">c</font>t(), !showContextmenu);                          </pre></div>
<div row="1766"><pre row="1766">1766      <font color="black">790</font>     // selector                                                                                                <font color="black">869</font>     // selector                                                                                          </pre></div>
<div row="1767"><pre row="1767">1767      <font color="black">791</font>     this.selector = new Selector(data);                                                                        <font color="black">870</font>     this.selector = new Selector(data);                                                                  </pre></div>
<div row="1768"><pre row="1768">1768      <font color="black">792</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre></div>
<div row="1769"><pre row="1769">1769      <font color="black">793</font>     this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)                                             <font color="black">871</font>     this.overlayerCEl = h('div', `${cssPrefix}-overlayer-content`)                                       </pre></div>
<div row="1770"><pre row="1770">1770      <font color="black">794</font>       .children(                                                                                               <font color="black">872</font>       .children(                                                                                         </pre></div>
<div row="1771"><pre row="1771">1771      <font color="black">795</font>         this.editor.el,                                                                                        <font color="black">873</font>         this.editor.el,                                                                                  </pre></div>
<div row="1772"><pre row="1772">1772      <font color="black">796</font>         this.selector.el,                                                                                      <font color="black">874</font>         this.selector.el,                                                                                </pre></div>
<div row="1773"><pre row="1773">1773      <font color="black">797</font>       );                                                                                                       <font color="black">875</font>       );                                                                                                 </pre></div>
<div row="1774"><pre row="1774">1774      <font color="black">798</font>     this.overlayerEl = h('div', `${cssPrefix}-overlayer`)                                                      <font color="black">876</font>     this.overlayerEl = h('div', `${cssPrefix}-overlayer`)                                                </pre></div>
<div row="1775"><pre row="1775">1775      <font color="black">799</font>       .child(this.overlayerCEl);                                                                               <font color="black">877</font>       .child(this.overlayerCEl);                                                                         </pre></div>
<div row="1776"><pre row="1776">1776      <font color="black">800</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre></div>
<div row="1777"><pre row="1777">1777      <font color="black">801</font>     // sortFilter                                                                                              <font color="black">878</font>     // sortFilter                                                                                        </pre></div>
<div row="1778"><pre row="1778">1778      <font color="black">802</font>     this.sortFilter = new SortFilter();                                                                        <font color="black">879</font>     this.sortFilter = new SortFilter();                                                                  </pre></div>
<div row="1779"><pre row="1779">1779      <font color="black">803</font>     // root element                                                                                            <font color="black">880</font>     // root element                                                                                      </pre></div>
<div row="1780"><pre row="1780">1780      <font color="black">804</font>     this.el.children(                                                                                          <font color="black">881</font>     this.el.children(                                                                                    </pre></div>
<div row="1781"><pre row="1781">1781      <font color="black">805</font>       this.tableEl,                                                                                            <font color="black">882</font>       this.tableEl,                                                                                      </pre></div>
<div row="1782"><pre row="1782">1782 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1783"><pre row="1783">1783      <font color="black">813</font>       this.sortFilter.el,                                                                                      <font color="black">890</font>       this.sortFilter.el,                                                                                </pre></div>
<div row="1784"><pre row="1784">1784      <font color="black">814</font>     );                                                                                                         <font color="black">891</font>     );                                                                                                   </pre></div>
<div row="1785"><pre row="1785">1785      <font color="black">815</font>     // table                                                                                                   <font color="black">892</font>     // table                                                                                             </pre></div>
<div row="1786"><pre row="1786">1786      <font color="black">816</font>     this.table = new Table(this.tableEl.el, data);                                                             <font color="black">893</font>     this.table = new Table(this.tableEl.el, data);                                                       </pre></div>
<div row="1787"><pre row="1787">1787      <font color="black">817</font>     sheetInitEvents.call(this);                                                                                <font color="black">894</font>     sheetInitEvents.call(this);                                                                          </pre></div>
<div row="1788"><pre row="1788">1788      <font color="black">818</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1789"><pre row="1789">1789      <font color="black">819</font> <font color="red">    //this.overlayerEl.hide();//GUSA </font>                                                                                                                                                                                       </pre></div>
<div row="1790"><pre row="1790">1790      <font color="black">820</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1791"><pre row="1791">1791      <font color="black">821</font>     sheetReset.call(this);                                                                                     <font color="black">895</font>     sheetReset.call(this);                                                                               </pre></div>
<div row="1792"><pre row="1792">1792      <font color="black">822</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1793"><pre row="1793">1793      <font color="black">823</font> <font color="red">    //this.table.layerRender(); //GUSA TEST</font>                                                                                                                                                                                 </pre></div>
<div row="1794"><pre row="1794">1794      <font color="black">824</font> <font color="red">    //</font>                                                                                                                                                                                                                      </pre></div>
<div row="1795"><pre row="1795">1795      <font color="black">825</font>     // init selector [0, 0]                                                                                    <font color="black">896</font>     // init selector [0, 0]                                                                              </pre></div>
<div row="1796"><pre row="1796">1796      <font color="black">826</font>     selectorSet.call(this, false, 0, 0);                                                                       <font color="black">897</font>     selectorSet.call(this, false, 0, 0);                                                                 </pre></div>
<div row="1797"><pre row="1797">1797      <font color="black">827</font> <font color="red">    //this.sync_sheets = new Array(); //GUSA</font>                                                                   <font color="black">898</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="1798"><pre row="1798">1798      <font color="black">828</font> <font color="red">    this.sync_sheets = []; //GUSA</font>                                                                              <font color="black">899</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1799"><pre row="1799">1799                                                                                                                         <font color="black">900</font> <font color="green">  on(eventName, func) {</font>                                                                                  </pre></div>
<div row="1800"><pre row="1800">1800                                                                                                                         <font color="black">901</font> <font color="green">    this.eventMap.set(eventName, func);</font>                                                                  </pre></div>
<div row="1801"><pre row="1801">1801                                                                                                                         <font color="black">902</font> <font color="green">    return this;</font>                                                                                         </pre></div>
<div row="1802"><pre row="1802">1802                                                                                                                         <font color="black">903</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="1803"><pre row="1803">1803                                                                                                                         <font color="black">904</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1804"><pre row="1804">1804                                                                                                                         <font color="black">905</font> <font color="green">  trigger(eventName, ...args) {</font>                                                                          </pre></div>
<div row="1805"><pre row="1805">1805                                                                                                                         <font color="black">906</font> <font color="green">    const { eventMap } = this;</font>                                                                           </pre></div>
<div row="1806"><pre row="1806">1806                                                                                                                         <font color="black">907</font> <font color="green">    if (eventMap.has(eventName)) {</font>                                                                       </pre></div>
<div row="1807"><pre row="1807">1807                                                                                                                         <font color="black">908</font> <font color="green">      eventMap.get(eventName).call(this, ...args);</font>                                                       </pre></div>
<div row="1808"><pre row="1808">1808      <font color="black">829</font>   }                                                                                                            <font color="black">909</font> <font color="green">  </font>  }                                                                                                    </pre></div>
<div row="1809"><pre row="1809">1809      <font color="black">830</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1810"><pre row="1810">1810      <font color="black">831</font> <font color="red">  exportData() {</font>                                                                                                                                                                                                            </pre></div>
<div row="1811"><pre row="1811">1811      <font color="black">832</font> <font color="red">    return this.data.getData();</font>                                                                                                                                                                                             </pre></div>
<div row="1812"><pre row="1812">1812      <font color="black">833</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1813"><pre row="1813">1813      <font color="black">834</font>   }                                                                                                            <font color="black">910</font>   }                                                                                                      </pre></div>
<div row="1814"><pre row="1814">1814      <font color="black">835</font>                                                                                                                <font color="black">911</font>                                                                                                          </pre></div>
<div row="1815"><pre row="1815">1815      <font color="black">836</font> <font color="red">  setLayer() {</font>                                                                                                 <font color="black">912</font> <font color="green">  resetData(data) {</font>                                                                                      </pre></div>
<div row="1816"><pre row="1816">1816      <font color="black">837</font> <font color="red">    this.table.setlayer(); //GUSA TEST</font>                                                                         <font color="black">913</font> <font color="green">    this.data = data;</font>                                                                                    </pre></div>
<div row="1817"><pre row="1817">1817                                                                                                                         <font color="black">914</font> <font color="green">    this.toolbar.resetData(data);</font>                                                                        </pre></div>
<div row="1818"><pre row="1818">1818                                                                                                                         <font color="black">915</font> <font color="green">    this.print.resetData(data);</font>                                                                          </pre></div>
<div row="1819"><pre row="1819">1819                                                                                                                         <font color="black">916</font> <font color="green">    this.selector.resetData(data);</font>                                                                       </pre></div>
<div row="1820"><pre row="1820">1820                                                                                                                         <font color="black">917</font> <font color="green">    this.table.resetData(data);</font>                                                                          </pre></div>
<div row="1821"><pre row="1821">1821      <font color="black">838</font>   }                                                                                                            <font color="black">918</font>   }                                                                                                      </pre></div>
<div row="1822"><pre row="1822">1822      <font color="black">839</font>                                                                                                                <font color="black">919</font>                                                                                                          </pre></div>
<div row="1823"><pre row="1823">1823      <font color="black">840</font>   loadData(data) {                                                                                             <font color="black">920</font>   loadData(data) {                                                                                       </pre></div>
<div row="1824"><pre row="1824">1824      <font color="black">841</font>     this.data.setData(data);                                                                                   <font color="black">921</font>     this.data.setData(data);                                                                             </pre></div>
<div row="1825"><pre row="1825">1825      <font color="black">842</font> <font color="red">    this.setLayer();</font>                                                                                                                                                                                                        </pre></div>
<div row="1826"><pre row="1826">1826      <font color="black">843</font>     sheetReset.call(this);                                                                                     <font color="black">922</font>     sheetReset.call(this);                                                                               </pre></div>
<div row="1827"><pre row="1827">1827      <font color="black">844</font> <font color="red">    console.log("loadData end");</font>                                                                                                                                                                                            </pre></div>
<div row="1828"><pre row="1828">1828      <font color="black">845</font>     return this;                                                                                               <font color="black">923</font>     return this;                                                                                         </pre></div>
<div row="1829"><pre row="1829">1829      <font color="black">846</font>   }                                                                                                            <font color="black">924</font>   }                                                                                                      </pre></div>
<div row="1830"><pre row="1830">1830      <font color="black">847</font>                                                                                                                <font color="black">925</font>                                                                                                          </pre></div>
<div row="1831"><pre row="1831">1831      <font color="black">848</font> <font color="red">  /*</font>                                                                                                                                                                                                                        </pre></div>
<div row="1832"><pre row="1832">1832      <font color="black">849</font> <font color="red">  addSyncSheet(sheet) {  //GUSA</font>                                                                                                                                                                                             </pre></div>
<div row="1833"><pre row="1833">1833      <font color="black">850</font> <font color="red">    //this.sync_sheet.push(sheet);</font>                                                                                                                                                                                          </pre></div>
<div row="1834"><pre row="1834">1834      <font color="black">851</font> <font color="red">    this.sync_sheets[0]= sheet;</font>                                                                                                                                                                                             </pre></div>
<div row="1835"><pre row="1835">1835      <font color="black">852</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1836"><pre row="1836">1836      <font color="black">853</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="1837"><pre row="1837">1837      <font color="black">854</font> <font color="red">  */</font>                                                                                                                                                                                                                        </pre></div>
<div row="1838"><pre row="1838">1838      <font color="black">855</font>   // freeze rows or cols                                                                                       <font color="black">926</font>   // freeze rows or cols                                                                                 </pre></div>
<div row="1839"><pre row="1839">1839      <font color="black">856</font>   freeze(ri, ci) {                                                                                             <font color="black">927</font>   freeze(ri, ci) {                                                                                       </pre></div>
<div row="1840"><pre row="1840">1840      <font color="black">857</font>     const { data } = this;                                                                                     <font color="black">928</font>     const { data } = this;                                                                               </pre></div>
<div row="1841"><pre row="1841">1841      <font color="black">858</font>     data.setFreeze(ri, ci);                                                                                    <font color="black">929</font>     data.setFreeze(ri, ci);                                                                              </pre></div>
<div row="1842"><pre row="1842">1842      <font color="black">859</font>     sheetReset.call(this);                                                                                     <font color="black">930</font>     sheetReset.call(this);                                                                               </pre></div>
<div row="1843"><pre row="1843">1843 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1844"><pre row="1844">1844      <font color="black">873</font>   reload() {                                                                                                   <font color="black">944</font>   reload() {                                                                                             </pre></div>
<div row="1845"><pre row="1845">1845      <font color="black">874</font>     sheetReset.call(this);                                                                                     <font color="black">945</font>     sheetReset.call(this);                                                                               </pre></div>
<div row="1846"><pre row="1846">1846      <font color="black">875</font>     return this;                                                                                               <font color="black">946</font>     return this;                                                                                         </pre></div>
<div row="1847"><pre row="1847">1847      <font color="black">876</font>   }                                                                                                            <font color="black">947</font>   }                                                                                                      </pre></div>
<div row="1848"><pre row="1848">1848      <font color="black">877</font>                                                                                                                <font color="black">948</font>                                                                                                          </pre></div>
<div row="1849"><pre row="1849">1849      <font color="black">878</font> <font color="red">  sync() {  //GUSA</font>                                                                                                                                                                                                          </pre></div>
<div row="1850"><pre row="1850">1850      <font color="black">879</font> <font color="red">    dataSync.call(this);</font>                                                                                                                                                                                                    </pre></div>
<div row="1851"><pre row="1851">1851      <font color="black">880</font> <font color="red">    //sheetReset.call(this);</font>                                                                                                                                                                                                </pre></div>
<div row="1852"><pre row="1852">1852      <font color="black">881</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1853"><pre row="1853">1853      <font color="black">882</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="1854"><pre row="1854">1854      <font color="black">883</font> <font color="red">  sync_movex(x) {</font>                                                                                                                                                                                                           </pre></div>
<div row="1855"><pre row="1855">1855      <font color="black">884</font> <font color="red">    sync_horizontalScrollbarMove.call(this,x);</font>                                                                                                                                                                              </pre></div>
<div row="1856"><pre row="1856">1856      <font color="black">885</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="1857"><pre row="1857">1857      <font color="black">886</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1858"><pre row="1858">1858      <font color="black">887</font> <font color="red">  sync_movey(y) {</font>                                                                                                                                                                                                           </pre></div>
<div row="1859"><pre row="1859">1859      <font color="black">888</font> <font color="red">    sync_verticalScrollbarMove.call(this,y);</font>                                                                                                                                                                                </pre></div>
<div row="1860"><pre row="1860">1860      <font color="black">889</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="1861"><pre row="1861">1861      <font color="black">890</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre></div>
<div row="1862"><pre row="1862">1862      <font color="black">891</font> <font color="red">  sync_shape_layer() {</font>                                                                                                                                                                                                      </pre></div>
<div row="1863"><pre row="1863">1863      <font color="black">892</font> <font color="red">    sync_shape_layer_move(this);</font>                                                                                                                                                                                            </pre></div>
<div row="1864"><pre row="1864">1864      <font color="black">893</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="1865"><pre row="1865">1865      <font color="black">894</font> <font color="red">  */</font>                                                                                                                                                                                                                        </pre></div>
<div row="1866"><pre row="1866">1866      <font color="black">895</font>   getRect() {                                                                                                  <font color="black">949</font>   getRect() {                                                                                            </pre></div>
<div row="1867"><pre row="1867">1867      <font color="black">896</font>     const { data } = this;                                                                                     <font color="black">950</font>     const { data } = this;                                                                               </pre></div>
<div row="1868"><pre row="1868">1868      <font color="black">897</font>     return { width: data.viewWidth(), height: data.viewHeight() };                                             <font color="black">951</font>     return { width: data.viewWidth(), height: data.viewHeight() };                                       </pre></div>
<div row="1869"><pre row="1869">1869      <font color="black">898</font>   }                                                                                                            <font color="black">952</font>   }                                                                                                      </pre></div>
<div row="1870"><pre row="1870">1870      <font color="black">899</font>                                                                                                                <font color="black">953</font>                                                                                                          </pre></div>
<div row="1871"><pre row="1871">1871 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1872"><pre row="1872">1872      <font color="black">905</font>       height: height - rows.height,                                                                            <font color="black">959</font>       height: height - rows.height,                                                                      </pre></div>
<div row="1873"><pre row="1873">1873      <font color="black">906</font>       left: cols.indexWidth,                                                                                   <font color="black">960</font>       left: cols.indexWidth,                                                                             </pre></div>
<div row="1874"><pre row="1874">1874      <font color="black">907</font>       top: rows.height,                                                                                        <font color="black">961</font>       top: rows.height,                                                                                  </pre></div>
<div row="1875"><pre row="1875">1875      <font color="black">908</font>     };                                                                                                         <font color="black">962</font>     };                                                                                                   </pre></div>
<div row="1876"><pre row="1876">1876      <font color="black">909</font>   }                                                                                                            <font color="black">963</font>   }                                                                                                      </pre></div>
<div row="1877"><pre row="1877">1877      <font color="black">910</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="1878"><pre row="1878">1878      <font color="black">911</font> <font color="red">  enableOverlayer(flag) {  //GUSA</font>                                                                                                                                                                                           </pre></div>
<div row="1879"><pre row="1879">1879      <font color="black">912</font> <font color="red">    if (flag) {</font>                                                                                                                                                                                                             </pre></div>
<div row="1880"><pre row="1880">1880      <font color="black">913</font> <font color="red">      this.overlayerEl.show();//GUSA </font>                                                                                                                                                                                       </pre></div>
<div row="1881"><pre row="1881">1881      <font color="black">914</font> <font color="red">    } else {</font>                                                                                                                                                                                                                </pre></div>
<div row="1882"><pre row="1882">1882      <font color="black">915</font> <font color="red">      this.overlayerEl.hide();//GUSA </font>                                                                                                                                                                                       </pre></div>
<div row="1883"><pre row="1883">1883      <font color="black">916</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre></div>
<div row="1884"><pre row="1884">1884      <font color="black">917</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="1885"><pre row="1885">1885      <font color="black">918</font> }                                                                                                              <font color="black">964</font> }                                                                                                        </pre></div>
<div id="id-component-sort_filter_js"  class="pagelink" row="1886"><pre class="pagehead" row="1886">1886 id-component-sort_filter_js</pre></div>
<div><pre row="1887"><code =class"javascript">1887 ../src/component/sort_filter.js             ../../x-spreadsheet/src/component/sort_filter.js</code></pre></div>
<div id="id-component-suggest_js"  class="pagelink" row="1888"><pre class="pagehead" row="1888">1888 id-component-suggest_js</pre></div>
<div><pre row="1889"><code =class"javascript">1889 ../src/component/suggest.js             ../../x-spreadsheet/src/component/suggest.js</code></pre></div>
<div id="id-component-table_js"  class="pagelink" row="1890"><pre class="pagehead" row="1890">1890 id-component-table_js</pre></div>
<div row="1891"><pre row="1891">1891 <font color="blue">../src/component/table.js</font>                                                                                          <font color="blue">../../x-spreadsheet/src/component/table.js</font>                                                                        </pre></div>
<div row="1892"><pre row="1892">1892       <font color="black">24</font>     lineWidth: thinLineWidth(),                                                                                 <font color="black">24</font>     lineWidth: thinLineWidth(),                                                                          </pre></div>
<div row="1893"><pre row="1893">1893       <font color="black">25</font>     strokeStyle: '#e6e6e6',                                                                                     <font color="black">25</font>     strokeStyle: '#e6e6e6',                                                                              </pre></div>
<div row="1894"><pre row="1894">1894       <font color="black">26</font>   };                                                                                                            <font color="black">26</font>   };                                                                                                     </pre></div>
<div row="1895"><pre row="1895">1895       <font color="black">27</font> }                                                                                                               <font color="black">27</font> }                                                                                                        </pre></div>
<div row="1896"><pre row="1896">1896       <font color="black">28</font>                                                                                                                 <font color="black">28</font>                                                                                                          </pre></div>
<div row="1897"><pre row="1897">1897       <font color="black">29</font> function getDrawBox(rindex, cindex) {                                                                           <font color="black">29</font> function getDrawBox(<font color="green">data, </font>rindex, cindex<font color="green">, yoffset = 0</font>) {                                                 </pre></div>
<div row="1898"><pre row="1898">1898       <font color="black">30</font> <font color="red">  const { data } = this;</font>                                                                                                                                                                                                    </pre></div>
<div row="1899"><pre row="1899">1899       <font color="black">31</font>   const {                                                                                                       <font color="black">30</font>   const {                                                                                                </pre></div>
<div row="1900"><pre row="1900">1900       <font color="black">32</font>     left, top, width, height,                                                                                   <font color="black">31</font>     left, top, width, height,                                                                            </pre></div>
<div row="1901"><pre row="1901">1901       <font color="black">33</font>   } = data.cellRect(rindex, cindex);                                                                            <font color="black">32</font>   } = data.cellRect(rindex, cindex);                                                                     </pre></div>
<div row="1902"><pre row="1902">1902       <font color="black">34</font>   return new DrawBox(left, top, width, height, cellPaddingWidth);                                               <font color="black">33</font>   return new DrawBox(left, top<font color="green"> + yoffset</font>, width, height, cellPaddingWidth);                              </pre></div>
<div row="1903"><pre row="1903">1903       <font color="black">35</font> }                                                                                                               <font color="black">34</font> }                                                                                                        </pre></div>
<div row="1904"><pre row="1904">1904       <font color="black">36</font> /*                                                                                                              <font color="black">35</font> /*                                                                                                       </pre></div>
<div row="1905"><pre row="1905">1905       <font color="black">37</font> function renderCellBorders(bboxes, translateFunc) {                                                             <font color="black">36</font> function renderCellBorders(bboxes, translateFunc) {                                                      </pre></div>
<div row="1906"><pre row="1906">1906       <font color="black">38</font>   const { draw } = this;                                                                                        <font color="black">37</font>   const { draw } = this;                                                                                 </pre></div>
<div row="1907"><pre row="1907">1907       <font color="black">39</font>   if (bboxes) {                                                                                                 <font color="black">38</font>   if (bboxes) {                                                                                          </pre></div>
<div row="1908"><pre row="1908">1908 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1909"><pre row="1909">1909       <font color="black">48</font>     });                                                                                                         <font color="black">47</font>     });                                                                                                  </pre></div>
<div row="1910"><pre row="1910">1910       <font color="black">49</font>   }                                                                                                             <font color="black">48</font>   }                                                                                                      </pre></div>
<div row="1911"><pre row="1911">1911       <font color="black">50</font> }                                                                                                               <font color="black">49</font> }                                                                                                        </pre></div>
<div row="1912"><pre row="1912">1912       <font color="black">51</font> */                                                                                                              <font color="black">50</font> */                                                                                                       </pre></div>
<div row="1913"><pre row="1913">1913       <font color="black">52</font>                                                                                                                 <font color="black">51</font>                                                                                                          </pre></div>
<div row="1914"><pre row="1914">1914       <font color="black">53</font> <font color="red">function renderCell(rindex, cindex) {</font>                                                                           <font color="black">52</font> <font color="green">export function renderCell(draw, data, rindex, cindex, yoffset = 0) {</font>                                    </pre></div>
<div row="1915"><pre row="1915">1915       <font color="black">54</font> <font color="red">  const { draw, data } = this;</font>                                                                                                                                                                                              </pre></div>
<div row="1916"><pre row="1916">1916       <font color="black">55</font>   const { sortedRowMap } = data;                                                                                <font color="black">53</font>   const { sortedRowMap<font color="green">, rows, cols</font> } = data;                                                             </pre></div>
<div row="1917"><pre row="1917">1917                                                                                                                          <font color="black">54</font> <font color="green">  if (rows.isHide(rindex) || cols.isHide(cindex)) return;</font>                                                </pre></div>
<div row="1918"><pre row="1918">1918       <font color="black">56</font>   let nrindex = rindex;                                                                                         <font color="black">55</font>   let nrindex = rindex;                                                                                  </pre></div>
<div row="1919"><pre row="1919">1919       <font color="black">57</font>   if (sortedRowMap.has(rindex)) {                                                                               <font color="black">56</font>   if (sortedRowMap.has(rindex)) {                                                                        </pre></div>
<div row="1920"><pre row="1920">1920       <font color="black">58</font>     nrindex = sortedRowMap.get(rindex);                                                                         <font color="black">57</font>     nrindex = sortedRowMap.get(rindex);                                                                  </pre></div>
<div row="1921"><pre row="1921">1921       <font color="black">59</font>   }                                                                                                             <font color="black">58</font>   }                                                                                                      </pre></div>
<div row="1922"><pre row="1922">1922       <font color="black">60</font>                                                                                                                 <font color="black">59</font>                                                                                                          </pre></div>
<div row="1923"><pre row="1923">1923       <font color="black">61</font>   const cell = data.getCell(nrindex, cindex);                                                                   <font color="black">60</font>   const cell = data.getCell(nrindex, cindex);                                                            </pre></div>
<div row="1924"><pre row="1924">1924       <font color="black">62</font>   if (cell === null) return;                                                                                    <font color="black">61</font>   if (cell === null) return;                                                                             </pre></div>
<div row="1925"><pre row="1925">1925                                                                                                                          <font color="black">62</font> <font color="green">  let frozen = false;</font>                                                                                    </pre></div>
<div row="1926"><pre row="1926">1926                                                                                                                          <font color="black">63</font> <font color="green">  if ('editable' in cell && cell.editable === false) {</font>                                                   </pre></div>
<div row="1927"><pre row="1927">1927                                                                                                                          <font color="black">64</font> <font color="green">    frozen = true;</font>                                                                                       </pre></div>
<div row="1928"><pre row="1928">1928                                                                                                                          <font color="black">65</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="1929"><pre row="1929">1929       <font color="black">63</font>                                                                                                                 <font color="black">66</font>                                                                                                          </pre></div>
<div row="1930"><pre row="1930">1930       <font color="black">64</font>   const style = data.getCellStyleOrDefault(nrindex, cindex);                                                    <font color="black">67</font>   const style = data.getCellStyleOrDefault(nrindex, cindex);                                             </pre></div>
<div row="1931"><pre row="1931">1931       <font color="black">65</font> <font color="red">  // console.log('style:', style);</font>                                                                                                                                                                                          </pre></div>
<div row="1932"><pre row="1932">1932       <font color="black">66</font>   const dbox = getDrawBox<font color="orange">.c</font>a<font color="red">ll(</font>t<font color="orange">his</font>, rindex, cindex);                                                           <font color="black">68</font>   const dbox = getDrawBox<font color="orange">(d</font>at<font color="orange">a</font>, rindex, cindex<font color="green">, yoffset</font>);                                                </pre></div>
<div row="1933"><pre row="1933">1933       <font color="black">67</font>   dbox.bgcolor = style.bgcolor;                                                                                 <font color="black">69</font>   dbox.bgcolor = style.bgcolor;                                                                          </pre></div>
<div row="1934"><pre row="1934">1934       <font color="black">68</font>   if (style.border !== undefined) {                                                                             <font color="black">70</font>   if (style.border !== undefined) {                                                                      </pre></div>
<div row="1935"><pre row="1935">1935       <font color="black">69</font>     dbox.setBorders(style.border);                                                                              <font color="black">71</font>     dbox.setBorders(style.border);                                                                       </pre></div>
<div row="1936"><pre row="1936">1936       <font color="black">70</font>     // bboxes.push({ ri: rindex, ci: cindex, box: dbox });                                                      <font color="black">72</font>     // bboxes.push({ ri: rindex, ci: cindex, box: dbox });                                               </pre></div>
<div row="1937"><pre row="1937">1937       <font color="black">71</font>     draw.strokeBorders(dbox);                                                                                   <font color="black">73</font>     draw.strokeBorders(dbox);                                                                            </pre></div>
<div row="1938"><pre row="1938">1938 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1939"><pre row="1939">1939       <font color="black">92</font>     const error = data.validations.getError(rindex, cindex);                                                    <font color="black">94</font>     const error = data.validations.getError(rindex, cindex);                                             </pre></div>
<div row="1940"><pre row="1940">1940       <font color="black">93</font>     if (error) {                                                                                                <font color="black">95</font>     if (error) {                                                                                         </pre></div>
<div row="1941"><pre row="1941">1941       <font color="black">94</font>       // console.log('error:', rindex, cindex, error);                                                          <font color="black">96</font>       // console.log('error:', rindex, cindex, error);                                                   </pre></div>
<div row="1942"><pre row="1942">1942       <font color="black">95</font>       draw.error(dbox);                                                                                         <font color="black">97</font>       draw.error(dbox);                                                                                  </pre></div>
<div row="1943"><pre row="1943">1943       <font color="black">96</font>     }                                                                                                           <font color="black">98</font>     }                                                                                                    </pre></div>
<div row="1944"><pre row="1944">1944                                                                                                                          <font color="black">99</font> <font color="green">    if (frozen) {</font>                                                                                        </pre></div>
<div row="1945"><pre row="1945">1945                                                                                                                         <font color="black">100</font> <font color="green">      draw.frozen(dbox);</font>                                                                                 </pre></div>
<div row="1946"><pre row="1946">1946                                                                                                                         <font color="black">101</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="1947"><pre row="1947">1947       <font color="black">97</font>   });                                                                                                          <font color="black">102</font>   });                                                                                                    </pre></div>
<div row="1948"><pre row="1948">1948       <font color="black">98</font> }                                                                                                              <font color="black">103</font> }                                                                                                        </pre></div>
<div row="1949"><pre row="1949">1949       <font color="black">99</font>                                                                                                                <font color="black">104</font>                                                                                                          </pre></div>
<div row="1950"><pre row="1950">1950      <font color="black">100</font> function renderAutofilter(viewRange) {                                                                         <font color="black">105</font> function renderAutofilter(viewRange) {                                                                   </pre></div>
<div row="1951"><pre row="1951">1951      <font color="black">101</font>   const { data, draw } = this;                                                                                 <font color="black">106</font>   const { data, draw } = this;                                                                           </pre></div>
<div row="1952"><pre row="1952">1952 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1953"><pre row="1953">1953      <font color="black">103</font>     const { autoFilter } = data;                                                                               <font color="black">108</font>     const { autoFilter } = data;                                                                         </pre></div>
<div row="1954"><pre row="1954">1954      <font color="black">104</font>     if (!autoFilter.active()) return;                                                                          <font color="black">109</font>     if (!autoFilter.active()) return;                                                                    </pre></div>
<div row="1955"><pre row="1955">1955      <font color="black">105</font>     const afRange = autoFilter.hrange();                                                                       <font color="black">110</font>     const afRange = autoFilter.hrange();                                                                 </pre></div>
<div row="1956"><pre row="1956">1956      <font color="black">106</font>     if (viewRange.intersects(afRange)) {                                                                       <font color="black">111</font>     if (viewRange.intersects(afRange)) {                                                                 </pre></div>
<div row="1957"><pre row="1957">1957      <font color="black">107</font>       afRange.each((ri, ci) =&gt; {                                                                               <font color="black">112</font>       afRange.each((ri, ci) =&gt; {                                                                         </pre></div>
<div row="1958"><pre row="1958">1958      <font color="black">108</font>         const dbox = getDrawBox<font color="orange">.c</font>a<font color="red">ll(</font>t<font color="orange">his</font>, ri, ci);                                                            <font color="black">113</font>         const dbox = getDrawBox<font color="orange">(d</font>at<font color="orange">a</font>, ri, ci);                                                           </pre></div>
<div row="1959"><pre row="1959">1959      <font color="black">109</font>         draw.dropdown(dbox);                                                                                   <font color="black">114</font>         draw.dropdown(dbox);                                                                             </pre></div>
<div row="1960"><pre row="1960">1960      <font color="black">110</font>       });                                                                                                      <font color="black">115</font>       });                                                                                                </pre></div>
<div row="1961"><pre row="1961">1961      <font color="black">111</font>     }                                                                                                          <font color="black">116</font>     }                                                                                                    </pre></div>
<div row="1962"><pre row="1962">1962      <font color="black">112</font>   }                                                                                                            <font color="black">117</font>   }                                                                                                      </pre></div>
<div row="1963"><pre row="1963">1963      <font color="black">113</font> }                                                                                                              <font color="black">118</font> }                                                                                                        </pre></div>
<div row="1964"><pre row="1964">1964 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="1965"><pre row="1965">1965      <font color="black">117</font>   draw.save();                                                                                                 <font color="black">122</font>   draw.save();                                                                                           </pre></div>
<div row="1966"><pre row="1966">1966      <font color="black">118</font>   draw.translate(fw, fh)                                                                                       <font color="black">123</font>   draw.translate(fw, fh)                                                                                 </pre></div>
<div row="1967"><pre row="1967">1967      <font color="black">119</font>     .translate(tx, ty);                                                                                        <font color="black">124</font>     .translate(tx, ty);                                                                                  </pre></div>
<div row="1968"><pre row="1968">1968      <font color="black">120</font>                                                                                                                <font color="black">125</font>                                                                                                          </pre></div>
<div row="1969"><pre row="1969">1969      <font color="black">121</font>   const { exceptRowSet } = data;                                                                               <font color="black">126</font>   const { exceptRowSet } = data;                                                                         </pre></div>
<div row="1970"><pre row="1970">1970                                                                                                                         <font color="black">127</font> <font color="green">  // const exceptRows = Array.from(exceptRowSet);</font>                                                        </pre></div>
<div row="1971"><pre row="1971">1971      <font color="black">122</font>   const filteredTranslateFunc = (ri) =&gt; {                                                                      <font color="black">128</font>   const filteredTranslateFunc = (ri) =&gt; {                                                                </pre></div>
<div row="1972"><pre row="1972">1972      <font color="black">123</font>     const ret = exceptRowSet.has(ri);                                                                          <font color="black">129</font>     const ret = exceptRowSet.has(ri);                                                                    </pre></div>
<div row="1973"><pre row="1973">1973      <font color="black">124</font>     if (ret) {                                                                                                 <font color="black">130</font>     if (ret) {                                                                                           </pre></div>
<div row="1974"><pre row="1974">1974      <font color="black">125</font>       const height = data.rows.getHeight(ri);                                                                  <font color="black">131</font>       const height = data.rows.getHeight(ri);                                                            </pre></div>
<div row="1975"><pre row="1975">1975      <font color="black">126</font>       draw.translate(0, -height);                                                                              <font color="black">132</font>       draw.translate(0, -height);                                                                        </pre></div>
<div row="1976"><pre row="1976">1976      <font color="black">127</font>     }                                                                                                          <font color="black">133</font>     }                                                                                                    </pre></div>
<div row="1977"><pre row="1977">1977      <font color="black">128</font>     return !ret;                                                                                               <font color="black">134</font>     return !ret;                                                                                         </pre></div>
<div row="1978"><pre row="1978">1978      <font color="black">129</font>   };                                                                                                           <font color="black">135</font>   };                                                                                                     </pre></div>
<div row="1979"><pre row="1979">1979                                                                                                                         <font color="black">136</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="1980"><pre row="1980">1980                                                                                                                         <font color="black">137</font> <font color="green">  const exceptRowTotalHeight = data.exceptRowTotalHeight(viewRange.sri, viewRange.eri);</font>                  </pre></div>
<div row="1981"><pre row="1981">1981      <font color="black">130</font>   // 1 render cell                                                                                             <font color="black">138</font>   // 1 render cell                                                                                       </pre></div>
<div row="1982"><pre row="1982">1982      <font color="black">131</font> <font color="red">  // let bboxes = [];</font>                                                                                                                                                                                                       </pre></div>
<div row="1983"><pre row="1983">1983      <font color="black">132</font>   draw.save();                                                                                                 <font color="black">139</font>   draw.save();                                                                                           </pre></div>
<div row="1984"><pre row="1984">1984                                                                                                                         <font color="black">140</font> <font color="green">  draw.translate(0, -exceptRowTotalHeight);</font>                                                              </pre></div>
<div row="1985"><pre row="1985">1985      <font color="black">133</font>   viewRange.each((ri, ci) =&gt; {                                                                                 <font color="black">141</font>   viewRange.each((ri, ci) =&gt; {                                                                           </pre></div>
<div row="1986"><pre row="1986">1986      <font color="black">134</font>     renderCell<font color="orange">.c</font>a<font color="orange">ll(</font>t<font color="orange">his</font>, ri, ci);                                                                             <font color="black">142</font>     renderCell<font color="orange">(dr</font>a<font color="orange">w, da</font>t<font color="orange">a</font>, ri, ci);                                                                      </pre></div>
<div row="1987"><pre row="1987">1987      <font color="black">135</font>   }, ri =&gt; filteredTranslateFunc(ri));                                                                         <font color="black">143</font>   }, ri =&gt; filteredTranslateFunc(ri));                                                                   </pre></div>
<div row="1988"><pre row="1988">1988      <font color="black">136</font>   draw.restore();                                                                                              <font color="black">144</font>   draw.restore();                                                                                        </pre></div>
<div row="1989"><pre row="1989">1989      <font color="black">137</font>                                                                                                                <font color="black">145</font>                                                                                                          </pre></div>
<div row="1990"><pre row="1990">1990      <font color="black">138</font> <font color="red">  // 2 render cell border</font>                                                                                                                                                                                                   </pre></div>
<div row="1991"><pre row="1991">1991      <font color="black">139</font> <font color="red">  // draw.save();</font>                                                                                                                                                                                                           </pre></div>
<div row="1992"><pre row="1992">1992      <font color="black">140</font> <font color="red">  // renderCellBorders.call(this, bboxes, (ri) =&gt; filteredTranslateFunc(ri));</font>                                                                                                                                               </pre></div>
<div row="1993"><pre row="1993">1993      <font color="black">141</font> <font color="red">  // draw.restore();</font>                                                                                                                                                                                                        </pre></div>
<div row="1994"><pre row="1994">1994      <font color="black">142</font>                                                                                                                <font color="black">146</font>                                                                                                          </pre></div>
<div row="1995"><pre row="1995">1995      <font color="black">143</font> <font color="red">  // / bboxes = [];</font>                                                                                                                                                                                                         </pre></div>
<div row="1996"><pre row="1996">1996      <font color="black">144</font>   // <font color="orange">3</font> render mergeCell                                                                                        <font color="black">147</font>   // <font color="orange">2</font> render mergeCell                                                                                  </pre></div>
<div row="1997"><pre row="1997">1997      <font color="black">145</font>   const rset = new Set();                                                                                      <font color="black">148</font>   const rset = new Set();                                                                                </pre></div>
<div row="1998"><pre row="1998">1998      <font color="black">146</font>   draw.save();                                                                                                 <font color="black">149</font>   draw.save();                                                                                           </pre></div>
<div row="1999"><pre row="1999">1999                                                                                                                         <font color="black">150</font> <font color="green">  draw.translate(0, -exceptRowTotalHeight);</font>                                                              </pre></div>
<div row="2000"><pre row="2000">2000      <font color="black">147</font>   data.eachMergesInView(viewRange, ({ sri, sci, eri }) =&gt; {                                                    <font color="black">151</font>   data.eachMergesInView(viewRange, ({ sri, sci, eri }) =&gt; {                                              </pre></div>
<div row="2001"><pre row="2001">2001      <font color="black">148</font>     if (!exceptRowSet.has(sri)) {                                                                              <font color="black">152</font>     if (!exceptRowSet.has(sri)) {                                                                        </pre></div>
<div row="2002"><pre row="2002">2002      <font color="black">149</font>       renderCell<font color="orange">.c</font>a<font color="orange">ll(</font>t<font color="orange">his</font>, sri, sci);                                                                         <font color="black">153</font>       renderCell<font color="orange">(dr</font>a<font color="orange">w, da</font>t<font color="orange">a</font>, sri, sci);                                                                  </pre></div>
<div row="2003"><pre row="2003">2003      <font color="black">150</font>     } else if (!rset.has(sri)) {                                                                               <font color="black">154</font>     } else if (!rset.has(sri)) {                                                                         </pre></div>
<div row="2004"><pre row="2004">2004      <font color="black">151</font>       rset.add(sri);                                                                                           <font color="black">155</font>       rset.add(sri);                                                                                     </pre></div>
<div row="2005"><pre row="2005">2005      <font color="black">152</font>       const height = data.rows.sumHeight(sri, eri + 1);                                                        <font color="black">156</font>       const height = data.rows.sumHeight(sri, eri + 1);                                                  </pre></div>
<div row="2006"><pre row="2006">2006      <font color="black">153</font>       draw.translate(0, -height);                                                                              <font color="black">157</font>       draw.translate(0, -height);                                                                        </pre></div>
<div row="2007"><pre row="2007">2007      <font color="black">154</font>     }                                                                                                          <font color="black">158</font>     }                                                                                                    </pre></div>
<div row="2008"><pre row="2008">2008      <font color="black">155</font>   });                                                                                                          <font color="black">159</font>   });                                                                                                    </pre></div>
<div row="2009"><pre row="2009">2009      <font color="black">156</font>   draw.restore();                                                                                              <font color="black">160</font>   draw.restore();                                                                                        </pre></div>
<div row="2010"><pre row="2010">2010      <font color="black">157</font>                                                                                                                <font color="black">161</font>                                                                                                          </pre></div>
<div row="2011"><pre row="2011">2011      <font color="black">158</font> <font color="red">  // 4 render mergeCell border</font>                                                                                                                                                                                              </pre></div>
<div row="2012"><pre row="2012">2012      <font color="black">159</font> <font color="red">  // draw.save();</font>                                                                                                                                                                                                           </pre></div>
<div row="2013"><pre row="2013">2013      <font color="black">160</font> <font color="red">  // renderCellBorders.call(this, bboxes, (ri) =&gt; filteredTranslateFunc(ri));</font>                                                                                                                                               </pre></div>
<div row="2014"><pre row="2014">2014      <font color="black">161</font> <font color="red">  // draw.restore();</font>                                                                                                                                                                                                        </pre></div>
<div row="2015"><pre row="2015">2015      <font color="black">162</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2016"><pre row="2016">2016      <font color="black">163</font>   // <font color="orange">5</font> render autofilter                                                                                       <font color="black">162</font>   // <font color="orange">3</font> render autofilter                                                                                 </pre></div>
<div row="2017"><pre row="2017">2017      <font color="black">164</font>   renderAutofilter.call(this, viewRange);                                                                      <font color="black">163</font>   renderAutofilter.call(this, viewRange);                                                                </pre></div>
<div row="2018"><pre row="2018">2018      <font color="black">165</font>                                                                                                                <font color="black">164</font>                                                                                                          </pre></div>
<div row="2019"><pre row="2019">2019      <font color="black">166</font>   draw.restore();                                                                                              <font color="black">165</font>   draw.restore();                                                                                        </pre></div>
<div row="2020"><pre row="2020">2020      <font color="black">167</font> }                                                                                                              <font color="black">166</font> }                                                                                                        </pre></div>
<div row="2021"><pre row="2021">2021      <font color="black">168</font>                                                                                                                <font color="black">167</font>                                                                                                          </pre></div>
<div row="2022"><pre row="2022">2022 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2023"><pre row="2023">2023      <font color="black">208</font>       draw.line([0, y], [w, y]);                                                                               <font color="black">207</font>       draw.line([0, y], [w, y]);                                                                         </pre></div>
<div row="2024"><pre row="2024">2024      <font color="black">209</font>       if (sri &lt;= ii && ii &lt; eri + 1) {                                                                         <font color="black">208</font>       if (sri &lt;= ii && ii &lt; eri + 1) {                                                                   </pre></div>
<div row="2025"><pre row="2025">2025      <font color="black">210</font>         renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);                                               <font color="black">209</font>         renderSelectedHeaderCell.call(this, 0, y, w, rowHeight);                                         </pre></div>
<div row="2026"><pre row="2026">2026      <font color="black">211</font>       }                                                                                                        <font color="black">210</font>       }                                                                                                  </pre></div>
<div row="2027"><pre row="2027">2027      <font color="black">212</font>       draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));                                                       <font color="black">211</font>       draw.fillText(ii + 1, w / 2, y + (rowHeight / 2));                                                 </pre></div>
<div row="2028"><pre row="2028">2028                                                                                                                         <font color="black">212</font> <font color="green">      if (i &gt; 0 && data.rows.isHide(i - 1)) {</font>                                                            </pre></div>
<div row="2029"><pre row="2029">2029                                                                                                                         <font color="black">213</font> <font color="green">        draw.save();</font>                                                                                     </pre></div>
<div row="2030"><pre row="2030">2030                                                                                                                         <font color="black">214</font> <font color="green">        draw.attr({ strokeStyle: '#c6c6c6' });</font>                                                           </pre></div>
<div row="2031"><pre row="2031">2031                                                                                                                         <font color="black">215</font> <font color="green">        draw.line([5, y + 5], [w - 5, y + 5]);</font>                                                           </pre></div>
<div row="2032"><pre row="2032">2032                                                                                                                         <font color="black">216</font> <font color="green">        draw.restore();</font>                                                                                  </pre></div>
<div row="2033"><pre row="2033">2033                                                                                                                         <font color="black">217</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2034"><pre row="2034">2034      <font color="black">213</font>     });                                                                                                        <font color="black">218</font>     });                                                                                                  </pre></div>
<div row="2035"><pre row="2035">2035      <font color="black">214</font>     draw.line([0, sumHeight + nty], [w, sumHeight + nty]);                                                     <font color="black">219</font>     draw.line([0, sumHeight + nty], [w, sumHeight + nty]);                                               </pre></div>
<div row="2036"><pre row="2036">2036      <font color="black">215</font>     draw.line([w, nty], [w, sumHeight + nty]);                                                                 <font color="black">220</font>     draw.line([w, nty], [w, sumHeight + nty]);                                                           </pre></div>
<div row="2037"><pre row="2037">2037      <font color="black">216</font>   }                                                                                                            <font color="black">221</font>   }                                                                                                      </pre></div>
<div row="2038"><pre row="2038">2038      <font color="black">217</font>   // x-header-text                                                                                             <font color="black">222</font>   // x-header-text                                                                                       </pre></div>
<div row="2039"><pre row="2039">2039 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2040"><pre row="2040">2040      <font color="black">222</font>       draw.line([x, 0], [x, h]);                                                                               <font color="black">227</font>       draw.line([x, 0], [x, h]);                                                                         </pre></div>
<div row="2041"><pre row="2041">2041      <font color="black">223</font>       if (sci &lt;= ii && ii &lt; eci + 1) {                                                                         <font color="black">228</font>       if (sci &lt;= ii && ii &lt; eci + 1) {                                                                   </pre></div>
<div row="2042"><pre row="2042">2042      <font color="black">224</font>         renderSelectedHeaderCell.call(this, x, 0, colWidth, h);                                                <font color="black">229</font>         renderSelectedHeaderCell.call(this, x, 0, colWidth, h);                                          </pre></div>
<div row="2043"><pre row="2043">2043      <font color="black">225</font>       }                                                                                                        <font color="black">230</font>       }                                                                                                  </pre></div>
<div row="2044"><pre row="2044">2044      <font color="black">226</font>       draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);                                                  <font color="black">231</font>       draw.fillText(stringAt(ii), x + (colWidth / 2), h / 2);                                            </pre></div>
<div row="2045"><pre row="2045">2045                                                                                                                         <font color="black">232</font> <font color="green">      if (i &gt; 0 && data.cols.isHide(i - 1)) {</font>                                                            </pre></div>
<div row="2046"><pre row="2046">2046                                                                                                                         <font color="black">233</font> <font color="green">        draw.save();</font>                                                                                     </pre></div>
<div row="2047"><pre row="2047">2047                                                                                                                         <font color="black">234</font> <font color="green">        draw.attr({ strokeStyle: '#c6c6c6' });</font>                                                           </pre></div>
<div row="2048"><pre row="2048">2048                                                                                                                         <font color="black">235</font> <font color="green">        draw.line([x + 5, 5], [x + 5, h - 5]);</font>                                                           </pre></div>
<div row="2049"><pre row="2049">2049                                                                                                                         <font color="black">236</font> <font color="green">        draw.restore();</font>                                                                                  </pre></div>
<div row="2050"><pre row="2050">2050                                                                                                                         <font color="black">237</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2051"><pre row="2051">2051      <font color="black">227</font>     });                                                                                                        <font color="black">238</font>     });                                                                                                  </pre></div>
<div row="2052"><pre row="2052">2052      <font color="black">228</font>     draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);                                                       <font color="black">239</font>     draw.line([sumWidth + ntx, 0], [sumWidth + ntx, h]);                                                 </pre></div>
<div row="2053"><pre row="2053">2053      <font color="black">229</font>     draw.line([0, h], [sumWidth + ntx, h]);                                                                    <font color="black">240</font>     draw.line([0, h], [sumWidth + ntx, h]);                                                              </pre></div>
<div row="2054"><pre row="2054">2054      <font color="black">230</font>   }                                                                                                            <font color="black">241</font>   }                                                                                                      </pre></div>
<div row="2055"><pre row="2055">2055      <font color="black">231</font>   draw.restore();                                                                                              <font color="black">242</font>   draw.restore();                                                                                        </pre></div>
<div row="2056"><pre row="2056">2056 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2057"><pre row="2057">2057      <font color="black">286</font> class Table {                                                                                                  <font color="black">297</font> class Table {                                                                                            </pre></div>
<div row="2058"><pre row="2058">2058      <font color="black">287</font>   constructor(el, data) {                                                                                      <font color="black">298</font>   constructor(el, data) {                                                                                </pre></div>
<div row="2059"><pre row="2059">2059      <font color="black">288</font>     this.el = el;                                                                                              <font color="black">299</font>     this.el = el;                                                                                        </pre></div>
<div row="2060"><pre row="2060">2060      <font color="black">289</font>     this.draw = new Draw(el, data.viewWidth(), data.viewHeight());                                             <font color="black">300</font>     this.draw = new Draw(el, data.viewWidth(), data.viewHeight());                                       </pre></div>
<div row="2061"><pre row="2061">2061      <font color="black">290</font>     this.data = data;                                                                                          <font color="black">301</font>     this.data = data;                                                                                    </pre></div>
<div row="2062"><pre row="2062">2062                                                                                                                         <font color="black">302</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="2063"><pre row="2063">2063                                                                                                                         <font color="black">303</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2064"><pre row="2064">2064                                                                                                                         <font color="black">304</font> <font color="green">  resetData(data) {</font>                                                                                      </pre></div>
<div row="2065"><pre row="2065">2065                                                                                                                         <font color="black">305</font> <font color="green">    this.data = data;</font>                                                                                    </pre></div>
<div row="2066"><pre row="2066">2066                                                                                                                         <font color="black">306</font> <font color="green">    this.render();</font>                                                                                       </pre></div>
<div row="2067"><pre row="2067">2067      <font color="black">291</font>   }                                                                                                            <font color="black">307</font>   }                                                                                                      </pre></div>
<div row="2068"><pre row="2068">2068      <font color="black">292</font>                                                                                                                <font color="black">308</font>                                                                                                          </pre></div>
<div row="2069"><pre row="2069">2069      <font color="black">293</font>   render() {                                                                                                   <font color="black">309</font>   render() {                                                                                             </pre></div>
<div row="2070"><pre row="2070">2070      <font color="black">294</font>     // resize canvas                                                                                           <font color="black">310</font>     // resize canvas                                                                                     </pre></div>
<div row="2071"><pre row="2071">2071      <font color="black">295</font>     const { data } = this;                                                                                     <font color="black">311</font>     const { data } = this;                                                                               </pre></div>
<div id="id-component-toolbar_js"  class="pagelink" row="2072"><pre class="pagehead" row="2072">2072 id-component-toolbar_js</pre></div>
<div row="2073"><pre row="2073">2073 <font color="blue">../src/component/toolbar.js</font>                                                                                        <font color="blue">../../x-spreadsheet/src/component/toolbar.js</font>                                                                      </pre></div>
<div row="2074"><pre row="2074">2074      <font color="black">156</font>       this.textwrapEl = buildButtonWithIcon(`${t('toolbar.textwrap')}`, 'textwrap', () =&gt; toggleChange.ca      <font color="black">156</font>       this.textwrapEl = buildButtonWithIcon(`${t('toolbar.textwrap')}`, 'textwrap', () =&gt; toggleChange.ca</pre></div>
<div row="2075"><pre row="2075">2075 ll(this, 'textwrap')),                                                                                             ll(this, 'textwrap')),                                                                                            </pre></div>
<div row="2076"><pre row="2076">2076      <font color="black">157</font>       buildDivider(),                                                                                          <font color="black">157</font>       buildDivider(),                                                                                    </pre></div>
<div row="2077"><pre row="2077">2077      <font color="black">158</font>       // this.linkEl = buildButtonWithIcon('Insert link', 'link'),                                             <font color="black">158</font>       // this.linkEl = buildButtonWithIcon('Insert link', 'link'),                                       </pre></div>
<div row="2078"><pre row="2078">2078      <font color="black">159</font>       // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),                                          <font color="black">159</font>       // this.chartEl = buildButtonWithIcon('Insert chart', 'chart'),                                    </pre></div>
<div row="2079"><pre row="2079">2079      <font color="black">160</font>       this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () =&gt; toggleChange.call(thi      <font color="black">160</font>       this.freezeEl = buildButtonWithIcon(`${t('toolbar.freeze')}`, 'freeze', () =&gt; toggleChange.call(thi</pre></div>
<div row="2080"><pre row="2080">2080 s, 'freeze')),                                                                                                     s, 'freeze')),                                                                                                    </pre></div>
<div row="2081"><pre row="2081">2081      <font color="black">161</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2082"><pre row="2082">2082      <font color="black">162</font> <font color="red">      //GUSA</font>                                                                                                                                                                                                                </pre></div>
<div row="2083"><pre row="2083">2083      <font color="black">163</font> <font color="red">      this.overlayerEl = buildButtonWithIcon(`${t('toolbar.overlayer')}`, 'overlayer', () =&gt; toggleChange</font>                                                                                                                   </pre></div>
<div row="2084"><pre row="2084">2084 <font color="red">.call(this, 'overlayer')),</font>                                                                                                                                                                                                           </pre></div>
<div row="2085"><pre row="2085">2085      <font color="black">164</font>       this.autofilterEl = buildButtonWithIcon(`${t('toolbar.autofilter')}`, 'autofilter', () =&gt; toggleCha      <font color="black">161</font>       this.autofilterEl = buildButtonWithIcon(`${t('toolbar.autofilter')}`, 'autofilter', () =&gt; toggleCha</pre></div>
<div row="2086"><pre row="2086">2086 nge.call(this, 'autofilter')),                                                                                     nge.call(this, 'autofilter')),                                                                                    </pre></div>
<div row="2087"><pre row="2087">2087      <font color="black">165</font>       buildButton(`${t('toolbar.formula')}`).child(this.ddFormula.el),                                         <font color="black">162</font>       buildButton(`${t('toolbar.formula')}`).child(this.ddFormula.el),                                   </pre></div>
<div row="2088"><pre row="2088">2088      <font color="black">166</font>       // buildDivider(),                                                                                       <font color="black">163</font>       // buildDivider(),                                                                                 </pre></div>
<div row="2089"><pre row="2089">2089      <font color="black">167</font>       this.moreEl = buildButton(`${t('toolbar.more')}`).child(this.ddMore.el).hide(),                          <font color="black">164</font>       this.moreEl = buildButton(`${t('toolbar.more')}`).child(this.ddMore.el).hide(),                    </pre></div>
<div row="2090"><pre row="2090">2090      <font color="black">168</font>     ];                                                                                                         <font color="black">165</font>     ];                                                                                                   </pre></div>
<div row="2091"><pre row="2091">2091 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2092"><pre row="2092">2092      <font color="black">222</font>     if (cell) {                                                                                                <font color="black">219</font>     if (cell) {                                                                                          </pre></div>
<div row="2093"><pre row="2093">2093      <font color="black">223</font>       if (cell.format) {                                                                                       <font color="black">220</font>       if (cell.format) {                                                                                 </pre></div>
<div row="2094"><pre row="2094">2094      <font color="black">224</font>         this.ddFormat.setTitle(cell.format);                                                                   <font color="black">221</font>         this.ddFormat.setTitle(cell.format);                                                             </pre></div>
<div row="2095"><pre row="2095">2095      <font color="black">225</font>       }                                                                                                        <font color="black">222</font>       }                                                                                                  </pre></div>
<div row="2096"><pre row="2096">2096      <font color="black">226</font>     }                                                                                                          <font color="black">223</font>     }                                                                                                    </pre></div>
<div row="2097"><pre row="2097">2097      <font color="black">227</font> <font color="red">    this.overlayerEl.active(true);</font>                                                                                                                                                                                          </pre></div>
<div row="2098"><pre row="2098">2098      <font color="black">228</font>   }                                                                                                            <font color="black">224</font>   }                                                                                                      </pre></div>
<div row="2099"><pre row="2099">2099      <font color="black">229</font> }                                                                                                              <font color="black">225</font> }                                                                                                        </pre></div>
<div id="id-component-tooltip_js"  class="pagelink" row="2100"><pre class="pagehead" row="2100">2100 id-component-tooltip_js</pre></div>
<div><pre row="2101"><code =class"javascript">2101 ../src/component/tooltip.js             ../../x-spreadsheet/src/component/tooltip.js</code></pre></div>
<div id="id-core-alphabet_js"  class="pagelink" row="2102"><pre class="pagehead" row="2102">2102 id-core-alphabet_js</pre></div>
<div row="2103"><pre row="2103">2103 <font color="blue">../src/core/alphabet.js</font>                                                                                            <font color="blue">../../x-spreadsheet/src/core/alphabet.js</font>                                                                          </pre></div>
<div row="2104"><pre row="2104">2104                                                                                                                           <font color="black">1</font> <font color="green">import './_.prototypes';</font>                                                                                 </pre></div>
<div row="2105"><pre row="2105">2105                                                                                                                           <font color="black">2</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2106"><pre row="2106">2106        <font color="black">1</font> const alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', '        <font color="black">3</font> const alphabets = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', '</pre></div>
<div row="2107"><pre row="2107">2107 R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];                                                                       R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];                                                                      </pre></div>
<div row="2108"><pre row="2108">2108        <font color="black">2</font>                                                                                                                  <font color="black">4</font>                                                                                                          </pre></div>
<div row="2109"><pre row="2109">2109                                                                                                                           <font color="black">5</font> <font color="green">/** index number 2 letters</font>                                                                               </pre></div>
<div row="2110"><pre row="2110">2110                                                                                                                           <font color="black">6</font> <font color="green"> * @example stringAt(26) ==&gt; 'AA'</font>                                                                        </pre></div>
<div row="2111"><pre row="2111">2111                                                                                                                           <font color="black">7</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre></div>
<div row="2112"><pre row="2112">2112                                                                                                                           <font color="black">8</font> <font color="green"> * @export</font>                                                                                               </pre></div>
<div row="2113"><pre row="2113">2113                                                                                                                           <font color="black">9</font> <font color="green"> * @param {number} index</font>                                                                                 </pre></div>
<div row="2114"><pre row="2114">2114                                                                                                                          <font color="black">10</font> <font color="green"> * @returns {string}</font>                                                                                     </pre></div>
<div row="2115"><pre row="2115">2115                                                                                                                          <font color="black">11</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2116"><pre row="2116">2116        <font color="black">3</font> export function stringAt(index) {                                                                               <font color="black">12</font> export function stringAt(index) {                                                                        </pre></div>
<div row="2117"><pre row="2117">2117        <font color="black">4</font>   let str = '';                                                                                                 <font color="black">13</font>   let str = '';                                                                                          </pre></div>
<div row="2118"><pre row="2118">2118        <font color="black">5</font>   let cindex = index;                                                                                           <font color="black">14</font>   let cindex = index;                                                                                    </pre></div>
<div row="2119"><pre row="2119">2119        <font color="black">6</font>   while (cindex &gt;= alphabets.length) {                                                                          <font color="black">15</font>   while (cindex &gt;= alphabets.length) {                                                                   </pre></div>
<div row="2120"><pre row="2120">2120        <font color="black">7</font>     cindex /= alphabets.length;                                                                                 <font color="black">16</font>     cindex /= alphabets.length;                                                                          </pre></div>
<div row="2121"><pre row="2121">2121 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2122"><pre row="2122">2122       <font color="black">11</font>   const last = index % alphabets.length;                                                                        <font color="black">20</font>   const last = index % alphabets.length;                                                                 </pre></div>
<div row="2123"><pre row="2123">2123       <font color="black">12</font>   str += alphabets[last];                                                                                       <font color="black">21</font>   str += alphabets[last];                                                                                </pre></div>
<div row="2124"><pre row="2124">2124       <font color="black">13</font>   return str;                                                                                                   <font color="black">22</font>   return str;                                                                                            </pre></div>
<div row="2125"><pre row="2125">2125       <font color="black">14</font> }                                                                                                               <font color="black">23</font> }                                                                                                        </pre></div>
<div row="2126"><pre row="2126">2126       <font color="black">15</font>                                                                                                                 <font color="black">24</font>                                                                                                          </pre></div>
<div row="2127"><pre row="2127">2127                                                                                                                          <font color="black">25</font> <font color="green">/** translate letter in A1-tag to number</font>                                                                 </pre></div>
<div row="2128"><pre row="2128">2128                                                                                                                          <font color="black">26</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre></div>
<div row="2129"><pre row="2129">2129                                                                                                                          <font color="black">27</font> <font color="green"> * @export</font>                                                                                               </pre></div>
<div row="2130"><pre row="2130">2130                                                                                                                          <font color="black">28</font> <font color="green"> * @param {string} str "AA" in A1-tag "AA1"</font>                                                              </pre></div>
<div row="2131"><pre row="2131">2131                                                                                                                          <font color="black">29</font> <font color="green"> * @returns {number}</font>                                                                                     </pre></div>
<div row="2132"><pre row="2132">2132                                                                                                                          <font color="black">30</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2133"><pre row="2133">2133       <font color="black">16</font> export function indexAt(str) {                                                                                  <font color="black">31</font> export function indexAt(str) {                                                                           </pre></div>
<div row="2134"><pre row="2134">2134       <font color="black">17</font>   let ret = 0;                                                                                                  <font color="black">32</font>   let ret = 0;                                                                                           </pre></div>
<div row="2135"><pre row="2135">2135       <font color="black">18</font>   for (let i = 0; i &lt; str.length - 1; i += 1) {                                                                 <font color="black">33</font>   for (let i = 0; i &lt; str.length - 1; i += 1) {                                                          </pre></div>
<div row="2136"><pre row="2136">2136       <font color="black">19</font>     const cindex = str.charCodeAt(i) - 65;                                                                      <font color="black">34</font>     const cindex = str.charCodeAt(i) - 65;                                                               </pre></div>
<div row="2137"><pre row="2137">2137       <font color="black">20</font>     const exponet = str.length - 1 - i;                                                                         <font color="black">35</font>     const exponet = str.length - 1 - i;                                                                  </pre></div>
<div row="2138"><pre row="2138">2138 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2139"><pre row="2139">2139       <font color="black">23</font>   ret += str.charCodeAt(str.length - 1) - 65;                                                                   <font color="black">38</font>   ret += str.charCodeAt(str.length - 1) - 65;                                                            </pre></div>
<div row="2140"><pre row="2140">2140       <font color="black">24</font>   return ret;                                                                                                   <font color="black">39</font>   return ret;                                                                                            </pre></div>
<div row="2141"><pre row="2141">2141       <font color="black">25</font> }                                                                                                               <font color="black">40</font> }                                                                                                        </pre></div>
<div row="2142"><pre row="2142">2142       <font color="black">26</font>                                                                                                                 <font color="black">41</font>                                                                                                          </pre></div>
<div row="2143"><pre row="2143">2143       <font color="black">27</font> // B10 =&gt; x,y                                                                                                   <font color="black">42</font> // B10 =&gt; x,y                                                                                            </pre></div>
<div row="2144"><pre row="2144">2144                                                                                                                          <font color="black">43</font> <font color="green">/** translate A1-tag to XY-tag</font>                                                                           </pre></div>
<div row="2145"><pre row="2145">2145                                                                                                                          <font color="black">44</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre></div>
<div row="2146"><pre row="2146">2146                                                                                                                          <font color="black">45</font> <font color="green"> * @export</font>                                                                                               </pre></div>
<div row="2147"><pre row="2147">2147                                                                                                                          <font color="black">46</font> <font color="green"> * @param {tagA1} src</font>                                                                                    </pre></div>
<div row="2148"><pre row="2148">2148                                                                                                                          <font color="black">47</font> <font color="green"> * @returns {tagXY}</font>                                                                                      </pre></div>
<div row="2149"><pre row="2149">2149                                                                                                                          <font color="black">48</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2150"><pre row="2150">2150       <font color="black">28</font> export function expr2xy(src) {                                                                                  <font color="black">49</font> export function expr2xy(src) {                                                                           </pre></div>
<div row="2151"><pre row="2151">2151       <font color="black">29</font>   let x = '';                                                                                                   <font color="black">50</font>   let x = '';                                                                                            </pre></div>
<div row="2152"><pre row="2152">2152       <font color="black">30</font>   let y = '';                                                                                                   <font color="black">51</font>   let y = '';                                                                                            </pre></div>
<div row="2153"><pre row="2153">2153       <font color="black">31</font>   for (let i = 0; i &lt; src.length; i += 1) {                                                                     <font color="black">52</font>   for (let i = 0; i &lt; src.length; i += 1) {                                                              </pre></div>
<div row="2154"><pre row="2154">2154       <font color="black">32</font>     if (src.charAt(i) &gt;= '0' && src.charAt(i) &lt;= '9') {                                                         <font color="black">53</font>     if (src.charAt(i) &gt;= '0' && src.charAt(i) &lt;= '9') {                                                  </pre></div>
<div row="2155"><pre row="2155">2155 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2156"><pre row="2156">2156       <font color="black">36</font>     }                                                                                                           <font color="black">57</font>     }                                                                                                    </pre></div>
<div row="2157"><pre row="2157">2157       <font color="black">37</font>   }                                                                                                             <font color="black">58</font>   }                                                                                                      </pre></div>
<div row="2158"><pre row="2158">2158       <font color="black">38</font>   return [indexAt(x), parseInt(y, 10) - 1];                                                                     <font color="black">59</font>   return [indexAt(x), parseInt(y, 10) - 1];                                                              </pre></div>
<div row="2159"><pre row="2159">2159       <font color="black">39</font> }                                                                                                               <font color="black">60</font> }                                                                                                        </pre></div>
<div row="2160"><pre row="2160">2160       <font color="black">40</font>                                                                                                                 <font color="black">61</font>                                                                                                          </pre></div>
<div row="2161"><pre row="2161">2161                                                                                                                          <font color="black">62</font> <font color="green">/** translate XY-tag to A1-tag</font>                                                                           </pre></div>
<div row="2162"><pre row="2162">2162                                                                                                                          <font color="black">63</font> <font color="green"> * @example x,y =&gt; B10</font>                                                                                   </pre></div>
<div row="2163"><pre row="2163">2163                                                                                                                          <font color="black">64</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre></div>
<div row="2164"><pre row="2164">2164                                                                                                                          <font color="black">65</font> <font color="green"> * @export</font>                                                                                               </pre></div>
<div row="2165"><pre row="2165">2165                                                                                                                          <font color="black">66</font> <font color="green"> * @param {number} x</font>                                                                                     </pre></div>
<div row="2166"><pre row="2166">2166                                                                                                                          <font color="black">67</font> <font color="green"> * @param {number} y</font>                                                                                     </pre></div>
<div row="2167"><pre row="2167">2167                                                                                                                          <font color="black">68</font> <font color="green"> * @returns {tagA1}</font>                                                                                      </pre></div>
<div row="2168"><pre row="2168">2168                                                                                                                          <font color="black">69</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2169"><pre row="2169">2169                                                                                                                          <font color="black">70</font> <font color="green">export function xy2expr(x, y) {</font>                                                                          </pre></div>
<div row="2170"><pre row="2170">2170                                                                                                                          <font color="black">71</font> <font color="green">  return `${stringAt(x)}${y + 1}`;</font>                                                                       </pre></div>
<div row="2171"><pre row="2171">2171                                                                                                                          <font color="black">72</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="2172"><pre row="2172">2172                                                                                                                          <font color="black">73</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2173"><pre row="2173">2173                                                                                                                          <font color="black">74</font> <font color="green">/** translate A1-tag src by (xn, yn)</font>                                                                     </pre></div>
<div row="2174"><pre row="2174">2174                                                                                                                          <font color="black">75</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre></div>
<div row="2175"><pre row="2175">2175                                                                                                                          <font color="black">76</font> <font color="green"> * @export</font>                                                                                               </pre></div>
<div row="2176"><pre row="2176">2176                                                                                                                          <font color="black">77</font> <font color="green"> * @param {tagA1} src</font>                                                                                    </pre></div>
<div row="2177"><pre row="2177">2177                                                                                                                          <font color="black">78</font> <font color="green"> * @param {number} xn</font>                                                                                    </pre></div>
<div row="2178"><pre row="2178">2178                                                                                                                          <font color="black">79</font> <font color="green"> * @param {number} yn</font>                                                                                    </pre></div>
<div row="2179"><pre row="2179">2179                                                                                                                          <font color="black">80</font> <font color="green"> * @returns {tagA1}</font>                                                                                      </pre></div>
<div row="2180"><pre row="2180">2180                                                                                                                          <font color="black">81</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2181"><pre row="2181">2181       <font color="black">41</font> export function expr2expr(src, xn, yn) {                                                                        <font color="black">82</font> export function expr2expr(src, xn, yn) {                                                                 </pre></div>
<div row="2182"><pre row="2182">2182       <font color="black">42</font>   const [x, y] = expr2xy(src);                                                                                  <font color="black">83</font>   const [x, y] = expr2xy(src);                                                                           </pre></div>
<div row="2183"><pre row="2183">2183       <font color="black">43</font> <font color="red">  return stringAt(x + xn) + (y + yn);</font>                                                                           <font color="black">84</font> <font color="green">  return xy2expr(x + xn, y + yn);</font>                                                                        </pre></div>
<div row="2184"><pre row="2184">2184       <font color="black">44</font> <font color="red">}</font>                                                                                                                                                                                                                           </pre></div>
<div row="2185"><pre row="2185">2185       <font color="black">45</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2186"><pre row="2186">2186       <font color="black">46</font> <font color="red">// x,y =&gt; B10</font>                                                                                                                                                                                                               </pre></div>
<div row="2187"><pre row="2187">2187       <font color="black">47</font> <font color="red">export function xy2expr(x, y) {</font>                                                                                                                                                                                             </pre></div>
<div row="2188"><pre row="2188">2188       <font color="black">48</font> <font color="red">  return `${stringAt(x)}${y + 1}`;</font>                                                                                                                                                                                          </pre></div>
<div row="2189"><pre row="2189">2189       <font color="black">49</font> }                                                                                                               <font color="black">85</font> }                                                                                                        </pre></div>
<div row="2190"><pre row="2190">2190       <font color="black">50</font>                                                                                                                 <font color="black">86</font>                                                                                                          </pre></div>
<div row="2191"><pre row="2191">2191       <font color="black">51</font> export default {                                                                                                <font color="black">87</font> export default {                                                                                         </pre></div>
<div row="2192"><pre row="2192">2192       <font color="black">52</font>   stringAt,                                                                                                     <font color="black">88</font>   stringAt,                                                                                              </pre></div>
<div row="2193"><pre row="2193">2193       <font color="black">53</font>   indexAt,                                                                                                      <font color="black">89</font>   indexAt,                                                                                               </pre></div>
<div id="id-core-auto_filter_js"  class="pagelink" row="2194"><pre class="pagehead" row="2194">2194 id-core-auto_filter_js</pre></div>
<div><pre row="2195"><code =class"javascript">2195 ../src/core/auto_filter.js             ../../x-spreadsheet/src/core/auto_filter.js</code></pre></div>
<div id="id-core-cell_js"  class="pagelink" row="2196"><pre class="pagehead" row="2196">2196 id-core-cell_js</pre></div>
<div row="2197"><pre row="2197">2197 <font color="blue">../src/core/cell.js</font>                                                                                                <font color="blue">../../x-spreadsheet/src/core/cell.js</font>                                                                              </pre></div>
<div row="2198"><pre row="2198">2198        <font color="black">6</font> const infixExprToSuffixExpr = (src) =&gt; {                                                                         <font color="black">6</font> const infixExprToSuffixExpr = (src) =&gt; {                                                                 </pre></div>
<div row="2199"><pre row="2199">2199        <font color="black">7</font>   const operatorStack = [];                                                                                      <font color="black">7</font>   const operatorStack = [];                                                                              </pre></div>
<div row="2200"><pre row="2200">2200        <font color="black">8</font>   const stack = [];                                                                                              <font color="black">8</font>   const stack = [];                                                                                      </pre></div>
<div row="2201"><pre row="2201">2201        <font color="black">9</font>   let subStrs = []; // SUM, A1, B2, 50 ...                                                                       <font color="black">9</font>   let subStrs = []; // SUM, A1, B2, 50 ...                                                               </pre></div>
<div row="2202"><pre row="2202">2202       <font color="black">10</font>   let fnArgType = 0; // 1 =&gt; , 2 =&gt; :                                                                           <font color="black">10</font>   let fnArgType = 0; // 1 =&gt; , 2 =&gt; :                                                                    </pre></div>
<div row="2203"><pre row="2203">2203                                                                                                                          <font color="black">11</font> <font color="green">  let fnArgOperator = '';</font>                                                                                </pre></div>
<div row="2204"><pre row="2204">2204       <font color="black">11</font>   let fnArgsLen = 1; // A1,A2,A3...                                                                             <font color="black">12</font>   let fnArgsLen = 1; // A1,A2,A3...                                                                      </pre></div>
<div row="2205"><pre row="2205">2205       <font color="black">12</font>   for (let i = 0; i &lt; src.length; i += 1) {                                                                     <font color="black">13</font>   for (let i = 0; i &lt; src.length; i += 1) {                                                              </pre></div>
<div row="2206"><pre row="2206">2206       <font color="black">13</font>     const c = src.charAt(i);                                                                                    <font color="black">14</font>     const c = src.charAt(i);                                                                             </pre></div>
<div row="2207"><pre row="2207">2207       <font color="black">14</font>     // console.log('c:', c);                                                                                    <font color="black">15</font>     // console.log('c:', c);                                                                             </pre></div>
<div row="2208"><pre row="2208">2208       <font color="black">15</font>     if (c !== ' ') {                                                                                            <font color="black">16</font>     if (c !== ' ') {                                                                                     </pre></div>
<div row="2209"><pre row="2209">2209 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2210"><pre row="2210">2210       <font color="black">47</font>               }                                                                                                 <font color="black">48</font>               }                                                                                          </pre></div>
<div row="2211"><pre row="2211">2211       <font color="black">48</font>               stack.push([c1, rangelen]);                                                                       <font color="black">49</font>               stack.push([c1, rangelen]);                                                                </pre></div>
<div row="2212"><pre row="2212">2212       <font color="black">49</font>             } catch (e) {                                                                                       <font color="black">50</font>             } catch (e) {                                                                                </pre></div>
<div row="2213"><pre row="2213">2213       <font color="black">50</font>               // console.log(e);                                                                                <font color="black">51</font>               // console.log(e);                                                                         </pre></div>
<div row="2214"><pre row="2214">2214       <font color="black">51</font>             }                                                                                                   <font color="black">52</font>             }                                                                                            </pre></div>
<div row="2215"><pre row="2215">2215       <font color="black">52</font>           } else if (fnArgType === 1) {                                                                         <font color="black">53</font>           } else if (fnArgType === 1<font color="green"> || fnArgType === 3</font>) {                                               </pre></div>
<div row="2216"><pre row="2216">2216                                                                                                                          <font color="black">54</font> <font color="green">            if (fnArgType === 3) stack.push(fnArgOperator);</font>                                              </pre></div>
<div row="2217"><pre row="2217">2217       <font color="black">53</font>             // fn argument =&gt; A1,A2,B5                                                                          <font color="black">55</font>             // fn argument =&gt; A1,A2,B5                                                                   </pre></div>
<div row="2218"><pre row="2218">2218       <font color="black">54</font>             stack.push([c1, fnArgsLen]);                                                                        <font color="black">56</font>             stack.push([c1, fnArgsLen]);                                                                 </pre></div>
<div row="2219"><pre row="2219">2219       <font color="black">55</font>             fnArgsLen = 1;                                                                                      <font color="black">57</font>             fnArgsLen = 1;                                                                               </pre></div>
<div row="2220"><pre row="2220">2220       <font color="black">56</font>           } else {                                                                                              <font color="black">58</font>           } else {                                                                                       </pre></div>
<div row="2221"><pre row="2221">2221       <font color="black">57</font>             // console.log('c1:', c1, fnArgType, stack, operatorStack);                                         <font color="black">59</font>             // console.log('c1:', c1, fnArgType, stack, operatorStack);                                  </pre></div>
<div row="2222"><pre row="2222">2222 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2223"><pre row="2223">2223       <font color="black">60</font>               if (operatorStack.length &lt;= 0) break;                                                             <font color="black">62</font>               if (operatorStack.length &lt;= 0) break;                                                      </pre></div>
<div row="2224"><pre row="2224">2224       <font color="black">61</font>               c1 = operatorStack.pop();                                                                         <font color="black">63</font>               c1 = operatorStack.pop();                                                                  </pre></div>
<div row="2225"><pre row="2225">2225       <font color="black">62</font>             }                                                                                                   <font color="black">64</font>             }                                                                                            </pre></div>
<div row="2226"><pre row="2226">2226       <font color="black">63</font>           }                                                                                                     <font color="black">65</font>           }                                                                                              </pre></div>
<div row="2227"><pre row="2227">2227       <font color="black">64</font>           fnArgType = 0;                                                                                        <font color="black">66</font>           fnArgType = 0;                                                                                 </pre></div>
<div row="2228"><pre row="2228">2228                                                                                                                          <font color="black">67</font> <font color="green">        } else if (c === '=' || c === '&gt;' || c === '&lt;') {</font>                                                </pre></div>
<div row="2229"><pre row="2229">2229                                                                                                                          <font color="black">68</font> <font color="green">          const nc = src.charAt(i + 1);</font>                                                                  </pre></div>
<div row="2230"><pre row="2230">2230                                                                                                                          <font color="black">69</font> <font color="green">          fnArgOperator = c;</font>                                                                             </pre></div>
<div row="2231"><pre row="2231">2231                                                                                                                          <font color="black">70</font> <font color="green">          if (nc === '=' || nc === '-') {</font>                                                                </pre></div>
<div row="2232"><pre row="2232">2232                                                                                                                          <font color="black">71</font> <font color="green">            fnArgOperator += nc;</font>                                                                         </pre></div>
<div row="2233"><pre row="2233">2233                                                                                                                          <font color="black">72</font> <font color="green">            i += 1;</font>                                                                                      </pre></div>
<div row="2234"><pre row="2234">2234                                                                                                                          <font color="black">73</font> <font color="green">          }</font>                                                                                              </pre></div>
<div row="2235"><pre row="2235">2235                                                                                                                          <font color="black">74</font> <font color="green">          fnArgType = 3;</font>                                                                                 </pre></div>
<div row="2236"><pre row="2236">2236       <font color="black">65</font>         } else if (c === ':') {                                                                                 <font color="black">75</font>         } else if (c === ':') {                                                                          </pre></div>
<div row="2237"><pre row="2237">2237       <font color="black">66</font>           fnArgType = 2;                                                                                        <font color="black">76</font>           fnArgType = 2;                                                                                 </pre></div>
<div row="2238"><pre row="2238">2238       <font color="black">67</font>         } else if (c === ',') {                                                                                 <font color="black">77</font>         } else if (c === ',') {                                                                          </pre></div>
<div row="2239"><pre row="2239">2239                                                                                                                          <font color="black">78</font> <font color="green">          if (fnArgType === 3) {</font>                                                                         </pre></div>
<div row="2240"><pre row="2240">2240                                                                                                                          <font color="black">79</font> <font color="green">            stack.push(fnArgOperator);</font>                                                                   </pre></div>
<div row="2241"><pre row="2241">2241                                                                                                                          <font color="black">80</font> <font color="green">          }</font>                                                                                              </pre></div>
<div row="2242"><pre row="2242">2242       <font color="black">68</font>           fnArgType = 1;                                                                                        <font color="black">81</font>           fnArgType = 1;                                                                                 </pre></div>
<div row="2243"><pre row="2243">2243       <font color="black">69</font>           fnArgsLen += 1;                                                                                       <font color="black">82</font>           fnArgsLen += 1;                                                                                </pre></div>
<div row="2244"><pre row="2244">2244       <font color="black">70</font>         } else if (c === '(' && subStrs.length &gt; 0) {                                                           <font color="black">83</font>         } else if (c === '(' && subStrs.length &gt; 0) {                                                    </pre></div>
<div row="2245"><pre row="2245">2245       <font color="black">71</font>           // function                                                                                           <font color="black">84</font>           // function                                                                                    </pre></div>
<div row="2246"><pre row="2246">2246       <font color="black">72</font>           operatorStack.push(subStrs.join(''));                                                                 <font color="black">85</font>           operatorStack.push(subStrs.join(''));                                                          </pre></div>
<div row="2247"><pre row="2247">2247 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2248"><pre row="2248">2248      <font color="black">117</font> const evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) =&gt; {                                       <font color="black">130</font> const evalSuffixExpr = (srcStack, formulaMap, cellRender, cellList) =&gt; {                                 </pre></div>
<div row="2249"><pre row="2249">2249      <font color="black">118</font>   const stack = [];                                                                                            <font color="black">131</font>   const stack = [];                                                                                      </pre></div>
<div row="2250"><pre row="2250">2250      <font color="black">119</font>   // console.log(':::::formulaMap:', formulaMap);                                                              <font color="black">132</font>   // console.log(':::::formulaMap:', formulaMap);                                                        </pre></div>
<div row="2251"><pre row="2251">2251      <font color="black">120</font>   for (let i = 0; i &lt; srcStack.length; i += 1) {                                                               <font color="black">133</font>   for (let i = 0; i &lt; srcStack.length; i += 1) {                                                         </pre></div>
<div row="2252"><pre row="2252">2252      <font color="black">121</font>     // console.log(':::&gt;&gt;&gt;', srcStack[i]);                                                                     <font color="black">134</font>     // console.log(':::&gt;&gt;&gt;', srcStack[i]);                                                               </pre></div>
<div row="2253"><pre row="2253">2253                                                                                                                         <font color="black">135</font> <font color="green">    const expr = srcStack[i];</font>                                                                            </pre></div>
<div row="2254"><pre row="2254">2254                                                                                                                         <font color="black">136</font> <font color="green">    const fc = expr[0];</font>                                                                                  </pre></div>
<div row="2255"><pre row="2255">2255      <font color="black">122</font>     if (<font color="orange">s</font>r<font color="red">cStack[i]</font> === '+') {                                                                                 <font color="black">137</font>     if (<font color="orange">exp</font>r === '+') {                                                                                  </pre></div>
<div row="2256"><pre row="2256">2256      <font color="black">123</font>       const top = stack.pop();                                                                                 <font color="black">138</font>       const top = stack.pop();                                                                           </pre></div>
<div row="2257"><pre row="2257">2257      <font color="black">124</font>       stack.push(Number(stack.pop()) + Number(top));                                                           <font color="black">139</font>       stack.push(Number(stack.pop()) + Number(top));                                                     </pre></div>
<div row="2258"><pre row="2258">2258      <font color="black">125</font>     } else if (<font color="orange">s</font>r<font color="red">cStack[i]</font> === '-') {                                                                          <font color="black">140</font>     } else if (<font color="orange">exp</font>r === '-') {                                                                           </pre></div>
<div row="2259"><pre row="2259">2259                                                                                                                         <font color="black">141</font> <font color="green">      if (stack.length === 1) {</font>                                                                          </pre></div>
<div row="2260"><pre row="2260">2260      <font color="black">126</font>       const top = stack.pop();                                                                                 <font color="black">142</font> <font color="green">  </font>      const top = stack.pop();                                                                         </pre></div>
<div row="2261"><pre row="2261">2261                                                                                                                         <font color="black">143</font> <font color="green">        stack.push(Number(top) * -1);</font>                                                                    </pre></div>
<div row="2262"><pre row="2262">2262                                                                                                                         <font color="black">144</font> <font color="green">      } else {</font>                                                                                           </pre></div>
<div row="2263"><pre row="2263">2263                                                                                                                         <font color="black">145</font> <font color="green">        const top = stack.pop();</font>                                                                         </pre></div>
<div row="2264"><pre row="2264">2264      <font color="black">127</font>       stack.push(Number(stack.pop()) - Number(top));                                                           <font color="black">146</font> <font color="green">  </font>      stack.push(Number(stack.pop()) - Number(top));                                                   </pre></div>
<div row="2265"><pre row="2265">2265                                                                                                                         <font color="black">147</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2266"><pre row="2266">2266      <font color="black">128</font>     } else if (<font color="orange">s</font>r<font color="red">cStack[i]</font> === '*') {                                                                          <font color="black">148</font>     } else if (<font color="orange">exp</font>r === '*') {                                                                           </pre></div>
<div row="2267"><pre row="2267">2267      <font color="black">129</font>       stack.push(Number(stack.pop()) * Number(stack.pop()));                                                   <font color="black">149</font>       stack.push(Number(stack.pop()) * Number(stack.pop()));                                             </pre></div>
<div row="2268"><pre row="2268">2268      <font color="black">130</font>     } else if (<font color="orange">s</font>r<font color="red">cStack[i]</font> === '/') {                                                                          <font color="black">150</font>     } else if (<font color="orange">exp</font>r === '/') {                                                                           </pre></div>
<div row="2269"><pre row="2269">2269      <font color="black">131</font>       const top = stack.pop();                                                                                 <font color="black">151</font>       const top = stack.pop();                                                                           </pre></div>
<div row="2270"><pre row="2270">2270      <font color="black">132</font>       stack.push(Number(stack.pop()) / Number(top));                                                           <font color="black">152</font>       stack.push(Number(stack.pop()) / Number(top));                                                     </pre></div>
<div row="2271"><pre row="2271">2271                                                                                                                         <font color="black">153</font> <font color="green">    } else if (fc === '=' || fc === '&gt;' || fc === '&lt;') {</font>                                                 </pre></div>
<div row="2272"><pre row="2272">2272                                                                                                                         <font color="black">154</font> <font color="green">      const top = stack.pop();</font>                                                                           </pre></div>
<div row="2273"><pre row="2273">2273                                                                                                                         <font color="black">155</font> <font color="green">      const Fn = Function;</font>                                                                               </pre></div>
<div row="2274"><pre row="2274">2274                                                                                                                         <font color="black">156</font> <font color="green">      stack.push(new Fn(`return ${stack.pop()} ${expr === '=' ? '==' : expr} ${top}`)());</font>                </pre></div>
<div row="2275"><pre row="2275">2275      <font color="black">133</font>     } else if (Array.isArray(<font color="orange">s</font>r<font color="red">cStack[i]</font>)) {                                                                   <font color="black">157</font>     } else if (Array.isArray(<font color="orange">exp</font>r)) {                                                                    </pre></div>
<div row="2276"><pre row="2276">2276      <font color="black">134</font>       const [formula, len] = <font color="orange">s</font>r<font color="red">cStack[i]</font>;                                                                      <font color="black">158</font>       const [formula, len] = <font color="orange">exp</font>r;                                                                       </pre></div>
<div row="2277"><pre row="2277">2277      <font color="black">135</font>       const params = [];                                                                                       <font color="black">159</font>       const params = [];                                                                                 </pre></div>
<div row="2278"><pre row="2278">2278      <font color="black">136</font>       for (let j = 0; j &lt; len; j += 1) {                                                                       <font color="black">160</font>       for (let j = 0; j &lt; len; j += 1) {                                                                 </pre></div>
<div row="2279"><pre row="2279">2279      <font color="black">137</font>         params.push(stack.pop());                                                                              <font color="black">161</font>         params.push(stack.pop());                                                                        </pre></div>
<div row="2280"><pre row="2280">2280      <font color="black">138</font>       }                                                                                                        <font color="black">162</font>       }                                                                                                  </pre></div>
<div row="2281"><pre row="2281">2281                                                                                                                         <font color="black">163</font> <font color="green">      // console.log('::::params:', formulaMap, expr,  formula, params);</font>                                 </pre></div>
<div row="2282"><pre row="2282">2282      <font color="black">139</font>       stack.push(formulaMap[formula].render(params.reverse()));                                                <font color="black">164</font>       stack.push(formulaMap[formula].render(params.reverse()));                                          </pre></div>
<div row="2283"><pre row="2283">2283      <font color="black">140</font>     } else {                                                                                                   <font color="black">165</font>     } else {                                                                                             </pre></div>
<div row="2284"><pre row="2284">2284                                                                                                                         <font color="black">166</font> <font color="green">      // console.log('cellList:', cellList, expr);</font>                                                       </pre></div>
<div row="2285"><pre row="2285">2285      <font color="black">141</font>       if (cellList.includes(<font color="orange">s</font>r<font color="red">cStack[i]</font>)) {                                                                    <font color="black">167</font>       if (cellList.includes(<font color="orange">exp</font>r)) {                                                                     </pre></div>
<div row="2286"><pre row="2286">2286      <font color="black">142</font>         return 0;                                                                                              <font color="black">168</font>         return 0;                                                                                        </pre></div>
<div row="2287"><pre row="2287">2287      <font color="black">143</font>       }                                                                                                        <font color="black">169</font>       }                                                                                                  </pre></div>
<div row="2288"><pre row="2288">2288                                                                                                                         <font color="black">170</font> <font color="green">      if ((fc &gt;= 'a' && fc &lt;= 'z') || (fc &gt;= 'A' && fc &lt;= 'Z')) {</font>                                        </pre></div>
<div row="2289"><pre row="2289">2289      <font color="black">144</font>       cellList.push(<font color="orange">s</font>r<font color="red">cStack[i]</font>);                                                                              <font color="black">171</font> <font color="green">  </font>      cellList.push(<font color="orange">exp</font>r);                                                                             </pre></div>
<div row="2290"><pre row="2290">2290                                                                                                                         <font color="black">172</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2291"><pre row="2291">2291      <font color="black">145</font>       stack.push(evalSubExpr(<font color="orange">s</font>r<font color="red">cStack[i]</font>, cellRender));                                                        <font color="black">173</font>       stack.push(evalSubExpr(<font color="orange">exp</font>r, cellRender));                                                         </pre></div>
<div row="2292"><pre row="2292">2292      <font color="black">146</font>     }                                                                                                          <font color="black">174</font>     }                                                                                                    </pre></div>
<div row="2293"><pre row="2293">2293      <font color="black">147</font>     // console.log('stack:', stack);                                                                           <font color="black">175</font>     // console.log('stack:', stack);                                                                     </pre></div>
<div row="2294"><pre row="2294">2294      <font color="black">148</font>   }                                                                                                            <font color="black">176</font>   }                                                                                                      </pre></div>
<div row="2295"><pre row="2295">2295      <font color="black">149</font>   return stack[0];                                                                                             <font color="black">177</font>   return stack[0];                                                                                       </pre></div>
<div row="2296"><pre row="2296">2296      <font color="black">150</font> };                                                                                                             <font color="black">178</font> };                                                                                                       </pre></div>
<div id="id-core-cell_range_js"  class="pagelink" row="2297"><pre class="pagehead" row="2297">2297 id-core-cell_range_js</pre></div>
<div><pre row="2298"><code =class"javascript">2298 ../src/core/cell_range.js             ../../x-spreadsheet/src/core/cell_range.js</code></pre></div>
<div id="id-core-clipboard_js"  class="pagelink" row="2299"><pre class="pagehead" row="2299">2299 id-core-clipboard_js</pre></div>
<div><pre row="2300"><code =class"javascript">2300 ../src/core/clipboard.js             ../../x-spreadsheet/src/core/clipboard.js</code></pre></div>
<div id="id-core-col_js"  class="pagelink" row="2301"><pre class="pagehead" row="2301">2301 id-core-col_js</pre></div>
<div row="2302"><pre row="2302">2302 <font color="blue">../src/core/col.js</font>                                                                                                 <font color="blue">../../x-spreadsheet/src/core/col.js</font>                                                                               </pre></div>
<div row="2303"><pre row="2303">2303       <font color="black">10</font>     this.indexWidth = indexWidth;                                                                               <font color="black">10</font>     this.indexWidth = indexWidth;                                                                        </pre></div>
<div row="2304"><pre row="2304">2304       <font color="black">11</font>     this.minWidth = minWidth;                                                                                   <font color="black">11</font>     this.minWidth = minWidth;                                                                            </pre></div>
<div row="2305"><pre row="2305">2305       <font color="black">12</font>   }                                                                                                             <font color="black">12</font>   }                                                                                                      </pre></div>
<div row="2306"><pre row="2306">2306       <font color="black">13</font>                                                                                                                 <font color="black">13</font>                                                                                                          </pre></div>
<div row="2307"><pre row="2307">2307       <font color="black">14</font>   setData(d) {                                                                                                  <font color="black">14</font>   setData(d) {                                                                                           </pre></div>
<div row="2308"><pre row="2308">2308       <font color="black">15</font> <font color="red">    console.log("col setData:", d);</font>                                                                                                                                                                                         </pre></div>
<div row="2309"><pre row="2309">2309       <font color="black">16</font>     if (d.len) {                                                                                                <font color="black">15</font>     if (d.len) {                                                                                         </pre></div>
<div row="2310"><pre row="2310">2310       <font color="black">17</font>       this.len = d.len;                                                                                         <font color="black">16</font>       this.len = d.len;                                                                                  </pre></div>
<div row="2311"><pre row="2311">2311       <font color="black">18</font>       delete d.len;                                                                                             <font color="black">17</font>       delete d.len;                                                                                      </pre></div>
<div row="2312"><pre row="2312">2312       <font color="black">19</font>     }                                                                                                           <font color="black">18</font>     }                                                                                                    </pre></div>
<div row="2313"><pre row="2313">2313       <font color="black">20</font>     this._ = d;                                                                                                 <font color="black">19</font>     this._ = d;                                                                                          </pre></div>
<div row="2314"><pre row="2314">2314 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2315"><pre row="2315">2315       <font color="black">24</font>     const { len } = this;                                                                                       <font color="black">23</font>     const { len } = this;                                                                                </pre></div>
<div row="2316"><pre row="2316">2316       <font color="black">25</font>     return Object.assign({ len }, this._);                                                                      <font color="black">24</font>     return Object.assign({ len }, this._);                                                               </pre></div>
<div row="2317"><pre row="2317">2317       <font color="black">26</font>   }                                                                                                             <font color="black">25</font>   }                                                                                                      </pre></div>
<div row="2318"><pre row="2318">2318       <font color="black">27</font>                                                                                                                 <font color="black">26</font>                                                                                                          </pre></div>
<div row="2319"><pre row="2319">2319       <font color="black">28</font>   getWidth(i) {                                                                                                 <font color="black">27</font>   getWidth(i) {                                                                                          </pre></div>
<div row="2320"><pre row="2320">2320                                                                                                                          <font color="black">28</font> <font color="green">    if (this.isHide(i)) return 0;</font>                                                                        </pre></div>
<div row="2321"><pre row="2321">2321       <font color="black">29</font>     const col = this._[i];                                                                                      <font color="black">29</font>     const col = this._[i];                                                                               </pre></div>
<div row="2322"><pre row="2322">2322       <font color="black">30</font>     if (col && col.width) {                                                                                     <font color="black">30</font>     if (col && col.width) {                                                                              </pre></div>
<div row="2323"><pre row="2323">2323       <font color="black">31</font>       return col.width;                                                                                         <font color="black">31</font>       return col.width;                                                                                  </pre></div>
<div row="2324"><pre row="2324">2324       <font color="black">32</font>     }                                                                                                           <font color="black">32</font>     }                                                                                                    </pre></div>
<div row="2325"><pre row="2325">2325       <font color="black">33</font> <font color="red">    //console.log("col gwtWidth: ", this.width);</font>                                                                                                                                                                            </pre></div>
<div row="2326"><pre row="2326">2326       <font color="black">34</font>     return this.width;                                                                                          <font color="black">33</font>     return this.width;                                                                                   </pre></div>
<div row="2327"><pre row="2327">2327       <font color="black">35</font>   }                                                                                                             <font color="black">34</font>   }                                                                                                      </pre></div>
<div row="2328"><pre row="2328">2328       <font color="black">36</font>                                                                                                                 <font color="black">35</font>                                                                                                          </pre></div>
<div row="2329"><pre row="2329">2329       <font color="black">37</font>   getOrNew(ci) {                                                                                                <font color="black">36</font>   getOrNew(ci) {                                                                                         </pre></div>
<div row="2330"><pre row="2330">2330       <font color="black">38</font>     this._[ci] = this._[ci] || {};                                                                              <font color="black">37</font>     this._[ci] = this._[ci] || {};                                                                       </pre></div>
<div row="2331"><pre row="2331">2331       <font color="black">39</font>     return this._[ci];                                                                                          <font color="black">38</font>     return this._[ci];                                                                                   </pre></div>
<div row="2332"><pre row="2332">2332       <font color="black">40</font>   }                                                                                                             <font color="black">39</font>   }                                                                                                      </pre></div>
<div row="2333"><pre row="2333">2333       <font color="black">41</font>                                                                                                                 <font color="black">40</font>                                                                                                          </pre></div>
<div row="2334"><pre row="2334">2334       <font color="black">42</font>   setWidth(ci, width) {                                                                                         <font color="black">41</font>   setWidth(ci, width) {                                                                                  </pre></div>
<div row="2335"><pre row="2335">2335       <font color="black">43</font> <font color="red">    console.log("col setWidth: ", ci, width);</font>                                                                                                                                                                               </pre></div>
<div row="2336"><pre row="2336">2336       <font color="black">44</font>     const col = this.getOrNew(ci);                                                                              <font color="black">42</font>     const col = this.getOrNew(ci);                                                                       </pre></div>
<div row="2337"><pre row="2337">2337       <font color="black">45</font>     col.width = width;                                                                                          <font color="black">43</font>     col.width = width;                                                                                   </pre></div>
<div row="2338"><pre row="2338">2338                                                                                                                          <font color="black">44</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="2339"><pre row="2339">2339                                                                                                                          <font color="black">45</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2340"><pre row="2340">2340                                                                                                                          <font color="black">46</font> <font color="green">  unhide(idx) {</font>                                                                                          </pre></div>
<div row="2341"><pre row="2341">2341                                                                                                                          <font color="black">47</font> <font color="green">    let index = idx;</font>                                                                                     </pre></div>
<div row="2342"><pre row="2342">2342                                                                                                                          <font color="black">48</font> <font color="green">    while (index &gt; 0) {</font>                                                                                  </pre></div>
<div row="2343"><pre row="2343">2343                                                                                                                          <font color="black">49</font> <font color="green">      index -= 1;</font>                                                                                        </pre></div>
<div row="2344"><pre row="2344">2344                                                                                                                          <font color="black">50</font> <font color="green">      if (this.isHide(index)) {</font>                                                                          </pre></div>
<div row="2345"><pre row="2345">2345                                                                                                                          <font color="black">51</font> <font color="green">        this.setHide(index, false);</font>                                                                      </pre></div>
<div row="2346"><pre row="2346">2346                                                                                                                          <font color="black">52</font> <font color="green">      } else break;</font>                                                                                      </pre></div>
<div row="2347"><pre row="2347">2347                                                                                                                          <font color="black">53</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="2348"><pre row="2348">2348                                                                                                                          <font color="black">54</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="2349"><pre row="2349">2349                                                                                                                          <font color="black">55</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2350"><pre row="2350">2350                                                                                                                          <font color="black">56</font> <font color="green">  isHide(ci) {</font>                                                                                           </pre></div>
<div row="2351"><pre row="2351">2351                                                                                                                          <font color="black">57</font> <font color="green">    const col = this._[ci];</font>                                                                              </pre></div>
<div row="2352"><pre row="2352">2352                                                                                                                          <font color="black">58</font> <font color="green">    return col && col.hide;</font>                                                                              </pre></div>
<div row="2353"><pre row="2353">2353                                                                                                                          <font color="black">59</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="2354"><pre row="2354">2354                                                                                                                          <font color="black">60</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2355"><pre row="2355">2355                                                                                                                          <font color="black">61</font> <font color="green">  setHide(ci, v) {</font>                                                                                       </pre></div>
<div row="2356"><pre row="2356">2356                                                                                                                          <font color="black">62</font> <font color="green">    const col = this.getOrNew(ci);</font>                                                                       </pre></div>
<div row="2357"><pre row="2357">2357                                                                                                                          <font color="black">63</font> <font color="green">    if (v === true) col.hide = true;</font>                                                                     </pre></div>
<div row="2358"><pre row="2358">2358                                                                                                                          <font color="black">64</font> <font color="green">    else delete col.hide;</font>                                                                                </pre></div>
<div row="2359"><pre row="2359">2359       <font color="black">46</font>   }                                                                                                             <font color="black">65</font>   }                                                                                                      </pre></div>
<div row="2360"><pre row="2360">2360       <font color="black">47</font>                                                                                                                 <font color="black">66</font>                                                                                                          </pre></div>
<div row="2361"><pre row="2361">2361       <font color="black">48</font>   setStyle(ci, style) {                                                                                         <font color="black">67</font>   setStyle(ci, style) {                                                                                  </pre></div>
<div row="2362"><pre row="2362">2362       <font color="black">49</font>     const col = this.getOrNew(ci);                                                                              <font color="black">68</font>     const col = this.getOrNew(ci);                                                                       </pre></div>
<div row="2363"><pre row="2363">2363       <font color="black">50</font>     col.style = style;                                                                                          <font color="black">69</font>     col.style = style;                                                                                   </pre></div>
<div id="id-core-data_proxy_js"  class="pagelink" row="2364"><pre class="pagehead" row="2364">2364 id-core-data_proxy_js</pre></div>
<div row="2365"><pre row="2365">2365 <font color="blue">../src/core/data_proxy.js</font>                                                                                          <font color="blue">../../x-spreadsheet/src/core/data_proxy.js</font>                                                                        </pre></div>
<div row="2366"><pre row="2366">2366       <font color="black">11</font> import { Cols } from './col';                                                                                   <font color="black">11</font> import { Cols } from './col';                                                                            </pre></div>
<div row="2367"><pre row="2367">2367       <font color="black">12</font> import { Validations } from './validation';                                                                     <font color="black">12</font> import { Validations } from './validation';                                                              </pre></div>
<div row="2368"><pre row="2368">2368       <font color="black">13</font> import { CellRange } from './cell_range';                                                                       <font color="black">13</font> import { CellRange } from './cell_range';                                                                </pre></div>
<div row="2369"><pre row="2369">2369       <font color="black">14</font> import { expr2xy, xy2expr } from './alphabet';                                                                  <font color="black">14</font> import { expr2xy, xy2expr } from './alphabet';                                                           </pre></div>
<div row="2370"><pre row="2370">2370       <font color="black">15</font> import { t } from '../locale/locale';                                                                           <font color="black">15</font> import { t } from '../locale/locale';                                                                    </pre></div>
<div row="2371"><pre row="2371">2371       <font color="black">16</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2372"><pre row="2372">2372       <font color="black">17</font> <font color="red">import { Shapes } from './shape';  //GUSA</font>                                                                                                                                                                                   </pre></div>
<div row="2373"><pre row="2373">2373       <font color="black">18</font>                                                                                                                 <font color="black">16</font>                                                                                                          </pre></div>
<div row="2374"><pre row="2374">2374       <font color="black">19</font> // private methods                                                                                              <font color="black">17</font> // private methods                                                                                       </pre></div>
<div row="2375"><pre row="2375">2375       <font color="black">20</font> /*                                                                                                              <font color="black">18</font> /*                                                                                                       </pre></div>
<div row="2376"><pre row="2376">2376       <font color="black">21</font>  * {                                                                                                            <font color="black">19</font>  * {                                                                                                     </pre></div>
<div row="2377"><pre row="2377">2377       <font color="black">22</font>  *  name: ''                                                                                                    <font color="black">20</font>  *  name: ''                                                                                             </pre></div>
<div row="2378"><pre row="2378">2378 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2379"><pre row="2379">2379       <font color="black">37</font>  *        right: [style, color],                                                                                <font color="black">35</font>  *        right: [style, color],                                                                         </pre></div>
<div row="2380"><pre row="2380">2380       <font color="black">38</font>  *        top: [style, color],                                                                                  <font color="black">36</font>  *        top: [style, color],                                                                           </pre></div>
<div row="2381"><pre row="2381">2381       <font color="black">39</font>  *        bottom: [style, color],                                                                               <font color="black">37</font>  *        bottom: [style, color],                                                                        </pre></div>
<div row="2382"><pre row="2382">2382       <font color="black">40</font>  *      },                                                                                                      <font color="black">38</font>  *      },                                                                                               </pre></div>
<div row="2383"><pre row="2383">2383       <font color="black">41</font>  *      font: {                                                                                                 <font color="black">39</font>  *      font: {                                                                                          </pre></div>
<div row="2384"><pre row="2384">2384       <font color="black">42</font>  *        <font color="orange">f</font>am<font color="orange">ily</font>: 'Helvetica',                                                                                  <font color="black">40</font>  *        <font color="orange">n</font>am<font color="orange">e</font>: 'Helvetica',                                                                             </pre></div>
<div row="2385"><pre row="2385">2385       <font color="black">43</font>  *        size: 10,                                                                                             <font color="black">41</font>  *        size: 10,                                                                                      </pre></div>
<div row="2386"><pre row="2386">2386       <font color="black">44</font>  *        bold: false,                                                                                          <font color="black">42</font>  *        bold: false,                                                                                   </pre></div>
<div row="2387"><pre row="2387">2387       <font color="black">45</font>  *        italic: false,                                                                                        <font color="black">43</font>  *        italic: false,                                                                                 </pre></div>
<div row="2388"><pre row="2388">2388       <font color="black">46</font>  *      }                                                                                                       <font color="black">44</font>  *      }                                                                                                </pre></div>
<div row="2389"><pre row="2389">2389       <font color="black">47</font>  *    }                                                                                                         <font color="black">45</font>  *    }                                                                                                  </pre></div>
<div row="2390"><pre row="2390">2390 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2391"><pre row="2391">2391       <font color="black">77</font>   },                                                                                                            <font color="black">75</font>   },                                                                                                     </pre></div>
<div row="2392"><pre row="2392">2392       <font color="black">78</font>   showGrid: true,                                                                                               <font color="black">76</font>   showGrid: true,                                                                                        </pre></div>
<div row="2393"><pre row="2393">2393       <font color="black">79</font>   showToolbar: true,                                                                                            <font color="black">77</font>   showToolbar: true,                                                                                     </pre></div>
<div row="2394"><pre row="2394">2394       <font color="black">80</font>   showContextmenu: true,                                                                                        <font color="black">78</font>   showContextmenu: true,                                                                                 </pre></div>
<div row="2395"><pre row="2395">2395       <font color="black">81</font>   row: {                                                                                                        <font color="black">79</font>   row: {                                                                                                 </pre></div>
<div row="2396"><pre row="2396">2396       <font color="black">82</font> <font color="red">//    len: 100,</font>                                                                                                                                                                                                             </pre></div>
<div row="2397"><pre row="2397">2397       <font color="black">83</font>     len: 100<font color="red">0</font>,                                                                                                  <font color="black">80</font>     len: 100,                                                                                            </pre></div>
<div row="2398"><pre row="2398">2398       <font color="black">84</font>     height: 2<font color="orange">0</font>,                                                                                                 <font color="black">81</font>     height: 2<font color="orange">5</font>,                                                                                          </pre></div>
<div row="2399"><pre row="2399">2399       <font color="black">85</font>   },                                                                                                            <font color="black">82</font>   },                                                                                                     </pre></div>
<div row="2400"><pre row="2400">2400       <font color="black">86</font>   col: {                                                                                                        <font color="black">83</font>   col: {                                                                                                 </pre></div>
<div row="2401"><pre row="2401">2401       <font color="black">87</font> <font color="red">//</font>    len: 26,                                                                                                  <font color="black">84</font>     len: 26,                                                                                             </pre></div>
<div row="2402"><pre row="2402">2402       <font color="black">88</font> <font color="red">    len: 1000,</font>                                                                                                                                                                                                              </pre></div>
<div row="2403"><pre row="2403">2403       <font color="black">89</font>     width: 100,                                                                                                 <font color="black">85</font>     width: 100,                                                                                          </pre></div>
<div row="2404"><pre row="2404">2404       <font color="black">90</font>     indexWidth: 60,                                                                                             <font color="black">86</font>     indexWidth: 60,                                                                                      </pre></div>
<div row="2405"><pre row="2405">2405       <font color="black">91</font>     minWidth: 60,                                                                                               <font color="black">87</font>     minWidth: 60,                                                                                        </pre></div>
<div row="2406"><pre row="2406">2406       <font color="black">92</font> <font color="red">  },</font>                                                                                                                                                                                                                        </pre></div>
<div row="2407"><pre row="2407">2407       <font color="black">93</font> <font color="red">  shape: {</font>                                                                                                                                                                                                                  </pre></div>
<div row="2408"><pre row="2408">2408       <font color="black">94</font> <font color="red">    draggable: true,</font>                                                                                                                                                                                                        </pre></div>
<div row="2409"><pre row="2409">2409       <font color="black">95</font>   },                                                                                                            <font color="black">88</font>   },                                                                                                     </pre></div>
<div row="2410"><pre row="2410">2410       <font color="black">96</font>   style: {                                                                                                      <font color="black">89</font>   style: {                                                                                               </pre></div>
<div row="2411"><pre row="2411">2411       <font color="black">97</font>     bgcolor: '#ffffff',                                                                                         <font color="black">90</font>     bgcolor: '#ffffff',                                                                                  </pre></div>
<div row="2412"><pre row="2412">2412       <font color="black">98</font>     align: 'left',                                                                                              <font color="black">91</font>     align: 'left',                                                                                       </pre></div>
<div row="2413"><pre row="2413">2413       <font color="black">99</font>     valign: 'middle',                                                                                           <font color="black">92</font>     valign: 'middle',                                                                                    </pre></div>
<div row="2414"><pre row="2414">2414 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2415"><pre row="2415">2415      <font color="black">109</font>     },                                                                                                         <font color="black">102</font>     },                                                                                                   </pre></div>
<div row="2416"><pre row="2416">2416      <font color="black">110</font>   },                                                                                                           <font color="black">103</font>   },                                                                                                     </pre></div>
<div row="2417"><pre row="2417">2417      <font color="black">111</font> };                                                                                                             <font color="black">104</font> };                                                                                                       </pre></div>
<div row="2418"><pre row="2418">2418      <font color="black">112</font>                                                                                                                <font color="black">105</font>                                                                                                          </pre></div>
<div row="2419"><pre row="2419">2419      <font color="black">113</font> const toolbarHeight = 41;                                                                                      <font color="black">106</font> const toolbarHeight = 41;                                                                                </pre></div>
<div row="2420"><pre row="2420">2420                                                                                                                         <font color="black">107</font> <font color="green">const bottombarHeight = 41;</font>                                                                              </pre></div>
<div row="2421"><pre row="2421">2421      <font color="black">114</font>                                                                                                                <font color="black">108</font>                                                                                                          </pre></div>
<div row="2422"><pre row="2422">2422      <font color="black">115</font>                                                                                                                <font color="black">109</font>                                                                                                          </pre></div>
<div row="2423"><pre row="2423">2423      <font color="black">116</font> // src: cellRange                                                                                              <font color="black">110</font> // src: cellRange                                                                                        </pre></div>
<div row="2424"><pre row="2424">2424      <font color="black">117</font> // dst: cellRange                                                                                              <font color="black">111</font> // dst: cellRange                                                                                        </pre></div>
<div row="2425"><pre row="2425">2425      <font color="black">118</font> function canPaste(src, dst, error = () =&gt; {}) {                                                                <font color="black">112</font> function canPaste(src, dst, error = () =&gt; {}) {                                                          </pre></div>
<div row="2426"><pre row="2426">2426 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2427"><pre row="2427">2427      <font color="black">334</font>     this.freeze = [0, 0];                                                                                      <font color="black">328</font>     this.freeze = [0, 0];                                                                                </pre></div>
<div row="2428"><pre row="2428">2428      <font color="black">335</font>     this.styles = []; // Array&lt;Style&gt;                                                                          <font color="black">329</font>     this.styles = []; // Array&lt;Style&gt;                                                                    </pre></div>
<div row="2429"><pre row="2429">2429      <font color="black">336</font>     this.merges = new Merges(); // [CellRange, ...]                                                            <font color="black">330</font>     this.merges = new Merges(); // [CellRange, ...]                                                      </pre></div>
<div row="2430"><pre row="2430">2430      <font color="black">337</font>     this.rows = new Rows(this.settings.row);                                                                   <font color="black">331</font>     this.rows = new Rows(this.settings.row);                                                             </pre></div>
<div row="2431"><pre row="2431">2431      <font color="black">338</font>     this.cols = new Cols(this.settings.col);                                                                   <font color="black">332</font>     this.cols = new Cols(this.settings.col);                                                             </pre></div>
<div row="2432"><pre row="2432">2432      <font color="black">339</font> <font color="red">//    console.log("rows: ",this.rows);</font>                                                                                                                                                                                      </pre></div>
<div row="2433"><pre row="2433">2433      <font color="black">340</font> <font color="red">//    console.log("cols: ",this.cols);</font>                                                                                                                                                                                      </pre></div>
<div row="2434"><pre row="2434">2434      <font color="black">341</font> <font color="red">    this.shapes = new Shapes(this.settings.shape);//GUSA</font>                                                                                                                                                                    </pre></div>
<div row="2435"><pre row="2435">2435      <font color="black">342</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2436"><pre row="2436">2436      <font color="black">343</font> <font color="red">    console.log(this.rows);</font>                                                                                                                                                                                                 </pre></div>
<div row="2437"><pre row="2437">2437      <font color="black">344</font> <font color="red">    console.log(this.cols);</font>                                                                                                                                                                                                 </pre></div>
<div row="2438"><pre row="2438">2438      <font color="black">345</font> <font color="red">    console.log(this.shapes);</font>                                                                                                                                                                                               </pre></div>
<div row="2439"><pre row="2439">2439      <font color="black">346</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2440"><pre row="2440">2440      <font color="black">347</font>     this.validations = new Validations();                                                                      <font color="black">333</font>     this.validations = new Validations();                                                                </pre></div>
<div row="2441"><pre row="2441">2441      <font color="black">348</font>     this.hyperlinks = {};                                                                                      <font color="black">334</font>     this.hyperlinks = {};                                                                                </pre></div>
<div row="2442"><pre row="2442">2442      <font color="black">349</font>     this.comments = {};                                                                                        <font color="black">335</font>     this.comments = {};                                                                                  </pre></div>
<div row="2443"><pre row="2443">2443      <font color="black">350</font>     // save data end                                                                                           <font color="black">336</font>     // save data end                                                                                     </pre></div>
<div row="2444"><pre row="2444">2444      <font color="black">351</font>                                                                                                                <font color="black">337</font>                                                                                                          </pre></div>
<div row="2445"><pre row="2445">2445 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2446"><pre row="2446">2446      <font color="black">357</font>     this.autoFilter = new AutoFilter();                                                                        <font color="black">343</font>     this.autoFilter = new AutoFilter();                                                                  </pre></div>
<div row="2447"><pre row="2447">2447      <font color="black">358</font>     this.change = () =&gt; {};                                                                                    <font color="black">344</font>     this.change = () =&gt; {};                                                                              </pre></div>
<div row="2448"><pre row="2448">2448      <font color="black">359</font>     this.exceptRowSet = new Set();                                                                             <font color="black">345</font>     this.exceptRowSet = new Set();                                                                       </pre></div>
<div row="2449"><pre row="2449">2449      <font color="black">360</font>     this.sortedRowMap = new Map();                                                                             <font color="black">346</font>     this.sortedRowMap = new Map();                                                                       </pre></div>
<div row="2450"><pre row="2450">2450      <font color="black">361</font>     this.unsortedRowMap = new Map();                                                                           <font color="black">347</font>     this.unsortedRowMap = new Map();                                                                     </pre></div>
<div row="2451"><pre row="2451">2451      <font color="black">362</font> <font color="red">    this.h_splitSheets = new Array();</font>                                                                                                                                                                                       </pre></div>
<div row="2452"><pre row="2452">2452      <font color="black">363</font> <font color="red">    this.v_splitSheets = new Array();</font>                                                                                                                                                                                       </pre></div>
<div row="2453"><pre row="2453">2453      <font color="black">364</font>   }                                                                                                            <font color="black">348</font>   }                                                                                                      </pre></div>
<div row="2454"><pre row="2454">2454      <font color="black">365</font>                                                                                                                <font color="black">349</font>                                                                                                          </pre></div>
<div row="2455"><pre row="2455">2455      <font color="black">366</font>   addValidation(mode, ref, validator) {                                                                        <font color="black">350</font>   addValidation(mode, ref, validator) {                                                                  </pre></div>
<div row="2456"><pre row="2456">2456      <font color="black">367</font>     // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);                                   <font color="black">351</font>     // console.log('mode:', mode, ', ref:', ref, ', validator:', validator);                             </pre></div>
<div row="2457"><pre row="2457">2457      <font color="black">368</font>     this.changeData(() =&gt; {                                                                                    <font color="black">352</font>     this.changeData(() =&gt; {                                                                              </pre></div>
<div row="2458"><pre row="2458">2458 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2459"><pre row="2459">2459      <font color="black">435</font>       } else if (clipboard.isCut()) {                                                                          <font color="black">419</font>       } else if (clipboard.isCut()) {                                                                    </pre></div>
<div row="2460"><pre row="2460">2460      <font color="black">436</font>         cutPaste.call(this, clipboard.range, selector.range);                                                  <font color="black">420</font>         cutPaste.call(this, clipboard.range, selector.range);                                            </pre></div>
<div row="2461"><pre row="2461">2461      <font color="black">437</font>       }                                                                                                        <font color="black">421</font>       }                                                                                                  </pre></div>
<div row="2462"><pre row="2462">2462      <font color="black">438</font>     });                                                                                                        <font color="black">422</font>     });                                                                                                  </pre></div>
<div row="2463"><pre row="2463">2463      <font color="black">439</font>     return true;                                                                                               <font color="black">423</font>     return true;                                                                                         </pre></div>
<div row="2464"><pre row="2464">2464                                                                                                                         <font color="black">424</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="2465"><pre row="2465">2465                                                                                                                         <font color="black">425</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2466"><pre row="2466">2466                                                                                                                         <font color="black">426</font> <font color="green">  pasteFromText(txt) {</font>                                                                                   </pre></div>
<div row="2467"><pre row="2467">2467                                                                                                                         <font color="black">427</font> <font color="green">    const lines = txt.split('\r\n').map(it =&gt; it.replace(/"/g, '').split('\t'));</font>                         </pre></div>
<div row="2468"><pre row="2468">2468                                                                                                                         <font color="black">428</font> <font color="green">    if (lines.length &gt; 0) lines.length -= 1;</font>                                                             </pre></div>
<div row="2469"><pre row="2469">2469                                                                                                                         <font color="black">429</font> <font color="green">    const { rows, selector } = this;</font>                                                                     </pre></div>
<div row="2470"><pre row="2470">2470                                                                                                                         <font color="black">430</font> <font color="green">    this.changeData(() =&gt; {</font>                                                                              </pre></div>
<div row="2471"><pre row="2471">2471                                                                                                                         <font color="black">431</font> <font color="green">      rows.paste(lines, selector.range);</font>                                                                 </pre></div>
<div row="2472"><pre row="2472">2472                                                                                                                         <font color="black">432</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="2473"><pre row="2473">2473      <font color="black">440</font>   }                                                                                                            <font color="black">433</font>   }                                                                                                      </pre></div>
<div row="2474"><pre row="2474">2474      <font color="black">441</font>                                                                                                                <font color="black">434</font>                                                                                                          </pre></div>
<div row="2475"><pre row="2475">2475      <font color="black">442</font>   autofill(cellRange, what, error = () =&gt; {}) {                                                                <font color="black">435</font>   autofill(cellRange, what, error = () =&gt; {}) {                                                          </pre></div>
<div row="2476"><pre row="2476">2476      <font color="black">443</font>     const srcRange = this.selector.range;                                                                      <font color="black">436</font>     const srcRange = this.selector.range;                                                                </pre></div>
<div row="2477"><pre row="2477">2477      <font color="black">444</font>     if (!canPaste.call(this, srcRange, cellRange, error)) return false;                                        <font color="black">437</font>     if (!canPaste.call(this, srcRange, cellRange, error)) return false;                                  </pre></div>
<div row="2478"><pre row="2478">2478 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2479"><pre row="2479">2479      <font color="black">504</font>         if (value) this.merge();                                                                               <font color="black">497</font>         if (value) this.merge();                                                                         </pre></div>
<div row="2480"><pre row="2480">2480      <font color="black">505</font>         else this.unmerge();                                                                                   <font color="black">498</font>         else this.unmerge();                                                                             </pre></div>
<div row="2481"><pre row="2481">2481      <font color="black">506</font>       } else if (property === 'border') {                                                                      <font color="black">499</font>       } else if (property === 'border') {                                                                </pre></div>
<div row="2482"><pre row="2482">2482      <font color="black">507</font>         setStyleBorders.call(this, value);                                                                     <font color="black">500</font>         setStyleBorders.call(this, value);                                                               </pre></div>
<div row="2483"><pre row="2483">2483      <font color="black">508</font>       } else if (property === 'formula') {                                                                     <font color="black">501</font>       } else if (property === 'formula') {                                                               </pre></div>
<div row="2484"><pre row="2484">2484                                                                                                                         <font color="black">502</font> <font color="green">        // console.log('&gt;&gt;&gt;', selector.multiple());</font>                                                      </pre></div>
<div row="2485"><pre row="2485">2485                                                                                                                         <font color="black">503</font> <font color="green">        const { ri, ci, range } = selector;</font>                                                              </pre></div>
<div row="2486"><pre row="2486">2486                                                                                                                         <font color="black">504</font> <font color="green">        if (selector.multiple()) {</font>                                                                       </pre></div>
<div row="2487"><pre row="2487">2487                                                                                                                         <font color="black">505</font> <font color="green">          const [rn, cn] = selector.size();</font>                                                              </pre></div>
<div row="2488"><pre row="2488">2488                                                                                                                         <font color="black">506</font> <font color="green">          const {</font>                                                                                        </pre></div>
<div row="2489"><pre row="2489">2489                                                                                                                         <font color="black">507</font> <font color="green">            sri, sci, eri, eci,</font>                                                                          </pre></div>
<div row="2490"><pre row="2490">2490                                                                                                                         <font color="black">508</font> <font color="green">          } = range;</font>                                                                                     </pre></div>
<div row="2491"><pre row="2491">2491                                                                                                                         <font color="black">509</font> <font color="green">          if (rn &gt; 1) {</font>                                                                                  </pre></div>
<div row="2492"><pre row="2492">2492                                                                                                                         <font color="black">510</font> <font color="green">            for (let i = sci; i &lt;= eci; i += 1) {</font>                                                        </pre></div>
<div row="2493"><pre row="2493">2493                                                                                                                         <font color="black">511</font> <font color="green">              const cell = rows.getCellOrNew(eri + 1, i);</font>                                                </pre></div>
<div row="2494"><pre row="2494">2494                                                                                                                         <font color="black">512</font> <font color="green">              cell.text = `=${value}(${xy2expr(i, sri)}:${xy2expr(i, eri)})`;</font>                            </pre></div>
<div row="2495"><pre row="2495">2495                                                                                                                         <font color="black">513</font> <font color="green">            }</font>                                                                                            </pre></div>
<div row="2496"><pre row="2496">2496                                                                                                                         <font color="black">514</font> <font color="green">          } else if (cn &gt; 1) {</font>                                                                           </pre></div>
<div row="2497"><pre row="2497">2497                                                                                                                         <font color="black">515</font> <font color="green">            const cell = rows.getCellOrNew(ri, eci + 1);</font>                                                 </pre></div>
<div row="2498"><pre row="2498">2498                                                                                                                         <font color="black">516</font> <font color="green">            cell.text = `=${value}(${xy2expr(sci, ri)}:${xy2expr(eci, ri)})`;</font>                            </pre></div>
<div row="2499"><pre row="2499">2499                                                                                                                         <font color="black">517</font> <font color="green">          }</font>                                                                                              </pre></div>
<div row="2500"><pre row="2500">2500                                                                                                                         <font color="black">518</font> <font color="green">        } else {</font>                                                                                         </pre></div>
<div row="2501"><pre row="2501">2501      <font color="black">509</font>         const cell = rows.getCellOrNew(<font color="red">selector.</font>ri, <font color="red">selector.</font>ci);                                              <font color="black">519</font> <font color="green">  </font>        const cell = rows.getCellOrNew(ri, ci);                                                        </pre></div>
<div row="2502"><pre row="2502">2502      <font color="black">510</font>         cell.text = `=${value}()`;                                                                             <font color="black">520</font> <font color="green">  </font>        cell.text = `=${value}()`;                                                                     </pre></div>
<div row="2503"><pre row="2503">2503                                                                                                                         <font color="black">521</font> <font color="green">        }</font>                                                                                                </pre></div>
<div row="2504"><pre row="2504">2504      <font color="black">511</font>       } else {                                                                                                 <font color="black">522</font>       } else {                                                                                           </pre></div>
<div row="2505"><pre row="2505">2505      <font color="black">512</font>         selector.range.each((ri, ci) =&gt; {                                                                      <font color="black">523</font>         selector.range.each((ri, ci) =&gt; {                                                                </pre></div>
<div row="2506"><pre row="2506">2506      <font color="black">513</font>           const cell = rows.getCellOrNew(ri, ci);                                                              <font color="black">524</font>           const cell = rows.getCellOrNew(ri, ci);                                                        </pre></div>
<div row="2507"><pre row="2507">2507      <font color="black">514</font>           let cstyle = {};                                                                                     <font color="black">525</font>           let cstyle = {};                                                                               </pre></div>
<div row="2508"><pre row="2508">2508      <font color="black">515</font>           if (cell.style !== undefined) {                                                                      <font color="black">526</font>           if (cell.style !== undefined) {                                                                </pre></div>
<div row="2509"><pre row="2509">2509 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2510"><pre row="2510">2510      <font color="black">528</font>             || property === 'underline'                                                                        <font color="black">539</font>             || property === 'underline'                                                                  </pre></div>
<div row="2511"><pre row="2511">2511      <font color="black">529</font>             || property === 'align' || property === 'valign'                                                   <font color="black">540</font>             || property === 'align' || property === 'valign'                                             </pre></div>
<div row="2512"><pre row="2512">2512      <font color="black">530</font>             || property === 'color' || property === 'bgcolor') {                                               <font color="black">541</font>             || property === 'color' || property === 'bgcolor') {                                         </pre></div>
<div row="2513"><pre row="2513">2513      <font color="black">531</font>             cstyle[property] = value;                                                                          <font color="black">542</font>             cstyle[property] = value;                                                                    </pre></div>
<div row="2514"><pre row="2514">2514      <font color="black">532</font>             cell.style = this.addStyle(cstyle);                                                                <font color="black">543</font>             cell.style = this.addStyle(cstyle);                                                          </pre></div>
<div row="2515"><pre row="2515">2515                                                                                                                         <font color="black">544</font> <font color="green">          } else {</font>                                                                                       </pre></div>
<div row="2516"><pre row="2516">2516                                                                                                                         <font color="black">545</font> <font color="green">            cell[property] = value;</font>                                                                      </pre></div>
<div row="2517"><pre row="2517">2517      <font color="black">533</font>           }                                                                                                    <font color="black">546</font>           }                                                                                              </pre></div>
<div row="2518"><pre row="2518">2518      <font color="black">534</font>         });                                                                                                    <font color="black">547</font>         });                                                                                              </pre></div>
<div row="2519"><pre row="2519">2519      <font color="black">535</font>       }                                                                                                        <font color="black">548</font>       }                                                                                                  </pre></div>
<div row="2520"><pre row="2520">2520      <font color="black">536</font>     });                                                                                                        <font color="black">549</font>     });                                                                                                  </pre></div>
<div row="2521"><pre row="2521">2521      <font color="black">537</font>   }                                                                                                            <font color="black">550</font>   }                                                                                                      </pre></div>
<div row="2522"><pre row="2522">2522      <font color="black">538</font>                                                                                                                <font color="black">551</font>                                                                                                          </pre></div>
<div row="2523"><pre row="2523">2523      <font color="black">539</font>   // state: input | finished                                                                                   <font color="black">552</font>   // state: input | finished                                                                             </pre></div>
<div row="2524"><pre row="2524">2524      <font color="black">540</font>   setSelectedCellText(text, state = 'input') {                                                                 <font color="black">553</font>   setSelectedCellText(text, state = 'input') {                                                           </pre></div>
<div row="2525"><pre row="2525">2525                                                                                                                         <font color="black">554</font> <font color="green">    const { autoFilter, selector, rows } = this;</font>                                                         </pre></div>
<div row="2526"><pre row="2526">2526      <font color="black">541</font>     const { ri, ci } = <font color="red">this.</font>selector;                                                                          <font color="black">555</font>     const { ri, ci } = selector;                                                                         </pre></div>
<div row="2527"><pre row="2527">2527      <font color="black">542</font>     let nri = ri;                                                                                              <font color="black">556</font>     let nri = ri;                                                                                        </pre></div>
<div row="2528"><pre row="2528">2528      <font color="black">543</font>     if (this.unsortedRowMap.has(ri)) {                                                                         <font color="black">557</font>     if (this.unsortedRowMap.has(ri)) {                                                                   </pre></div>
<div row="2529"><pre row="2529">2529      <font color="black">544</font>       nri = this.unsortedRowMap.get(ri);                                                                       <font color="black">558</font>       nri = this.unsortedRowMap.get(ri);                                                                 </pre></div>
<div row="2530"><pre row="2530">2530      <font color="black">545</font>     }                                                                                                          <font color="black">559</font>     }                                                                                                    </pre></div>
<div row="2531"><pre row="2531">2531                                                                                                                         <font color="black">560</font> <font color="green">    const oldCell = rows.getCell(nri, ci);</font>                                                               </pre></div>
<div row="2532"><pre row="2532">2532                                                                                                                         <font color="black">561</font> <font color="green">    const oldText = oldCell ? oldCell.text : '';</font>                                                         </pre></div>
<div row="2533"><pre row="2533">2533      <font color="black">546</font>     this.setCellText(nri, ci, text, state);                                                                    <font color="black">562</font>     this.setCellText(nri, ci, text, state);                                                              </pre></div>
<div row="2534"><pre row="2534">2534                                                                                                                         <font color="black">563</font> <font color="green">    // replace filter.value</font>                                                                              </pre></div>
<div row="2535"><pre row="2535">2535                                                                                                                         <font color="black">564</font> <font color="green">    if (autoFilter.active()) {</font>                                                                           </pre></div>
<div row="2536"><pre row="2536">2536                                                                                                                         <font color="black">565</font> <font color="green">      const filter = autoFilter.getFilter(ci);</font>                                                           </pre></div>
<div row="2537"><pre row="2537">2537                                                                                                                         <font color="black">566</font> <font color="green">      if (filter) {</font>                                                                                      </pre></div>
<div row="2538"><pre row="2538">2538                                                                                                                         <font color="black">567</font> <font color="green">        const vIndex = filter.value.findIndex(v =&gt; v === oldText);</font>                                       </pre></div>
<div row="2539"><pre row="2539">2539                                                                                                                         <font color="black">568</font> <font color="green">        if (vIndex &gt;= 0) {</font>                                                                               </pre></div>
<div row="2540"><pre row="2540">2540                                                                                                                         <font color="black">569</font> <font color="green">          filter.value.splice(vIndex, 1, text);</font>                                                          </pre></div>
<div row="2541"><pre row="2541">2541                                                                                                                         <font color="black">570</font> <font color="green">        }</font>                                                                                                </pre></div>
<div row="2542"><pre row="2542">2542                                                                                                                         <font color="black">571</font> <font color="green">        // console.log('filter:', filter, oldCell);</font>                                                      </pre></div>
<div row="2543"><pre row="2543">2543                                                                                                                         <font color="black">572</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2544"><pre row="2544">2544                                                                                                                         <font color="black">573</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="2545"><pre row="2545">2545      <font color="black">547</font>     this.resetAutoFilter();                                                                                    <font color="black">574</font>    <font color="green"> //</font> this.resetAutoFilter();                                                                           </pre></div>
<div row="2546"><pre row="2546">2546      <font color="black">548</font>   }                                                                                                            <font color="black">575</font>   }                                                                                                      </pre></div>
<div row="2547"><pre row="2547">2547      <font color="black">549</font>                                                                                                                <font color="black">576</font>                                                                                                          </pre></div>
<div row="2548"><pre row="2548">2548      <font color="black">550</font>   getSelectedCell() {                                                                                          <font color="black">577</font>   getSelectedCell() {                                                                                    </pre></div>
<div row="2549"><pre row="2549">2549      <font color="black">551</font>     const { ri, ci } = this.selector;                                                                          <font color="black">578</font>     const { ri, ci } = this.selector;                                                                    </pre></div>
<div row="2550"><pre row="2550">2550      <font color="black">552</font>     let nri = ri;                                                                                              <font color="black">579</font>     let nri = ri;                                                                                        </pre></div>
<div row="2551"><pre row="2551">2551 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2552"><pre row="2552">2552      <font color="black">811</font>       });                                                                                                      <font color="black">838</font>       });                                                                                                </pre></div>
<div row="2553"><pre row="2553">2553      <font color="black">812</font>     });                                                                                                        <font color="black">839</font>     });                                                                                                  </pre></div>
<div row="2554"><pre row="2554">2554      <font color="black">813</font>   }                                                                                                            <font color="black">840</font>   }                                                                                                      </pre></div>
<div row="2555"><pre row="2555">2555      <font color="black">814</font>                                                                                                                <font color="black">841</font>                                                                                                          </pre></div>
<div row="2556"><pre row="2556">2556      <font color="black">815</font>   scrollx(x, cb) {                                                                                             <font color="black">842</font>   scrollx(x, cb) {                                                                                       </pre></div>
<div row="2557"><pre row="2557">2557      <font color="black">816</font> <font color="red">    console.log("scrollx: ");</font>                                                                                                                                                                                               </pre></div>
<div row="2558"><pre row="2558">2558      <font color="black">817</font>     const { scroll, freeze, cols } = this;                                                                     <font color="black">843</font>     const { scroll, freeze, cols } = this;                                                               </pre></div>
<div row="2559"><pre row="2559">2559      <font color="black">818</font>     const [, fci] = freeze;                                                                                    <font color="black">844</font>     const [, fci] = freeze;                                                                              </pre></div>
<div row="2560"><pre row="2560">2560      <font color="black">819</font>     const [                                                                                                    <font color="black">845</font>     const [                                                                                              </pre></div>
<div row="2561"><pre row="2561">2561      <font color="black">820</font>       ci, left, width,                                                                                         <font color="black">846</font>       ci, left, width,                                                                                   </pre></div>
<div row="2562"><pre row="2562">2562      <font color="black">821</font>     ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i =&gt; cols.getWidth(i));                                   <font color="black">847</font>     ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i =&gt; cols.getWidth(i));                             </pre></div>
<div row="2563"><pre row="2563">2563 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2564"><pre row="2564">2564      <font color="black">825</font>     if (scroll.x !== x1) {                                                                                     <font color="black">851</font>     if (scroll.x !== x1) {                                                                               </pre></div>
<div row="2565"><pre row="2565">2565      <font color="black">826</font>       scroll.ci = x &gt; 0 ? ci : 0;                                                                              <font color="black">852</font>       scroll.ci = x &gt; 0 ? ci : 0;                                                                        </pre></div>
<div row="2566"><pre row="2566">2566      <font color="black">827</font>       scroll.x = x1;                                                                                           <font color="black">853</font>       scroll.x = x1;                                                                                     </pre></div>
<div row="2567"><pre row="2567">2567      <font color="black">828</font>       cb();                                                                                                    <font color="black">854</font>       cb();                                                                                              </pre></div>
<div row="2568"><pre row="2568">2568      <font color="black">829</font>     }                                                                                                          <font color="black">855</font>     }                                                                                                    </pre></div>
<div row="2569"><pre row="2569">2569      <font color="black">830</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2570"><pre row="2570">2570      <font color="black">831</font> <font color="red">    this.v_splitSheets.forEach(function(sheet) { </font>                                                                                                                                                                           </pre></div>
<div row="2571"><pre row="2571">2571      <font color="black">832</font> <font color="red">        console.log("movex: ", x);</font>                                                                                                                                                                                          </pre></div>
<div row="2572"><pre row="2572">2572      <font color="black">833</font> <font color="red">       sheet.sync_movex(x); </font>                                                                                                                                                                                                </pre></div>
<div row="2573"><pre row="2573">2573      <font color="black">834</font> <font color="red">     });</font>                                                                                                                                                                                                                    </pre></div>
<div row="2574"><pre row="2574">2574      <font color="black">835</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="2575"><pre row="2575">2575      <font color="black">836</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2576"><pre row="2576">2576      <font color="black">837</font> <font color="red">  sync_scrollx(x, cb) {</font>                                                                                                                                                                                                     </pre></div>
<div row="2577"><pre row="2577">2577      <font color="black">838</font> <font color="red">    const { scroll, freeze, cols } = this;</font>                                                                                                                                                                                  </pre></div>
<div row="2578"><pre row="2578">2578      <font color="black">839</font> <font color="red">    const [, fci] = freeze;</font>                                                                                                                                                                                                 </pre></div>
<div row="2579"><pre row="2579">2579      <font color="black">840</font> <font color="red">    const [</font>                                                                                                                                                                                                                 </pre></div>
<div row="2580"><pre row="2580">2580      <font color="black">841</font> <font color="red">      ci, left, width,</font>                                                                                                                                                                                                      </pre></div>
<div row="2581"><pre row="2581">2581      <font color="black">842</font> <font color="red">    ] = helper.rangeReduceIf(fci, cols.len, 0, 0, x, i =&gt; cols.getWidth(i));</font>                                                                                                                                                </pre></div>
<div row="2582"><pre row="2582">2582      <font color="black">843</font> <font color="red">    // console.log('fci:', fci, ', ci:', ci);</font>                                                                                                                                                                               </pre></div>
<div row="2583"><pre row="2583">2583      <font color="black">844</font> <font color="red">    let x1 = left;</font>                                                                                                                                                                                                          </pre></div>
<div row="2584"><pre row="2584">2584      <font color="black">845</font> <font color="red">    if (x &gt; 0) x1 += width;</font>                                                                                                                                                                                                 </pre></div>
<div row="2585"><pre row="2585">2585      <font color="black">846</font> <font color="red">    if (scroll.x !== x1) {</font>                                                                                                                                                                                                  </pre></div>
<div row="2586"><pre row="2586">2586      <font color="black">847</font> <font color="red">      scroll.ci = x &gt; 0 ? ci : 0;</font>                                                                                                                                                                                           </pre></div>
<div row="2587"><pre row="2587">2587      <font color="black">848</font> <font color="red">      scroll.x = x1;</font>                                                                                                                                                                                                        </pre></div>
<div row="2588"><pre row="2588">2588      <font color="black">849</font> <font color="red">      cb();</font>                                                                                                                                                                                                                 </pre></div>
<div row="2589"><pre row="2589">2589      <font color="black">850</font> <font color="red">    }</font>                                                                                                                                                                                                                       </pre></div>
<div row="2590"><pre row="2590">2590      <font color="black">851</font>   }                                                                                                            <font color="black">856</font>   }                                                                                                      </pre></div>
<div row="2591"><pre row="2591">2591      <font color="black">852</font>                                                                                                                <font color="black">857</font>                                                                                                          </pre></div>
<div row="2592"><pre row="2592">2592      <font color="black">853</font>   scrolly(y, cb) {                                                                                             <font color="black">858</font>   scrolly(y, cb) {                                                                                       </pre></div>
<div row="2593"><pre row="2593">2593      <font color="black">854</font> <font color="red">    console.log("scrolly: ");</font>                                                                                                                                                                                               </pre></div>
<div row="2594"><pre row="2594">2594      <font color="black">855</font>     const { scroll, freeze, rows } = this;                                                                     <font color="black">859</font>     const { scroll, freeze, rows } = this;                                                               </pre></div>
<div row="2595"><pre row="2595">2595      <font color="black">856</font>     const [fri] = freeze;                                                                                      <font color="black">860</font>     const [fri] = freeze;                                                                                </pre></div>
<div row="2596"><pre row="2596">2596      <font color="black">857</font>     const [                                                                                                    <font color="black">861</font>     const [                                                                                              </pre></div>
<div row="2597"><pre row="2597">2597      <font color="black">858</font>       ri, top, height,                                                                                         <font color="black">862</font>       ri, top, height,                                                                                   </pre></div>
<div row="2598"><pre row="2598">2598      <font color="black">859</font>     ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i =&gt; rows.getHeight(i));                                  <font color="black">863</font>     ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i =&gt; rows.getHeight(i));                            </pre></div>
<div row="2599"><pre row="2599">2599 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2600"><pre row="2600">2600      <font color="black">863</font>     if (scroll.y !== y1) {                                                                                     <font color="black">867</font>     if (scroll.y !== y1) {                                                                               </pre></div>
<div row="2601"><pre row="2601">2601      <font color="black">864</font>       scroll.ri = y &gt; 0 ? ri : 0;                                                                              <font color="black">868</font>       scroll.ri = y &gt; 0 ? ri : 0;                                                                        </pre></div>
<div row="2602"><pre row="2602">2602      <font color="black">865</font>       scroll.y = y1;                                                                                           <font color="black">869</font>       scroll.y = y1;                                                                                     </pre></div>
<div row="2603"><pre row="2603">2603      <font color="black">866</font>       cb();                                                                                                    <font color="black">870</font>       cb();                                                                                              </pre></div>
<div row="2604"><pre row="2604">2604      <font color="black">867</font>     }                                                                                                          <font color="black">871</font>     }                                                                                                    </pre></div>
<div row="2605"><pre row="2605">2605      <font color="black">868</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2606"><pre row="2606">2606      <font color="black">869</font> <font color="red">   this.h_splitSheets.forEach(function(sheet) {</font>                                                                                                                                                                             </pre></div>
<div row="2607"><pre row="2607">2607      <font color="black">870</font> <font color="red">      console.log("movey: ", y);</font>                                                                                                                                                                                            </pre></div>
<div row="2608"><pre row="2608">2608      <font color="black">871</font> <font color="red">     sheet.sync_movey(y);</font>                                                                                                                                                                                                   </pre></div>
<div row="2609"><pre row="2609">2609      <font color="black">872</font> <font color="red">    });</font>                                                                                                                                                                                                                     </pre></div>
<div row="2610"><pre row="2610">2610      <font color="black">873</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="2611"><pre row="2611">2611      <font color="black">874</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2612"><pre row="2612">2612      <font color="black">875</font> <font color="red">  sync_scrolly(y, cb) {</font>                                                                                                                                                                                                     </pre></div>
<div row="2613"><pre row="2613">2613      <font color="black">876</font> <font color="red">    const { scroll, freeze, rows } = this;</font>                                                                                                                                                                                  </pre></div>
<div row="2614"><pre row="2614">2614      <font color="black">877</font> <font color="red">    const [fri] = freeze;</font>                                                                                                                                                                                                   </pre></div>
<div row="2615"><pre row="2615">2615      <font color="black">878</font> <font color="red">    const [</font>                                                                                                                                                                                                                 </pre></div>
<div row="2616"><pre row="2616">2616      <font color="black">879</font> <font color="red">      ri, top, height,</font>                                                                                                                                                                                                      </pre></div>
<div row="2617"><pre row="2617">2617      <font color="black">880</font> <font color="red">    ] = helper.rangeReduceIf(fri, rows.len, 0, 0, y, i =&gt; rows.getHeight(i));</font>                                                                                                                                               </pre></div>
<div row="2618"><pre row="2618">2618      <font color="black">881</font> <font color="red">    let y1 = top;</font>                                                                                                                                                                                                           </pre></div>
<div row="2619"><pre row="2619">2619      <font color="black">882</font> <font color="red">    if (y &gt; 0) y1 += height;</font>                                                                                                                                                                                                </pre></div>
<div row="2620"><pre row="2620">2620      <font color="black">883</font> <font color="red">    // console.log('ri:', ri, ' ,y:', y1);</font>                                                                                                                                                                                  </pre></div>
<div row="2621"><pre row="2621">2621      <font color="black">884</font> <font color="red">    if (scroll.y !== y1) {</font>                                                                                                                                                                                                  </pre></div>
<div row="2622"><pre row="2622">2622      <font color="black">885</font> <font color="red">      scroll.ri = y &gt; 0 ? ri : 0;</font>                                                                                                                                                                                           </pre></div>
<div row="2623"><pre row="2623">2623      <font color="black">886</font> <font color="red">      scroll.y = y1;</font>                                                                                                                                                                                                        </pre></div>
<div row="2624"><pre row="2624">2624      <font color="black">887</font> <font color="red">      cb();</font>                                                                                                                                                                                                                 </pre></div>
<div row="2625"><pre row="2625">2625      <font color="black">888</font> <font color="red">  </font>  }                                                                                                          <font color="black">872</font>   }                                                                                                      </pre></div>
<div row="2626"><pre row="2626">2626      <font color="black">889</font> <font color="red">  }</font>                                                                                                            <font color="black">873</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2627"><pre row="2627">2627      <font color="black">890</font>   cellRect(ri, ci) {                                                                                           <font color="black">874</font>   cellRect(ri, ci) {                                                                                     </pre></div>
<div row="2628"><pre row="2628">2628      <font color="black">891</font>     const { rows, cols } = this;                                                                               <font color="black">875</font>     const { rows, cols } = this;                                                                         </pre></div>
<div row="2629"><pre row="2629">2629      <font color="black">892</font>     const left = cols.sumWidth(0, ci);                                                                         <font color="black">876</font>     const left = cols.sumWidth(0, ci);                                                                   </pre></div>
<div row="2630"><pre row="2630">2630      <font color="black">893</font>     const top = rows.sumHeight(0, ri);                                                                         <font color="black">877</font>     const top = rows.sumHeight(0, ri);                                                                   </pre></div>
<div row="2631"><pre row="2631">2631      <font color="black">894</font>     const cell = rows.getCell(ri, ci);                                                                         <font color="black">878</font>     const cell = rows.getCell(ri, ci);                                                                   </pre></div>
<div row="2632"><pre row="2632">2632 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2633"><pre row="2633">2633      <font color="black">949</font>   setCellText(ri, ci, text, state) {                                                                           <font color="black">933</font>   setCellText(ri, ci, text, state) {                                                                     </pre></div>
<div row="2634"><pre row="2634">2634      <font color="black">950</font>     const { rows, history, validations } = this;                                                               <font color="black">934</font>     const { rows, history, validations } = this;                                                         </pre></div>
<div row="2635"><pre row="2635">2635      <font color="black">951</font>     if (state === 'finished') {                                                                                <font color="black">935</font>     if (state === 'finished') {                                                                          </pre></div>
<div row="2636"><pre row="2636">2636      <font color="black">952</font>       rows.setCellText(ri, ci, '');                                                                            <font color="black">936</font>       rows.setCellText(ri, ci, '');                                                                      </pre></div>
<div row="2637"><pre row="2637">2637      <font color="black">953</font>       history.add(this.getData());                                                                             <font color="black">937</font>       history.add(this.getData());                                                                       </pre></div>
<div row="2638"><pre row="2638">2638      <font color="black">954</font>       <font color="red">//</font>rows.setCellText(ri, ci, text);                                                                        <font color="black">938</font>       rows.setCellText(ri, ci, text);                                                                    </pre></div>
<div row="2639"><pre row="2639">2639      <font color="black">955</font> <font color="red">      //console.log("*** setCellText: ", text);</font>                                                                                                                                                                             </pre></div>
<div row="2640"><pre row="2640">2640      <font color="black">956</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2641"><pre row="2641">2641      <font color="black">957</font> <font color="red">      this.changeData(() =&gt; { </font>                                                                                                                                                                                              </pre></div>
<div row="2642"><pre row="2642">2642      <font color="black">958</font> <font color="red">         this.rows.setCellText(ri, ci, text);</font>                                                                                                                                                                               </pre></div>
<div row="2643"><pre row="2643">2643      <font color="black">959</font> <font color="red">      }); </font>                                                                                                                                                                                                                  </pre></div>
<div row="2644"><pre row="2644">2644      <font color="black">960</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2645"><pre row="2645">2645      <font color="black">961</font>     } else {                                                                                                   <font color="black">939</font>     } else {                                                                                             </pre></div>
<div row="2646"><pre row="2646">2646      <font color="black">962</font>       rows.setCellText(ri, ci, text);                                                                          <font color="black">940</font>       rows.setCellText(ri, ci, text);                                                                    </pre></div>
<div row="2647"><pre row="2647">2647      <font color="black">963</font>       this.change(this.getData());                                                                             <font color="black">941</font>       this.change(this.getData());                                                                       </pre></div>
<div row="2648"><pre row="2648">2648      <font color="black">964</font>     }                                                                                                          <font color="black">942</font>     }                                                                                                    </pre></div>
<div row="2649"><pre row="2649">2649      <font color="black">965</font>     // validator                                                                                               <font color="black">943</font>     // validator                                                                                         </pre></div>
<div row="2650"><pre row="2650">2650 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2651"><pre row="2651">2651      <font color="black">984</font>   freezeTotalHeight() {                                                                                        <font color="black">962</font>   freezeTotalHeight() {                                                                                  </pre></div>
<div row="2652"><pre row="2652">2652      <font color="black">985</font>     return this.rows.sumHeight(0, this.freeze[0]);                                                             <font color="black">963</font>     return this.rows.sumHeight(0, this.freeze[0]);                                                       </pre></div>
<div row="2653"><pre row="2653">2653      <font color="black">986</font>   }                                                                                                            <font color="black">964</font>   }                                                                                                      </pre></div>
<div row="2654"><pre row="2654">2654      <font color="black">987</font>                                                                                                                <font color="black">965</font>                                                                                                          </pre></div>
<div row="2655"><pre row="2655">2655      <font color="black">988</font>   setRowHeight(ri, height) {                                                                                   <font color="black">966</font>   setRowHeight(ri, height) {                                                                             </pre></div>
<div row="2656"><pre row="2656">2656      <font color="black">989</font> <font color="red">//    console.log("setRowHeight");</font>                                                                                                                                                                                          </pre></div>
<div row="2657"><pre row="2657">2657      <font color="black">990</font>     this.changeData(() =&gt; {                                                                                    <font color="black">967</font>     this.changeData(() =&gt; {                                                                              </pre></div>
<div row="2658"><pre row="2658">2658      <font color="black">991</font>       this.rows.setHeight(ri, height);                                                                         <font color="black">968</font>       this.rows.setHeight(ri, height);                                                                   </pre></div>
<div row="2659"><pre row="2659">2659      <font color="black">992</font>     });                                                                                                        <font color="black">969</font>     });                                                                                                  </pre></div>
<div row="2660"><pre row="2660">2660      <font color="black">993</font>   }                                                                                                            <font color="black">970</font>   }                                                                                                      </pre></div>
<div row="2661"><pre row="2661">2661      <font color="black">994</font>                                                                                                                <font color="black">971</font>                                                                                                          </pre></div>
<div row="2662"><pre row="2662">2662      <font color="black">995</font>   setColWidth(ci, width) {                                                                                     <font color="black">972</font>   setColWidth(ci, width) {                                                                               </pre></div>
<div row="2663"><pre row="2663">2663      <font color="black">996</font> <font color="red">//    console.log("setColWidth");</font>                                                                                                                                                                                           </pre></div>
<div row="2664"><pre row="2664">2664      <font color="black">997</font>     this.changeData(() =&gt; {                                                                                    <font color="black">973</font>     this.changeData(() =&gt; {                                                                              </pre></div>
<div row="2665"><pre row="2665">2665      <font color="black">998</font>       this.cols.setWidth(ci, width);                                                                           <font color="black">974</font>       this.cols.setWidth(ci, width);                                                                     </pre></div>
<div row="2666"><pre row="2666">2666      <font color="black">999</font>     });                                                                                                        <font color="black">975</font>     });                                                                                                  </pre></div>
<div row="2667"><pre row="2667">2667     <font color="black">1000</font>   }                                                                                                            <font color="black">976</font>   }                                                                                                      </pre></div>
<div row="2668"><pre row="2668">2668     <font color="black">1001</font>                                                                                                                <font color="black">977</font>                                                                                                          </pre></div>
<div row="2669"><pre row="2669">2669     <font color="black">1002</font>   viewHeight() {                                                                                               <font color="black">978</font>   viewHeight() {                                                                                         </pre></div>
<div row="2670"><pre row="2670">2670     <font color="black">1003</font>     const { view, showToolbar } = this.settings;                                                               <font color="black">979</font>     const { view, showToolbar } = this.settings;                                                         </pre></div>
<div row="2671"><pre row="2671">2671     <font color="black">1004</font>     let h = view.height();                                                                                     <font color="black">980</font>     let h = view.height();                                                                               </pre></div>
<div row="2672"><pre row="2672">2672                                                                                                                         <font color="black">981</font> <font color="green">    h -= bottombarHeight;</font>                                                                                </pre></div>
<div row="2673"><pre row="2673">2673     <font color="black">1005</font>     if (showToolbar) {                                                                                         <font color="black">982</font>     if (showToolbar) {                                                                                   </pre></div>
<div row="2674"><pre row="2674">2674     <font color="black">1006</font>       h -= toolbarHeight;                                                                                      <font color="black">983</font>       h -= toolbarHeight;                                                                                </pre></div>
<div row="2675"><pre row="2675">2675     <font color="black">1007</font>     }                                                                                                          <font color="black">984</font>     }                                                                                                    </pre></div>
<div row="2676"><pre row="2676">2676     <font color="black">1008</font>     return h;                                                                                                  <font color="black">985</font>     return h;                                                                                            </pre></div>
<div row="2677"><pre row="2677">2677     <font color="black">1009</font>   }                                                                                                            <font color="black">986</font>   }                                                                                                      </pre></div>
<div row="2678"><pre row="2678">2678 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2679"><pre row="2679">2679     <font color="black">1015</font>   freezeViewRange() {                                                                                          <font color="black">992</font>   freezeViewRange() {                                                                                    </pre></div>
<div row="2680"><pre row="2680">2680     <font color="black">1016</font>     const [ri, ci] = this.freeze;                                                                              <font color="black">993</font>     const [ri, ci] = this.freeze;                                                                        </pre></div>
<div row="2681"><pre row="2681">2681     <font color="black">1017</font>     return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());             <font color="black">994</font>     return new CellRange(0, 0, ri - 1, ci - 1, this.freezeTotalWidth(), this.freezeTotalHeight());       </pre></div>
<div row="2682"><pre row="2682">2682     <font color="black">1018</font>   }                                                                                                            <font color="black">995</font>   }                                                                                                      </pre></div>
<div row="2683"><pre row="2683">2683     <font color="black">1019</font>                                                                                                                <font color="black">996</font>                                                                                                          </pre></div>
<div row="2684"><pre row="2684">2684                                                                                                                         <font color="black">997</font> <font color="green">  contentRange() {</font>                                                                                       </pre></div>
<div row="2685"><pre row="2685">2685                                                                                                                         <font color="black">998</font> <font color="green">    const { rows, cols } = this;</font>                                                                         </pre></div>
<div row="2686"><pre row="2686">2686                                                                                                                         <font color="black">999</font> <font color="green">    const [ri, ci] = rows.maxCell();</font>                                                                     </pre></div>
<div row="2687"><pre row="2687">2687                                                                                                                        <font color="black">1000</font> <font color="green">    const h = rows.sumHeight(0, ri + 1);</font>                                                                 </pre></div>
<div row="2688"><pre row="2688">2688                                                                                                                        <font color="black">1001</font> <font color="green">    const w = cols.sumWidth(0, ci + 1);</font>                                                                  </pre></div>
<div row="2689"><pre row="2689">2689                                                                                                                        <font color="black">1002</font> <font color="green">    return new CellRange(0, 0, ri, ci, w, h);</font>                                                            </pre></div>
<div row="2690"><pre row="2690">2690                                                                                                                        <font color="black">1003</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="2691"><pre row="2691">2691                                                                                                                        <font color="black">1004</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2692"><pre row="2692">2692                                                                                                                        <font color="black">1005</font> <font color="green">  exceptRowTotalHeight(sri, eri) {</font>                                                                       </pre></div>
<div row="2693"><pre row="2693">2693                                                                                                                        <font color="black">1006</font> <font color="green">    const { exceptRowSet, rows } = this;</font>                                                                 </pre></div>
<div row="2694"><pre row="2694">2694                                                                                                                        <font color="black">1007</font> <font color="green">    const exceptRows = Array.from(exceptRowSet);</font>                                                         </pre></div>
<div row="2695"><pre row="2695">2695                                                                                                                        <font color="black">1008</font> <font color="green">    let exceptRowTH = 0;</font>                                                                                 </pre></div>
<div row="2696"><pre row="2696">2696                                                                                                                        <font color="black">1009</font> <font color="green">    exceptRows.forEach((ri) =&gt; {</font>                                                                         </pre></div>
<div row="2697"><pre row="2697">2697                                                                                                                        <font color="black">1010</font> <font color="green">      if (ri &lt; sri || ri &gt; eri) {</font>                                                                        </pre></div>
<div row="2698"><pre row="2698">2698                                                                                                                        <font color="black">1011</font> <font color="green">        const height = rows.getHeight(ri);</font>                                                               </pre></div>
<div row="2699"><pre row="2699">2699                                                                                                                        <font color="black">1012</font> <font color="green">        exceptRowTH += height;</font>                                                                           </pre></div>
<div row="2700"><pre row="2700">2700                                                                                                                        <font color="black">1013</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2701"><pre row="2701">2701                                                                                                                        <font color="black">1014</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="2702"><pre row="2702">2702                                                                                                                        <font color="black">1015</font> <font color="green">    return exceptRowTH;</font>                                                                                  </pre></div>
<div row="2703"><pre row="2703">2703                                                                                                                        <font color="black">1016</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="2704"><pre row="2704">2704                                                                                                                        <font color="black">1017</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2705"><pre row="2705">2705     <font color="black">1020</font>   viewRange() {                                                                                               <font color="black">1018</font>   viewRange() {                                                                                          </pre></div>
<div row="2706"><pre row="2706">2706     <font color="black">1021</font>     const {                                                                                                   <font color="black">1019</font>     const {                                                                                              </pre></div>
<div row="2707"><pre row="2707">2707     <font color="black">1022</font>       scroll, rows, cols, freeze,                                                                             <font color="black">1020</font>       scroll, rows, cols, freeze,<font color="green"> exceptRowSet,</font>                                                          </pre></div>
<div row="2708"><pre row="2708">2708     <font color="black">1023</font>     } = this;                                                                                                 <font color="black">1021</font>     } = this;                                                                                            </pre></div>
<div row="2709"><pre row="2709">2709     <font color="black">1024</font>     let { ri, ci } = scroll;                                                                                  <font color="black">1022</font>     let { ri, ci } = scroll;                                                                             </pre></div>
<div row="2710"><pre row="2710">2710     <font color="black">1025</font>     if (ri &lt;= 0) [ri] = freeze;                                                                               <font color="black">1023</font>     if (ri &lt;= 0) [ri] = freeze;                                                                          </pre></div>
<div row="2711"><pre row="2711">2711     <font color="black">1026</font>     if (ci &lt;= 0) [, ci] = freeze;                                                                             <font color="black">1024</font>     if (ci &lt;= 0) [, ci] = freeze;                                                                        </pre></div>
<div row="2712"><pre row="2712">2712     <font color="black">1027</font>                                                                                                               <font color="black">1025</font>                                                                                                          </pre></div>
<div row="2713"><pre row="2713">2713     <font color="black">1028</font>     let [x, y] = [0, 0];                                                                                      <font color="black">1026</font>     let [x, y] = [0, 0];                                                                                 </pre></div>
<div row="2714"><pre row="2714">2714     <font color="black">1029</font>     let [eri, eci] = [rows.len, cols.len];                                                                    <font color="black">1027</font>     let [eri, eci] = [rows.len, cols.len];                                                               </pre></div>
<div row="2715"><pre row="2715">2715     <font color="black">1030</font>     for (let i = ri; i &lt; rows.len; i += 1) {                                                                  <font color="black">1028</font>     for (let i = ri; i &lt; rows.len; i += 1) {                                                             </pre></div>
<div row="2716"><pre row="2716">2716                                                                                                                        <font color="black">1029</font> <font color="green">      if (!exceptRowSet.has(i)) {</font>                                                                        </pre></div>
<div row="2717"><pre row="2717">2717     <font color="black">1031</font>       y += rows.getHeight(i);                                                                                 <font color="black">1030</font> <font color="green">  </font>      y += rows.getHeight(i);                                                                          </pre></div>
<div row="2718"><pre row="2718">2718     <font color="black">1032</font>       eri = i;                                                                                                <font color="black">1031</font> <font color="green">  </font>      eri = i;                                                                                         </pre></div>
<div row="2719"><pre row="2719">2719                                                                                                                        <font color="black">1032</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2720"><pre row="2720">2720     <font color="black">1033</font>       if (y &gt; this.viewHeight()) break;                                                                       <font color="black">1033</font>       if (y &gt; this.viewHeight()) break;                                                                  </pre></div>
<div row="2721"><pre row="2721">2721     <font color="black">1034</font>     }                                                                                                         <font color="black">1034</font>     }                                                                                                    </pre></div>
<div row="2722"><pre row="2722">2722     <font color="black">1035</font>     for (let j = ci; j &lt; cols.len; j += 1) {                                                                  <font color="black">1035</font>     for (let j = ci; j &lt; cols.len; j += 1) {                                                             </pre></div>
<div row="2723"><pre row="2723">2723     <font color="black">1036</font>       x += cols.getWidth(j);                                                                                  <font color="black">1036</font>       x += cols.getWidth(j);                                                                             </pre></div>
<div row="2724"><pre row="2724">2724     <font color="black">1037</font>       eci = j;                                                                                                <font color="black">1037</font>       eci = j;                                                                                           </pre></div>
<div row="2725"><pre row="2725">2725 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2726"><pre row="2726">2726     <font color="black">1042</font>   }                                                                                                           <font color="black">1042</font>   }                                                                                                      </pre></div>
<div row="2727"><pre row="2727">2727     <font color="black">1043</font>                                                                                                               <font color="black">1043</font>                                                                                                          </pre></div>
<div row="2728"><pre row="2728">2728     <font color="black">1044</font>   eachMergesInView(viewRange, cb) {                                                                           <font color="black">1044</font>   eachMergesInView(viewRange, cb) {                                                                      </pre></div>
<div row="2729"><pre row="2729">2729     <font color="black">1045</font>     this.merges.filterIntersects(viewRange)                                                                   <font color="black">1045</font>     this.merges.filterIntersects(viewRange)                                                              </pre></div>
<div row="2730"><pre row="2730">2730     <font color="black">1046</font>       .forEach(it =&gt; cb(it));                                                                                 <font color="black">1046</font>       .forEach(it =&gt; cb(it));                                                                            </pre></div>
<div row="2731"><pre row="2731">2731                                                                                                                        <font color="black">1047</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="2732"><pre row="2732">2732                                                                                                                        <font color="black">1048</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2733"><pre row="2733">2733                                                                                                                        <font color="black">1049</font> <font color="green">  hideRowsOrCols() {</font>                                                                                     </pre></div>
<div row="2734"><pre row="2734">2734                                                                                                                        <font color="black">1050</font> <font color="green">    const { rows, cols, selector } = this;</font>                                                               </pre></div>
<div row="2735"><pre row="2735">2735                                                                                                                        <font color="black">1051</font> <font color="green">    const [rlen, clen] = selector.size();</font>                                                                </pre></div>
<div row="2736"><pre row="2736">2736                                                                                                                        <font color="black">1052</font> <font color="green">    const {</font>                                                                                              </pre></div>
<div row="2737"><pre row="2737">2737                                                                                                                        <font color="black">1053</font> <font color="green">      sri, sci, eri, eci,</font>                                                                                </pre></div>
<div row="2738"><pre row="2738">2738                                                                                                                        <font color="black">1054</font> <font color="green">    } = selector.range;</font>                                                                                  </pre></div>
<div row="2739"><pre row="2739">2739                                                                                                                        <font color="black">1055</font> <font color="green">    if (rlen === rows.len) {</font>                                                                             </pre></div>
<div row="2740"><pre row="2740">2740                                                                                                                        <font color="black">1056</font> <font color="green">      for (let ci = sci; ci &lt;= eci; ci += 1) {</font>                                                           </pre></div>
<div row="2741"><pre row="2741">2741                                                                                                                        <font color="black">1057</font> <font color="green">        cols.setHide(ci, true);</font>                                                                          </pre></div>
<div row="2742"><pre row="2742">2742                                                                                                                        <font color="black">1058</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2743"><pre row="2743">2743                                                                                                                        <font color="black">1059</font> <font color="green">    } else if (clen === cols.len) {</font>                                                                      </pre></div>
<div row="2744"><pre row="2744">2744                                                                                                                        <font color="black">1060</font> <font color="green">      for (let ri = sri; ri &lt;= eri; ri += 1) {</font>                                                           </pre></div>
<div row="2745"><pre row="2745">2745                                                                                                                        <font color="black">1061</font> <font color="green">        rows.setHide(ri, true);</font>                                                                          </pre></div>
<div row="2746"><pre row="2746">2746                                                                                                                        <font color="black">1062</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2747"><pre row="2747">2747                                                                                                                        <font color="black">1063</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="2748"><pre row="2748">2748                                                                                                                        <font color="black">1064</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="2749"><pre row="2749">2749                                                                                                                        <font color="black">1065</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2750"><pre row="2750">2750                                                                                                                        <font color="black">1066</font> <font color="green">  // type: row | col</font>                                                                                     </pre></div>
<div row="2751"><pre row="2751">2751                                                                                                                        <font color="black">1067</font> <font color="green">  // index row-index | col-index</font>                                                                         </pre></div>
<div row="2752"><pre row="2752">2752                                                                                                                        <font color="black">1068</font> <font color="green">  unhideRowsOrCols(type, index) {</font>                                                                        </pre></div>
<div row="2753"><pre row="2753">2753                                                                                                                        <font color="black">1069</font> <font color="green">    this[`${type}s`].unhide(index);</font>                                                                      </pre></div>
<div row="2754"><pre row="2754">2754     <font color="black">1047</font>   }                                                                                                           <font color="black">1070</font>   }                                                                                                      </pre></div>
<div row="2755"><pre row="2755">2755     <font color="black">1048</font>                                                                                                               <font color="black">1071</font>                                                                                                          </pre></div>
<div row="2756"><pre row="2756">2756     <font color="black">1049</font>   rowEach(min, max, cb) {                                                                                     <font color="black">1072</font>   rowEach(min, max, cb) {                                                                                </pre></div>
<div row="2757"><pre row="2757">2757     <font color="black">1050</font>     let y = 0;                                                                                                <font color="black">1073</font>     let y = 0;                                                                                           </pre></div>
<div row="2758"><pre row="2758">2758     <font color="black">1051</font>     const { rows } = this;                                                                                    <font color="black">1074</font>     const { rows } = this;                                                                               </pre></div>
<div row="2759"><pre row="2759">2759     <font color="black">1052</font>     const frset = this.exceptRowSet;                                                                          <font color="black">1075</font>     const frset = this.exceptRowSet;                                                                     </pre></div>
<div row="2760"><pre row="2760">2760     <font color="black">1053</font>     const frary = [...frset];                                                                                 <font color="black">1076</font>     const frary = [...frset];                                                                            </pre></div>
<div row="2761"><pre row="2761">2761     <font color="black">1054</font>     let offset = 0;                                                                                           <font color="black">1077</font>     let offset = 0;                                                                                      </pre></div>
<div row="2762"><pre row="2762">2762     <font color="black">1055</font>     for (let i = 0; i &lt; frary.length; i += 1) {                                                               <font color="black">1078</font>     for (let i = 0; i &lt; frary.length; i += 1) {                                                          </pre></div>
<div row="2763"><pre row="2763">2763     <font color="black">1056</font>       if (frary[i] &lt; min) <font color="orange">offset += 1;</font>                                                                        <font color="black">1079</font>       if (frary[i] &lt; min) <font color="orange">{</font>                                                                              </pre></div>
<div row="2764"><pre row="2764">2764                                                                                                                        <font color="black">1080</font> <font color="green">        offset += 1;</font>                                                                                     </pre></div>
<div row="2765"><pre row="2765">2765                                                                                                                        <font color="black">1081</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2766"><pre row="2766">2766     <font color="black">1057</font>     }                                                                                                         <font color="black">1082</font>     }                                                                                                    </pre></div>
<div row="2767"><pre row="2767">2767     <font color="black">1058</font>     // console.log('min:', min, ', max:', max, ', scroll:', scroll);                                          <font color="black">1083</font>     // console.log('min:', min, ', max:', max, ', scroll:', scroll);                                     </pre></div>
<div row="2768"><pre row="2768">2768     <font color="black">1059</font>     for (let i = min + offset; i &lt;= max + offset; i += 1) {                                                   <font color="black">1084</font>     for (let i = min + offset; i &lt;= max + offset; i += 1) {                                              </pre></div>
<div row="2769"><pre row="2769">2769     <font color="black">1060</font>       if (frset.has(i)) {                                                                                     <font color="black">1085</font>       if (frset.has(i)) {                                                                                </pre></div>
<div row="2770"><pre row="2770">2770     <font color="black">1061</font>         offset += 1;                                                                                          <font color="black">1086</font>         offset += 1;                                                                                     </pre></div>
<div row="2771"><pre row="2771">2771     <font color="black">1062</font>       } else {                                                                                                <font color="black">1087</font>       } else {                                                                                           </pre></div>
<div row="2772"><pre row="2772">2772     <font color="black">1063</font>         const rowHeight = rows.getHeight(i);                                                                  <font color="black">1088</font>         const rowHeight = rows.getHeight(i);                                                             </pre></div>
<div row="2773"><pre row="2773">2773                                                                                                                        <font color="black">1089</font> <font color="green">        if (rowHeight &gt; 0) {</font>                                                                             </pre></div>
<div row="2774"><pre row="2774">2774     <font color="black">1064</font>         cb(i, y, rowHeight);                                                                                  <font color="black">1090</font> <font color="green">  </font>        cb(i, y, rowHeight);                                                                           </pre></div>
<div row="2775"><pre row="2775">2775     <font color="black">1065</font>         y += rowHeight;                                                                                       <font color="black">1091</font> <font color="green">  </font>        y += rowHeight;                                                                                </pre></div>
<div row="2776"><pre row="2776">2776     <font color="black">1066</font>         if (y &gt; this.viewHeight()) break;                                                                     <font color="black">1092</font> <font color="green">  </font>        if (y &gt; this.viewHeight()) break;                                                              </pre></div>
<div row="2777"><pre row="2777">2777                                                                                                                        <font color="black">1093</font> <font color="green">        }</font>                                                                                                </pre></div>
<div row="2778"><pre row="2778">2778     <font color="black">1067</font>       }                                                                                                       <font color="black">1094</font>       }                                                                                                  </pre></div>
<div row="2779"><pre row="2779">2779     <font color="black">1068</font>     }                                                                                                         <font color="black">1095</font>     }                                                                                                    </pre></div>
<div row="2780"><pre row="2780">2780     <font color="black">1069</font>   }                                                                                                           <font color="black">1096</font>   }                                                                                                      </pre></div>
<div row="2781"><pre row="2781">2781     <font color="black">1070</font>                                                                                                               <font color="black">1097</font>                                                                                                          </pre></div>
<div row="2782"><pre row="2782">2782     <font color="black">1071</font>   colEach(min, max, cb) {                                                                                     <font color="black">1098</font>   colEach(min, max, cb) {                                                                                </pre></div>
<div row="2783"><pre row="2783">2783     <font color="black">1072</font>     let x = 0;                                                                                                <font color="black">1099</font>     let x = 0;                                                                                           </pre></div>
<div row="2784"><pre row="2784">2784     <font color="black">1073</font>     const { cols } = this;                                                                                    <font color="black">1100</font>     const { cols } = this;                                                                               </pre></div>
<div row="2785"><pre row="2785">2785     <font color="black">1074</font>     for (let i = min; i &lt;= max; i += 1) {                                                                     <font color="black">1101</font>     for (let i = min; i &lt;= max; i += 1) {                                                                </pre></div>
<div row="2786"><pre row="2786">2786     <font color="black">1075</font>       const colWidth = cols.getWidth(i);                                                                      <font color="black">1102</font>       const colWidth = cols.getWidth(i);                                                                 </pre></div>
<div row="2787"><pre row="2787">2787                                                                                                                        <font color="black">1103</font> <font color="green">      if (colWidth &gt; 0) {</font>                                                                                </pre></div>
<div row="2788"><pre row="2788">2788     <font color="black">1076</font>       cb(i, x, colWidth);                                                                                     <font color="black">1104</font> <font color="green">  </font>      cb(i, x, colWidth);                                                                              </pre></div>
<div row="2789"><pre row="2789">2789     <font color="black">1077</font>       x += colWidth;                                                                                          <font color="black">1105</font> <font color="green">  </font>      x += colWidth;                                                                                   </pre></div>
<div row="2790"><pre row="2790">2790     <font color="black">1078</font>       if (x &gt; this.viewWidth()) break;                                                                        <font color="black">1106</font> <font color="green">  </font>      if (x &gt; this.viewWidth()) break;                                                                 </pre></div>
<div row="2791"><pre row="2791">2791                                                                                                                        <font color="black">1107</font> <font color="green">      }</font>                                                                                                  </pre></div>
<div row="2792"><pre row="2792">2792     <font color="black">1079</font>     }                                                                                                         <font color="black">1108</font>     }                                                                                                    </pre></div>
<div row="2793"><pre row="2793">2793     <font color="black">1080</font>   }                                                                                                           <font color="black">1109</font>   }                                                                                                      </pre></div>
<div row="2794"><pre row="2794">2794     <font color="black">1081</font>                                                                                                               <font color="black">1110</font>                                                                                                          </pre></div>
<div row="2795"><pre row="2795">2795     <font color="black">1082</font>   defaultStyle() {                                                                                            <font color="black">1111</font>   defaultStyle() {                                                                                       </pre></div>
<div row="2796"><pre row="2796">2796     <font color="black">1083</font>     return this.settings.style;                                                                               <font color="black">1112</font>     return this.settings.style;                                                                          </pre></div>
<div row="2797"><pre row="2797">2797 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2798"><pre row="2798">2798     <font color="black">1093</font>     styles.push(nstyle);                                                                                      <font color="black">1122</font>     styles.push(nstyle);                                                                                 </pre></div>
<div row="2799"><pre row="2799">2799     <font color="black">1094</font>     return styles.length - 1;                                                                                 <font color="black">1123</font>     return styles.length - 1;                                                                            </pre></div>
<div row="2800"><pre row="2800">2800     <font color="black">1095</font>   }                                                                                                           <font color="black">1124</font>   }                                                                                                      </pre></div>
<div row="2801"><pre row="2801">2801     <font color="black">1096</font>                                                                                                               <font color="black">1125</font>                                                                                                          </pre></div>
<div row="2802"><pre row="2802">2802     <font color="black">1097</font>   changeData(cb) {                                                                                            <font color="black">1126</font>   changeData(cb) {                                                                                       </pre></div>
<div row="2803"><pre row="2803">2803     <font color="black">1098</font> <font color="red">//    console.log("***changeData");</font>                                                                                                                                                                                         </pre></div>
<div row="2804"><pre row="2804">2804     <font color="black">1099</font>     this.history.add(this.getData());                                                                         <font color="black">1127</font>     this.history.add(this.getData());                                                                    </pre></div>
<div row="2805"><pre row="2805">2805     <font color="black">1100</font>     cb();                                                                                                     <font color="black">1128</font>     cb();                                                                                                </pre></div>
<div row="2806"><pre row="2806">2806     <font color="black">1101</font>     this.change(this.getData());                                                                              <font color="black">1129</font>     this.change(this.getData());                                                                         </pre></div>
<div row="2807"><pre row="2807">2807     <font color="black">1102</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2808"><pre row="2808">2808     <font color="black">1103</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre></div>
<div row="2809"><pre row="2809">2809     <font color="black">1104</font> <font color="red">    //splitSheets.length</font>                                                                                                                                                                                                    </pre></div>
<div row="2810"><pre row="2810">2810     <font color="black">1105</font> <font color="red">    this.v_splitSheets.forEach(function(sheet) {</font>                                                                                                                                                                            </pre></div>
<div row="2811"><pre row="2811">2811     <font color="black">1106</font> <font color="red">      sheet.sync();</font>                                                                                                                                                                                                         </pre></div>
<div row="2812"><pre row="2812">2812     <font color="black">1107</font> <font color="red">    });</font>                                                                                                                                                                                                                     </pre></div>
<div row="2813"><pre row="2813">2813     <font color="black">1108</font> <font color="red">    this.h_splitSheets.forEach(function(sheet) {</font>                                                                                                                                                                            </pre></div>
<div row="2814"><pre row="2814">2814     <font color="black">1109</font> <font color="red">      sheet.sync();</font>                                                                                                                                                                                                         </pre></div>
<div row="2815"><pre row="2815">2815     <font color="black">1110</font> <font color="red">    });</font>                                                                                                                                                                                                                     </pre></div>
<div row="2816"><pre row="2816">2816     <font color="black">1111</font> <font color="red">    </font>                                                                                                                                                                                                                        </pre></div>
<div row="2817"><pre row="2817">2817     <font color="black">1112</font>   }                                                                                                           <font color="black">1130</font>   }                                                                                                      </pre></div>
<div row="2818"><pre row="2818">2818     <font color="black">1113</font>                                                                                                               <font color="black">1131</font>                                                                                                          </pre></div>
<div row="2819"><pre row="2819">2819     <font color="black">1114</font>   setData(d) {                                                                                                <font color="black">1132</font>   setData(d) {                                                                                           </pre></div>
<div row="2820"><pre row="2820">2820     <font color="black">1115</font> <font color="red">//    console.log("***setData");</font>                                                                                                                                                                                            </pre></div>
<div row="2821"><pre row="2821">2821     <font color="black">1116</font>     Object.keys(d).forEach((property) =&gt; {                                                                    <font color="black">1133</font>     Object.keys(d).forEach((property) =&gt; {                                                               </pre></div>
<div row="2822"><pre row="2822">2822     <font color="black">1117</font>       if (property === 'merges' || property === 'rows'                                                        <font color="black">1134</font>       if (property === 'merges' || property === 'rows'                                                   </pre></div>
<div row="2823"><pre row="2823">2823     <font color="black">1118</font>         || property === 'cols' || property === 'validations'                                                  <font color="black">1135</font>         || property === 'cols' || property === 'validations'<font color="green">) {</font>                                          </pre></div>
<div row="2824"><pre row="2824">2824     <font color="black">1119</font> <font color="red">         || property === 'shapes' </font>                                                                                                                                                                                          </pre></div>
<div row="2825"><pre row="2825">2825     <font color="black">1120</font> <font color="red">      ) {</font>                                                                                                                                                                                                                   </pre></div>
<div row="2826"><pre row="2826">2826     <font color="black">1121</font>         this[property].setData(d[property]);                                                                  <font color="black">1136</font>         this[property].setData(d[property]);                                                             </pre></div>
<div row="2827"><pre row="2827">2827     <font color="black">1122</font>       } else if (property === 'freeze') {                                                                     <font color="black">1137</font>       } else if (property === 'freeze') {                                                                </pre></div>
<div row="2828"><pre row="2828">2828     <font color="black">1123</font>         const [x, y] = expr2xy(d[property]);                                                                  <font color="black">1138</font>         const [x, y] = expr2xy(d[property]);                                                             </pre></div>
<div row="2829"><pre row="2829">2829     <font color="black">1124</font>         this.freeze = [y, x];                                                                                 <font color="black">1139</font>         this.freeze = [y, x];                                                                            </pre></div>
<div row="2830"><pre row="2830">2830     <font color="black">1125</font>       } else if (d[property] !== undefined) {                                                                 <font color="black">1140</font>       } else if (d[property] !== undefined) {                                                            </pre></div>
<div row="2831"><pre row="2831">2831     <font color="black">1126</font>         this[property] = d[property];                                                                         <font color="black">1141</font>         this[property] = d[property];                                                                    </pre></div>
<div row="2832"><pre row="2832">2832     <font color="black">1127</font>       }                                                                                                       <font color="black">1142</font>       }                                                                                                  </pre></div>
<div row="2833"><pre row="2833">2833     <font color="black">1128</font>     });                                                                                                       <font color="black">1143</font>     });                                                                                                  </pre></div>
<div row="2834"><pre row="2834">2834     <font color="black">1129</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2835"><pre row="2835">2835     <font color="black">1130</font> <font color="red">//   console.log(this['cols'].getData()) ;</font>                                                                                                                                                                                  </pre></div>
<div row="2836"><pre row="2836">2836     <font color="black">1131</font> <font color="red">//   let c = this['cols'].getData();</font>                                                                                                                                                                                        </pre></div>
<div row="2837"><pre row="2837">2837     <font color="black">1132</font> <font color="red">/*</font>                                                                                                                                                                                                                          </pre></div>
<div row="2838"><pre row="2838">2838     <font color="black">1133</font> <font color="red">   if  (!(c.[])) {</font>                                                                                                                                                                                                          </pre></div>
<div row="2839"><pre row="2839">2839     <font color="black">1134</font> <font color="red">        console.log("col setdata ok");</font>                                                                                                                                                                                      </pre></div>
<div row="2840"><pre row="2840">2840     <font color="black">1135</font> <font color="red">  //      const d = this['cols'].getData();</font>                                                                                                                                                                                 </pre></div>
<div row="2841"><pre row="2841">2841     <font color="black">1136</font> <font color="red">  //       Object.assign([{width: 100}], d);</font>                                                                                                                                                                                </pre></div>
<div row="2842"><pre row="2842">2842     <font color="black">1137</font> <font color="red">  //      this['cols'].setData(d);</font>                                                                                                                                                                                          </pre></div>
<div row="2843"><pre row="2843">2843     <font color="black">1138</font> <font color="red">   }  else {</font>                                                                                                                                                                                                                </pre></div>
<div row="2844"><pre row="2844">2844     <font color="black">1139</font> <font color="red">        console.log("col setdata ng");</font>                                                                                                                                                                                      </pre></div>
<div row="2845"><pre row="2845">2845     <font color="black">1140</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2846"><pre row="2846">2846     <font color="black">1141</font> <font color="red">   }</font>                                                                                                                                                                                                                        </pre></div>
<div row="2847"><pre row="2847">2847     <font color="black">1142</font> <font color="red">  */ </font>                                                                                                                                                                                                                       </pre></div>
<div row="2848"><pre row="2848">2848     <font color="black">1143</font>     return this;                                                                                              <font color="black">1144</font>     return this;                                                                                         </pre></div>
<div row="2849"><pre row="2849">2849     <font color="black">1144</font>   }                                                                                                           <font color="black">1145</font>   }                                                                                                      </pre></div>
<div row="2850"><pre row="2850">2850     <font color="black">1145</font>                                                                                                               <font color="black">1146</font>                                                                                                          </pre></div>
<div row="2851"><pre row="2851">2851     <font color="black">1146</font>   getData() {                                                                                                 <font color="black">1147</font>   getData() {                                                                                            </pre></div>
<div row="2852"><pre row="2852">2852     <font color="black">1147</font>     const {                                                                                                   <font color="black">1148</font>     const {                                                                                              </pre></div>
<div row="2853"><pre row="2853">2853 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2854"><pre row="2854">2854     <font color="black">1156</font>       cols: cols.getData(),                                                                                   <font color="black">1157</font>       cols: cols.getData(),                                                                              </pre></div>
<div row="2855"><pre row="2855">2855     <font color="black">1157</font>       validations: validations.getData(),                                                                     <font color="black">1158</font>       validations: validations.getData(),                                                                </pre></div>
<div row="2856"><pre row="2856">2856     <font color="black">1158</font>       autofilter: autoFilter.getData(),                                                                       <font color="black">1159</font>       autofilter: autoFilter.getData(),                                                                  </pre></div>
<div row="2857"><pre row="2857">2857     <font color="black">1159</font>     };                                                                                                        <font color="black">1160</font>     };                                                                                                   </pre></div>
<div row="2858"><pre row="2858">2858     <font color="black">1160</font>   }                                                                                                           <font color="black">1161</font>   }                                                                                                      </pre></div>
<div row="2859"><pre row="2859">2859     <font color="black">1161</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2860"><pre row="2860">2860     <font color="black">1162</font> <font color="red">  horizontalAddSplitSheet(seet){ //GUSA</font>                                                                                                                                                                                     </pre></div>
<div row="2861"><pre row="2861">2861     <font color="black">1163</font> <font color="red">     const {</font>                                                                                                                                                                                                                </pre></div>
<div row="2862"><pre row="2862">2862     <font color="black">1164</font> <font color="red">       h_splitSheets,</font>                                                                                                                                                                                                       </pre></div>
<div row="2863"><pre row="2863">2863     <font color="black">1165</font> <font color="red">     } = this;</font>                                                                                                                                                                                                              </pre></div>
<div row="2864"><pre row="2864">2864     <font color="black">1166</font> <font color="red">     h_splitSheets.push(seet);</font>                                                                                                                                                                                              </pre></div>
<div row="2865"><pre row="2865">2865     <font color="black">1167</font> <font color="red">  }</font>                                                                                                                                                                                                                         </pre></div>
<div row="2866"><pre row="2866">2866     <font color="black">1168</font> <font color="red"> </font>                                                                                                                                                                                                                           </pre></div>
<div row="2867"><pre row="2867">2867     <font color="black">1169</font> <font color="red">  verticalAddSplitSheet(seet){ //GUSA</font>                                                                                                                                                                                       </pre></div>
<div row="2868"><pre row="2868">2868     <font color="black">1170</font> <font color="red">     const {</font>                                                                                                                                                                                                                </pre></div>
<div row="2869"><pre row="2869">2869     <font color="black">1171</font> <font color="red">       v_splitSheets,</font>                                                                                                                                                                                                       </pre></div>
<div row="2870"><pre row="2870">2870     <font color="black">1172</font> <font color="red">     } = this;</font>                                                                                                                                                                                                              </pre></div>
<div row="2871"><pre row="2871">2871     <font color="black">1173</font> <font color="red">     v_splitSheets.push(seet);</font>                                                                                                                                                                                              </pre></div>
<div row="2872"><pre row="2872">2872     <font color="black">1174</font> <font color="red">//     console.log("addSplitSheet: ", splitSheets.length);</font>                                                                                                                                                                  </pre></div>
<div row="2873"><pre row="2873">2873     <font color="black">1175</font> <font color="red">  };</font>                                                                                                                                                                                                                        </pre></div>
<div row="2874"><pre row="2874">2874     <font color="black">1176</font> }                                                                                                             <font color="black">1162</font> }                                                                                                        </pre></div>
<div id="id-core-font_js"  class="pagelink" row="2875"><pre class="pagehead" row="2875">2875 id-core-font_js</pre></div>
<div row="2876"><pre row="2876">2876 <font color="blue">../src/core/font.js</font>                                                                                                <font color="blue">../../x-spreadsheet/src/core/font.js</font>                                                                              </pre></div>
<div row="2877"><pre row="2877">2877                                                                                                                           <font color="black">1</font> <font color="green">// docs</font>                                                                                                  </pre></div>
<div row="2878"><pre row="2878">2878                                                                                                                           <font color="black">2</font> <font color="green">import './_.prototypes';</font>                                                                                 </pre></div>
<div row="2879"><pre row="2879">2879                                                                                                                           <font color="black">3</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="2880"><pre row="2880">2880                                                                                                                           <font color="black">4</font> <font color="green">/** default font list</font>                                                                                    </pre></div>
<div row="2881"><pre row="2881">2881                                                                                                                           <font color="black">5</font> <font color="green"> * @type {BaseFont[]}</font>                                                                                    </pre></div>
<div row="2882"><pre row="2882">2882                                                                                                                           <font color="black">6</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2883"><pre row="2883">2883        <font color="black">1</font> const baseFonts = [                                                                                              <font color="black">7</font> const baseFonts = [                                                                                      </pre></div>
<div row="2884"><pre row="2884">2884        <font color="black">2</font>   { key: 'Arial', title: 'Arial' },                                                                              <font color="black">8</font>   { key: 'Arial', title: 'Arial' },                                                                      </pre></div>
<div row="2885"><pre row="2885">2885        <font color="black">3</font>   { key: 'Helvetica', title: 'Helvetica' },                                                                      <font color="black">9</font>   { key: 'Helvetica', title: 'Helvetica' },                                                              </pre></div>
<div row="2886"><pre row="2886">2886        <font color="black">4</font>   { key: 'Source Sans Pro', title: 'Source Sans Pro' },                                                         <font color="black">10</font>   { key: 'Source Sans Pro', title: 'Source Sans Pro' },                                                  </pre></div>
<div row="2887"><pre row="2887">2887        <font color="black">5</font>   { key: 'Comic Sans MS', title: 'Comic Sans MS' },                                                             <font color="black">11</font>   { key: 'Comic Sans MS', title: 'Comic Sans MS' },                                                      </pre></div>
<div row="2888"><pre row="2888">2888        <font color="black">6</font>   { key: 'Courier New', title: 'Courier New' },                                                                 <font color="black">12</font>   { key: 'Courier New', title: 'Courier New' },                                                          </pre></div>
<div row="2889"><pre row="2889">2889        <font color="black">7</font>   { key: 'Verdana', title: 'Verdana' },                                                                         <font color="black">13</font>   { key: 'Verdana', title: 'Verdana' },                                                                  </pre></div>
<div row="2890"><pre row="2890">2890        <font color="black">8</font>   { key: 'Lato', title: 'Lato' },                                                                               <font color="black">14</font>   { key: 'Lato', title: 'Lato' },                                                                        </pre></div>
<div row="2891"><pre row="2891">2891        <font color="black">9</font> ];                                                                                                              <font color="black">15</font> ];                                                                                                       </pre></div>
<div row="2892"><pre row="2892">2892       <font color="black">10</font>                                                                                                                 <font color="black">16</font>                                                                                                          </pre></div>
<div row="2893"><pre row="2893">2893                                                                                                                          <font color="black">17</font> <font color="green">/** default fontSize list</font>                                                                                </pre></div>
<div row="2894"><pre row="2894">2894                                                                                                                          <font color="black">18</font> <font color="green"> * @type {FontSize[]}</font>                                                                                    </pre></div>
<div row="2895"><pre row="2895">2895                                                                                                                          <font color="black">19</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2896"><pre row="2896">2896       <font color="black">11</font> const fontSizes = [                                                                                             <font color="black">20</font> const fontSizes = [                                                                                      </pre></div>
<div row="2897"><pre row="2897">2897       <font color="black">12</font>   { pt: 7.5, px: 10 },                                                                                          <font color="black">21</font>   { pt: 7.5, px: 10 },                                                                                   </pre></div>
<div row="2898"><pre row="2898">2898       <font color="black">13</font>   { pt: 8, px: 11 },                                                                                            <font color="black">22</font>   { pt: 8, px: 11 },                                                                                     </pre></div>
<div row="2899"><pre row="2899">2899       <font color="black">14</font>   { pt: 9, px: 12 },                                                                                            <font color="black">23</font>   { pt: 9, px: 12 },                                                                                     </pre></div>
<div row="2900"><pre row="2900">2900       <font color="black">15</font>   { pt: 10, px: 13 },                                                                                           <font color="black">24</font>   { pt: 10, px: 13 },                                                                                    </pre></div>
<div row="2901"><pre row="2901">2901 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2902"><pre row="2902">2902       <font color="black">28</font>   // { pt: 54, px: 71.7 },                                                                                      <font color="black">37</font>   // { pt: 54, px: 71.7 },                                                                               </pre></div>
<div row="2903"><pre row="2903">2903       <font color="black">29</font>   // { pt: 63, px: 83.7 },                                                                                      <font color="black">38</font>   // { pt: 63, px: 83.7 },                                                                               </pre></div>
<div row="2904"><pre row="2904">2904       <font color="black">30</font>   // { pt: 72, px: 95.6 },                                                                                      <font color="black">39</font>   // { pt: 72, px: 95.6 },                                                                               </pre></div>
<div row="2905"><pre row="2905">2905       <font color="black">31</font> ];                                                                                                              <font color="black">40</font> ];                                                                                                       </pre></div>
<div row="2906"><pre row="2906">2906       <font color="black">32</font>                                                                                                                 <font color="black">41</font>                                                                                                          </pre></div>
<div row="2907"><pre row="2907">2907                                                                                                                          <font color="black">42</font> <font color="green">/** map pt to px</font>                                                                                         </pre></div>
<div row="2908"><pre row="2908">2908                                                                                                                          <font color="black">43</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre></div>
<div row="2909"><pre row="2909">2909                                                                                                                          <font color="black">44</font> <font color="green"> * @param {fontsizePT} pt</font>                                                                                </pre></div>
<div row="2910"><pre row="2910">2910                                                                                                                          <font color="black">45</font> <font color="green"> * @returns {fontsizePX}</font>                                                                                 </pre></div>
<div row="2911"><pre row="2911">2911                                                                                                                          <font color="black">46</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2912"><pre row="2912">2912       <font color="black">33</font> function getFontSizePxByPt(pt) {                                                                                <font color="black">47</font> function getFontSizePxByPt(pt) {                                                                         </pre></div>
<div row="2913"><pre row="2913">2913       <font color="black">34</font>   for (let i = 0; i &lt; fontSizes.length; i += 1) {                                                               <font color="black">48</font>   for (let i = 0; i &lt; fontSizes.length; i += 1) {                                                        </pre></div>
<div row="2914"><pre row="2914">2914       <font color="black">35</font>     const fontSize = fontSizes[i];                                                                              <font color="black">49</font>     const fontSize = fontSizes[i];                                                                       </pre></div>
<div row="2915"><pre row="2915">2915       <font color="black">36</font>     if (fontSize.pt === pt) {                                                                                   <font color="black">50</font>     if (fontSize.pt === pt) {                                                                            </pre></div>
<div row="2916"><pre row="2916">2916       <font color="black">37</font>       return fontSize.px;                                                                                       <font color="black">51</font>       return fontSize.px;                                                                                </pre></div>
<div row="2917"><pre row="2917">2917       <font color="black">38</font>     }                                                                                                           <font color="black">52</font>     }                                                                                                    </pre></div>
<div row="2918"><pre row="2918">2918       <font color="black">39</font>   }                                                                                                             <font color="black">53</font>   }                                                                                                      </pre></div>
<div row="2919"><pre row="2919">2919       <font color="black">40</font>   return pt;                                                                                                    <font color="black">54</font>   return pt;                                                                                             </pre></div>
<div row="2920"><pre row="2920">2920       <font color="black">41</font> }                                                                                                               <font color="black">55</font> }                                                                                                        </pre></div>
<div row="2921"><pre row="2921">2921       <font color="black">42</font>                                                                                                                 <font color="black">56</font>                                                                                                          </pre></div>
<div row="2922"><pre row="2922">2922                                                                                                                          <font color="black">57</font> <font color="green">/** transform baseFonts to map</font>                                                                           </pre></div>
<div row="2923"><pre row="2923">2923                                                                                                                          <font color="black">58</font> <font color="green"> * @date 2019-10-10</font>                                                                                      </pre></div>
<div row="2924"><pre row="2924">2924                                                                                                                          <font color="black">59</font> <font color="green"> * @param {BaseFont[]} [ary=[]]</font>                                                                          </pre></div>
<div row="2925"><pre row="2925">2925                                                                                                                          <font color="black">60</font> <font color="green"> * @returns {object}</font>                                                                                     </pre></div>
<div row="2926"><pre row="2926">2926                                                                                                                          <font color="black">61</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2927"><pre row="2927">2927       <font color="black">43</font> con<font color="red">st</font> fonts<font color="red"> = </font>(ary = []) <font color="red">=&gt; </font>{                                                                                   <font color="black">62</font> <font color="green">fun</font>c<font color="green">ti</font>on fonts(ary = []) {                                                                               </pre></div>
<div row="2928"><pre row="2928">2928       <font color="black">44</font>   const map = {};                                                                                               <font color="black">63</font>   const map = {};                                                                                        </pre></div>
<div row="2929"><pre row="2929">2929       <font color="black">45</font>   baseFonts.concat(ary).forEach((f) =&gt; {                                                                        <font color="black">64</font>   baseFonts.concat(ary).forEach((f) =&gt; {                                                                 </pre></div>
<div row="2930"><pre row="2930">2930       <font color="black">46</font>     map[f.key] = f;                                                                                             <font color="black">65</font>     map[f.key] = f;                                                                                      </pre></div>
<div row="2931"><pre row="2931">2931       <font color="black">47</font>   });                                                                                                           <font color="black">66</font>   });                                                                                                    </pre></div>
<div row="2932"><pre row="2932">2932       <font color="black">48</font>   return map;                                                                                                   <font color="black">67</font>   return map;                                                                                            </pre></div>
<div row="2933"><pre row="2933">2933       <font color="black">49</font> <font color="red">};</font>                                                                                                              <font color="black">68</font> <font color="green">}</font>                                                                                                        </pre></div>
<div row="2934"><pre row="2934">2934       <font color="black">50</font>                                                                                                                 <font color="black">69</font>                                                                                                          </pre></div>
<div row="2935"><pre row="2935">2935       <font color="black">51</font> export default {};                                                                                              <font color="black">70</font> export default {};                                                                                       </pre></div>
<div row="2936"><pre row="2936">2936       <font color="black">52</font> export {                                                                                                        <font color="black">71</font> export {                                                                                                 </pre></div>
<div row="2937"><pre row="2937">2937       <font color="black">53</font>   fontSizes,                                                                                                    <font color="black">72</font>   fontSizes,                                                                                             </pre></div>
<div row="2938"><pre row="2938">2938       <font color="black">54</font>   fonts,                                                                                                        <font color="black">73</font>   fonts,                                                                                                 </pre></div>
<div id="id-core-format_js"  class="pagelink" row="2939"><pre class="pagehead" row="2939">2939 id-core-format_js</pre></div>
<div row="2940"><pre row="2940">2940 <font color="blue">../src/core/format.js</font>                                                                                              <font color="blue">../../x-spreadsheet/src/core/format.js</font>                                                                            </pre></div>
<div row="2941"><pre row="2941">2941        <font color="black">1</font> import { tf } from '../locale/locale';                                                                           <font color="black">1</font> import { tf } from '../locale/locale';                                                                   </pre></div>
<div row="2942"><pre row="2942">2942        <font color="black">2</font>                                                                                                                  <font color="black">2</font>                                                                                                          </pre></div>
<div row="2943"><pre row="2943">2943        <font color="black">3</font> const formatStringRender = v =&gt; v;                                                                               <font color="black">3</font> const formatStringRender = v =&gt; v;                                                                       </pre></div>
<div row="2944"><pre row="2944">2944        <font color="black">4</font>                                                                                                                  <font color="black">4</font>                                                                                                          </pre></div>
<div row="2945"><pre row="2945">2945        <font color="black">5</font> const formatNumberRender = (v) =&gt; {                                                                              <font color="black">5</font> const formatNumberRender = (v) =&gt; {                                                                      </pre></div>
<div row="2946"><pre row="2946">2946                                                                                                                           <font color="black">6</font> <font color="green">  // match "-12.1" or "12" or "12.1"</font>                                                                     </pre></div>
<div row="2947"><pre row="2947">2947        <font color="black">6</font>   if (/^(-?\d*.?\d*)$/.test(v)) {                                                                                <font color="black">7</font>   if (/^(-?\d*.?\d*)$/.test(v)) {                                                                        </pre></div>
<div row="2948"><pre row="2948">2948        <font color="black">7</font>     const v1 = Number(v).toFixed(2).toString();                                                                  <font color="black">8</font>     const v1 = Number(v).toFixed(2).toString();                                                          </pre></div>
<div row="2949"><pre row="2949">2949        <font color="black">8</font>     const [first, ...parts] = v1.split('\\.');                                                                   <font color="black">9</font>     const [first, ...parts] = v1.split('\\.');                                                           </pre></div>
<div row="2950"><pre row="2950">2950        <font color="black">9</font>     return [first.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,'), ...parts];                                         <font color="black">10</font>     return [first.replace(/(\d)(?=(\d{3})+(?!\d))/g, '$1,'), ...parts];                                  </pre></div>
<div row="2951"><pre row="2951">2951       <font color="black">10</font>   }                                                                                                             <font color="black">11</font>   }                                                                                                      </pre></div>
<div row="2952"><pre row="2952">2952 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2953"><pre row="2953">2953       <font color="black">51</font>     type: 'number',                                                                                             <font color="black">52</font>     type: 'number',                                                                                      </pre></div>
<div row="2954"><pre row="2954">2954       <font color="black">52</font>     label: '$10.00',                                                                                            <font color="black">53</font>     label: '$10.00',                                                                                     </pre></div>
<div row="2955"><pre row="2955">2955       <font color="black">53</font>     render: v =&gt; `$${formatNumberRender(v)}`,                                                                   <font color="black">54</font>     render: v =&gt; `$${formatNumberRender(v)}`,                                                            </pre></div>
<div row="2956"><pre row="2956">2956       <font color="black">54</font>   },                                                                                                            <font color="black">55</font>   },                                                                                                     </pre></div>
<div row="2957"><pre row="2957">2957       <font color="black">55</font>   {                                                                                                             <font color="black">56</font>   {                                                                                                      </pre></div>
<div row="2958"><pre row="2958">2958                                                                                                                          <font color="black">57</font> <font color="green">    key: 'eur',</font>                                                                                          </pre></div>
<div row="2959"><pre row="2959">2959                                                                                                                          <font color="black">58</font> <font color="green">    title: tf('format.eur'),</font>                                                                             </pre></div>
<div row="2960"><pre row="2960">2960                                                                                                                          <font color="black">59</font> <font color="green">    type: 'number',</font>                                                                                      </pre></div>
<div row="2961"><pre row="2961">2961                                                                                                                          <font color="black">60</font> <font color="green">    label: '€10.00',</font>                                                                                     </pre></div>
<div row="2962"><pre row="2962">2962                                                                                                                          <font color="black">61</font> <font color="green">    render: v =&gt; `€${formatNumberRender(v)}`,</font>                                                            </pre></div>
<div row="2963"><pre row="2963">2963                                                                                                                          <font color="black">62</font> <font color="green">  },</font>                                                                                                     </pre></div>
<div row="2964"><pre row="2964">2964                                                                                                                          <font color="black">63</font> <font color="green">  {</font>                                                                                                      </pre></div>
<div row="2965"><pre row="2965">2965       <font color="black">56</font>     key: 'date',                                                                                                <font color="black">64</font>     key: 'date',                                                                                         </pre></div>
<div row="2966"><pre row="2966">2966       <font color="black">57</font>     title: tf('format.date'),                                                                                   <font color="black">65</font>     title: tf('format.date'),                                                                            </pre></div>
<div row="2967"><pre row="2967">2967       <font color="black">58</font>     type: 'date',                                                                                               <font color="black">66</font>     type: 'date',                                                                                        </pre></div>
<div row="2968"><pre row="2968">2968       <font color="black">59</font>     label: '26/09/2008',                                                                                        <font color="black">67</font>     label: '26/09/2008',                                                                                 </pre></div>
<div row="2969"><pre row="2969">2969       <font color="black">60</font>     render: formatStringRender,                                                                                 <font color="black">68</font>     render: formatStringRender,                                                                          </pre></div>
<div id="id-core-formula_js"  class="pagelink" row="2970"><pre class="pagehead" row="2970">2970 id-core-formula_js</pre></div>
<div row="2971"><pre row="2971">2971 <font color="blue">../src/core/formula.js</font>                                                                                             <font color="blue">../../x-spreadsheet/src/core/formula.js</font>                                                                           </pre></div>
<div row="2972"><pre row="2972">2972        <font color="black">2</font>   formula:                                                                                                       <font color="black">2</font>   formula:                                                                                               </pre></div>
<div row="2973"><pre row="2973">2973        <font color="black">3</font>     key                                                                                                          <font color="black">3</font>     key                                                                                                  </pre></div>
<div row="2974"><pre row="2974">2974        <font color="black">4</font>     title                                                                                                        <font color="black">4</font>     title                                                                                                </pre></div>
<div row="2975"><pre row="2975">2975        <font color="black">5</font>     render                                                                                                       <font color="black">5</font>     render                                                                                               </pre></div>
<div row="2976"><pre row="2976">2976        <font color="black">6</font> */                                                                                                               <font color="black">6</font> */                                                                                                       </pre></div>
<div row="2977"><pre row="2977">2977                                                                                                                           <font color="black">7</font> <font color="green">/**</font>                                                                                                      </pre></div>
<div row="2978"><pre row="2978">2978                                                                                                                           <font color="black">8</font> <font color="green"> * @typedef {object} Formula</font>                                                                             </pre></div>
<div row="2979"><pre row="2979">2979                                                                                                                           <font color="black">9</font> <font color="green"> * @property {string} key</font>                                                                                </pre></div>
<div row="2980"><pre row="2980">2980                                                                                                                          <font color="black">10</font> <font color="green"> * @property {function} title</font>                                                                            </pre></div>
<div row="2981"><pre row="2981">2981                                                                                                                          <font color="black">11</font> <font color="green"> * @property {function} render</font>                                                                           </pre></div>
<div row="2982"><pre row="2982">2982                                                                                                                          <font color="black">12</font> <font color="green"> */</font>                                                                                                      </pre></div>
<div row="2983"><pre row="2983">2983        <font color="black">7</font> import { tf } from '../locale/locale';                                                                          <font color="black">13</font> import { tf } from '../locale/locale';                                                                   </pre></div>
<div row="2984"><pre row="2984">2984        <font color="black">8</font>                                                                                                                 <font color="black">14</font>                                                                                                          </pre></div>
<div row="2985"><pre row="2985">2985                                                                                                                          <font color="black">15</font> <font color="green">/** @type {Formula[]} */</font>                                                                                 </pre></div>
<div row="2986"><pre row="2986">2986        <font color="black">9</font> const baseFormulas = [                                                                                          <font color="black">16</font> const baseFormulas = [                                                                                   </pre></div>
<div row="2987"><pre row="2987">2987       <font color="black">10</font>   {                                                                                                             <font color="black">17</font>   {                                                                                                      </pre></div>
<div row="2988"><pre row="2988">2988       <font color="black">11</font>     key: 'SUM',                                                                                                 <font color="black">18</font>     key: 'SUM',                                                                                          </pre></div>
<div row="2989"><pre row="2989">2989       <font color="black">12</font>     title: tf('formula.sum'),                                                                                   <font color="black">19</font>     title: tf('formula.sum'),                                                                            </pre></div>
<div row="2990"><pre row="2990">2990       <font color="black">13</font>     render: ary =&gt; ary.reduce((a, b) =&gt; Number(a) + Number(b), 0),                                              <font color="black">20</font>     render: ary =&gt; ary.reduce((a, b) =&gt; Number(a) + Number(b), 0),                                       </pre></div>
<div row="2991"><pre row="2991">2991 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="2992"><pre row="2992">2992       <font color="black">26</font>     key: 'MIN',                                                                                                 <font color="black">33</font>     key: 'MIN',                                                                                          </pre></div>
<div row="2993"><pre row="2993">2993       <font color="black">27</font>     title: tf('formula.min'),                                                                                   <font color="black">34</font>     title: tf('formula.min'),                                                                            </pre></div>
<div row="2994"><pre row="2994">2994       <font color="black">28</font>     render: ary =&gt; Math.min(...ary.map(v =&gt; Number(v))),                                                        <font color="black">35</font>     render: ary =&gt; Math.min(...ary.map(v =&gt; Number(v))),                                                 </pre></div>
<div row="2995"><pre row="2995">2995       <font color="black">29</font>   },                                                                                                            <font color="black">36</font>   },                                                                                                     </pre></div>
<div row="2996"><pre row="2996">2996       <font color="black">30</font>   {                                                                                                             <font color="black">37</font>   {                                                                                                      </pre></div>
<div row="2997"><pre row="2997">2997                                                                                                                          <font color="black">38</font> <font color="green">    key: 'IF',</font>                                                                                           </pre></div>
<div row="2998"><pre row="2998">2998                                                                                                                          <font color="black">39</font> <font color="green">    title: tf('formula._if'),</font>                                                                            </pre></div>
<div row="2999"><pre row="2999">2999                                                                                                                          <font color="black">40</font> <font color="green">    render: ([b, t, f]) =&gt; (b ? t : f),</font>                                                                  </pre></div>
<div row="3000"><pre row="3000">3000                                                                                                                          <font color="black">41</font> <font color="green">  },</font>                                                                                                     </pre></div>
<div row="3001"><pre row="3001">3001                                                                                                                          <font color="black">42</font> <font color="green">  {</font>                                                                                                      </pre></div>
<div row="3002"><pre row="3002">3002                                                                                                                          <font color="black">43</font> <font color="green">    key: 'AND',</font>                                                                                          </pre></div>
<div row="3003"><pre row="3003">3003                                                                                                                          <font color="black">44</font> <font color="green">    title: tf('formula.and'),</font>                                                                            </pre></div>
<div row="3004"><pre row="3004">3004                                                                                                                          <font color="black">45</font> <font color="green">    render: ary =&gt; ary.every(it =&gt; it),</font>                                                                  </pre></div>
<div row="3005"><pre row="3005">3005                                                                                                                          <font color="black">46</font> <font color="green">  },</font>                                                                                                     </pre></div>
<div row="3006"><pre row="3006">3006                                                                                                                          <font color="black">47</font> <font color="green">  {</font>                                                                                                      </pre></div>
<div row="3007"><pre row="3007">3007                                                                                                                          <font color="black">48</font> <font color="green">    key: 'OR',</font>                                                                                           </pre></div>
<div row="3008"><pre row="3008">3008                                                                                                                          <font color="black">49</font> <font color="green">    title: tf('formula.or'),</font>                                                                             </pre></div>
<div row="3009"><pre row="3009">3009                                                                                                                          <font color="black">50</font> <font color="green">    render: ary =&gt; ary.some(it =&gt; it),</font>                                                                   </pre></div>
<div row="3010"><pre row="3010">3010                                                                                                                          <font color="black">51</font> <font color="green">  },</font>                                                                                                     </pre></div>
<div row="3011"><pre row="3011">3011                                                                                                                          <font color="black">52</font> <font color="green">  {</font>                                                                                                      </pre></div>
<div row="3012"><pre row="3012">3012       <font color="black">31</font>     key: 'CONCAT',                                                                                              <font color="black">53</font>     key: 'CONCAT',                                                                                       </pre></div>
<div row="3013"><pre row="3013">3013       <font color="black">32</font>     title: tf('formula.concat'),                                                                                <font color="black">54</font>     title: tf('formula.concat'),                                                                         </pre></div>
<div row="3014"><pre row="3014">3014       <font color="black">33</font>     render: ary =&gt; ary.join(''),                                                                                <font color="black">55</font>     render: ary =&gt; ary.join(''),                                                                         </pre></div>
<div row="3015"><pre row="3015">3015       <font color="black">34</font>   },                                                                                                            <font color="black">56</font>   },                                                                                                     </pre></div>
<div row="3016"><pre row="3016">3016                                                                                                                          <font color="black">57</font> <font color="green">  /* support:  1 + A1 + B2 * 3</font>                                                                           </pre></div>
<div row="3017"><pre row="3017">3017                                                                                                                          <font color="black">58</font> <font color="green">  {</font>                                                                                                      </pre></div>
<div row="3018"><pre row="3018">3018                                                                                                                          <font color="black">59</font> <font color="green">    key: 'DIVIDE',</font>                                                                                       </pre></div>
<div row="3019"><pre row="3019">3019                                                                                                                          <font color="black">60</font> <font color="green">    title: tf('formula.divide'),</font>                                                                         </pre></div>
<div row="3020"><pre row="3020">3020                                                                                                                          <font color="black">61</font> <font color="green">    render: ary =&gt; ary.reduce((a, b) =&gt; Number(a) / Number(b)),</font>                                          </pre></div>
<div row="3021"><pre row="3021">3021                                                                                                                          <font color="black">62</font> <font color="green">  },</font>                                                                                                     </pre></div>
<div row="3022"><pre row="3022">3022                                                                                                                          <font color="black">63</font> <font color="green">  {</font>                                                                                                      </pre></div>
<div row="3023"><pre row="3023">3023                                                                                                                          <font color="black">64</font> <font color="green">    key: 'PRODUCT',</font>                                                                                      </pre></div>
<div row="3024"><pre row="3024">3024                                                                                                                          <font color="black">65</font> <font color="green">    title: tf('formula.product'),</font>                                                                        </pre></div>
<div row="3025"><pre row="3025">3025                                                                                                                          <font color="black">66</font> <font color="green">    render: ary =&gt; ary.reduce((a, b) =&gt; Number(a) * Number(b),1),</font>                                        </pre></div>
<div row="3026"><pre row="3026">3026                                                                                                                          <font color="black">67</font> <font color="green">  },</font>                                                                                                     </pre></div>
<div row="3027"><pre row="3027">3027                                                                                                                          <font color="black">68</font> <font color="green">  {</font>                                                                                                      </pre></div>
<div row="3028"><pre row="3028">3028                                                                                                                          <font color="black">69</font> <font color="green">    key: 'SUBTRACT',</font>                                                                                     </pre></div>
<div row="3029"><pre row="3029">3029                                                                                                                          <font color="black">70</font> <font color="green">    title: tf('formula.subtract'),</font>                                                                       </pre></div>
<div row="3030"><pre row="3030">3030                                                                                                                          <font color="black">71</font> <font color="green">    render: ary =&gt; ary.reduce((a, b) =&gt; Number(a) - Number(b)),</font>                                          </pre></div>
<div row="3031"><pre row="3031">3031                                                                                                                          <font color="black">72</font> <font color="green">  },</font>                                                                                                     </pre></div>
<div row="3032"><pre row="3032">3032                                                                                                                          <font color="black">73</font> <font color="green">  */</font>                                                                                                     </pre></div>
<div row="3033"><pre row="3033">3033       <font color="black">35</font> ];                                                                                                              <font color="black">74</font> ];                                                                                                       </pre></div>
<div row="3034"><pre row="3034">3034       <font color="black">36</font>                                                                                                                 <font color="black">75</font>                                                                                                          </pre></div>
<div row="3035"><pre row="3035">3035       <font color="black">37</font> const formulas = baseFormulas;                                                                                  <font color="black">76</font> const formulas = baseFormulas;                                                                           </pre></div>
<div row="3036"><pre row="3036">3036       <font color="black">38</font>                                                                                                                 <font color="black">77</font>                                                                                                          </pre></div>
<div row="3037"><pre row="3037">3037       <font color="black">39</font> // const formulas = (formulaAry = []) =&gt; {                                                                      <font color="black">78</font> // const formulas = (formulaAry = []) =&gt; {                                                               </pre></div>
<div id="id-core-helper_js"  class="pagelink" row="3038"><pre class="pagehead" row="3038">3038 id-core-helper_js</pre></div>
<div><pre row="3039"><code =class"javascript">3039 ../src/core/helper.js             ../../x-spreadsheet/src/core/helper.js</code></pre></div>
<div id="id-core-history_js"  class="pagelink" row="3040"><pre class="pagehead" row="3040">3040 id-core-history_js</pre></div>
<div row="3041"><pre row="3041">3041 <font color="blue">../src/core/history.js</font>                                                                                             <font color="blue">../../x-spreadsheet/src/core/history.js</font>                                                                           </pre></div>
<div row="3042"><pre row="3042">3042        <font color="black">7</font>   }                                                                                                              <font color="black">7</font>   }                                                                                                      </pre></div>
<div row="3043"><pre row="3043">3043        <font color="black">8</font>                                                                                                                  <font color="black">8</font>                                                                                                          </pre></div>
<div row="3044"><pre row="3044">3044        <font color="black">9</font>   add(data) {                                                                                                    <font color="black">9</font>   add(data) {                                                                                            </pre></div>
<div row="3045"><pre row="3045">3045       <font color="black">10</font>     this.undoItems.push(JSON.stringify(data));                                                                  <font color="black">10</font>     this.undoItems.push(JSON.stringify(data));                                                           </pre></div>
<div row="3046"><pre row="3046">3046       <font color="black">11</font>     this.redoItems = [];                                                                                        <font color="black">11</font>     this.redoItems = [];                                                                                 </pre></div>
<div row="3047"><pre row="3047">3047       <font color="black">12</font> <font color="red">    //console.log("histry add");</font>                                                                                                                                                                                            </pre></div>
<div row="3048"><pre row="3048">3048       <font color="black">13</font>   }                                                                                                             <font color="black">12</font>   }                                                                                                      </pre></div>
<div row="3049"><pre row="3049">3049       <font color="black">14</font>                                                                                                                 <font color="black">13</font>                                                                                                          </pre></div>
<div row="3050"><pre row="3050">3050       <font color="black">15</font>   canUndo() {                                                                                                   <font color="black">14</font>   canUndo() {                                                                                            </pre></div>
<div row="3051"><pre row="3051">3051       <font color="black">16</font>     return this.undoItems.length &gt; 0;                                                                           <font color="black">15</font>     return this.undoItems.length &gt; 0;                                                                    </pre></div>
<div row="3052"><pre row="3052">3052       <font color="black">17</font>   }                                                                                                             <font color="black">16</font>   }                                                                                                      </pre></div>
<div id="id-core-merge_js"  class="pagelink" row="3053"><pre class="pagehead" row="3053">3053 id-core-merge_js</pre></div>
<div><pre row="3054"><code =class"javascript">3054 ../src/core/merge.js             ../../x-spreadsheet/src/core/merge.js</code></pre></div>
<div id="id-core-row_js"  class="pagelink" row="3055"><pre class="pagehead" row="3055">3055 id-core-row_js</pre></div>
<div row="3056"><pre row="3056">3056 <font color="blue">../src/core/row.js</font>                                                                                                 <font color="blue">../../x-spreadsheet/src/core/row.js</font>                                                                               </pre></div>
<div row="3057"><pre row="3057">3057        <font color="black">8</font>     // default row height                                                                                        <font color="black">8</font>     // default row height                                                                                </pre></div>
<div row="3058"><pre row="3058">3058        <font color="black">9</font>     this.height = height;                                                                                        <font color="black">9</font>     this.height = height;                                                                                </pre></div>
<div row="3059"><pre row="3059">3059       <font color="black">10</font>   }                                                                                                             <font color="black">10</font>   }                                                                                                      </pre></div>
<div row="3060"><pre row="3060">3060       <font color="black">11</font>                                                                                                                 <font color="black">11</font>                                                                                                          </pre></div>
<div row="3061"><pre row="3061">3061       <font color="black">12</font>   getHeight(ri) {                                                                                               <font color="black">12</font>   getHeight(ri) {                                                                                        </pre></div>
<div row="3062"><pre row="3062">3062                                                                                                                          <font color="black">13</font> <font color="green">    if (this.isHide(ri)) return 0;</font>                                                                       </pre></div>
<div row="3063"><pre row="3063">3063       <font color="black">13</font>     const row = this.get(ri);                                                                                   <font color="black">14</font>     const row = this.get(ri);                                                                            </pre></div>
<div row="3064"><pre row="3064">3064       <font color="black">14</font>     if (row && row.height) {                                                                                    <font color="black">15</font>     if (row && row.height) {                                                                             </pre></div>
<div row="3065"><pre row="3065">3065       <font color="black">15</font>       return row.height;                                                                                        <font color="black">16</font>       return row.height;                                                                                 </pre></div>
<div row="3066"><pre row="3066">3066       <font color="black">16</font>     }                                                                                                           <font color="black">17</font>     }                                                                                                    </pre></div>
<div row="3067"><pre row="3067">3067       <font color="black">17</font>     return this.height;                                                                                         <font color="black">18</font>     return this.height;                                                                                  </pre></div>
<div row="3068"><pre row="3068">3068       <font color="black">18</font>   }                                                                                                             <font color="black">19</font>   }                                                                                                      </pre></div>
<div row="3069"><pre row="3069">3069       <font color="black">19</font>                                                                                                                 <font color="black">20</font>                                                                                                          </pre></div>
<div row="3070"><pre row="3070">3070       <font color="black">20</font>   setHeight(ri, v) {                                                                                            <font color="black">21</font>   setHeight(ri, v) {                                                                                     </pre></div>
<div row="3071"><pre row="3071">3071       <font color="black">21</font> <font color="red">//    console.log("row setHeight");</font>                                                                                                                                                                                         </pre></div>
<div row="3072"><pre row="3072">3072       <font color="black">22</font>     const row = this.getOrNew(ri);                                                                              <font color="black">22</font>     const row = this.getOrNew(ri);                                                                       </pre></div>
<div row="3073"><pre row="3073">3073       <font color="black">23</font>     row.height = v;                                                                                             <font color="black">23</font>     row.height = v;                                                                                      </pre></div>
<div row="3074"><pre row="3074">3074                                                                                                                          <font color="black">24</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="3075"><pre row="3075">3075                                                                                                                          <font color="black">25</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="3076"><pre row="3076">3076                                                                                                                          <font color="black">26</font> <font color="green">  unhide(idx) {</font>                                                                                          </pre></div>
<div row="3077"><pre row="3077">3077                                                                                                                          <font color="black">27</font> <font color="green">    let index = idx;</font>                                                                                     </pre></div>
<div row="3078"><pre row="3078">3078                                                                                                                          <font color="black">28</font> <font color="green">    while (index &gt; 0) {</font>                                                                                  </pre></div>
<div row="3079"><pre row="3079">3079                                                                                                                          <font color="black">29</font> <font color="green">      index -= 1;</font>                                                                                        </pre></div>
<div row="3080"><pre row="3080">3080                                                                                                                          <font color="black">30</font> <font color="green">      if (this.isHide(index)) {</font>                                                                          </pre></div>
<div row="3081"><pre row="3081">3081                                                                                                                          <font color="black">31</font> <font color="green">        this.setHide(index, false);</font>                                                                      </pre></div>
<div row="3082"><pre row="3082">3082                                                                                                                          <font color="black">32</font> <font color="green">      } else break;</font>                                                                                      </pre></div>
<div row="3083"><pre row="3083">3083                                                                                                                          <font color="black">33</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="3084"><pre row="3084">3084                                                                                                                          <font color="black">34</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="3085"><pre row="3085">3085                                                                                                                          <font color="black">35</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="3086"><pre row="3086">3086                                                                                                                          <font color="black">36</font> <font color="green">  isHide(ri) {</font>                                                                                           </pre></div>
<div row="3087"><pre row="3087">3087                                                                                                                          <font color="black">37</font> <font color="green">    const row = this.get(ri);</font>                                                                            </pre></div>
<div row="3088"><pre row="3088">3088                                                                                                                          <font color="black">38</font> <font color="green">    return row && row.hide;</font>                                                                              </pre></div>
<div row="3089"><pre row="3089">3089                                                                                                                          <font color="black">39</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="3090"><pre row="3090">3090                                                                                                                          <font color="black">40</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="3091"><pre row="3091">3091                                                                                                                          <font color="black">41</font> <font color="green">  setHide(ri, v) {</font>                                                                                       </pre></div>
<div row="3092"><pre row="3092">3092                                                                                                                          <font color="black">42</font> <font color="green">    const row = this.getOrNew(ri);</font>                                                                       </pre></div>
<div row="3093"><pre row="3093">3093                                                                                                                          <font color="black">43</font> <font color="green">    if (v === true) row.hide = true;</font>                                                                     </pre></div>
<div row="3094"><pre row="3094">3094                                                                                                                          <font color="black">44</font> <font color="green">    else delete row.hide;</font>                                                                                </pre></div>
<div row="3095"><pre row="3095">3095       <font color="black">24</font>   }                                                                                                             <font color="black">45</font>   }                                                                                                      </pre></div>
<div row="3096"><pre row="3096">3096       <font color="black">25</font>                                                                                                                 <font color="black">46</font>                                                                                                          </pre></div>
<div row="3097"><pre row="3097">3097       <font color="black">26</font>   setStyle(ri, style) {                                                                                         <font color="black">47</font>   setStyle(ri, style) {                                                                                  </pre></div>
<div row="3098"><pre row="3098">3098       <font color="black">27</font>     const row = this.getOrNew(ri);                                                                              <font color="black">48</font>     const row = this.getOrNew(ri);                                                                       </pre></div>
<div row="3099"><pre row="3099">3099       <font color="black">28</font>     row.style = style;                                                                                          <font color="black">49</font>     row.style = style;                                                                                   </pre></div>
<div row="3100"><pre row="3100">3100 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="3101"><pre row="3101">3101      <font color="black">105</font>     if (deri &lt; sri || deci &lt; sci) {                                                                            <font color="black">126</font>     if (deri &lt; sri || deci &lt; sci) {                                                                      </pre></div>
<div row="3102"><pre row="3102">3102      <font color="black">106</font>       isAdd = false;                                                                                           <font color="black">127</font>       isAdd = false;                                                                                     </pre></div>
<div row="3103"><pre row="3103">3103      <font color="black">107</font>       if (deri &lt; sri) dn = drn;                                                                                <font color="black">128</font>       if (deri &lt; sri) dn = drn;                                                                          </pre></div>
<div row="3104"><pre row="3104">3104      <font color="black">108</font>       else dn = dcn;                                                                                           <font color="black">129</font>       else dn = dcn;                                                                                     </pre></div>
<div row="3105"><pre row="3105">3105      <font color="black">109</font>     }                                                                                                          <font color="black">130</font>     }                                                                                                    </pre></div>
<div row="3106"><pre row="3106">3106      <font color="black">110</font>     // console.log('drn:', drn, ', dcn:', dcn);                                                                <font color="black">131</font>     // console.log('drn:', drn, ', dcn:', dcn<font color="green">, dn, isAdd</font>);                                               </pre></div>
<div row="3107"><pre row="3107">3107      <font color="black">111</font>     for (let i = sri; i &lt;= eri; i += 1) {                                                                      <font color="black">132</font>     for (let i = sri; i &lt;= eri; i += 1) {                                                                </pre></div>
<div row="3108"><pre row="3108">3108      <font color="black">112</font>       if (this._[i]) {                                                                                         <font color="black">133</font>       if (this._[i]) {                                                                                   </pre></div>
<div row="3109"><pre row="3109">3109      <font color="black">113</font>         for (let j = sci; j &lt;= eci; j += 1) {                                                                  <font color="black">134</font>         for (let j = sci; j &lt;= eci; j += 1) {                                                            </pre></div>
<div row="3110"><pre row="3110">3110      <font color="black">114</font>           if (this._[i].cells && this._[i].cells[j]) {                                                         <font color="black">135</font>           if (this._[i].cells && this._[i].cells[j]) {                                                   </pre></div>
<div row="3111"><pre row="3111">3111      <font color="black">115</font>             for (let ii = dsri; ii &lt;= deri; ii += rn) {                                                        <font color="black">136</font>             for (let ii = dsri; ii &lt;= deri; ii += rn) {                                                  </pre></div>
<div row="3112"><pre row="3112">3112 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="3113"><pre row="3113">3113      <font color="black">118</font>                 const nci = jj + (j - sci);                                                                    <font color="black">139</font>                 const nci = jj + (j - sci);                                                              </pre></div>
<div row="3114"><pre row="3114">3114      <font color="black">119</font>                 const ncell = helper.cloneDeep(this._[i].cells[j]);                                            <font color="black">140</font>                 const ncell = helper.cloneDeep(this._[i].cells[j]);                                      </pre></div>
<div row="3115"><pre row="3115">3115      <font color="black">120</font>                 // ncell.text                                                                                  <font color="black">141</font>                 // ncell.text                                                                            </pre></div>
<div row="3116"><pre row="3116">3116      <font color="black">121</font>                 if (autofill && ncell && ncell.text && ncell.text.length &gt; 0) {                                <font color="black">142</font>                 if (autofill && ncell && ncell.text && ncell.text.length &gt; 0) {                          </pre></div>
<div row="3117"><pre row="3117">3117      <font color="black">122</font>                   const { text } = ncell;                                                                      <font color="black">143</font>                   const { text } = ncell;                                                                </pre></div>
<div row="3118"><pre row="3118">3118      <font color="black">123</font>                   let n = (jj - dsci) + (ii - dsri) + <font color="orange">1</font>;                                                       <font color="black">144</font>                   let n = (jj - dsci) + (ii - dsri) + <font color="orange">2</font>;                                                 </pre></div>
<div row="3119"><pre row="3119">3119      <font color="black">124</font> <font color="red">                  // console.log('n:', n);</font>                                                                                                                                                                                  </pre></div>
<div row="3120"><pre row="3120">3120      <font color="black">125</font>                   if (!isAdd) {                                                                                <font color="black">145</font>                   if (!isAdd) {                                                                          </pre></div>
<div row="3121"><pre row="3121">3121      <font color="black">126</font>                     n -= dn + 1;                                                                               <font color="black">146</font>                     n -= dn + 1;                                                                         </pre></div>
<div row="3122"><pre row="3122">3122      <font color="black">127</font>                   }                                                                                            <font color="black">147</font>                   }                                                                                      </pre></div>
<div row="3123"><pre row="3123">3123      <font color="black">128</font>                   if (text[0] === '=') {                                                                       <font color="black">148</font>                   if (text[0] === '=') {                                                                 </pre></div>
<div row="3124"><pre row="3124">3124      <font color="black">129</font>                     ncell.text = text.replace(/\w{1,3}\d/g, (word) =&gt; {                                        <font color="black">149</font>                     ncell.text = text.replace(/\w{1,3}\d/g, (word) =&gt; {                                  </pre></div>
<div row="3125"><pre row="3125">3125      <font color="black">130</font>                       let [xn, yn] = [0, 0];                                                                   <font color="black">150</font>                       let [xn, yn] = [0, 0];                                                             </pre></div>
<div row="3126"><pre row="3126">3126      <font color="black">131</font>                       if (sri === dsri) {                                                                      <font color="black">151</font>                       if (sri === dsri) {                                                                </pre></div>
<div row="3127"><pre row="3127">3127      <font color="black">132</font>                         xn = n;                                                                                <font color="black">152</font>                         xn = n<font color="green"> - 1</font>;                                                                      </pre></div>
<div row="3128"><pre row="3128">3128                                                                                                                         <font color="black">153</font> <font color="green">                        // if (isAdd) xn -= 1;</font>                                                           </pre></div>
<div row="3129"><pre row="3129">3129      <font color="black">133</font>                       } else {                                                                                 <font color="black">154</font>                       } else {                                                                           </pre></div>
<div row="3130"><pre row="3130">3130      <font color="black">134</font>                         yn = n;                                                                                <font color="black">155</font>                         yn = n<font color="green"> - 1</font>;                                                                      </pre></div>
<div row="3131"><pre row="3131">3131      <font color="black">135</font>                       }                                                                                        <font color="black">156</font>                       }                                                                                  </pre></div>
<div row="3132"><pre row="3132">3132      <font color="black">136</font>                       // console.log('xn:', xn, ', yn:', yn, expr2expr(word, xn, yn));                         <font color="black">157</font>                       // console.log('xn:', xn, ', yn:', yn,<font color="green"> word,</font> expr2expr(word, xn, yn));             </pre></div>
<div row="3133"><pre row="3133">3133      <font color="black">137</font>                       return expr2expr(word, xn, yn);                                                          <font color="black">158</font>                       return expr2expr(word, xn, yn);                                                    </pre></div>
<div row="3134"><pre row="3134">3134      <font color="black">138</font>                     });                                                                                        <font color="black">159</font>                     });                                                                                  </pre></div>
<div row="3135"><pre row="3135">3135      <font color="black">139</font>                   } else {                                                                                     <font color="black">160</font>                   } else {                                                                               </pre></div>
<div row="3136"><pre row="3136">3136      <font color="black">140</font>                     const result = /[\\.\d]+$/.exec(text);                                                     <font color="black">161</font>                     const result = /[\\.\d]+$/.exec(text);                                               </pre></div>
<div row="3137"><pre row="3137">3137      <font color="black">141</font>                     // console.log('result:', result);                                                         <font color="black">162</font>                     // console.log('result:', result);                                                   </pre></div>
<div row="3138"><pre row="3138">3138      <font color="black">142</font>                     if (result !== null) {                                                                     <font color="black">163</font>                     if (result !== null) {                                                               </pre></div>
<div row="3139"><pre row="3139">3139      <font color="black">143</font>                       const index = Number(result[0]) + n;                                                     <font color="black">164</font>                       const index = Number(result[0]) + n<font color="green"> - 1</font>;                                           </pre></div>
<div row="3140"><pre row="3140">3140      <font color="black">144</font>                       ncell.text = text.substring(0, result.index) + index;                                    <font color="black">165</font>                       ncell.text = text.substring(0, result.index) + index;                              </pre></div>
<div row="3141"><pre row="3141">3141      <font color="black">145</font>                     }                                                                                          <font color="black">166</font>                     }                                                                                    </pre></div>
<div row="3142"><pre row="3142">3142      <font color="black">146</font>                   }                                                                                            <font color="black">167</font>                   }                                                                                      </pre></div>
<div row="3143"><pre row="3143">3143      <font color="black">147</font>                 }                                                                                              <font color="black">168</font>                 }                                                                                        </pre></div>
<div row="3144"><pre row="3144">3144      <font color="black">148</font> <font color="red">                // console.log('ncell:', nri, nci, ncell);</font>                                                                                                                                                                  </pre></div>
<div row="3145"><pre row="3145">3145      <font color="black">149</font>                 this.setCell(nri, nci, ncell, what);                                                           <font color="black">169</font>                 this.setCell(nri, nci, ncell, what);                                                     </pre></div>
<div row="3146"><pre row="3146">3146      <font color="black">150</font>                 cb(nri, nci, ncell);                                                                           <font color="black">170</font>                 cb(nri, nci, ncell);                                                                     </pre></div>
<div row="3147"><pre row="3147">3147      <font color="black">151</font>               }                                                                                                <font color="black">171</font>               }                                                                                          </pre></div>
<div row="3148"><pre row="3148">3148      <font color="black">152</font>             }                                                                                                  <font color="black">172</font>             }                                                                                            </pre></div>
<div row="3149"><pre row="3149">3149      <font color="black">153</font>           }                                                                                                    <font color="black">173</font>           }                                                                                              </pre></div>
<div row="3150"><pre row="3150">3150 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="3151"><pre row="3151">3151      <font color="black">169</font>         ncellmm[nri] = ncellmm[nri] || { cells: {} };                                                          <font color="black">189</font>         ncellmm[nri] = ncellmm[nri] || { cells: {} };                                                    </pre></div>
<div row="3152"><pre row="3152">3152      <font color="black">170</font>         ncellmm[nri].cells[nci] = this._[ri].cells[ci];                                                        <font color="black">190</font>         ncellmm[nri].cells[nci] = this._[ri].cells[ci];                                                  </pre></div>
<div row="3153"><pre row="3153">3153      <font color="black">171</font>       });                                                                                                      <font color="black">191</font>       });                                                                                                </pre></div>
<div row="3154"><pre row="3154">3154      <font color="black">172</font>     });                                                                                                        <font color="black">192</font>     });                                                                                                  </pre></div>
<div row="3155"><pre row="3155">3155      <font color="black">173</font>     this._ = ncellmm;                                                                                          <font color="black">193</font>     this._ = ncellmm;                                                                                    </pre></div>
<div row="3156"><pre row="3156">3156                                                                                                                         <font color="black">194</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="3157"><pre row="3157">3157                                                                                                                         <font color="black">195</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="3158"><pre row="3158">3158                                                                                                                         <font color="black">196</font> <font color="green">  // src: Array&lt;Array&lt;String&gt;&gt;</font>                                                                           </pre></div>
<div row="3159"><pre row="3159">3159                                                                                                                         <font color="black">197</font> <font color="green">  paste(src, dstCellRange) {</font>                                                                             </pre></div>
<div row="3160"><pre row="3160">3160                                                                                                                         <font color="black">198</font> <font color="green">    if (src.length &lt;= 0) return;</font>                                                                         </pre></div>
<div row="3161"><pre row="3161">3161                                                                                                                         <font color="black">199</font> <font color="green">    const { sri, sci } = dstCellRange;</font>                                                                   </pre></div>
<div row="3162"><pre row="3162">3162                                                                                                                         <font color="black">200</font> <font color="green">    src.forEach((row, i) =&gt; {</font>                                                                            </pre></div>
<div row="3163"><pre row="3163">3163                                                                                                                         <font color="black">201</font> <font color="green">      const ri = sri + i;</font>                                                                                </pre></div>
<div row="3164"><pre row="3164">3164                                                                                                                         <font color="black">202</font> <font color="green">      row.forEach((cell, j) =&gt; {</font>                                                                         </pre></div>
<div row="3165"><pre row="3165">3165                                                                                                                         <font color="black">203</font> <font color="green">        const ci = sci + j;</font>                                                                              </pre></div>
<div row="3166"><pre row="3166">3166                                                                                                                         <font color="black">204</font> <font color="green">        this.setCellText(ri, ci, cell);</font>                                                                  </pre></div>
<div row="3167"><pre row="3167">3167                                                                                                                         <font color="black">205</font> <font color="green">      });</font>                                                                                                </pre></div>
<div row="3168"><pre row="3168">3168                                                                                                                         <font color="black">206</font> <font color="green">    });</font>                                                                                                  </pre></div>
<div row="3169"><pre row="3169">3169      <font color="black">174</font>   }                                                                                                            <font color="black">207</font>   }                                                                                                      </pre></div>
<div row="3170"><pre row="3170">3170      <font color="black">175</font>                                                                                                                <font color="black">208</font>                                                                                                          </pre></div>
<div row="3171"><pre row="3171">3171      <font color="black">176</font>   insert(sri, n = 1) {                                                                                         <font color="black">209</font>   insert(sri, n = 1) {                                                                                   </pre></div>
<div row="3172"><pre row="3172">3172      <font color="black">177</font>     const ndata = {};                                                                                          <font color="black">210</font>     const ndata = {};                                                                                    </pre></div>
<div row="3173"><pre row="3173">3173      <font color="black">178</font>     this.each((ri, row) =&gt; {                                                                                   <font color="black">211</font>     this.each((ri, row) =&gt; {                                                                             </pre></div>
<div row="3174"><pre row="3174">3174 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="3175"><pre row="3175">3175      <font color="black">257</font>         }                                                                                                      <font color="black">290</font>         }                                                                                                </pre></div>
<div row="3176"><pre row="3176">3176      <font color="black">258</font>       }                                                                                                        <font color="black">291</font>       }                                                                                                  </pre></div>
<div row="3177"><pre row="3177">3177      <font color="black">259</font>     }                                                                                                          <font color="black">292</font>     }                                                                                                    </pre></div>
<div row="3178"><pre row="3178">3178      <font color="black">260</font>   }                                                                                                            <font color="black">293</font>   }                                                                                                      </pre></div>
<div row="3179"><pre row="3179">3179      <font color="black">261</font>                                                                                                                <font color="black">294</font>                                                                                                          </pre></div>
<div row="3180"><pre row="3180">3180                                                                                                                         <font color="black">295</font> <font color="green">  maxCell() {</font>                                                                                            </pre></div>
<div row="3181"><pre row="3181">3181                                                                                                                         <font color="black">296</font> <font color="green">    const keys = Object.keys(this._);</font>                                                                    </pre></div>
<div row="3182"><pre row="3182">3182                                                                                                                         <font color="black">297</font> <font color="green">    const ri = keys[keys.length - 1];</font>                                                                    </pre></div>
<div row="3183"><pre row="3183">3183                                                                                                                         <font color="black">298</font> <font color="green">    const col = this._[ri];</font>                                                                              </pre></div>
<div row="3184"><pre row="3184">3184                                                                                                                         <font color="black">299</font> <font color="green">    if (col) {</font>                                                                                           </pre></div>
<div row="3185"><pre row="3185">3185                                                                                                                         <font color="black">300</font> <font color="green">      const { cells } = col;</font>                                                                             </pre></div>
<div row="3186"><pre row="3186">3186                                                                                                                         <font color="black">301</font> <font color="green">      const ks = Object.keys(cells);</font>                                                                     </pre></div>
<div row="3187"><pre row="3187">3187                                                                                                                         <font color="black">302</font> <font color="green">      const ci = ks[ks.length - 1];</font>                                                                      </pre></div>
<div row="3188"><pre row="3188">3188                                                                                                                         <font color="black">303</font> <font color="green">      return [parseInt(ri, 10), parseInt(ci, 10)];</font>                                                       </pre></div>
<div row="3189"><pre row="3189">3189                                                                                                                         <font color="black">304</font> <font color="green">    }</font>                                                                                                    </pre></div>
<div row="3190"><pre row="3190">3190                                                                                                                         <font color="black">305</font> <font color="green">    return [0, 0];</font>                                                                                       </pre></div>
<div row="3191"><pre row="3191">3191                                                                                                                         <font color="black">306</font> <font color="green">  }</font>                                                                                                      </pre></div>
<div row="3192"><pre row="3192">3192                                                                                                                         <font color="black">307</font> <font color="green"> </font>                                                                                                        </pre></div>
<div row="3193"><pre row="3193">3193      <font color="black">262</font>   each(cb) {                                                                                                   <font color="black">308</font>   each(cb) {                                                                                             </pre></div>
<div row="3194"><pre row="3194">3194      <font color="black">263</font>     Object.entries(this._).forEach(([ri, row]) =&gt; {                                                            <font color="black">309</font>     Object.entries(this._).forEach(([ri, row]) =&gt; {                                                      </pre></div>
<div row="3195"><pre row="3195">3195      <font color="black">264</font>       cb(ri, row);                                                                                             <font color="black">310</font>       cb(ri, row);                                                                                       </pre></div>
<div row="3196"><pre row="3196">3196      <font color="black">265</font>     });                                                                                                        <font color="black">311</font>     });                                                                                                  </pre></div>
<div row="3197"><pre row="3197">3197      <font color="black">266</font>   }                                                                                                            <font color="black">312</font>   }                                                                                                      </pre></div>
<div row="3198"><pre row="3198">3198 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="3199"><pre row="3199">3199      <font color="black">272</font>       });                                                                                                      <font color="black">318</font>       });                                                                                                </pre></div>
<div row="3200"><pre row="3200">3200      <font color="black">273</font>     }                                                                                                          <font color="black">319</font>     }                                                                                                    </pre></div>
<div row="3201"><pre row="3201">3201      <font color="black">274</font>   }                                                                                                            <font color="black">320</font>   }                                                                                                      </pre></div>
<div row="3202"><pre row="3202">3202      <font color="black">275</font>                                                                                                                <font color="black">321</font>                                                                                                          </pre></div>
<div row="3203"><pre row="3203">3203      <font color="black">276</font>   setData(d) {                                                                                                 <font color="black">322</font>   setData(d) {                                                                                           </pre></div>
<div row="3204"><pre row="3204">3204      <font color="black">277</font> <font color="red">//    console.log("row setData: ",d);</font>                                                                                                                                                                                       </pre></div>
<div row="3205"><pre row="3205">3205      <font color="black">278</font>     if (d.len) {                                                                                               <font color="black">323</font>     if (d.len) {                                                                                         </pre></div>
<div row="3206"><pre row="3206">3206      <font color="black">279</font>       this.len = d.len;                                                                                        <font color="black">324</font>       this.len = d.len;                                                                                  </pre></div>
<div row="3207"><pre row="3207">3207      <font color="black">280</font>       delete d.len;                                                                                            <font color="black">325</font>       delete d.len;                                                                                      </pre></div>
<div row="3208"><pre row="3208">3208      <font color="black">281</font>     }                                                                                                          <font color="black">326</font>     }                                                                                                    </pre></div>
<div row="3209"><pre row="3209">3209      <font color="black">282</font>     this._ = d;                                                                                                <font color="black">327</font>     this._ = d;                                                                                          </pre></div>
<div id="id-core-scroll_js"  class="pagelink" row="3210"><pre class="pagehead" row="3210">3210 id-core-scroll_js</pre></div>
<div><pre row="3211"><code =class"javascript">3211 ../src/core/scroll.js             ../../x-spreadsheet/src/core/scroll.js</code></pre></div>
<div id="id-core-selector_js"  class="pagelink" row="3212"><pre class="pagehead" row="3212">3212 id-core-selector_js</pre></div>
<div><pre row="3213"><code =class"javascript">3213 ../src/core/selector.js             ../../x-spreadsheet/src/core/selector.js</code></pre></div>
<div id="id-core-validation_js"  class="pagelink" row="3214"><pre class="pagehead" row="3214">3214 id-core-validation_js</pre></div>
<div><pre row="3215"><code =class"javascript">3215 ../src/core/validation.js             ../../x-spreadsheet/src/core/validation.js</code></pre></div>
<div id="id-core-validator_js"  class="pagelink" row="3216"><pre class="pagehead" row="3216">3216 id-core-validator_js</pre></div>
<div><pre row="3217"><code =class"javascript">3217 ../src/core/validator.js             ../../x-spreadsheet/src/core/validator.js</code></pre></div>
<div id="id-locale-de_js"  class="pagelink" row="3218"><pre class="pagehead" row="3218">3218 id-locale-de_js</pre></div>
<div><pre row="3219"><code =class"javascript">3219 ../src/locale/de.js             ../../x-spreadsheet/src/locale/de.js</code></pre></div>
<div id="id-locale-en_js"  class="pagelink" row="3220"><pre class="pagehead" row="3220">3220 id-locale-en_js</pre></div>
<div row="3221"><pre row="3221">3221 <font color="blue">../src/locale/en.js</font>                                                                                                <font color="blue">../../x-spreadsheet/src/locale/en.js</font>                                                                              </pre></div>
<div row="3222"><pre row="3222">3222        <font color="black">1</font> export default {                                                                                                 <font color="black">1</font> export default {                                                                                         </pre></div>
<div row="3223"><pre row="3223">3223        <font color="black">2</font>   toolbar: {                                                                                                     <font color="black">2</font>   toolbar: {                                                                                             </pre></div>
<div row="3224"><pre row="3224">3224        <font color="black">3</font>     undo: 'Undo',                                                                                                <font color="black">3</font>     undo: 'Undo',                                                                                        </pre></div>
<div row="3225"><pre row="3225">3225        <font color="black">4</font>     redo: 'Redo',                                                                                                <font color="black">4</font>     redo: 'Redo',                                                                                        </pre></div>
<div row="3226"><pre row="3226">3226                                                                                                                           <font color="black">5</font> <font color="green">    print: 'Print',</font>                                                                                      </pre></div>
<div row="3227"><pre row="3227">3227        <font color="black">5</font>     paintformat: 'Paint format',                                                                                 <font color="black">6</font>     paintformat: 'Paint format',                                                                         </pre></div>
<div row="3228"><pre row="3228">3228        <font color="black">6</font>     clearformat: 'Clear format',                                                                                 <font color="black">7</font>     clearformat: 'Clear format',                                                                         </pre></div>
<div row="3229"><pre row="3229">3229        <font color="black">7</font>     format: 'Format',                                                                                            <font color="black">8</font>     format: 'Format',                                                                                    </pre></div>
<div row="3230"><pre row="3230">3230        <font color="black">8</font>     font: 'Font',                                                                                                <font color="black">9</font>     font<font color="green">Name</font>: 'Font',                                                                                    </pre></div>
<div row="3231"><pre row="3231">3231        <font color="black">9</font>     fontSize: 'Font size',                                                                                      <font color="black">10</font>     fontSize: 'Font size',                                                                               </pre></div>
<div row="3232"><pre row="3232">3232       <font color="black">10</font>     fontBold: 'Font bold',                                                                                      <font color="black">11</font>     fontBold: 'Font bold',                                                                               </pre></div>
<div row="3233"><pre row="3233">3233       <font color="black">11</font>     fontItalic: 'Font italic',                                                                                  <font color="black">12</font>     fontItalic: 'Font italic',                                                                           </pre></div>
<div row="3234"><pre row="3234">3234       <font color="black">12</font>     underline: 'Underline',                                                                                     <font color="black">13</font>     underline: 'Underline',                                                                              </pre></div>
<div row="3235"><pre row="3235">3235       <font color="black">13</font>     strike: 'Strike',                                                                                           <font color="black">14</font>     strike: 'Strike',                                                                                    </pre></div>
<div row="3236"><pre row="3236">3236       <font color="black">14</font>     <font color="orange">textC</font>olor: 'Text color',                                                                                    <font color="black">15</font>     <font color="orange">c</font>olor: 'Text color',                                                                                 </pre></div>
<div row="3237"><pre row="3237">3237       <font color="black">15</font>     <font color="orange">fillC</font>olor: 'Fill color',                                                                                    <font color="black">16</font>     <font color="orange">bgc</font>olor: 'Fill color',                                                                               </pre></div>
<div row="3238"><pre row="3238">3238       <font color="black">16</font>     border: 'Borders',                                                                                          <font color="black">17</font>     border: 'Borders',                                                                                   </pre></div>
<div row="3239"><pre row="3239">3239       <font color="black">17</font>     merge: 'Merge cells',                                                                                       <font color="black">18</font>     merge: 'Merge cells',                                                                                </pre></div>
<div row="3240"><pre row="3240">3240       <font color="black">18</font>     align: 'Horizontal align',                                                                                  <font color="black">19</font>     align: 'Horizontal align',                                                                           </pre></div>
<div row="3241"><pre row="3241">3241       <font color="black">19</font>     valign: 'Vertical align',                                                                                   <font color="black">20</font>     valign: 'Vertical align',                                                                            </pre></div>
<div row="3242"><pre row="3242">3242       <font color="black">20</font>     textwrap: 'Text wrapping',                                                                                  <font color="black">21</font>     textwrap: 'Text wrapping',                                                                           </pre></div>
<div row="3243"><pre row="3243">3243       <font color="black">21</font>     freeze: 'Freeze cell',                                                                                      <font color="black">22</font>     freeze: 'Freeze cell',                                                                               </pre></div>
<div row="3244"><pre row="3244">3244       <font color="black">22</font> <font color="red">    overlayer: 'OverLayer enable',</font>                                                                                                                                                                                          </pre></div>
<div row="3245"><pre row="3245">3245       <font color="black">23</font>     autofilter: 'Filter',                                                                                       <font color="black">23</font>     autofilter: 'Filter',                                                                                </pre></div>
<div row="3246"><pre row="3246">3246       <font color="black">24</font>     formula: 'Functions',                                                                                       <font color="black">24</font>     formula: 'Functions',                                                                                </pre></div>
<div row="3247"><pre row="3247">3247       <font color="black">25</font>     more: 'More',                                                                                               <font color="black">25</font>     more: 'More',                                                                                        </pre></div>
<div row="3248"><pre row="3248">3248       <font color="black">26</font>   },                                                                                                            <font color="black">26</font>   },                                                                                                     </pre></div>
<div row="3249"><pre row="3249">3249       <font color="black">27</font>   contextmenu: {                                                                                                <font color="black">27</font>   contextmenu: {                                                                                         </pre></div>
<div row="3250"><pre row="3250">3250       <font color="black">28</font>     copy: 'Copy',                                                                                               <font color="black">28</font>     copy: 'Copy',                                                                                        </pre></div>
<div row="3251"><pre row="3251">3251       <font color="black">29</font>     cut: 'Cut',                                                                                                 <font color="black">29</font>     cut: 'Cut',                                                                                          </pre></div>
<div row="3252"><pre row="3252">3252       <font color="black">30</font>     paste: 'Paste',                                                                                             <font color="black">30</font>     paste: 'Paste',                                                                                      </pre></div>
<div row="3253"><pre row="3253">3253       <font color="black">31</font>     pasteValue: 'Paste values only',                                                                            <font color="black">31</font>     pasteValue: 'Paste values only',                                                                     </pre></div>
<div row="3254"><pre row="3254">3254       <font color="black">32</font>     pasteFormat: 'Paste format only',                                                                           <font color="black">32</font>     pasteFormat: 'Paste format only',                                                                    </pre></div>
<div row="3255"><pre row="3255">3255                                                                                                                          <font color="black">33</font> <font color="green">    hide: 'Hide',</font>                                                                                        </pre></div>
<div row="3256"><pre row="3256">3256       <font color="black">33</font>     insertRow: 'Insert row',                                                                                    <font color="black">34</font>     insertRow: 'Insert row',                                                                             </pre></div>
<div row="3257"><pre row="3257">3257       <font color="black">34</font>     insertColumn: 'Insert column',                                                                              <font color="black">35</font>     insertColumn: 'Insert column',                                                                       </pre></div>
<div row="3258"><pre row="3258">3258                                                                                                                          <font color="black">36</font> <font color="green">    deleteSheet: 'Delete',</font>                                                                               </pre></div>
<div row="3259"><pre row="3259">3259       <font color="black">35</font>     deleteRow: 'Delete row',                                                                                    <font color="black">37</font>     deleteRow: 'Delete row',                                                                             </pre></div>
<div row="3260"><pre row="3260">3260       <font color="black">36</font>     deleteColumn: 'Delete column',                                                                              <font color="black">38</font>     deleteColumn: 'Delete column',                                                                       </pre></div>
<div row="3261"><pre row="3261">3261       <font color="black">37</font>     deleteCell: 'Delete cell',                                                                                  <font color="black">39</font>     deleteCell: 'Delete cell',                                                                           </pre></div>
<div row="3262"><pre row="3262">3262       <font color="black">38</font>     deleteCellText: 'Delete cell text',                                                                         <font color="black">40</font>     deleteCellText: 'Delete cell text',                                                                  </pre></div>
<div row="3263"><pre row="3263">3263       <font color="black">39</font>     validation: 'Data validations',                                                                             <font color="black">41</font>     validation: 'Data validations',                                                                      </pre></div>
<div row="3264"><pre row="3264">3264                                                                                                                          <font color="black">42</font> <font color="green">    cellprintable: 'Enable export',</font>                                                                      </pre></div>
<div row="3265"><pre row="3265">3265                                                                                                                          <font color="black">43</font> <font color="green">    cellnonprintable: 'Disable export',</font>                                                                  </pre></div>
<div row="3266"><pre row="3266">3266                                                                                                                          <font color="black">44</font> <font color="green">    celleditable: 'Enable editing',</font>                                                                      </pre></div>
<div row="3267"><pre row="3267">3267                                                                                                                          <font color="black">45</font> <font color="green">    cellnoneditable: 'Disable editing',</font>                                                                  </pre></div>
<div row="3268"><pre row="3268">3268       <font color="black">40</font>   },                                                                                                            <font color="black">46</font>   },                                                                                                     </pre></div>
<div row="3269"><pre row="3269">3269       <font color="black">41</font>   format: {                                                                                                     <font color="black">47</font>   format: {                                                                                              </pre></div>
<div row="3270"><pre row="3270">3270       <font color="black">42</font>     normal: 'Normal',                                                                                           <font color="black">48</font>     normal: 'Normal',                                                                                    </pre></div>
<div row="3271"><pre row="3271">3271       <font color="black">43</font>     text: 'Plain Text',                                                                                         <font color="black">49</font>     text: 'Plain Text',                                                                                  </pre></div>
<div row="3272"><pre row="3272">3272       <font color="black">44</font>     number: 'Number',                                                                                           <font color="black">50</font>     number: 'Number',                                                                                    </pre></div>
<div row="3273"><pre row="3273">3273       <font color="black">45</font>     percent: 'Percent',                                                                                         <font color="black">51</font>     percent: 'Percent',                                                                                  </pre></div>
<div row="3274"><pre row="3274">3274       <font color="black">46</font>     rmb: 'RMB',                                                                                                 <font color="black">52</font>     rmb: 'RMB',                                                                                          </pre></div>
<div row="3275"><pre row="3275">3275       <font color="black">47</font>     usd: 'USD',                                                                                                 <font color="black">53</font>     usd: 'USD',                                                                                          </pre></div>
<div row="3276"><pre row="3276">3276                                                                                                                          <font color="black">54</font> <font color="green">    eur: 'EUR',</font>                                                                                          </pre></div>
<div row="3277"><pre row="3277">3277       <font color="black">48</font>     date: 'Date',                                                                                               <font color="black">55</font>     date: 'Date',                                                                                        </pre></div>
<div row="3278"><pre row="3278">3278       <font color="black">49</font>     time: 'Time',                                                                                               <font color="black">56</font>     time: 'Time',                                                                                        </pre></div>
<div row="3279"><pre row="3279">3279       <font color="black">50</font>     datetime: 'Date time',                                                                                      <font color="black">57</font>     datetime: 'Date time',                                                                               </pre></div>
<div row="3280"><pre row="3280">3280       <font color="black">51</font>     duration: 'Duration',                                                                                       <font color="black">58</font>     duration: 'Duration',                                                                                </pre></div>
<div row="3281"><pre row="3281">3281       <font color="black">52</font>   },                                                                                                            <font color="black">59</font>   },                                                                                                     </pre></div>
<div row="3282"><pre row="3282">3282       <font color="black">53</font>   formula: {                                                                                                    <font color="black">60</font>   formula: {                                                                                             </pre></div>
<div row="3283"><pre row="3283">3283       <font color="black">54</font>     sum: 'Sum',                                                                                                 <font color="black">61</font>     sum: 'Sum',                                                                                          </pre></div>
<div row="3284"><pre row="3284">3284       <font color="black">55</font>     average: 'Average',                                                                                         <font color="black">62</font>     average: 'Average',                                                                                  </pre></div>
<div row="3285"><pre row="3285">3285       <font color="black">56</font>     max: 'Max',                                                                                                 <font color="black">63</font>     max: 'Max',                                                                                          </pre></div>
<div row="3286"><pre row="3286">3286       <font color="black">57</font>     min: 'Min',                                                                                                 <font color="black">64</font>     min: 'Min',                                                                                          </pre></div>
<div row="3287"><pre row="3287">3287                                                                                                                          <font color="black">65</font> <font color="green">    _if: 'IF',</font>                                                                                           </pre></div>
<div row="3288"><pre row="3288">3288                                                                                                                          <font color="black">66</font> <font color="green">    and: 'AND',</font>                                                                                          </pre></div>
<div row="3289"><pre row="3289">3289                                                                                                                          <font color="black">67</font> <font color="green">    or: 'OR',</font>                                                                                            </pre></div>
<div row="3290"><pre row="3290">3290       <font color="black">58</font>     concat: 'Concat',                                                                                           <font color="black">68</font>     concat: 'Concat',                                                                                    </pre></div>
<div row="3291"><pre row="3291">3291       <font color="black">59</font>   },                                                                                                            <font color="black">69</font>   },                                                                                                     </pre></div>
<div row="3292"><pre row="3292">3292       <font color="black">60</font>   validation: {                                                                                                 <font color="black">70</font>   validation: {                                                                                          </pre></div>
<div row="3293"><pre row="3293">3293       <font color="black">61</font>     required: 'it must be required',                                                                            <font color="black">71</font>     required: 'it must be required',                                                                     </pre></div>
<div row="3294"><pre row="3294">3294       <font color="black">62</font>     notMatch: 'it not match its validation rule',                                                               <font color="black">72</font>     notMatch: 'it not match its validation rule',                                                        </pre></div>
<div row="3295"><pre row="3295">3295 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="3296"><pre row="3296">3296       <font color="black">76</font>   calendar: {                                                                                                   <font color="black">86</font>   calendar: {                                                                                            </pre></div>
<div row="3297"><pre row="3297">3297       <font color="black">77</font>     weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],                                                   <font color="black">87</font>     weeks: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],                                            </pre></div>
<div row="3298"><pre row="3298">3298       <font color="black">78</font>     months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'Octo       <font color="black">88</font>     months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'Octo</pre></div>
<div row="3299"><pre row="3299">3299 ber', 'November', 'December'],                                                                                     ber', 'November', 'December'],                                                                                    </pre></div>
<div row="3300"><pre row="3300">3300       <font color="black">79</font>   },                                                                                                            <font color="black">89</font>   },                                                                                                     </pre></div>
<div row="3301"><pre row="3301">3301       <font color="black">80</font>   button: {                                                                                                     <font color="black">90</font>   button: {                                                                                              </pre></div>
<div row="3302"><pre row="3302">3302                                                                                                                          <font color="black">91</font> <font color="green">    next: 'Next',</font>                                                                                        </pre></div>
<div row="3303"><pre row="3303">3303       <font color="black">81</font>     cancel: 'Cancel',                                                                                           <font color="black">92</font>     cancel: 'Cancel',                                                                                    </pre></div>
<div row="3304"><pre row="3304">3304       <font color="black">82</font>     remove: 'Remove',                                                                                           <font color="black">93</font>     remove: 'Remove',                                                                                    </pre></div>
<div row="3305"><pre row="3305">3305       <font color="black">83</font>     save: 'Save',                                                                                               <font color="black">94</font>     save: 'Save',                                                                                        </pre></div>
<div row="3306"><pre row="3306">3306       <font color="black">84</font>     ok: 'OK',                                                                                                   <font color="black">95</font>     ok: 'OK',                                                                                            </pre></div>
<div row="3307"><pre row="3307">3307       <font color="black">85</font>   },                                                                                                            <font color="black">96</font>   },                                                                                                     </pre></div>
<div id="id-locale-locale_js"  class="pagelink" row="3308"><pre class="pagehead" row="3308">3308 id-locale-locale_js</pre></div>
<div><pre row="3309"><code =class"javascript">3309 ../src/locale/locale.js             ../../x-spreadsheet/src/locale/locale.js</code></pre></div>
<div id="id-locale-nl_js"  class="pagelink" row="3310"><pre class="pagehead" row="3310">3310 id-locale-nl_js</pre></div>
<div><pre row="3311"><code =class"javascript">3311 ../src/locale/nl.js             ../../x-spreadsheet/src/locale/nl.js</code></pre></div>
<div id="id-locale-zh-cn_js"  class="pagelink" row="3312"><pre class="pagehead" row="3312">3312 id-locale-zh-cn_js</pre></div>
<div row="3313"><pre row="3313">3313 <font color="blue">../src/locale/zh-cn.js</font>                                                                                             <font color="blue">../../x-spreadsheet/src/locale/zh-cn.js</font>                                                                           </pre></div>
<div row="3314"><pre row="3314">3314        <font color="black">1</font> export default {                                                                                                 <font color="black">1</font> export default {                                                                                         </pre></div>
<div row="3315"><pre row="3315">3315        <font color="black">2</font>   toolbar: {                                                                                                     <font color="black">2</font>   toolbar: {                                                                                             </pre></div>
<div row="3316"><pre row="3316">3316        <font color="black">3</font>     undo: '撤销',                                                                                                <font color="black">3</font>     undo: '撤销',                                                                                        </pre></div>
<div row="3317"><pre row="3317">3317        <font color="black">4</font>     redo: '恢复',                                                                                                <font color="black">4</font>     redo: '恢复',                                                                                        </pre></div>
<div row="3318"><pre row="3318">3318                                                                                                                           <font color="black">5</font> <font color="green">    print: '打印',</font>                                                                                       </pre></div>
<div row="3319"><pre row="3319">3319        <font color="black">5</font>     paintformat: '格式刷',                                                                                       <font color="black">6</font>     paintformat: '格式刷',                                                                               </pre></div>
<div row="3320"><pre row="3320">3320        <font color="black">6</font>     clearformat: '清除格式',                                                                                     <font color="black">7</font>     clearformat: '清除格式',                                                                             </pre></div>
<div row="3321"><pre row="3321">3321        <font color="black">7</font>     format: '数据格式',                                                                                          <font color="black">8</font>     format: '数据格式',                                                                                  </pre></div>
<div row="3322"><pre row="3322">3322        <font color="black">8</font>     font: '字体',                                                                                                <font color="black">9</font>     font<font color="green">Name</font>: '字体',                                                                                    </pre></div>
<div row="3323"><pre row="3323">3323        <font color="black">9</font>     fontSize: '字号',                                                                                           <font color="black">10</font>     fontSize: '字号',                                                                                    </pre></div>
<div row="3324"><pre row="3324">3324       <font color="black">10</font>     fontBold: '加粗',                                                                                           <font color="black">11</font>     fontBold: '加粗',                                                                                    </pre></div>
<div row="3325"><pre row="3325">3325       <font color="black">11</font>     fontItalic: '倾斜',                                                                                         <font color="black">12</font>     fontItalic: '倾斜',                                                                                  </pre></div>
<div row="3326"><pre row="3326">3326       <font color="black">12</font>     underline: '下划线',                                                                                        <font color="black">13</font>     underline: '下划线',                                                                                 </pre></div>
<div row="3327"><pre row="3327">3327       <font color="black">13</font>     strike: '删除线',                                                                                           <font color="black">14</font>     strike: '删除线',                                                                                    </pre></div>
<div row="3328"><pre row="3328">3328       <font color="black">14</font>     <font color="orange">textC</font>olor: '字体颜色',                                                                                      <font color="black">15</font>     <font color="orange">c</font>olor: '字体颜色',                                                                                   </pre></div>
<div row="3329"><pre row="3329">3329       <font color="black">15</font>     <font color="orange">fillC</font>olor: '填充颜色',                                                                                      <font color="black">16</font>     <font color="orange">bgc</font>olor: '填充颜色',                                                                                 </pre></div>
<div row="3330"><pre row="3330">3330       <font color="black">16</font>     border: '边框',                                                                                             <font color="black">17</font>     border: '边框',                                                                                      </pre></div>
<div row="3331"><pre row="3331">3331       <font color="black">17</font>     merge: '合并单元格',                                                                                        <font color="black">18</font>     merge: '合并单元格',                                                                                 </pre></div>
<div row="3332"><pre row="3332">3332       <font color="black">18</font>     align: '水平对齐',                                                                                          <font color="black">19</font>     align: '水平对齐',                                                                                   </pre></div>
<div row="3333"><pre row="3333">3333       <font color="black">19</font>     valign: '垂直对齐',                                                                                         <font color="black">20</font>     valign: '垂直对齐',                                                                                  </pre></div>
<div row="3334"><pre row="3334">3334       <font color="black">20</font>     textwrap: '自动换行',                                                                                       <font color="black">21</font>     textwrap: '自动换行',                                                                                </pre></div>
<div row="3335"><pre row="3335">3335 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="3336"><pre row="3336">3336       <font color="black">27</font>     copy: '复制',                                                                                               <font color="black">28</font>     copy: '复制',                                                                                        </pre></div>
<div row="3337"><pre row="3337">3337       <font color="black">28</font>     cut: '剪切',                                                                                                <font color="black">29</font>     cut: '剪切',                                                                                         </pre></div>
<div row="3338"><pre row="3338">3338       <font color="black">29</font>     paste: '粘贴',                                                                                              <font color="black">30</font>     paste: '粘贴',                                                                                       </pre></div>
<div row="3339"><pre row="3339">3339       <font color="black">30</font>     pasteValue: '粘贴数据',                                                                                     <font color="black">31</font>     pasteValue: '粘贴数据',                                                                              </pre></div>
<div row="3340"><pre row="3340">3340       <font color="black">31</font>     pasteFormat: '粘贴格式',                                                                                    <font color="black">32</font>     pasteFormat: '粘贴格式',                                                                             </pre></div>
<div row="3341"><pre row="3341">3341                                                                                                                          <font color="black">33</font> <font color="green">    hide: '隐藏',</font>                                                                                        </pre></div>
<div row="3342"><pre row="3342">3342       <font color="black">32</font>     insertRow: '插入行',                                                                                        <font color="black">34</font>     insertRow: '插入行',                                                                                 </pre></div>
<div row="3343"><pre row="3343">3343       <font color="black">33</font>     insertColumn: '插入列',                                                                                     <font color="black">35</font>     insertColumn: '插入列',                                                                              </pre></div>
<div row="3344"><pre row="3344">3344                                                                                                                          <font color="black">36</font> <font color="green">    deleteSheet: '删除',</font>                                                                                 </pre></div>
<div row="3345"><pre row="3345">3345       <font color="black">34</font>     deleteRow: '删除行',                                                                                        <font color="black">37</font>     deleteRow: '删除行',                                                                                 </pre></div>
<div row="3346"><pre row="3346">3346       <font color="black">35</font>     deleteColumn: '删除列',                                                                                     <font color="black">38</font>     deleteColumn: '删除列',                                                                              </pre></div>
<div row="3347"><pre row="3347">3347       <font color="black">36</font>     deleteCell: '删除',                                                                                         <font color="black">39</font>     deleteCell: '删除',                                                                                  </pre></div>
<div row="3348"><pre row="3348">3348       <font color="black">37</font>     deleteCellText: '删除数据',                                                                                 <font color="black">40</font>     deleteCellText: '删除数据',                                                                          </pre></div>
<div row="3349"><pre row="3349">3349       <font color="black">38</font>     validation: '数据验证',                                                                                     <font color="black">41</font>     validation: '数据验证',                                                                              </pre></div>
<div row="3350"><pre row="3350">3350                                                                                                                          <font color="black">42</font> <font color="green">    cellprintable: '可打印',</font>                                                                             </pre></div>
<div row="3351"><pre row="3351">3351                                                                                                                          <font color="black">43</font> <font color="green">    cellnonprintable: '不可打印',</font>                                                                        </pre></div>
<div row="3352"><pre row="3352">3352                                                                                                                          <font color="black">44</font> <font color="green">    celleditable: '可编辑',</font>                                                                              </pre></div>
<div row="3353"><pre row="3353">3353                                                                                                                          <font color="black">45</font> <font color="green">    cellnoneditable: '不可编辑',</font>                                                                         </pre></div>
<div row="3354"><pre row="3354">3354       <font color="black">39</font>   },                                                                                                            <font color="black">46</font>   },                                                                                                     </pre></div>
<div row="3355"><pre row="3355">3355       <font color="black">40</font>   format: {                                                                                                     <font color="black">47</font>   format: {                                                                                              </pre></div>
<div row="3356"><pre row="3356">3356       <font color="black">41</font>     normal: '正常',                                                                                             <font color="black">48</font>     normal: '正常',                                                                                      </pre></div>
<div row="3357"><pre row="3357">3357       <font color="black">42</font>     text: '文本',                                                                                               <font color="black">49</font>     text: '文本',                                                                                        </pre></div>
<div row="3358"><pre row="3358">3358       <font color="black">43</font>     number: '数值',                                                                                             <font color="black">50</font>     number: '数值',                                                                                      </pre></div>
<div row="3359"><pre row="3359">3359       <font color="black">44</font>     percent: '百分比',                                                                                          <font color="black">51</font>     percent: '百分比',                                                                                   </pre></div>
<div row="3360"><pre row="3360">3360       <font color="black">45</font>     rmb: '人民币',                                                                                              <font color="black">52</font>     rmb: '人民币',                                                                                       </pre></div>
<div row="3361"><pre row="3361">3361       <font color="black">46</font>     usd: '美元',                                                                                                <font color="black">53</font>     usd: '美元',                                                                                         </pre></div>
<div row="3362"><pre row="3362">3362                                                                                                                          <font color="black">54</font> <font color="green">    eur: '欧元',</font>                                                                                         </pre></div>
<div row="3363"><pre row="3363">3363       <font color="black">47</font>     date: '短日期',                                                                                             <font color="black">55</font>     date: '短日期',                                                                                      </pre></div>
<div row="3364"><pre row="3364">3364       <font color="black">48</font>     time: '时间',                                                                                               <font color="black">56</font>     time: '时间',                                                                                        </pre></div>
<div row="3365"><pre row="3365">3365       <font color="black">49</font>     datetime: '长日期',                                                                                         <font color="black">57</font>     datetime: '长日期',                                                                                  </pre></div>
<div row="3366"><pre row="3366">3366       <font color="black">50</font>     duration: '持续时间',                                                                                       <font color="black">58</font>     duration: '持续时间',                                                                                </pre></div>
<div row="3367"><pre row="3367">3367       <font color="black">51</font>   },                                                                                                            <font color="black">59</font>   },                                                                                                     </pre></div>
<div row="3368"><pre row="3368">3368 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="3369"><pre row="3369">3369       <font color="black">53</font>     sum: '求和',                                                                                                <font color="black">61</font>     sum: '求和',                                                                                         </pre></div>
<div row="3370"><pre row="3370">3370       <font color="black">54</font>     average: '求平均值',                                                                                        <font color="black">62</font>     average: '求平均值',                                                                                 </pre></div>
<div row="3371"><pre row="3371">3371       <font color="black">55</font>     max: '求最大值',                                                                                            <font color="black">63</font>     max: '求最大值',                                                                                     </pre></div>
<div row="3372"><pre row="3372">3372       <font color="black">56</font>     min: '求最小值',                                                                                            <font color="black">64</font>     min: '求最小值',                                                                                     </pre></div>
<div row="3373"><pre row="3373">3373       <font color="black">57</font>     concat: '字符拼接',                                                                                         <font color="black">65</font>     concat: '字符拼接',                                                                                  </pre></div>
<div row="3374"><pre row="3374">3374                                                                                                                          <font color="black">66</font> <font color="green">    _if: '条件判断',</font>                                                                                     </pre></div>
<div row="3375"><pre row="3375">3375                                                                                                                          <font color="black">67</font> <font color="green">    and: '和',</font>                                                                                           </pre></div>
<div row="3376"><pre row="3376">3376                                                                                                                          <font color="black">68</font> <font color="green">    or: '或',</font>                                                                                            </pre></div>
<div row="3377"><pre row="3377">3377       <font color="black">58</font>   },                                                                                                            <font color="black">69</font>   },                                                                                                     </pre></div>
<div row="3378"><pre row="3378">3378       <font color="black">59</font>   validation: {                                                                                                 <font color="black">70</font>   validation: {                                                                                          </pre></div>
<div row="3379"><pre row="3379">3379       <font color="black">60</font>     required: '此值必填',                                                                                       <font color="black">71</font>     required: '此值必填',                                                                                </pre></div>
<div row="3380"><pre row="3380">3380       <font color="black">61</font>     notMatch: '此值不匹配验证规则',                                                                             <font color="black">72</font>     notMatch: '此值不匹配验证规则',                                                                      </pre></div>
<div row="3381"><pre row="3381">3381       <font color="black">62</font>     between: '此值应在 {} 和 {} 之间',                                                                          <font color="black">73</font>     between: '此值应在 {} 和 {} 之间',                                                                   </pre></div>
<div row="3382"><pre row="3382">3382 <font color="blue">---</font>                                                                                                                <font color="blue">---</font>                                                                                                               </pre></div>
<div row="3383"><pre row="3383">3383       <font color="black">75</font>   calendar: {                                                                                                   <font color="black">86</font>   calendar: {                                                                                            </pre></div>
<div row="3384"><pre row="3384">3384       <font color="black">76</font>     weeks: ['日', '一', '二', '三', '四', '五', '六'],                                                          <font color="black">87</font>     weeks: ['日', '一', '二', '三', '四', '五', '六'],                                                   </pre></div>
<div row="3385"><pre row="3385">3385       <font color="black">77</font>     months: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十       <font color="black">88</font>     months: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十</pre></div>
<div row="3386"><pre row="3386">3386 二月'],                                                                                                            二月'],                                                                                                           </pre></div>
<div row="3387"><pre row="3387">3387       <font color="black">78</font>   },                                                                                                            <font color="black">89</font>   },                                                                                                     </pre></div>
<div row="3388"><pre row="3388">3388       <font color="black">79</font>   button: {                                                                                                     <font color="black">90</font>   button: {                                                                                              </pre></div>
<div row="3389"><pre row="3389">3389                                                                                                                          <font color="black">91</font> <font color="green">    next: '下一步',</font>                                                                                      </pre></div>
<div row="3390"><pre row="3390">3390       <font color="black">80</font>     cancel: '取消',                                                                                             <font color="black">92</font>     cancel: '取消',                                                                                      </pre></div>
<div row="3391"><pre row="3391">3391       <font color="black">81</font>     remove: '删除',                                                                                             <font color="black">93</font>     remove: '删除',                                                                                      </pre></div>
<div row="3392"><pre row="3392">3392       <font color="black">82</font>     save: '保存',                                                                                               <font color="black">94</font>     save: '保存',                                                                                        </pre></div>
<div row="3393"><pre row="3393">3393       <font color="black">83</font>     ok: '确认',                                                                                                 <font color="black">95</font>     ok: '确认',                                                                                          </pre></div>
<div row="3394"><pre row="3394">3394       <font color="black">84</font>   },                                                                                                            <font color="black">96</font>   },                                                                                                     </pre></div>
